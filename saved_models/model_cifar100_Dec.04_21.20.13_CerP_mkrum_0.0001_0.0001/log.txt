current path: saved_models/model_cifar100_Dec.04_21.20.13_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4307/4885 (88.1679%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43987158551864. Distance: 2.2927566248238884
Total norm for 4 adversaries is: 42.43987158551864. distance: 2.2927566248238884
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4416, Accuracy: 8831/9900 (89.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4739/5305 (89.3308%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43531526270675. Distance: 2.2508279548626895
Total norm for 4 adversaries is: 42.43531526270675. distance: 2.2508279548626895
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7356, Accuracy: 8294/9900 (83.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4177/4717 (88.5520%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43873398887065. Distance: 2.1787652146141396
Total norm for 4 adversaries is: 42.43873398887065. distance: 2.1787652146141396
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4145, Accuracy: 8904/9900 (89.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4458/5066 (87.9984%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.440324602242974. Distance: 2.3036356966636706
Total norm for 4 adversaries is: 42.440324602242974. distance: 2.3036356966636706
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6015, Accuracy: 8509/9900 (85.9495%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3835/4356 (88.0395%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3665/4356 (84.1368%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4643, Accuracy: 4634/10000 (46.3400%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3934/4465 (88.1075%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4107/4465 (91.9821%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0136, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4052/4647 (87.1960%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4153/4647 (89.3695%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9129, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4448/5055 (87.9921%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4532/5055 (89.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1115, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4444/5116 (86.8647%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4470/5116 (87.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0041, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3626/4126 (87.8817%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3745/4126 (90.7659%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0008, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3081/3472 (88.7385%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3220/3472 (92.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0716, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4437/4986 (88.9892%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4457/4986 (89.3903%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1444, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3538/4013 (88.1635%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3691/4013 (91.9761%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8385, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4036/4618 (87.3971%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4083/4618 (88.4149%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9882, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4433/5083 (87.2123%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4440/5083 (87.3500%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0821, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3968/4511 (87.9628%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4019/4511 (89.0933%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2228, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3332/3797 (87.7535%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3379/3797 (88.9913%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9508, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4996/5582 (89.5020%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5069/5582 (90.8097%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1288, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3161/3616 (87.4170%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3202/3616 (88.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1171, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4824/5455 (88.4326%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4847/5455 (88.8543%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9362, Accuracy: 5374/10000 (53.7400%)
time spent on training: 265.83230233192444
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1521, Accuracy: 6979/10000 (69.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.8562, Accuracy: 68/9900 (0.6869%)
Done in 296.93032670021057 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4378/4885 (89.6213%), train_poison_data_count: 385
Global model norm: 42.465348063248136.
Norm before scaling: 42.47203526200357. Distance: 2.1581168455251003
Total norm for 4 adversaries is: 42.47203526200357. distance: 2.1581168455251003
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1967, Accuracy: 9386/9900 (94.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4763/5305 (89.7832%), train_poison_data_count: 415
Global model norm: 42.465348063248136.
Norm before scaling: 42.46863071405249. Distance: 2.2072859625557366
Total norm for 4 adversaries is: 42.46863071405249. distance: 2.2072859625557366
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4317, Accuracy: 8850/9900 (89.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4166/4717 (88.3188%), train_poison_data_count: 370
Global model norm: 42.465348063248136.
Norm before scaling: 42.47353122230582. Distance: 2.2105978984643655
Total norm for 4 adversaries is: 42.47353122230582. distance: 2.2105978984643655
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1993, Accuracy: 9391/9900 (94.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4467/5066 (88.1761%), train_poison_data_count: 400
Global model norm: 42.465348063248136.
Norm before scaling: 42.47597264281449. Distance: 2.350160301097977
Total norm for 4 adversaries is: 42.47597264281449. distance: 2.350160301097977
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1828, Accuracy: 9395/9900 (94.8990%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3595/4025 (89.3168%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3719/4025 (92.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8721, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3319/3797 (87.4111%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3371/3797 (88.7806%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0007, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3925/4625 (84.8649%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4012/4625 (86.7459%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1653, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3858/4481 (86.0969%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3883/4481 (86.6548%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2170, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3839/4315 (88.9687%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3958/4315 (91.7265%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9971, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3699/4235 (87.3436%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3801/4235 (89.7521%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0652, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3380/3828 (88.2968%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3478/3828 (90.8568%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9504, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3823/4416 (86.5716%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3949/4416 (89.4248%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8898, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3160/3638 (86.8609%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3273/3638 (89.9670%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9811, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4530/5265 (86.0399%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4512/5265 (85.6980%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9769, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3348/3781 (88.5480%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3303/3781 (87.3578%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0706, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3952/4441 (88.9890%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4012/4441 (90.3400%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1872, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3966/4433 (89.4654%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4009/4433 (90.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9265, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4402/5083 (86.6024%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4471/5083 (87.9599%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1136, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4302/4928 (87.2971%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4418/4928 (89.6510%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9551, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4145/4793 (86.4803%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4351/4793 (90.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0715, Accuracy: 5333/10000 (53.3300%)
time spent on training: 263.6372129917145
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1627, Accuracy: 6964/10000 (69.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.7392, Accuracy: 55/9900 (0.5556%)
Done in 294.61197805404663 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 42.50780173106829.
Norm before scaling: 42.50938832426462. Distance: 2.115775675739867
Total norm for 4 adversaries is: 42.50938832426462. distance: 2.115775675739867
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2199, Accuracy: 9322/9900 (94.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4743/5305 (89.4062%), train_poison_data_count: 415
Global model norm: 42.50780173106829.
Norm before scaling: 42.511371123555726. Distance: 2.1972266706616423
Total norm for 4 adversaries is: 42.511371123555726. distance: 2.1972266706616423
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0983, Accuracy: 9633/9900 (97.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4203/4717 (89.1032%), train_poison_data_count: 370
Global model norm: 42.50780173106829.
Norm before scaling: 42.510974858246165. Distance: 2.0883125185810796
Total norm for 4 adversaries is: 42.510974858246165. distance: 2.0883125185810796
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1860, Accuracy: 9403/9900 (94.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4487/5066 (88.5709%), train_poison_data_count: 400
Global model norm: 42.50780173106829.
Norm before scaling: 42.51253979755929. Distance: 2.238584274897117
Total norm for 4 adversaries is: 42.51253979755929. distance: 2.238584274897117
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1980, Accuracy: 9363/9900 (94.5758%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3127/3616 (86.4768%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3293/3616 (91.0675%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8334, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3406/3837 (88.7673%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3506/3837 (91.3735%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9566, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4156/4679 (88.8224%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4281/4679 (91.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0262, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3105/3638 (85.3491%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3252/3638 (89.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0631, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3618/4046 (89.4217%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3680/4046 (90.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9274, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3981/4518 (88.1142%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4091/4518 (90.5489%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1660, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3368/3797 (88.7016%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3381/3797 (89.0440%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2120, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4407/5025 (87.7015%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4457/5025 (88.6965%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3792, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3881/4362 (88.9729%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3889/4362 (89.1564%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0882, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3973/4558 (87.1654%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4047/4558 (88.7889%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1857, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3188/3672 (86.8192%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3259/3672 (88.7527%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2184, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4295/4874 (88.1206%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4374/4874 (89.7415%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2115, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3600/4025 (89.4410%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3729/4025 (92.6460%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8941, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4090/4663 (87.7118%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4207/4663 (90.2209%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1405, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3438/3911 (87.9059%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3413/3911 (87.2667%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0768, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4401/5017 (87.7217%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4521/5017 (90.1136%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8167, Accuracy: 5677/10000 (56.7700%)
time spent on training: 260.5874843597412
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1795, Accuracy: 6886/10000 (68.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.5503, Accuracy: 59/9900 (0.5960%)
Done in 291.8015706539154 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4400/4885 (90.0716%), train_poison_data_count: 385
Global model norm: 42.53782352993701.
Norm before scaling: 42.54182942677198. Distance: 2.1166270735434316
Total norm for 4 adversaries is: 42.54182942677198. distance: 2.1166270735434316
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.6254, Accuracy: 8498/9900 (85.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4766/5305 (89.8398%), train_poison_data_count: 415
Global model norm: 42.53782352993701.
Norm before scaling: 42.53838742003362. Distance: 2.1643122449738845
Total norm for 4 adversaries is: 42.53838742003362. distance: 2.1643122449738845
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1187, Accuracy: 9591/9900 (96.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4219/4717 (89.4424%), train_poison_data_count: 370
Global model norm: 42.53782352993701.
Norm before scaling: 42.53985522103434. Distance: 2.081963228470808
Total norm for 4 adversaries is: 42.53985522103434. distance: 2.081963228470808
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1763, Accuracy: 9435/9900 (95.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4480/5066 (88.4327%), train_poison_data_count: 400
Global model norm: 42.53782352993701.
Norm before scaling: 42.54436017861607. Distance: 2.260710021875657
Total norm for 4 adversaries is: 42.54436017861607. distance: 2.260710021875657
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2849, Accuracy: 9186/9900 (92.7879%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5250/6124 (85.7283%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5344/6124 (87.2632%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1124, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3874/4356 (88.9348%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3647/4356 (83.7236%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.5034, Accuracy: 4815/10000 (48.1500%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3512/4158 (84.4637%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3569/4158 (85.8345%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1423, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4847/5455 (88.8543%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4875/5455 (89.3676%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9541, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3925/4511 (87.0095%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4048/4511 (89.7362%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0218, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4506/5232 (86.1239%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4558/5232 (87.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1250, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4494/5244 (85.6979%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4533/5244 (86.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0996, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4349/4918 (88.4303%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4422/4918 (89.9146%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0820, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3587/4126 (86.9365%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3704/4126 (89.7722%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.7932, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4345/4928 (88.1696%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4411/4928 (89.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1151, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3715/4223 (87.9706%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3824/4223 (90.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9754, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4503/5195 (86.6795%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4605/5195 (88.6429%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1335, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4133/4679 (88.3308%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4191/4679 (89.5704%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9822, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3174/3646 (87.0543%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3286/3646 (90.1262%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8945, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3146/3616 (87.0022%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3205/3616 (88.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8869, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4056/4716 (86.0051%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4158/4716 (88.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0046, Accuracy: 5435/10000 (54.3500%)
time spent on training: 267.07736253738403
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.2438, Accuracy: 6826/10000 (68.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.7458, Accuracy: 50/9900 (0.5051%)
Done in 297.9537582397461 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4400/4885 (90.0716%), train_poison_data_count: 385
Global model norm: 42.57683054224959.
Norm before scaling: 42.58206403797701. Distance: 2.136616873535385
Total norm for 4 adversaries is: 42.58206403797701. distance: 2.136616873535385
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1624, Accuracy: 9494/9900 (95.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 42.57683054224959.
Norm before scaling: 42.573173450616174. Distance: 2.156671676315472
Total norm for 4 adversaries is: 42.573173450616174. distance: 2.156671676315472
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1049, Accuracy: 9624/9900 (97.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4203/4717 (89.1032%), train_poison_data_count: 370
Global model norm: 42.57683054224959.
Norm before scaling: 42.5790538889502. Distance: 2.094441200150401
Total norm for 4 adversaries is: 42.5790538889502. distance: 2.094441200150401
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1636, Accuracy: 9474/9900 (95.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4462/5066 (88.0774%), train_poison_data_count: 400
Global model norm: 42.57683054224959.
Norm before scaling: 42.58585795603468. Distance: 2.2884449825662014
Total norm for 4 adversaries is: 42.58585795603468. distance: 2.2884449825662014
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2237, Accuracy: 9329/9900 (94.2323%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5253/6124 (85.7773%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5355/6124 (87.4428%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9552, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3891/4433 (87.7735%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3973/4433 (89.6233%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9182, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3373/3781 (89.2092%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3295/3781 (87.1463%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.4021, Accuracy: 4906/10000 (49.0600%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3546/3969 (89.3424%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3575/3969 (90.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0626, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4451/5025 (88.5771%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4561/5025 (90.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0709, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4138/4679 (88.4377%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4211/4679 (89.9979%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9622, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4119/4707 (87.5080%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4254/4707 (90.3760%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9687, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4395/4986 (88.1468%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4375/4986 (87.7457%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9700, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3859/4315 (89.4322%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3927/4315 (91.0081%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9123, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3819/4416 (86.4810%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3927/4416 (88.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9528, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4261/4804 (88.6969%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4038/4804 (84.0550%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2129, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4126/4793 (86.0839%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4274/4793 (89.1717%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0044, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4512/5232 (86.2385%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4550/5232 (86.9648%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9742, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4082/4662 (87.5590%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4207/4662 (90.2402%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0767, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4215/4956 (85.0484%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4334/4956 (87.4496%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1516, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3805/4368 (87.1108%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3848/4368 (88.0952%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9288, Accuracy: 5481/10000 (54.8100%)
time spent on training: 270.3760070800781
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.2686, Accuracy: 6794/10000 (67.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.8643, Accuracy: 46/9900 (0.4646%)
Done in 301.7841212749481 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4355/4885 (89.1505%), train_poison_data_count: 385
Global model norm: 42.615661493073034.
Norm before scaling: 42.61956985206444. Distance: 2.1619989906259276
Total norm for 4 adversaries is: 42.61956985206444. distance: 2.1619989906259276
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2798, Accuracy: 9217/9900 (93.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4745/5305 (89.4439%), train_poison_data_count: 415
Global model norm: 42.615661493073034.
Norm before scaling: 42.61570732420368. Distance: 2.185287992060966
Total norm for 4 adversaries is: 42.61570732420368. distance: 2.185287992060966
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2302, Accuracy: 9331/9900 (94.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4247/4717 (90.0360%), train_poison_data_count: 370
Global model norm: 42.615661493073034.
Norm before scaling: 42.613783806563106. Distance: 2.042479826735346
Total norm for 4 adversaries is: 42.613783806563106. distance: 2.042479826735346
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1729, Accuracy: 9450/9900 (95.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4481/5066 (88.4524%), train_poison_data_count: 400
Global model norm: 42.615661493073034.
Norm before scaling: 42.623718421441275. Distance: 2.2837430317255123
Total norm for 4 adversaries is: 42.623718421441275. distance: 2.2837430317255123
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1689, Accuracy: 9465/9900 (95.6061%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5286/6124 (86.3161%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5332/6124 (87.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1271, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5051/5902 (85.5812%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5138/5902 (87.0552%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0468, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4153/4707 (88.2303%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4171/4707 (88.6127%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9316, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4040/4647 (86.9378%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4170/4647 (89.7353%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9928, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2927/3297 (88.7777%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3013/3297 (91.3861%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7492, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5515/6263 (88.0568%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5674/6263 (90.5956%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1832, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4137/4663 (88.7197%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4232/4663 (90.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1453, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4289/4956 (86.5416%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4337/4956 (87.5101%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0573, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3583/4046 (88.5566%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3685/4046 (91.0776%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9795, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3682/4184 (88.0019%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3792/4184 (90.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8146, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4841/5591 (86.5856%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4926/5591 (88.1059%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2308, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4052/4634 (87.4407%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4174/4634 (90.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9787, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3331/3828 (87.0167%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3471/3828 (90.6740%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9698, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3073/3638 (84.4695%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3226/3638 (88.6751%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9105, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3363/3781 (88.9447%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3405/3781 (90.0555%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1596, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3389/3837 (88.3242%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3521/3837 (91.7644%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9041, Accuracy: 5604/10000 (56.0400%)
time spent on training: 263.5211570262909
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.2595, Accuracy: 6835/10000 (68.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.7159, Accuracy: 59/9900 (0.5960%)
Done in 294.6601572036743 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4385/4885 (89.7646%), train_poison_data_count: 385
Global model norm: 42.6611218028378.
Norm before scaling: 42.66394733664186. Distance: 2.1129144431330493
Total norm for 4 adversaries is: 42.66394733664186. distance: 2.1129144431330493
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2103, Accuracy: 9386/9900 (94.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 42.6611218028378.
Norm before scaling: 42.66106600560252. Distance: 2.148158495733154
Total norm for 4 adversaries is: 42.66106600560252. distance: 2.148158495733154
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1649, Accuracy: 9501/9900 (95.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4190/4717 (88.8276%), train_poison_data_count: 370
Global model norm: 42.6611218028378.
Norm before scaling: 42.66359969878084. Distance: 2.0905471901319763
Total norm for 4 adversaries is: 42.66359969878084. distance: 2.0905471901319763
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1565, Accuracy: 9500/9900 (95.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4490/5066 (88.6301%), train_poison_data_count: 400
Global model norm: 42.6611218028378.
Norm before scaling: 42.665632553284325. Distance: 2.227793570716458
Total norm for 4 adversaries is: 42.665632553284325. distance: 2.227793570716458
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1962, Accuracy: 9418/9900 (95.1313%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3883/4501 (86.2697%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3913/4501 (86.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9947, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3633/4175 (87.0180%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3766/4175 (90.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8283, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3104/3616 (85.8407%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3214/3616 (88.8827%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8537, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4027/4634 (86.9012%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4137/4634 (89.2749%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9241, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3958/4558 (86.8363%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3989/4558 (87.5165%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1993, Accuracy: 5060/10000 (50.6000%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4554/5167 (88.1362%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4620/5167 (89.4136%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1853, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3938/4356 (90.4040%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3919/4356 (89.9679%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1064, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4109/4716 (87.1289%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4160/4716 (88.2103%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9436, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5302/6124 (86.5774%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5334/6124 (87.0999%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9891, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4401/5055 (87.0623%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4529/5055 (89.5945%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0710, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4467/5025 (88.8955%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4584/5025 (91.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1896, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4339/4918 (88.2269%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4427/4918 (90.0163%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1094, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3695/4223 (87.4970%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3805/4223 (90.1018%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0131, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0082, Accuracy: 3866/4481 (86.2754%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3905/4481 (87.1457%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9882, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3142/3638 (86.3661%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3272/3638 (89.9395%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0232, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3573/4013 (89.0356%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3670/4013 (91.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8296, Accuracy: 5730/10000 (57.3000%)
time spent on training: 267.4060423374176
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.2629, Accuracy: 6820/10000 (68.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 10.0469, Accuracy: 38/9900 (0.3838%)
Done in 298.2327799797058 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4393/4885 (89.9284%), train_poison_data_count: 385
Global model norm: 42.70608209894918.
Norm before scaling: 42.708561673678204. Distance: 2.10403217855294
Total norm for 4 adversaries is: 42.708561673678204. distance: 2.10403217855294
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2173, Accuracy: 9366/9900 (94.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 42.70608209894918.
Norm before scaling: 42.706633763184996. Distance: 2.1777030634660446
Total norm for 4 adversaries is: 42.706633763184996. distance: 2.1777030634660446
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2173, Accuracy: 9377/9900 (94.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4213/4717 (89.3152%), train_poison_data_count: 370
Global model norm: 42.70608209894918.
Norm before scaling: 42.70689673015721. Distance: 2.043903902657745
Total norm for 4 adversaries is: 42.70689673015721. distance: 2.043903902657745
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.3290, Accuracy: 9087/9900 (91.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4483/5066 (88.4919%), train_poison_data_count: 400
Global model norm: 42.70608209894918.
Norm before scaling: 42.71231863392501. Distance: 2.265942781458255
Total norm for 4 adversaries is: 42.71231863392501. distance: 2.265942781458255
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1159, Accuracy: 9599/9900 (96.9596%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3153/3646 (86.4783%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3297/3646 (90.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7802, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3897/4501 (86.5808%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4049/4501 (89.9578%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0159, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4039/4651 (86.8415%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4228/4651 (90.9052%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0086, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4553/5167 (88.1169%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4626/5167 (89.5297%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1285, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4858/5455 (89.0559%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4872/5455 (89.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0343, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4845/5591 (86.6571%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4902/5591 (87.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0457, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4172/4679 (89.1644%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4026/4679 (86.0440%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2118, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4422/5017 (88.1403%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4520/5017 (90.0937%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9286, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4185/4793 (87.3148%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4276/4793 (89.2134%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1518, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3990/4456 (89.5422%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4086/4456 (91.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9768, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4785/5424 (88.2190%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4941/5424 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1685, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3616/4175 (86.6108%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3636/4175 (87.0898%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0751, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4475/5116 (87.4707%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4529/5116 (88.5262%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0121, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3249/3704 (87.7160%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3332/3704 (89.9568%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8904, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4475/5232 (85.5313%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4599/5232 (87.9014%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1081, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3096/3472 (89.1705%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3171/3472 (91.3306%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0181, Accuracy: 5522/10000 (55.2200%)
time spent on training: 268.193722486496
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.2850, Accuracy: 6773/10000 (67.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 10.3404, Accuracy: 50/9900 (0.5051%)
Done in 298.8799328804016 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4373/4885 (89.5189%), train_poison_data_count: 385
Global model norm: 42.74364044893842.
Norm before scaling: 42.746580466764385. Distance: 2.09588650685904
Total norm for 4 adversaries is: 42.746580466764385. distance: 2.09588650685904
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2957, Accuracy: 9151/9900 (92.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4748/5305 (89.5005%), train_poison_data_count: 415
Global model norm: 42.74364044893842.
Norm before scaling: 42.7431221052544. Distance: 2.1868214235941137
Total norm for 4 adversaries is: 42.7431221052544. distance: 2.1868214235941137
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1844, Accuracy: 9439/9900 (95.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4212/4717 (89.2940%), train_poison_data_count: 370
Global model norm: 42.74364044893842.
Norm before scaling: 42.743756111547306. Distance: 2.0478157036679265
Total norm for 4 adversaries is: 42.743756111547306. distance: 2.0478157036679265
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1869, Accuracy: 9444/9900 (95.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4485/5066 (88.5314%), train_poison_data_count: 400
Global model norm: 42.74364044893842.
Norm before scaling: 42.75004568711009. Distance: 2.25799031860871
Total norm for 4 adversaries is: 42.75004568711009. distance: 2.25799031860871
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2879, Accuracy: 9168/9900 (92.6061%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3195/3590 (88.9972%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3318/3590 (92.4234%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9565, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3817/4368 (87.3855%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3901/4368 (89.3086%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9012, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3250/3704 (87.7430%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3365/3704 (90.8477%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9750, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4296/4928 (87.1753%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4400/4928 (89.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0531, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3960/4356 (90.9091%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3910/4356 (89.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0993, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3523/3911 (90.0793%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3408/3911 (87.1388%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2208, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4066/4651 (87.4221%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4158/4651 (89.4001%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1273, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3681/4184 (87.9780%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3776/4184 (90.2486%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8823, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3910/4346 (89.9678%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4008/4346 (92.2227%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0876, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4178/4793 (87.1688%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4344/4793 (90.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9784, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3356/3804 (88.2229%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3502/3804 (92.0610%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9196, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4455/4986 (89.3502%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4490/4986 (90.0521%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.7961, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5451/6124 (89.0105%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5410/6124 (88.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0714, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4140/4707 (87.9541%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4265/4707 (90.6097%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9601, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3763/4235 (88.8548%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3696/4235 (87.2727%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0835, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3613/4046 (89.2981%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3728/4046 (92.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9441, Accuracy: 5472/10000 (54.7200%)
time spent on training: 262.5216865539551
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.3235, Accuracy: 6667/10000 (66.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 10.2626, Accuracy: 44/9900 (0.4444%)
Done in 293.56615114212036 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 42.77436143408514.
Norm before scaling: 42.776818502220046. Distance: 2.1285105486252895
Total norm for 4 adversaries is: 42.776818502220046. distance: 2.1285105486252895
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1073, Accuracy: 9615/9900 (97.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4751/5305 (89.5570%), train_poison_data_count: 415
Global model norm: 42.77436143408514.
Norm before scaling: 42.77590674950313. Distance: 2.1808780167165716
Total norm for 4 adversaries is: 42.77590674950313. distance: 2.1808780167165716
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0913, Accuracy: 9669/9900 (97.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4263/4717 (90.3752%), train_poison_data_count: 370
Global model norm: 42.77436143408514.
Norm before scaling: 42.77208402538974. Distance: 2.0078377926194504
Total norm for 4 adversaries is: 42.77208402538974. distance: 2.0078377926194504
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3765, Accuracy: 9027/9900 (91.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4458/5066 (87.9984%), train_poison_data_count: 400
Global model norm: 42.77436143408514.
Norm before scaling: 42.78042822439369. Distance: 2.2805680601288536
Total norm for 4 adversaries is: 42.78042822439369. distance: 2.2805680601288536
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2815, Accuracy: 9184/9900 (92.7677%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4389/4986 (88.0265%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4457/4986 (89.3903%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9975, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4014/4634 (86.6206%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4134/4634 (89.2102%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9694, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4096/4716 (86.8533%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4240/4716 (89.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0091, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5399/6124 (88.1613%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5503/6124 (89.8596%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9886, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4333/4918 (88.1049%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4464/4918 (90.7686%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9237, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3336/3797 (87.8588%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3415/3797 (89.9394%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0247, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4953/5582 (88.7316%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5001/5582 (89.5915%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0806, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4281/4956 (86.3801%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4342/4956 (87.6110%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0397, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3937/4433 (88.8112%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4026/4433 (90.8189%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8667, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3822/4354 (87.7814%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0107, Accuracy: 3443/4354 (79.0767%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.5174, Accuracy: 4641/10000 (46.4100%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4323/4928 (87.7232%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4417/4928 (89.6307%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8854, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3525/3911 (90.1304%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3492/3911 (89.2866%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9318, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0087, Accuracy: 3814/4481 (85.1149%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3852/4481 (85.9630%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1770, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4548/5197 (87.5120%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4612/5197 (88.7435%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0695, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4802/5455 (88.0293%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4881/5455 (89.4775%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9812, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3765/4361 (86.3334%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3698/4361 (84.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2036, Accuracy: 5077/10000 (50.7700%)
time spent on training: 270.9259557723999
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.3644, Accuracy: 6607/10000 (66.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 10.5818, Accuracy: 42/9900 (0.4242%)
Done in 302.09714102745056 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4390/4885 (89.8669%), train_poison_data_count: 385
Global model norm: 42.81823068397677.
Norm before scaling: 42.82091899429092. Distance: 2.1191721267819865
Total norm for 4 adversaries is: 42.82091899429092. distance: 2.1191721267819865
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2097, Accuracy: 9430/9900 (95.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4747/5305 (89.4816%), train_poison_data_count: 415
Global model norm: 42.81823068397677.
Norm before scaling: 42.81855711029755. Distance: 2.1873077308081115
Total norm for 4 adversaries is: 42.81855711029755. distance: 2.1873077308081115
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1999, Accuracy: 9391/9900 (94.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4216/4717 (89.3788%), train_poison_data_count: 370
Global model norm: 42.81823068397677.
Norm before scaling: 42.81702758906204. Distance: 2.085745356136101
Total norm for 4 adversaries is: 42.81702758906204. distance: 2.085745356136101
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1394, Accuracy: 9522/9900 (96.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4450/5066 (87.8405%), train_poison_data_count: 400
Global model norm: 42.81823068397677.
Norm before scaling: 42.823715456143574. Distance: 2.3125546423152574
Total norm for 4 adversaries is: 42.823715456143574. distance: 2.3125546423152574
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1988, Accuracy: 9391/9900 (94.8586%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4265/4928 (86.5463%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4365/4928 (88.5755%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9865, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3693/4184 (88.2648%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3779/4184 (90.3203%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9203, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4173/4707 (88.6552%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4247/4707 (90.2273%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0035, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3360/3828 (87.7743%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3521/3828 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8679, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3931/4503 (87.2974%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4034/4503 (89.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9673, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4110/4662 (88.1596%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4246/4662 (91.0768%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9307, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3694/4235 (87.2255%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3846/4235 (90.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9940, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 4388/5244 (83.6766%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4513/5244 (86.0603%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9718, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4161/4793 (86.8141%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4359/4793 (90.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9541, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3877/4481 (86.5209%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3908/4481 (87.2127%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1769, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3864/4346 (88.9093%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4015/4346 (92.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7846, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3779/4361 (86.6544%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3738/4361 (85.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2429, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4493/5055 (88.8823%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4571/5055 (90.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8617, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4509/5195 (86.7950%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4568/5195 (87.9307%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1461, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3871/4315 (89.7103%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3988/4315 (92.4218%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9474, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4174/4663 (89.5132%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4279/4663 (91.7650%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2287, Accuracy: 5114/10000 (51.1400%)
time spent on training: 268.1156871318817
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.3613, Accuracy: 6596/10000 (65.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 10.4172, Accuracy: 55/9900 (0.5556%)
Done in 299.0733890533447 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4405/4885 (90.1740%), train_poison_data_count: 385
Global model norm: 42.85446734115068.
Norm before scaling: 42.85690699921149. Distance: 2.1048617080603167
Total norm for 4 adversaries is: 42.85690699921149. distance: 2.1048617080603167
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1440, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 42.85446734115068.
Norm before scaling: 42.85662501431007. Distance: 2.1875035967116077
Total norm for 4 adversaries is: 42.85662501431007. distance: 2.1875035967116077
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3357, Accuracy: 9115/9900 (92.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 42.85446734115068.
Norm before scaling: 42.851378047688705. Distance: 2.015797807249808
Total norm for 4 adversaries is: 42.851378047688705. distance: 2.015797807249808
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2135, Accuracy: 9361/9900 (94.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4485/5066 (88.5314%), train_poison_data_count: 400
Global model norm: 42.85446734115068.
Norm before scaling: 42.86057548218482. Distance: 2.2713095022835557
Total norm for 4 adversaries is: 42.86057548218482. distance: 2.2713095022835557
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1455, Accuracy: 9521/9900 (96.1717%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3902/4315 (90.4287%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3957/4315 (91.7034%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8798, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3192/3590 (88.9136%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3199/3590 (89.1086%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2033, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4239/4679 (90.5963%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4329/4679 (92.5198%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9496, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4539/5167 (87.8459%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4662/5167 (90.2264%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0749, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3322/3775 (88.0000%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3528/3775 (93.4570%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8072, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3359/3828 (87.7482%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3476/3828 (90.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9669, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3727/4235 (88.0047%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3867/4235 (91.3105%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8448, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4082/4647 (87.8416%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4204/4647 (90.4670%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9154, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4315/4918 (87.7389%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4433/4918 (90.1383%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0888, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3955/4433 (89.2172%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4011/4433 (90.4805%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9272, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4021/4481 (89.7344%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3969/4481 (88.5740%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0264, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3743/4295 (87.1478%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3686/4295 (85.8207%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0239, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3988/4503 (88.5632%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4040/4503 (89.7180%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8949, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3920/4354 (90.0322%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3754/4354 (86.2196%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.3095, Accuracy: 4979/10000 (49.7900%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4434/4986 (88.9290%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4452/4986 (89.2900%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0305, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5553/6263 (88.6636%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5741/6263 (91.6653%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0927, Accuracy: 5289/10000 (52.8900%)
time spent on training: 266.613974571228
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.4384, Accuracy: 6482/10000 (64.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 10.0504, Accuracy: 88/9900 (0.8889%)
Done in 297.9494822025299 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 42.88991774234724.
Norm before scaling: 42.89191567957839. Distance: 2.1530957578492096
Total norm for 4 adversaries is: 42.89191567957839. distance: 2.1530957578492096
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1604, Accuracy: 9494/9900 (95.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4702/5305 (88.6334%), train_poison_data_count: 415
Global model norm: 42.88991774234724.
Norm before scaling: 42.893633205071936. Distance: 2.30632576339868
Total norm for 4 adversaries is: 42.893633205071936. distance: 2.30632576339868
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0423, Accuracy: 9796/9900 (98.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 42.88991774234724.
Norm before scaling: 42.89013404773658. Distance: 2.0420481137352797
Total norm for 4 adversaries is: 42.89013404773658. distance: 2.0420481137352797
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1553, Accuracy: 9512/9900 (96.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4475/5066 (88.3340%), train_poison_data_count: 400
Global model norm: 42.88991774234724.
Norm before scaling: 42.89528663191767. Distance: 2.2676437329010115
Total norm for 4 adversaries is: 42.89528663191767. distance: 2.2676437329010115
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0907, Accuracy: 9663/9900 (97.6061%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3713/4223 (87.9233%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3849/4223 (91.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9049, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4830/5455 (88.5426%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4847/5455 (88.8543%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2411, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4977/5582 (89.1616%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5050/5582 (90.4694%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0814, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3959/4465 (88.6674%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4066/4465 (91.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8476, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4876/5591 (87.2116%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4953/5591 (88.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1623, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3497/3911 (89.4145%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3355/3911 (85.7837%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0795, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4001/4356 (91.8503%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0117, Accuracy: 3456/4356 (79.3388%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3954, Accuracy: 4810/10000 (48.1000%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4404/5037 (87.4330%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4529/5037 (89.9146%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9474, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4208/4679 (89.9337%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4333/4679 (92.6053%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9713, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3898/4362 (89.3627%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3881/4362 (88.9729%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3227, Accuracy: 4906/10000 (49.0600%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4039/4518 (89.3980%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4139/4518 (91.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0349, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4507/5083 (88.6681%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4531/5083 (89.1403%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1687, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3568/4013 (88.9110%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3727/4013 (92.8732%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7401, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4541/5197 (87.3773%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4619/5197 (88.8782%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1292, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2894/3297 (87.7768%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3029/3297 (91.8714%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9132, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3958/4441 (89.1241%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4041/4441 (90.9930%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0479, Accuracy: 5442/10000 (54.4200%)
time spent on training: 269.1979320049286
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.5037, Accuracy: 6432/10000 (64.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 9.9252, Accuracy: 75/9900 (0.7576%)
Done in 299.9958429336548 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4361/4885 (89.2733%), train_poison_data_count: 385
Global model norm: 42.93186058535447.
Norm before scaling: 42.93387363006991. Distance: 2.140168858399299
Total norm for 4 adversaries is: 42.93387363006991. distance: 2.140168858399299
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2600, Accuracy: 9298/9900 (93.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4737/5305 (89.2931%), train_poison_data_count: 415
Global model norm: 42.93186058535447.
Norm before scaling: 42.9297806243303. Distance: 2.2065130925208263
Total norm for 4 adversaries is: 42.9297806243303. distance: 2.2065130925208263
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1655, Accuracy: 9482/9900 (95.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 42.93186058535447.
Norm before scaling: 42.930916582724066. Distance: 2.0612997550812087
Total norm for 4 adversaries is: 42.930916582724066. distance: 2.0612997550812087
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.4243, Accuracy: 8839/9900 (89.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4437/5066 (87.5839%), train_poison_data_count: 400
Global model norm: 42.93186058535447.
Norm before scaling: 42.93704369981342. Distance: 2.314525850980273
Total norm for 4 adversaries is: 42.93704369981342. distance: 2.314525850980273
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2675, Accuracy: 9213/9900 (93.0606%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3938/4501 (87.4917%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4006/4501 (89.0024%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0616, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3905/4511 (86.5662%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4083/4511 (90.5121%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9216, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3981/4354 (91.4332%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3589/4354 (82.4299%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.6109, Accuracy: 4513/10000 (45.1300%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3887/4346 (89.4386%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3994/4346 (91.9006%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9161, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4106/4707 (87.2318%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4206/4707 (89.3563%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9494, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4855/5591 (86.8360%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4876/5591 (87.2116%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0504, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4053/4647 (87.2176%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4205/4647 (90.4885%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8487, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4007/4538 (88.2988%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4154/4538 (91.5381%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8474, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4257/4934 (86.2789%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4380/4934 (88.7718%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1458, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4301/4804 (89.5296%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4338/4804 (90.2998%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1443, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5533/6263 (88.3442%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5646/6263 (90.1485%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0598, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3959/4481 (88.3508%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4012/4481 (89.5336%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1255, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4367/5063 (86.2532%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4452/5063 (87.9321%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9295, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3663/4223 (86.7393%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3847/4223 (91.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9598, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3962/4441 (89.2141%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4058/4441 (91.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0218, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3315/3756 (88.2588%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3448/3756 (91.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9441, Accuracy: 5568/10000 (55.6800%)
time spent on training: 269.9542121887207
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.4543, Accuracy: 6461/10000 (64.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 10.6412, Accuracy: 52/9900 (0.5253%)
Done in 300.96432304382324 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4360/4885 (89.2528%), train_poison_data_count: 385
Global model norm: 42.97232513535965.
Norm before scaling: 42.97522820483694. Distance: 2.2047923386896064
Total norm for 4 adversaries is: 42.97522820483694. distance: 2.2047923386896064
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1534, Accuracy: 9501/9900 (95.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4726/5305 (89.0858%), train_poison_data_count: 415
Global model norm: 42.97232513535965.
Norm before scaling: 42.97149707127825. Distance: 2.281651500747171
Total norm for 4 adversaries is: 42.97149707127825. distance: 2.281651500747171
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0818, Accuracy: 9693/9900 (97.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4188/4717 (88.7852%), train_poison_data_count: 370
Global model norm: 42.97232513535965.
Norm before scaling: 42.97666120353145. Distance: 2.123066864340694
Total norm for 4 adversaries is: 42.97666120353145. distance: 2.123066864340694
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2406, Accuracy: 9287/9900 (93.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4445/5066 (87.7418%), train_poison_data_count: 400
Global model norm: 42.97232513535965.
Norm before scaling: 42.979494395310915. Distance: 2.342049452242473
Total norm for 4 adversaries is: 42.979494395310915. distance: 2.342049452242473
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1392, Accuracy: 9526/9900 (96.2222%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4373/5244 (83.3905%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4552/5244 (86.8040%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9671, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4292/4928 (87.0942%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4483/4928 (90.9700%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8003, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3369/3804 (88.5647%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3458/3804 (90.9043%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9620, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3546/4013 (88.3628%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3671/4013 (91.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8936, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3537/4158 (85.0649%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3595/4158 (86.4598%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9876, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4952/5582 (88.7137%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5016/5582 (89.8603%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0444, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4793/5455 (87.8643%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4910/5455 (90.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0256, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4054/4354 (93.1098%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3841/4354 (88.2177%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.3410, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3910/4433 (88.2021%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4021/4433 (90.7061%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9032, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3142/3646 (86.1766%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3323/3646 (91.1410%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9018, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4019/4518 (88.9553%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4093/4518 (90.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0675, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3719/4235 (87.8158%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3763/4235 (88.8548%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2602, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3926/4362 (90.0046%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3960/4362 (90.7840%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0156, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4797/5392 (88.9651%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4766/5392 (88.3902%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1019, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4809/5591 (86.0132%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4852/5591 (86.7823%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1167, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3320/3756 (88.3919%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3435/3756 (91.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0052, Accuracy: 5547/10000 (55.4700%)
time spent on training: 267.9798996448517
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.4435, Accuracy: 6485/10000 (64.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 10.4740, Accuracy: 64/9900 (0.6465%)
Done in 299.0163300037384 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4368/4885 (89.4166%), train_poison_data_count: 385
Global model norm: 43.00355266710167.
Norm before scaling: 43.00707239939947. Distance: 2.1606126961814307
Total norm for 4 adversaries is: 43.00707239939947. distance: 2.1606126961814307
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1369, Accuracy: 9534/9900 (96.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4696/5305 (88.5203%), train_poison_data_count: 415
Global model norm: 43.00355266710167.
Norm before scaling: 43.004886793083614. Distance: 2.2931931238044396
Total norm for 4 adversaries is: 43.004886793083614. distance: 2.2931931238044396
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0207, Accuracy: 9838/9900 (99.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4151/4717 (88.0008%), train_poison_data_count: 370
Global model norm: 43.00355266710167.
Norm before scaling: 43.00526715333469. Distance: 2.1620955910454365
Total norm for 4 adversaries is: 43.00526715333469. distance: 2.1620955910454365
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0875, Accuracy: 9677/9900 (97.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4414/5066 (87.1299%), train_poison_data_count: 400
Global model norm: 43.00355266710167.
Norm before scaling: 43.011762562699055. Distance: 2.391544638875701
Total norm for 4 adversaries is: 43.011762562699055. distance: 2.391544638875701
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1021, Accuracy: 9634/9900 (97.3131%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4053/4634 (87.4622%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4167/4634 (89.9223%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8960, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3972/4503 (88.2079%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4009/4503 (89.0295%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0098, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4265/4928 (86.5463%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4485/4928 (91.0106%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8418, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3316/3804 (87.1714%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3438/3804 (90.3785%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9537, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3164/3590 (88.1337%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3064/3590 (85.3482%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.4370, Accuracy: 4878/10000 (48.7800%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4035/4647 (86.8302%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4236/4647 (91.1556%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9164, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3927/4625 (84.9081%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4053/4625 (87.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1466, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4034/4356 (92.6079%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4078/4356 (93.6180%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9409, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3333/3797 (87.7798%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3465/3797 (91.2563%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8705, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3965/4456 (88.9811%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4060/4456 (91.1131%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9554, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3549/4025 (88.1739%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3708/4025 (92.1242%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8961, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3061/3472 (88.1624%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3164/3472 (91.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9465, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0069, Accuracy: 2863/3297 (86.8365%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3014/3297 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8822, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3834/4416 (86.8207%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3997/4416 (90.5118%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1318, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3954/4356 (90.7713%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4087/4356 (93.8246%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9685, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3125/3638 (85.8988%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3287/3638 (90.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9185, Accuracy: 5486/10000 (54.8600%)
time spent on training: 256.0350875854492
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.4212, Accuracy: 6530/10000 (65.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 10.1489, Accuracy: 93/9900 (0.9394%)
Done in 286.69995188713074 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4356/4885 (89.1709%), train_poison_data_count: 385
Global model norm: 43.03112518137308.
Norm before scaling: 43.03550070917105. Distance: 2.2221478516001896
Total norm for 4 adversaries is: 43.03550070917105. distance: 2.2221478516001896
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1779, Accuracy: 9474/9900 (95.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4728/5305 (89.1235%), train_poison_data_count: 415
Global model norm: 43.03112518137308.
Norm before scaling: 43.032654184605846. Distance: 2.2374059220467273
Total norm for 4 adversaries is: 43.032654184605846. distance: 2.2374059220467273
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1632, Accuracy: 9509/9900 (96.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4189/4717 (88.8064%), train_poison_data_count: 370
Global model norm: 43.03112518137308.
Norm before scaling: 43.02886561794521. Distance: 2.089794807217492
Total norm for 4 adversaries is: 43.02886561794521. distance: 2.089794807217492
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1103, Accuracy: 9594/9900 (96.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4448/5066 (87.8010%), train_poison_data_count: 400
Global model norm: 43.03112518137308.
Norm before scaling: 43.03800384997688. Distance: 2.299456747830679
Total norm for 4 adversaries is: 43.03800384997688. distance: 2.299456747830679
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1229, Accuracy: 9601/9900 (96.9798%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3605/4175 (86.3473%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3714/4175 (88.9581%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9338, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4223/4956 (85.2098%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4422/4956 (89.2252%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1427, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4405/5037 (87.4528%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4582/5037 (90.9668%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8832, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4160/4793 (86.7932%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4295/4793 (89.6098%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0804, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3324/3804 (87.3817%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3431/3804 (90.1945%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0129, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4762/5392 (88.3160%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4806/5392 (89.1320%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0597, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3937/4465 (88.1747%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4069/4465 (91.1310%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9777, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4078/4596 (88.7293%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4190/4596 (91.1662%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9650, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5350/6124 (87.3612%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5420/6124 (88.5042%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0918, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0067, Accuracy: 2844/3271 (86.9459%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2965/3271 (90.6451%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9027, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3254/3590 (90.6407%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3307/3590 (92.1170%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1328, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3844/4501 (85.4032%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4022/4501 (89.3579%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0510, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4519/5232 (86.3723%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4622/5232 (88.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0996, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3226/3672 (87.8540%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3292/3672 (89.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9844, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3697/4223 (87.5444%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3864/4223 (91.4989%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9680, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4112/4354 (94.4419%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0116, Accuracy: 3431/4354 (78.8011%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.5278, Accuracy: 4616/10000 (46.1600%)
time spent on training: 267.79352951049805
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.5208, Accuracy: 6338/10000 (63.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 9.4627, Accuracy: 228/9900 (2.3030%)
Done in 298.5066261291504 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4374/4885 (89.5394%), train_poison_data_count: 385
Global model norm: 43.07731172155767.
Norm before scaling: 43.08099827196876. Distance: 2.165691107199214
Total norm for 4 adversaries is: 43.08099827196876. distance: 2.165691107199214
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2478, Accuracy: 9324/9900 (94.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4743/5305 (89.4062%), train_poison_data_count: 415
Global model norm: 43.07731172155767.
Norm before scaling: 43.07833469299707. Distance: 2.225921003052133
Total norm for 4 adversaries is: 43.07833469299707. distance: 2.225921003052133
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0984, Accuracy: 9661/9900 (97.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4172/4717 (88.4460%), train_poison_data_count: 370
Global model norm: 43.07731172155767.
Norm before scaling: 43.08107902684411. Distance: 2.206969997940131
Total norm for 4 adversaries is: 43.08107902684411. distance: 2.206969997940131
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0679, Accuracy: 9719/9900 (98.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4427/5066 (87.3865%), train_poison_data_count: 400
Global model norm: 43.07731172155767.
Norm before scaling: 43.08629660435119. Distance: 2.3394032160743796
Total norm for 4 adversaries is: 43.08629660435119. distance: 2.3394032160743796
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1051, Accuracy: 9641/9900 (97.3838%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4962/5582 (88.8929%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5016/5582 (89.8603%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2198, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3985/4647 (85.7543%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4200/4647 (90.3809%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9444, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3893/4465 (87.1892%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4097/4465 (91.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8185, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4415/5083 (86.8582%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4498/5083 (88.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9693, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3765/4416 (85.2582%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3952/4416 (89.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9105, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4227/4956 (85.2906%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4362/4956 (88.0145%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1385, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3888/4362 (89.1334%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3873/4362 (88.7895%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1043, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4001/4356 (91.8503%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3998/4356 (91.7815%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1151, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3273/3781 (86.5644%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3433/3781 (90.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1393, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3225/3590 (89.8329%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3284/3590 (91.4763%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0164, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4081/4651 (87.7446%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4214/4651 (90.6042%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9918, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4046/4662 (86.7868%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4225/4662 (90.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9057, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3043/3472 (87.6440%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3225/3472 (92.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8844, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4792/5424 (88.3481%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4919/5424 (90.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1119, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2840/3271 (86.8236%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2918/3271 (89.2082%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9022, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4340/5037 (86.1624%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4487/5037 (89.0808%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9483, Accuracy: 5517/10000 (55.1700%)
time spent on training: 263.52240085601807
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.4734, Accuracy: 6431/10000 (64.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 9.2948, Accuracy: 210/9900 (2.1212%)
Done in 294.098566532135 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4382/4885 (89.7032%), train_poison_data_count: 385
Global model norm: 43.10581972699205.
Norm before scaling: 43.10849859792368. Distance: 2.1520829778365083
Total norm for 4 adversaries is: 43.10849859792368. distance: 2.1520829778365083
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2098, Accuracy: 9379/9900 (94.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4718/5305 (88.9350%), train_poison_data_count: 415
Global model norm: 43.10581972699205.
Norm before scaling: 43.10854532093956. Distance: 2.260736598096492
Total norm for 4 adversaries is: 43.10854532093956. distance: 2.260736598096492
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2068, Accuracy: 9368/9900 (94.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4224/4717 (89.5484%), train_poison_data_count: 370
Global model norm: 43.10581972699205.
Norm before scaling: 43.103103872883246. Distance: 2.045678291221055
Total norm for 4 adversaries is: 43.103103872883246. distance: 2.045678291221055
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2717, Accuracy: 9261/9900 (93.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4412/5066 (87.0904%), train_poison_data_count: 400
Global model norm: 43.10581972699205.
Norm before scaling: 43.11581367284949. Distance: 2.372220772329101
Total norm for 4 adversaries is: 43.11581367284949. distance: 2.372220772329101
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.4465, Accuracy: 8790/9900 (88.7879%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4267/4989 (85.5282%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4446/4989 (89.1161%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9462, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3536/4013 (88.1136%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3714/4013 (92.5492%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8367, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4428/5195 (85.2358%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4439/5195 (85.4475%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0181, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3458/3969 (87.1252%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3563/3969 (89.7707%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9313, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4098/4356 (94.0771%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4108/4356 (94.3067%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9471, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3936/4441 (88.6287%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3998/4441 (90.0248%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0585, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4025/4518 (89.0881%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4159/4518 (92.0540%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9728, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3436/3911 (87.8548%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3312/3911 (84.6842%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1704, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3859/4362 (88.4686%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3814/4362 (87.4370%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.4295, Accuracy: 4808/10000 (48.0800%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3326/3804 (87.4343%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3434/3804 (90.2734%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0176, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3691/4223 (87.4023%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3860/4223 (91.4042%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0239, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4058/4634 (87.5701%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4208/4634 (90.8071%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9086, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4134/4354 (94.9472%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3676/4354 (84.4281%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.3557, Accuracy: 4940/10000 (49.4000%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0091, Accuracy: 4303/5244 (82.0557%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4524/5244 (86.2700%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8981, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4373/5037 (86.8176%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4568/5037 (90.6889%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8860, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3154/3704 (85.1512%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3333/3704 (89.9838%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9430, Accuracy: 5527/10000 (55.2700%)
time spent on training: 265.0822944641113
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.5353, Accuracy: 6342/10000 (63.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 8.9821, Accuracy: 266/9900 (2.6869%)
Done in 296.2193043231964 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4373/4885 (89.5189%), train_poison_data_count: 385
Global model norm: 43.14452399982963.
Norm before scaling: 43.14611264219307. Distance: 2.1668993262550322
Total norm for 4 adversaries is: 43.14611264219307. distance: 2.1668993262550322
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1683, Accuracy: 9468/9900 (95.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4699/5305 (88.5768%), train_poison_data_count: 415
Global model norm: 43.14452399982963.
Norm before scaling: 43.14997436947023. Distance: 2.2919001258074108
Total norm for 4 adversaries is: 43.14997436947023. distance: 2.2919001258074108
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1034, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4180/4717 (88.6156%), train_poison_data_count: 370
Global model norm: 43.14452399982963.
Norm before scaling: 43.143225315511586. Distance: 2.1134908575722546
Total norm for 4 adversaries is: 43.143225315511586. distance: 2.1134908575722546
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1108, Accuracy: 9595/9900 (96.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4441/5066 (87.6629%), train_poison_data_count: 400
Global model norm: 43.14452399982963.
Norm before scaling: 43.15139024954758. Distance: 2.3292170274052166
Total norm for 4 adversaries is: 43.15139024954758. distance: 2.3292170274052166
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2110, Accuracy: 9358/9900 (94.5253%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3776/4416 (85.5072%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3969/4416 (89.8777%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8859, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4519/5197 (86.9540%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4611/5197 (88.7243%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0214, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4271/4918 (86.8442%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4433/4918 (90.1383%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0904, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5518/6263 (88.1047%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5659/6263 (90.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0529, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3098/3646 (84.9698%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3260/3646 (89.4131%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8925, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4138/4707 (87.9116%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4263/4707 (90.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9464, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4344/5063 (85.7989%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4343/5063 (85.7792%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0965, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3651/4295 (85.0058%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3815/4295 (88.8242%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1123, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4123/4793 (86.0213%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4294/4793 (89.5890%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0387, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3999/4538 (88.1225%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4186/4538 (92.2433%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9102, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4440/5083 (87.3500%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4524/5083 (89.0026%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9581, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3115/3638 (85.6240%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3271/3638 (89.9120%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8330, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5326/6124 (86.9693%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5453/6124 (89.0431%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0016, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3983/4618 (86.2495%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4077/4618 (88.2850%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9549, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3474/3969 (87.5283%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3559/3969 (89.6699%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9628, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0087, Accuracy: 3463/4158 (83.2852%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3642/4158 (87.5902%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9236, Accuracy: 5524/10000 (55.2400%)
time spent on training: 271.32846760749817
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.4902, Accuracy: 6419/10000 (64.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 9.0114, Accuracy: 297/9900 (3.0000%)
Done in 302.1837885379791 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4324/4885 (88.5159%), train_poison_data_count: 385
Global model norm: 43.181554006836215.
Norm before scaling: 43.18646972133966. Distance: 2.147910091514649
Total norm for 4 adversaries is: 43.18646972133966. distance: 2.147910091514649
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2447, Accuracy: 9275/9900 (93.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4696/5305 (88.5203%), train_poison_data_count: 415
Global model norm: 43.181554006836215.
Norm before scaling: 43.182910901713335. Distance: 2.2624759230201974
Total norm for 4 adversaries is: 43.182910901713335. distance: 2.2624759230201974
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2546, Accuracy: 9276/9900 (93.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4197/4717 (88.9760%), train_poison_data_count: 370
Global model norm: 43.181554006836215.
Norm before scaling: 43.179247187686265. Distance: 2.082930551375693
Total norm for 4 adversaries is: 43.179247187686265. distance: 2.082930551375693
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1835, Accuracy: 9413/9900 (95.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4451/5066 (87.8602%), train_poison_data_count: 400
Global model norm: 43.181554006836215.
Norm before scaling: 43.188247607946685. Distance: 2.3321594509752006
Total norm for 4 adversaries is: 43.188247607946685. distance: 2.3321594509752006
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2342, Accuracy: 9330/9900 (94.2424%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4025/4716 (85.3478%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4187/4716 (88.7829%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0367, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3947/4481 (88.0830%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3975/4481 (88.7079%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0893, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3794/4361 (86.9984%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3791/4361 (86.9296%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0196, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4141/4793 (86.3968%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4350/4793 (90.7574%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9637, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3729/4295 (86.8219%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3702/4295 (86.1932%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1582, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0085, Accuracy: 4359/5244 (83.1236%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4540/5244 (86.5751%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0394, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4279/4989 (85.7687%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4433/4989 (88.8555%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9678, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4533/5197 (87.2234%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4612/5197 (88.7435%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0076, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3899/4356 (89.5087%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3745/4356 (85.9734%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3349, Accuracy: 4833/10000 (48.3300%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4029/4647 (86.7011%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4159/4647 (89.4986%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9299, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3563/4013 (88.7864%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3722/4013 (92.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7775, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4000/4538 (88.1446%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4138/4538 (91.1855%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8564, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4105/4707 (87.2105%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4236/4707 (89.9936%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8901, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5533/6263 (88.3442%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5683/6263 (90.7393%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1244, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3718/4235 (87.7922%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3760/4235 (88.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0571, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3355/3861 (86.8946%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3504/3861 (90.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1198, Accuracy: 5299/10000 (52.9900%)
time spent on training: 259.2301082611084
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.5270, Accuracy: 6368/10000 (63.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 8.2068, Accuracy: 528/9900 (5.3333%)
Done in 289.8003809452057 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4343/4885 (88.9048%), train_poison_data_count: 385
Global model norm: 43.21247638396086.
Norm before scaling: 43.215835042695865. Distance: 2.2205126570830696
Total norm for 4 adversaries is: 43.215835042695865. distance: 2.2205126570830696
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0633, Accuracy: 9734/9900 (98.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4712/5305 (88.8219%), train_poison_data_count: 415
Global model norm: 43.21247638396086.
Norm before scaling: 43.2157856110075. Distance: 2.230088076199279
Total norm for 4 adversaries is: 43.2157856110075. distance: 2.230088076199279
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2465, Accuracy: 9336/9900 (94.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4170/4717 (88.4036%), train_poison_data_count: 370
Global model norm: 43.21247638396086.
Norm before scaling: 43.21353287834871. Distance: 2.127160937032874
Total norm for 4 adversaries is: 43.21353287834871. distance: 2.127160937032874
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1255, Accuracy: 9587/9900 (96.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4433/5066 (87.5049%), train_poison_data_count: 400
Global model norm: 43.21247638396086.
Norm before scaling: 43.21937420463912. Distance: 2.347418190665062
Total norm for 4 adversaries is: 43.21937420463912. distance: 2.347418190665062
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1435, Accuracy: 9525/9900 (96.2121%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4467/5055 (88.3680%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4590/5055 (90.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9062, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3338/3828 (87.1996%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3519/3828 (91.9279%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9189, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3787/4361 (86.8379%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3848/4361 (88.2366%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9814, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3542/4013 (88.2631%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3696/4013 (92.1007%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8530, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4000/4518 (88.5347%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4134/4518 (91.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9185, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3951/4558 (86.6828%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4062/4558 (89.1180%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1377, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3598/4126 (87.2031%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3803/4126 (92.1716%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8995, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4226/4679 (90.3184%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4000/4679 (85.4884%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0903, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3716/4235 (87.7450%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3747/4235 (88.4770%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9461, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4296/5037 (85.2889%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4582/5037 (90.9668%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8610, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3160/3672 (86.0566%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3371/3672 (91.8028%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8871, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4262/4928 (86.4854%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4416/4928 (89.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9456, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4037/4356 (92.6768%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3900/4356 (89.5317%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0345, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3939/4456 (88.3977%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4084/4456 (91.6517%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9991, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4122/4793 (86.0004%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4346/4793 (90.6739%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9701, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4378/5025 (87.1244%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4557/5025 (90.6866%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0205, Accuracy: 5460/10000 (54.6000%)
time spent on training: 266.7036292552948
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.4949, Accuracy: 6405/10000 (64.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 8.3319, Accuracy: 487/9900 (4.9192%)
Done in 297.4353108406067 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4359/4885 (89.2323%), train_poison_data_count: 385
Global model norm: 43.24804541961622.
Norm before scaling: 43.25352931093094. Distance: 2.166957309987182
Total norm for 4 adversaries is: 43.25352931093094. distance: 2.166957309987182
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0521, Accuracy: 9771/9900 (98.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4728/5305 (89.1235%), train_poison_data_count: 415
Global model norm: 43.24804541961622.
Norm before scaling: 43.24854359903348. Distance: 2.2459713579085676
Total norm for 4 adversaries is: 43.24854359903348. distance: 2.2459713579085676
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0728, Accuracy: 9695/9900 (97.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 43.24804541961622.
Norm before scaling: 43.245881871319554. Distance: 2.0467345211365853
Total norm for 4 adversaries is: 43.245881871319554. distance: 2.0467345211365853
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1845, Accuracy: 9450/9900 (95.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4436/5066 (87.5642%), train_poison_data_count: 400
Global model norm: 43.24804541961622.
Norm before scaling: 43.25447897237782. Distance: 2.297319745452927
Total norm for 4 adversaries is: 43.25447897237782. distance: 2.297319745452927
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2798, Accuracy: 9214/9900 (93.0707%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3858/4346 (88.7713%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4021/4346 (92.5219%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8585, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3647/4184 (87.1654%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3776/4184 (90.2486%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9604, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4045/4356 (92.8604%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3692/4356 (84.7567%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1883, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3176/3646 (87.1092%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3320/3646 (91.0587%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8227, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4445/5083 (87.4484%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4524/5083 (89.0026%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0226, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3966/4356 (91.0468%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3894/4356 (89.3939%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1017, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3942/4558 (86.4853%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4025/4558 (88.3063%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0965, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3594/4175 (86.0838%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3726/4175 (89.2455%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9141, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3027/3472 (87.1832%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3122/3472 (89.9194%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1359, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3914/4501 (86.9585%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4035/4501 (89.6467%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1947, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4800/5424 (88.4956%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4947/5424 (91.2058%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1693, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3937/4481 (87.8599%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3987/4481 (88.9757%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1004, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4730/5455 (86.7094%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4835/5455 (88.6343%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1697, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4496/5232 (85.9327%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4666/5232 (89.1820%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0717, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0077, Accuracy: 5422/6391 (84.8381%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5512/6391 (86.2463%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0794, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3365/3775 (89.1391%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3537/3775 (93.6954%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8444, Accuracy: 5735/10000 (57.3500%)
time spent on training: 267.9385221004486
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.4898, Accuracy: 6391/10000 (63.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 8.5782, Accuracy: 382/9900 (3.8586%)
Done in 299.13800525665283 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 43.284252208601366.
Norm before scaling: 43.28331730171135. Distance: 2.2026455404840246
Total norm for 4 adversaries is: 43.28331730171135. distance: 2.2026455404840246
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1381, Accuracy: 9525/9900 (96.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4733/5305 (89.2177%), train_poison_data_count: 415
Global model norm: 43.284252208601366.
Norm before scaling: 43.27998221293029. Distance: 2.1969455061948944
Total norm for 4 adversaries is: 43.27998221293029. distance: 2.1969455061948944
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0870, Accuracy: 9664/9900 (97.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4179/4717 (88.5944%), train_poison_data_count: 370
Global model norm: 43.284252208601366.
Norm before scaling: 43.28150806556638. Distance: 2.074486092043411
Total norm for 4 adversaries is: 43.28150806556638. distance: 2.074486092043411
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1169, Accuracy: 9591/9900 (96.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4409/5066 (87.0312%), train_poison_data_count: 400
Global model norm: 43.284252208601366.
Norm before scaling: 43.289607439946685. Distance: 2.312097669089412
Total norm for 4 adversaries is: 43.289607439946685. distance: 2.312097669089412
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1300, Accuracy: 9560/9900 (96.5657%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3552/4025 (88.2484%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3700/4025 (91.9255%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7721, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3681/4223 (87.1655%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3833/4223 (90.7649%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0265, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3154/3638 (86.6960%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3319/3638 (91.2314%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8642, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4421/5063 (87.3198%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4439/5063 (87.6753%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1156, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4198/4874 (86.1305%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4252/4874 (87.2384%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1879, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4299/4804 (89.4879%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4200/4804 (87.4271%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2245, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3471/4158 (83.4776%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3634/4158 (87.3978%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9375, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3978/4518 (88.0478%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4149/4518 (91.8327%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9056, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3723/4235 (87.9103%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3710/4235 (87.6033%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1766, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4214/4934 (85.4074%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4138/4934 (83.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2683, Accuracy: 4964/10000 (49.6400%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0078, Accuracy: 5421/6391 (84.8224%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5628/6391 (88.0613%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0616, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3712/4295 (86.4261%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3779/4295 (87.9860%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0970, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3333/3756 (88.7380%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3487/3756 (92.8381%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9343, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3937/4481 (87.8599%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3932/4481 (87.7483%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0668, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3598/4175 (86.1796%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3709/4175 (88.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8951, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3203/3590 (89.2201%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3145/3590 (87.6045%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2094, Accuracy: 5148/10000 (51.4800%)
time spent on training: 263.091361284256
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.5453, Accuracy: 6286/10000 (62.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 8.9701, Accuracy: 276/9900 (2.7879%)
Done in 294.17603969573975 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4386/4885 (89.7851%), train_poison_data_count: 385
Global model norm: 43.32507793333657.
Norm before scaling: 43.32534278166114. Distance: 2.1591506466062045
Total norm for 4 adversaries is: 43.32534278166114. distance: 2.1591506466062045
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2221, Accuracy: 9350/9900 (94.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4745/5305 (89.4439%), train_poison_data_count: 415
Global model norm: 43.32507793333657.
Norm before scaling: 43.324979319185054. Distance: 2.1973338748080935
Total norm for 4 adversaries is: 43.324979319185054. distance: 2.1973338748080935
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2023, Accuracy: 9427/9900 (95.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 43.32507793333657.
Norm before scaling: 43.3271417351468. Distance: 2.0778601915104558
Total norm for 4 adversaries is: 43.3271417351468. distance: 2.0778601915104558
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1328, Accuracy: 9587/9900 (96.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4428/5066 (87.4062%), train_poison_data_count: 400
Global model norm: 43.32507793333657.
Norm before scaling: 43.331814157314746. Distance: 2.3225348006188087
Total norm for 4 adversaries is: 43.331814157314746. distance: 2.3225348006188087
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1518, Accuracy: 9517/9900 (96.1313%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3364/3828 (87.8788%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3527/3828 (92.1369%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8583, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3466/3911 (88.6218%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3404/3911 (87.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0249, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3905/4362 (89.5232%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3910/4362 (89.6378%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0207, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4590/5197 (88.3202%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4582/5197 (88.1662%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0116, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4308/4679 (92.0710%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4382/4679 (93.6525%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9257, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4124/4793 (86.0421%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4254/4793 (88.7544%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0286, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4429/5116 (86.5715%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4585/5116 (89.6208%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0674, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3931/4625 (84.9946%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4070/4625 (88.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9720, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4071/4618 (88.1550%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4087/4618 (88.5015%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0315, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2861/3271 (87.4656%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3004/3271 (91.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8693, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3603/4175 (86.2994%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3676/4175 (88.0479%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9676, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3092/3616 (85.5088%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3303/3616 (91.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8113, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3882/4481 (86.6324%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3984/4481 (88.9087%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0313, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3796/4368 (86.9048%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3925/4368 (89.8581%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9883, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4926/5740 (85.8188%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5195/5740 (90.5052%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0257, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4043/4647 (87.0024%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4189/4647 (90.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0197, Accuracy: 5391/10000 (53.9100%)
time spent on training: 265.3665542602539
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.5661, Accuracy: 6306/10000 (63.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 7.3943, Accuracy: 680/9900 (6.8687%)
Done in 296.00966596603394 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4405/4885 (90.1740%), train_poison_data_count: 385
Global model norm: 43.35891187815733.
Norm before scaling: 43.35689463626287. Distance: 2.0955786619174406
Total norm for 4 adversaries is: 43.35689463626287. distance: 2.0955786619174406
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2547, Accuracy: 9232/9900 (93.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 43.35891187815733.
Norm before scaling: 43.3527739907761. Distance: 2.1373818883554527
Total norm for 4 adversaries is: 43.3527739907761. distance: 2.1373818883554527
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1982, Accuracy: 9398/9900 (94.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4202/4717 (89.0820%), train_poison_data_count: 370
Global model norm: 43.35891187815733.
Norm before scaling: 43.35861767356635. Distance: 2.051192062647633
Total norm for 4 adversaries is: 43.35861767356635. distance: 2.051192062647633
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1778, Accuracy: 9430/9900 (95.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4440/5066 (87.6431%), train_poison_data_count: 400
Global model norm: 43.35891187815733.
Norm before scaling: 43.36578218426511. Distance: 2.3036894107991692
Total norm for 4 adversaries is: 43.36578218426511. distance: 2.3036894107991692
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1058, Accuracy: 9620/9900 (97.1717%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4857/5591 (86.8718%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4993/5591 (89.3042%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1190, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4210/4956 (84.9475%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4309/4956 (86.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1306, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3907/4511 (86.6105%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4070/4511 (90.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9800, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3537/4013 (88.1385%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3670/4013 (91.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9344, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3237/3590 (90.1671%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3355/3590 (93.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8473, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4140/4793 (86.3760%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4316/4793 (90.0480%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1090, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3338/3804 (87.7497%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3452/3804 (90.7466%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8912, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3343/3837 (87.1254%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3532/3837 (92.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9451, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3785/4361 (86.7920%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3801/4361 (87.1589%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0908, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4446/5063 (87.8135%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4395/5063 (86.8062%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1394, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3789/4368 (86.7445%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3895/4368 (89.1712%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0701, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4330/4679 (92.5411%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4091/4679 (87.4332%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1238, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4632/5265 (87.9772%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4694/5265 (89.1548%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0459, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4103/4767 (86.0709%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4199/4767 (88.0847%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1408, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5143/5902 (87.1400%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4991/5902 (84.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1749, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3689/4223 (87.3550%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3844/4223 (91.0253%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9428, Accuracy: 5565/10000 (55.6500%)
time spent on training: 267.46591210365295
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Client 3 misclassified the most to class 2 with 1 misclassifications.
Client 3 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {3: 1})
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(3, 1)]
Top 3 clients: [(3, 1)]
Client 3 misclassification ratio: 1.0000
