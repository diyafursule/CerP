current path: saved_models/model_cifar100_Aug.21_15.01.00_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 85, 4, 97, 76, 38, 94, 86, 10, 29, 34, 7, 18, 6, 22, 69, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4750/5308 (89.4876%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.439156815964196. Distance: 2.2828087902626426
Total norm for 4 adversaries is: 42.439156815964196. distance: 2.2828087902626426
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5613, Accuracy: 8595/9900 (86.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5304/5777 (91.8124%), train_poison_data_count: 455
Global model norm: 42.432124970265015.
Norm before scaling: 42.429647941198645. Distance: 2.173558412941551
Total norm for 4 adversaries is: 42.429647941198645. distance: 2.173558412941551
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5684, Accuracy: 8586/9900 (86.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4581/5123 (89.4203%), train_poison_data_count: 403
Global model norm: 42.432124970265015.
Norm before scaling: 42.43905614322879. Distance: 2.2623691710693095
Total norm for 4 adversaries is: 42.43905614322879. distance: 2.2623691710693095
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4738, Accuracy: 8748/9900 (88.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4940/5503 (89.7692%), train_poison_data_count: 430
Global model norm: 42.432124970265015.
Norm before scaling: 42.43936103706528. Distance: 2.3062828619871953
Total norm for 4 adversaries is: 42.43936103706528. distance: 2.3062828619871953
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5330, Accuracy: 8597/9900 (86.8384%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 6165/6947 (88.7433%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 6167/6947 (88.7721%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1067, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3579/4028 (88.8530%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3701/4028 (91.8818%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9126, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4114/4736 (86.8666%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4237/4736 (89.4637%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9818, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3454/3959 (87.2443%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3587/3959 (90.6037%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8930, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5468/6235 (87.6985%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5458/6235 (87.5381%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.3110, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4530/5224 (86.7152%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4711/5224 (90.1799%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0245, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3458/3929 (88.0122%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3570/3929 (90.8628%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9288, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4573/5068 (90.2328%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4677/5068 (92.2849%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9745, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4306/4732 (90.9975%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4391/4732 (92.7937%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.7910, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4432/4911 (90.2464%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4502/4911 (91.6718%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9055, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4284/4869 (87.9852%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3994/4869 (82.0292%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2828, Accuracy: 4903/10000 (49.0300%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3749/4249 (88.2325%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3846/4249 (90.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0143, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4419/4929 (89.6531%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4472/4929 (90.7283%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9884, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5119/5696 (89.8701%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5138/5696 (90.2037%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0512, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3915/4364 (89.7113%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3912/4364 (89.6425%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9370, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4525/5035 (89.8709%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4653/5035 (92.4131%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9967, Accuracy: 5416/10000 (54.1600%)
time spent on training: 242.88913559913635
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1043, Accuracy: 7043/10000 (70.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 8.8574, Accuracy: 135/9900 (1.3636%)
Done in 269.1116440296173 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 47, 10, 95, 98, 64, 57, 27, 85, 93, 6, 74, 54, 88, 45, 51, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4870/5308 (91.7483%), train_poison_data_count: 415
Global model norm: 42.4532270770764.
Norm before scaling: 42.45555896822803. Distance: 2.068482363811254
Total norm for 4 adversaries is: 42.45555896822803. distance: 2.068482363811254
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2307, Accuracy: 9309/9900 (94.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5373/5777 (93.0068%), train_poison_data_count: 455
Global model norm: 42.4532270770764.
Norm before scaling: 42.44496666640816. Distance: 1.9870175165864326
Total norm for 4 adversaries is: 42.44496666640816. distance: 1.9870175165864326
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2258, Accuracy: 9332/9900 (94.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4600/5123 (89.7911%), train_poison_data_count: 403
Global model norm: 42.4532270770764.
Norm before scaling: 42.45735739851958. Distance: 2.1506793168782394
Total norm for 4 adversaries is: 42.45735739851958. distance: 2.1506793168782394
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1172, Accuracy: 9590/9900 (96.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5044/5503 (91.6591%), train_poison_data_count: 430
Global model norm: 42.4532270770764.
Norm before scaling: 42.45574010854201. Distance: 2.105358340282555
Total norm for 4 adversaries is: 42.45574010854201. distance: 2.105358340282555
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2887, Accuracy: 9181/9900 (92.7374%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4481/5123 (87.4683%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4197/5123 (81.9247%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0893, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4541/5068 (89.6014%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4604/5068 (90.8445%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0526, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4340/5018 (86.4886%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4466/5018 (88.9996%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2714, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3765/4161 (90.4831%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3761/4161 (90.3869%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0337, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4302/4894 (87.9036%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4322/4894 (88.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1696, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4424/4956 (89.2655%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4561/4956 (92.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9857, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4085/4587 (89.0560%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4161/4587 (90.7129%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0512, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 6180/6947 (88.9593%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   2,  Average loss: 0.0059, Accuracy: 6152/6947 (88.5562%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2023, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4488/5055 (88.7834%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4600/5055 (90.9990%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0945, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4422/4929 (89.7139%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4425/4929 (89.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3338, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4220/4797 (87.9716%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4278/4797 (89.1807%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9713, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4865/5645 (86.1825%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4885/5645 (86.5368%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2978, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4838/5362 (90.2275%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4873/5362 (90.8803%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0092, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4782/5489 (87.1197%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4867/5489 (88.6682%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1762, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3683/4108 (89.6543%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3815/4108 (92.8676%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9313, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3718/4130 (90.0242%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3804/4130 (92.1065%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9890, Accuracy: 5543/10000 (55.4300%)
time spent on training: 244.72748374938965
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0960, Accuracy: 7078/10000 (70.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 7.4856, Accuracy: 334/9900 (3.3737%)
Done in 271.38316798210144 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 31, 47, 14, 73, 99, 60, 81, 39, 40, 78, 27, 59, 7, 22, 83, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4894/5308 (92.2005%), train_poison_data_count: 415
Global model norm: 42.476301699355695.
Norm before scaling: 42.475461091339255. Distance: 1.9768431694176927
Total norm for 4 adversaries is: 42.475461091339255. distance: 1.9768431694176927
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3121, Accuracy: 9132/9900 (92.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5396/5777 (93.4049%), train_poison_data_count: 455
Global model norm: 42.476301699355695.
Norm before scaling: 42.469573495051286. Distance: 1.9588816531206312
Total norm for 4 adversaries is: 42.469573495051286. distance: 1.9588816531206312
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3103, Accuracy: 9097/9900 (91.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4685/5123 (91.4503%), train_poison_data_count: 403
Global model norm: 42.476301699355695.
Norm before scaling: 42.47428133818526. Distance: 1.9658049096282433
Total norm for 4 adversaries is: 42.47428133818526. distance: 1.9658049096282433
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2893, Accuracy: 9203/9900 (92.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5011/5503 (91.0594%), train_poison_data_count: 430
Global model norm: 42.476301699355695.
Norm before scaling: 42.47547689779731. Distance: 2.0822971310209093
Total norm for 4 adversaries is: 42.47547689779731. distance: 2.0822971310209093
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1056, Accuracy: 9644/9900 (97.4141%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4090/4537 (90.1477%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4176/4537 (92.0432%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8026, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4544/5123 (88.6980%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4470/5123 (87.2536%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1755, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3848/4196 (91.7064%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3953/4196 (94.2088%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8058, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4130/4605 (89.6851%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4253/4605 (92.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8600, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4320/4851 (89.0538%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4432/4851 (91.3626%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8645, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3667/4145 (88.4680%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3771/4145 (90.9771%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0262, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4550/5035 (90.3674%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4670/5035 (92.7507%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8996, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3693/4175 (88.4551%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3786/4175 (90.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1205, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5449/5939 (91.7495%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5514/5939 (92.8439%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0253, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3992/4368 (91.3919%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4073/4368 (93.2463%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0205, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4010/4587 (87.4210%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4132/4587 (90.0807%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0741, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4125/4397 (93.8140%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4204/4397 (95.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.7242, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4286/4869 (88.0263%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4183/4869 (85.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1257, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5166/5696 (90.6952%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5148/5696 (90.3792%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0793, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3161/3552 (88.9921%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3274/3552 (92.1734%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8202, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4163/4736 (87.9012%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4281/4736 (90.3927%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9574, Accuracy: 5491/10000 (54.9100%)
time spent on training: 239.46468710899353
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0910, Accuracy: 7092/10000 (70.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 6.4037, Accuracy: 663/9900 (6.6970%)
Done in 265.6080553531647 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 10, 76, 15, 42, 57, 17, 9, 3, 70, 8, 65, 33, 59, 52, 69, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4906/5308 (92.4265%), train_poison_data_count: 415
Global model norm: 42.49609787922813.
Norm before scaling: 42.49690073717876. Distance: 1.953831049140433
Total norm for 4 adversaries is: 42.49690073717876. distance: 1.953831049140433
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1158, Accuracy: 9616/9900 (97.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5397/5777 (93.4222%), train_poison_data_count: 455
Global model norm: 42.49609787922813.
Norm before scaling: 42.48668075988271. Distance: 1.940913055221768
Total norm for 4 adversaries is: 42.48668075988271. distance: 1.940913055221768
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1326, Accuracy: 9552/9900 (96.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4630/5123 (90.3767%), train_poison_data_count: 403
Global model norm: 42.49609787922813.
Norm before scaling: 42.499694105057245. Distance: 2.064807410322724
Total norm for 4 adversaries is: 42.499694105057245. distance: 2.064807410322724
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1639, Accuracy: 9466/9900 (95.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5058/5503 (91.9135%), train_poison_data_count: 430
Global model norm: 42.49609787922813.
Norm before scaling: 42.49751830989664. Distance: 2.0095253848076364
Total norm for 4 adversaries is: 42.49751830989664. distance: 2.0095253848076364
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1976, Accuracy: 9391/9900 (94.8586%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4637/5068 (91.4957%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4569/5068 (90.1539%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1070, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3470/3959 (87.6484%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3584/3959 (90.5279%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9287, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5487/6068 (90.4252%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5479/6068 (90.2933%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0506, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5309/5907 (89.8764%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5375/5907 (90.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3373, Accuracy: 4944/10000 (49.4400%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4514/4956 (91.0815%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4572/4956 (92.2518%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0000, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4244/4903 (86.5592%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4399/4903 (89.7206%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2746, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5003/5727 (87.3581%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5078/5727 (88.6677%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0369, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4899/5346 (91.6386%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4954/5346 (92.6674%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1227, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5371/5871 (91.4836%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5357/5871 (91.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0184, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4338/4889 (88.7298%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4410/4889 (90.2025%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1893, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4839/5497 (88.0298%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4960/5497 (90.2310%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0402, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4243/4818 (88.0656%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4255/4818 (88.3147%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9498, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4125/4397 (93.8140%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4197/4397 (95.4514%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8605, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3728/4130 (90.2663%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3786/4130 (91.6707%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9287, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3991/4364 (91.4528%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3958/4364 (90.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0537, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4837/5702 (84.8299%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4594/5702 (80.5682%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1581, Accuracy: 5168/10000 (51.6800%)
time spent on training: 248.95744800567627
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0932, Accuracy: 7064/10000 (70.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 5.4948, Accuracy: 1143/9900 (11.5455%)
Done in 275.6704273223877 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 57, 60, 74, 72, 70, 14, 43, 88, 9, 80, 22, 73, 66, 82, 56, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4928/5308 (92.8410%), train_poison_data_count: 415
Global model norm: 42.51868413975863.
Norm before scaling: 42.51260727529835. Distance: 1.8755512063122644
Total norm for 4 adversaries is: 42.51260727529835. distance: 1.8755512063122644
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2185, Accuracy: 9364/9900 (94.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5442/5777 (94.2011%), train_poison_data_count: 455
Global model norm: 42.51868413975863.
Norm before scaling: 42.50652667026927. Distance: 1.8253050353255653
Total norm for 4 adversaries is: 42.50652667026927. distance: 1.8253050353255653
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2093, Accuracy: 9396/9900 (94.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4662/5123 (91.0014%), train_poison_data_count: 403
Global model norm: 42.51868413975863.
Norm before scaling: 42.51967461649004. Distance: 1.9894883364488691
Total norm for 4 adversaries is: 42.51967461649004. distance: 1.9894883364488691
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1724, Accuracy: 9475/9900 (95.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5107/5503 (92.8039%), train_poison_data_count: 430
Global model norm: 42.51868413975863.
Norm before scaling: 42.5161834422163. Distance: 1.9381115471238617
Total norm for 4 adversaries is: 42.5161834422163. distance: 1.9381115471238617
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1005, Accuracy: 9629/9900 (97.2626%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4553/4956 (91.8684%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4545/4956 (91.7070%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0549, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3661/4145 (88.3233%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3769/4145 (90.9288%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9509, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4242/4797 (88.4303%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4315/4797 (89.9521%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9293, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4633/5193 (89.2163%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4624/5193 (89.0429%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2680, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5438/5871 (92.6248%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5386/5871 (91.7391%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1162, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3864/4196 (92.0877%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3935/4196 (93.7798%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9786, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4442/4979 (89.2147%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4519/4979 (90.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0108, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4847/5362 (90.3954%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4857/5362 (90.5819%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9472, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5064/5727 (88.4233%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5049/5727 (88.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0619, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4909/5461 (89.8920%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4941/5461 (90.4779%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1184, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5121/5696 (89.9052%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5188/5696 (91.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0134, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4176/4605 (90.6840%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4285/4605 (93.0510%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8990, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4342/4843 (89.6552%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4410/4843 (91.0593%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2303, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4890/5298 (92.2990%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4912/5298 (92.7142%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9336, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4831/5427 (89.0179%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4832/5427 (89.0363%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9741, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4431/4830 (91.7391%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4436/4830 (91.8427%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1407, Accuracy: 5337/10000 (53.3700%)
time spent on training: 244.76441097259521
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0969, Accuracy: 7054/10000 (70.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 4.6616, Accuracy: 1794/9900 (18.1212%)
Done in 271.4373197555542 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 69, 16, 75, 60, 24, 8, 77, 11, 80, 28, 41, 2, 76, 57, 33, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4938/5308 (93.0294%), train_poison_data_count: 415
Global model norm: 42.54106902407293.
Norm before scaling: 42.53781492086996. Distance: 1.8396179319809571
Total norm for 4 adversaries is: 42.53781492086996. distance: 1.8396179319809571
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2103, Accuracy: 9398/9900 (94.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5449/5777 (94.3223%), train_poison_data_count: 455
Global model norm: 42.54106902407293.
Norm before scaling: 42.52820898615779. Distance: 1.7809960033622505
Total norm for 4 adversaries is: 42.52820898615779. distance: 1.7809960033622505
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1027, Accuracy: 9651/9900 (97.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4672/5123 (91.1966%), train_poison_data_count: 403
Global model norm: 42.54106902407293.
Norm before scaling: 42.54090833346107. Distance: 1.9323397799223072
Total norm for 4 adversaries is: 42.54090833346107. distance: 1.9323397799223072
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1427, Accuracy: 9534/9900 (96.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5087/5503 (92.4405%), train_poison_data_count: 430
Global model norm: 42.54106902407293.
Norm before scaling: 42.542838015419825. Distance: 1.9661507174871213
Total norm for 4 adversaries is: 42.542838015419825. distance: 1.9661507174871213
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1336, Accuracy: 9545/9900 (96.4141%)
___Train Local_ResNet_18,  epoch  76, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3969/4364 (90.9487%)
___Train Local_ResNet_18,  epoch  76, local model 69, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3947/4364 (90.4445%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9269, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  76, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4801/5353 (89.6880%)
___Train Local_ResNet_18,  epoch  76, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4848/5353 (90.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9244, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  76, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4223/4672 (90.3896%)
___Train Local_ResNet_18,  epoch  76, local model 75, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4310/4672 (92.2517%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8025, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch  76, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3702/4145 (89.3124%)
___Train Local_ResNet_18,  epoch  76, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3761/4145 (90.7358%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9666, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  76, local model 24, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3931/4313 (91.1431%)
___Train Local_ResNet_18,  epoch  76, local model 24, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3958/4313 (91.7691%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8345, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch  76, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4359/4889 (89.1593%)
___Train Local_ResNet_18,  epoch  76, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4420/4889 (90.4070%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0413, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4401/5050 (87.1485%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4487/5050 (88.8515%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9802, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  76, local model 11, internal_epoch   1,  Average loss: 0.0086, Accuracy: 4805/5702 (84.2687%)
___Train Local_ResNet_18,  epoch  76, local model 11, internal_epoch   2,  Average loss: 0.0106, Accuracy: 4566/5702 (80.0772%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2254, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18,  epoch  76, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4937/5461 (90.4047%)
___Train Local_ResNet_18,  epoch  76, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4958/5461 (90.7892%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1741, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  76, local model 28, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4538/5122 (88.5982%)
___Train Local_ResNet_18,  epoch  76, local model 28, internal_epoch   2,  Average loss: 0.0118, Accuracy: 4088/5122 (79.8126%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3640, Accuracy: 4713/10000 (47.1300%)
___Train Local_ResNet_18,  epoch  76, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4288/4714 (90.9631%)
___Train Local_ResNet_18,  epoch  76, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4363/4714 (92.5541%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2139, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch  76, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3555/3968 (89.5917%)
___Train Local_ResNet_18,  epoch  76, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3625/3968 (91.3558%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8728, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3497/3959 (88.3304%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3614/3959 (91.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9189, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  76, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4523/4956 (91.2631%)
___Train Local_ResNet_18,  epoch  76, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4514/4956 (91.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0310, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  76, local model 33, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4267/4818 (88.5637%)
___Train Local_ResNet_18,  epoch  76, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4304/4818 (89.3317%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0136, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  76, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3983/4368 (91.1859%)
___Train Local_ResNet_18,  epoch  76, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4011/4368 (91.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1367, Accuracy: 5212/10000 (52.1200%)
time spent on training: 241.1063096523285
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1037, Accuracy: 7019/10000 (70.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 3.9415, Accuracy: 2604/9900 (26.3030%)
Done in 267.6448929309845 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 29, 81, 74, 11, 98, 12, 65, 40, 72, 67, 2, 26, 91, 61, 25, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4942/5308 (93.1047%), train_poison_data_count: 415
Global model norm: 42.56251147209831.
Norm before scaling: 42.557698655399. Distance: 1.8458904191511911
Total norm for 4 adversaries is: 42.557698655399. distance: 1.8458904191511911
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1065, Accuracy: 9622/9900 (97.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5481/5777 (94.8762%), train_poison_data_count: 455
Global model norm: 42.56251147209831.
Norm before scaling: 42.55141220528483. Distance: 1.7296747663764929
Total norm for 4 adversaries is: 42.55141220528483. distance: 1.7296747663764929
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1941, Accuracy: 9407/9900 (95.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4741/5123 (92.5434%), train_poison_data_count: 403
Global model norm: 42.56251147209831.
Norm before scaling: 42.55874415559701. Distance: 1.8509081235451477
Total norm for 4 adversaries is: 42.55874415559701. distance: 1.8509081235451477
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1932, Accuracy: 9414/9900 (95.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5126/5503 (93.1492%), train_poison_data_count: 430
Global model norm: 42.56251147209831.
Norm before scaling: 42.55936083091401. Distance: 1.8789356253185436
Total norm for 4 adversaries is: 42.55936083091401. distance: 1.8789356253185436
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2113, Accuracy: 9347/9900 (94.4141%)
___Train Local_ResNet_18,  epoch  77, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4363/4732 (92.2020%)
___Train Local_ResNet_18,  epoch  77, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4400/4732 (92.9839%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9564, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  77, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4558/5035 (90.5263%)
___Train Local_ResNet_18,  epoch  77, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4597/5035 (91.3009%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9484, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  77, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4266/4797 (88.9306%)
___Train Local_ResNet_18,  epoch  77, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4265/4797 (88.9097%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1189, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  77, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4768/5702 (83.6198%)
___Train Local_ResNet_18,  epoch  77, local model 11, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4730/5702 (82.9533%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1290, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  77, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3793/4161 (91.1560%)
___Train Local_ResNet_18,  epoch  77, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3827/4161 (91.9731%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9013, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  77, local model 12, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4883/5526 (88.3641%)
___Train Local_ResNet_18,  epoch  77, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4850/5526 (87.7669%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1324, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4893/5497 (89.0122%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4908/5497 (89.2851%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1055, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  77, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5457/5939 (91.8842%)
___Train Local_ResNet_18,  epoch  77, local model 40, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5511/5939 (92.7934%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0681, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  77, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4643/5193 (89.4088%)
___Train Local_ResNet_18,  epoch  77, local model 72, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4455/5193 (85.7886%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.3479, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch  77, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4857/5559 (87.3718%)
___Train Local_ResNet_18,  epoch  77, local model 67, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4906/5559 (88.2533%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0319, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  77, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3535/3968 (89.0877%)
___Train Local_ResNet_18,  epoch  77, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3625/3968 (91.3558%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8293, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  77, local model 26, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3749/4086 (91.7523%)
___Train Local_ResNet_18,  epoch  77, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3812/4086 (93.2942%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9406, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  77, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4046/4527 (89.3749%)
___Train Local_ResNet_18,  epoch  77, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4045/4527 (89.3528%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1243, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  77, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4037/4485 (90.0111%)
___Train Local_ResNet_18,  epoch  77, local model 61, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3812/4485 (84.9944%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0972, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  77, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5688/6419 (88.6119%)
___Train Local_ResNet_18,  epoch  77, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5576/6419 (86.8671%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2241, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch  77, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4867/5489 (88.6682%)
___Train Local_ResNet_18,  epoch  77, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4944/5489 (90.0711%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0107, Accuracy: 5423/10000 (54.2300%)
time spent on training: 245.72396564483643
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1072, Accuracy: 7036/10000 (70.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 3.4242, Accuracy: 3304/9900 (33.3737%)
Done in 272.28472661972046 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 56, 90, 54, 63, 94, 10, 96, 45, 38, 59, 6, 85, 55, 32, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4958/5308 (93.4062%), train_poison_data_count: 415
Global model norm: 42.586078672257294.
Norm before scaling: 42.58331677062626. Distance: 1.8122234791254244
Total norm for 4 adversaries is: 42.58331677062626. distance: 1.8122234791254244
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1884, Accuracy: 9466/9900 (95.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5495/5777 (95.1186%), train_poison_data_count: 455
Global model norm: 42.586078672257294.
Norm before scaling: 42.57112614495886. Distance: 1.7068099308357065
Total norm for 4 adversaries is: 42.57112614495886. distance: 1.7068099308357065
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1917, Accuracy: 9416/9900 (95.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4724/5123 (92.2116%), train_poison_data_count: 403
Global model norm: 42.586078672257294.
Norm before scaling: 42.58302580740432. Distance: 1.8370263949030996
Total norm for 4 adversaries is: 42.58302580740432. distance: 1.8370263949030996
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2086, Accuracy: 9366/9900 (94.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5117/5503 (92.9856%), train_poison_data_count: 430
Global model norm: 42.586078672257294.
Norm before scaling: 42.58276924212568. Distance: 1.8704708073797265
Total norm for 4 adversaries is: 42.58276924212568. distance: 1.8704708073797265
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1306, Accuracy: 9566/9900 (96.6263%)
___Train Local_ResNet_18,  epoch  78, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4838/5427 (89.1469%)
___Train Local_ResNet_18,  epoch  78, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4880/5427 (89.9208%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0625, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  78, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4377/4748 (92.1862%)
___Train Local_ResNet_18,  epoch  78, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4351/4748 (91.6386%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0692, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  78, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4910/5645 (86.9796%)
___Train Local_ResNet_18,  epoch  78, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4850/5645 (85.9167%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2785, Accuracy: 4928/10000 (49.2800%)
___Train Local_ResNet_18,  epoch  78, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3567/3910 (91.2276%)
___Train Local_ResNet_18,  epoch  78, local model 63, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3463/3910 (88.5678%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9921, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  78, local model 94, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4629/5224 (88.6103%)
___Train Local_ResNet_18,  epoch  78, local model 94, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4777/5224 (91.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0548, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  78, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4612/5068 (91.0024%)
___Train Local_ResNet_18,  epoch  78, local model 10, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4593/5068 (90.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1369, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4590/5086 (90.2477%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4647/5086 (91.3685%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9961, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  78, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4894/5489 (89.1601%)
___Train Local_ResNet_18,  epoch  78, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4951/5489 (90.1986%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0766, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  78, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5501/6235 (88.2277%)
___Train Local_ResNet_18,  epoch  78, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5513/6235 (88.4202%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2179, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch  78, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4150/4397 (94.3825%)
___Train Local_ResNet_18,  epoch  78, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4193/4397 (95.3605%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7623, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18,  epoch  78, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4442/4929 (90.1197%)
___Train Local_ResNet_18,  epoch  78, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4463/4929 (90.5457%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0649, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  78, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 6248/6947 (89.9381%)
___Train Local_ResNet_18,  epoch  78, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 6123/6947 (88.1388%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1625, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch  78, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4291/4731 (90.6996%)
___Train Local_ResNet_18,  epoch  78, local model 55, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4339/4731 (91.7142%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8899, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5288/6080 (86.9737%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5324/6080 (87.5658%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1486, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  78, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3194/3552 (89.9212%)
___Train Local_ResNet_18,  epoch  78, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3287/3552 (92.5394%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7979, Accuracy: 5867/10000 (58.6700%)
___Train Local_ResNet_18,  epoch  78, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4301/4737 (90.7959%)
___Train Local_ResNet_18,  epoch  78, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4306/4737 (90.9014%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9998, Accuracy: 5474/10000 (54.7400%)
time spent on training: 247.4459011554718
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1133, Accuracy: 7020/10000 (70.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 2.8446, Accuracy: 4127/9900 (41.6869%)
Done in 273.74454069137573 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 23, 89, 83, 1, 0, 90, 46, 70, 48, 5, 17, 96, 79, 7, 63, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4972/5308 (93.6699%), train_poison_data_count: 415
Global model norm: 42.607657475927226.
Norm before scaling: 42.60410761125695. Distance: 1.7838637600011962
Total norm for 4 adversaries is: 42.60410761125695. distance: 1.7838637600011962
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1785, Accuracy: 9453/9900 (95.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5476/5777 (94.7897%), train_poison_data_count: 455
Global model norm: 42.607657475927226.
Norm before scaling: 42.596617257216714. Distance: 1.7687813557248226
Total norm for 4 adversaries is: 42.596617257216714. distance: 1.7687813557248226
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1931, Accuracy: 9447/9900 (95.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4734/5123 (92.4068%), train_poison_data_count: 403
Global model norm: 42.607657475927226.
Norm before scaling: 42.60102595137088. Distance: 1.8203716350331267
Total norm for 4 adversaries is: 42.60102595137088. distance: 1.8203716350331267
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3664, Accuracy: 8963/9900 (90.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5122/5503 (93.0765%), train_poison_data_count: 430
Global model norm: 42.607657475927226.
Norm before scaling: 42.60233973135674. Distance: 1.8178871598764597
Total norm for 4 adversaries is: 42.60233973135674. distance: 1.8178871598764597
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3251, Accuracy: 9020/9900 (91.1111%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4264/4549 (93.7349%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4276/4549 (93.9987%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.7193, Accuracy: 5890/10000 (58.9000%)
___Train Local_ResNet_18,  epoch  79, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4286/4737 (90.4792%)
___Train Local_ResNet_18,  epoch  79, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4301/4737 (90.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2360, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch  79, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3209/3552 (90.3435%)
___Train Local_ResNet_18,  epoch  79, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3311/3552 (93.2151%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8871, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5020/5422 (92.5858%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5022/5422 (92.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9272, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch  79, local model 0, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4879/5454 (89.4573%)
___Train Local_ResNet_18,  epoch  79, local model 0, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4765/5454 (87.3671%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1363, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch  79, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4341/4748 (91.4280%)
___Train Local_ResNet_18,  epoch  79, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4383/4748 (92.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8965, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  79, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4674/5399 (86.5716%)
___Train Local_ResNet_18,  epoch  79, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4746/5399 (87.9052%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0965, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  79, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5438/5871 (92.6248%)
___Train Local_ResNet_18,  epoch  79, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5391/5871 (91.8242%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1328, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  79, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4461/4830 (92.3602%)
___Train Local_ResNet_18,  epoch  79, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4527/4830 (93.7267%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0425, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  79, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4627/4993 (92.6697%)
___Train Local_ResNet_18,  epoch  79, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4646/4993 (93.0503%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9198, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  79, local model 17, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4298/4903 (87.6606%)
___Train Local_ResNet_18,  epoch  79, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4360/4903 (88.9251%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1918, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch  79, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4604/5086 (90.5230%)
___Train Local_ResNet_18,  epoch  79, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4671/5086 (91.8403%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8756, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  79, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3728/4111 (90.6835%)
___Train Local_ResNet_18,  epoch  79, local model 79, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3678/4111 (89.4673%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0955, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  79, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4349/4869 (89.3202%)
___Train Local_ResNet_18,  epoch  79, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4099/4869 (84.1857%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2629, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3535/3910 (90.4092%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3565/3910 (91.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9863, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  79, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3736/4175 (89.4850%)
___Train Local_ResNet_18,  epoch  79, local model 39, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3735/4175 (89.4611%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9798, Accuracy: 5506/10000 (55.0600%)
time spent on training: 243.9521758556366
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1170, Accuracy: 7009/10000 (70.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 2.5270, Accuracy: 4616/9900 (46.6263%)
Done in 270.2731328010559 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 44, 30, 66, 73, 76, 81, 22, 46, 17, 34, 96, 31, 95, 40, 53, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4974/5308 (93.7076%), train_poison_data_count: 415
Global model norm: 42.62906213461144.
Norm before scaling: 42.6221675882618. Distance: 1.754505692232236
Total norm for 4 adversaries is: 42.6221675882618. distance: 1.754505692232236
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1441, Accuracy: 9555/9900 (96.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5488/5777 (94.9974%), train_poison_data_count: 455
Global model norm: 42.62906213461144.
Norm before scaling: 42.613629119317565. Distance: 1.6737264203895625
Total norm for 4 adversaries is: 42.613629119317565. distance: 1.6737264203895625
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1155, Accuracy: 9606/9900 (97.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4752/5123 (92.7581%), train_poison_data_count: 403
Global model norm: 42.62906213461144.
Norm before scaling: 42.62194276288697. Distance: 1.7898159522799792
Total norm for 4 adversaries is: 42.62194276288697. distance: 1.7898159522799792
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2838, Accuracy: 9192/9900 (92.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5148/5503 (93.5490%), train_poison_data_count: 430
Global model norm: 42.62906213461144.
Norm before scaling: 42.622703154759556. Distance: 1.8121717747747543
Total norm for 4 adversaries is: 42.622703154759556. distance: 1.8121717747747543
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2198, Accuracy: 9342/9900 (94.3636%)
___Train Local_ResNet_18,  epoch  80, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4646/5075 (91.5468%)
___Train Local_ResNet_18,  epoch  80, local model 44, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4538/5075 (89.4187%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1022, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  80, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3414/3774 (90.4610%)
___Train Local_ResNet_18,  epoch  80, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3527/3774 (93.4552%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8009, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch  80, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4362/4843 (90.0681%)
___Train Local_ResNet_18,  epoch  80, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4417/4843 (91.2038%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9533, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  80, local model 73, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4250/4605 (92.2910%)
___Train Local_ResNet_18,  epoch  80, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4244/4605 (92.1607%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9346, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  80, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3490/3959 (88.1536%)
___Train Local_ResNet_18,  epoch  80, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3613/3959 (91.2604%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0224, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  80, local model 81, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4580/5035 (90.9633%)
___Train Local_ResNet_18,  epoch  80, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4609/5035 (91.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0187, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  80, local model 22, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5200/5696 (91.2921%)
___Train Local_ResNet_18,  epoch  80, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5219/5696 (91.6257%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1882, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4671/5399 (86.5160%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4665/5399 (86.4049%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1585, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  80, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4360/4903 (88.9251%)
___Train Local_ResNet_18,  epoch  80, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4379/4903 (89.3127%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0812, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  80, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4465/4911 (90.9183%)
___Train Local_ResNet_18,  epoch  80, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4495/4911 (91.5292%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0442, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  80, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4596/5086 (90.3657%)
___Train Local_ResNet_18,  epoch  80, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4625/5086 (90.9359%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1233, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  80, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4119/4537 (90.7869%)
___Train Local_ResNet_18,  epoch  80, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4178/4537 (92.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9445, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  80, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4461/5018 (88.9000%)
___Train Local_ResNet_18,  epoch  80, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4434/5018 (88.3619%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2309, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5475/5939 (92.1872%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5520/5939 (92.9449%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8742, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5794/6664 (86.9448%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0079, Accuracy: 5639/6664 (84.6188%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2512, Accuracy: 4947/10000 (49.4700%)
___Train Local_ResNet_18,  epoch  80, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4847/5702 (85.0053%)
___Train Local_ResNet_18,  epoch  80, local model 11, internal_epoch   2,  Average loss: 0.0110, Accuracy: 4534/5702 (79.5160%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3535, Accuracy: 4880/10000 (48.8000%)
time spent on training: 254.49164009094238
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1228, Accuracy: 6996/10000 (69.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 2.1518, Accuracy: 5273/9900 (53.2626%)
Done in 281.2700071334839 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 69, 64, 10, 24, 15, 54, 35, 59, 42, 72, 84, 92, 73, 76, 29, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4989/5308 (93.9902%), train_poison_data_count: 415
Global model norm: 42.651025607264856.
Norm before scaling: 42.64126768707677. Distance: 1.671633408818753
Total norm for 4 adversaries is: 42.64126768707677. distance: 1.671633408818753
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0996, Accuracy: 9652/9900 (97.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5513/5777 (95.4302%), train_poison_data_count: 455
Global model norm: 42.651025607264856.
Norm before scaling: 42.632150357923834. Distance: 1.6385627501097917
Total norm for 4 adversaries is: 42.632150357923834. distance: 1.6385627501097917
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1023, Accuracy: 9646/9900 (97.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4772/5123 (93.1485%), train_poison_data_count: 403
Global model norm: 42.651025607264856.
Norm before scaling: 42.643719542345856. Distance: 1.7415816960148733
Total norm for 4 adversaries is: 42.643719542345856. distance: 1.7415816960148733
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1887, Accuracy: 9402/9900 (94.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5168/5503 (93.9124%), train_poison_data_count: 430
Global model norm: 42.651025607264856.
Norm before scaling: 42.642561620093105. Distance: 1.7519925898739255
Total norm for 4 adversaries is: 42.642561620093105. distance: 1.7519925898739255
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1893, Accuracy: 9415/9900 (95.1010%)
___Train Local_ResNet_18,  epoch  81, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3964/4364 (90.8341%)
___Train Local_ResNet_18,  epoch  81, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4014/4364 (91.9798%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0925, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4355/4894 (88.9865%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4372/4894 (89.3339%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1129, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4688/5068 (92.5020%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4625/5068 (91.2589%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1143, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  81, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3958/4313 (91.7691%)
___Train Local_ResNet_18,  epoch  81, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3975/4313 (92.1632%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8385, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  81, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5488/6068 (90.4417%)
___Train Local_ResNet_18,  epoch  81, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5481/6068 (90.3263%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2108, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4950/5645 (87.6882%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4909/5645 (86.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.3847, Accuracy: 4909/10000 (49.0900%)
___Train Local_ResNet_18,  epoch  81, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5038/5615 (89.7240%)
___Train Local_ResNet_18,  epoch  81, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5072/5615 (90.3295%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1361, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  81, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4137/4397 (94.0869%)
___Train Local_ResNet_18,  epoch  81, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4169/4397 (94.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7878, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch  81, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5335/5907 (90.3166%)
___Train Local_ResNet_18,  epoch  81, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5321/5907 (90.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2897, Accuracy: 4946/10000 (49.4600%)
___Train Local_ResNet_18,  epoch  81, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4659/5193 (89.7169%)
___Train Local_ResNet_18,  epoch  81, local model 72, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4509/5193 (86.8284%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.4708, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4682/5209 (89.8829%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4679/5209 (89.8253%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0782, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  81, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6272/6812 (92.0728%)
___Train Local_ResNet_18,  epoch  81, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6230/6812 (91.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1799, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4198/4605 (91.1618%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4255/4605 (92.3996%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8768, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  81, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3578/3959 (90.3764%)
___Train Local_ResNet_18,  epoch  81, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3646/3959 (92.0940%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0010, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4367/4732 (92.2866%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4439/4732 (93.8081%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8991, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4627/5075 (91.1724%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4645/5075 (91.5271%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0477, Accuracy: 5331/10000 (53.3100%)
time spent on training: 254.97974038124084
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1292, Accuracy: 6980/10000 (69.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 1.8523, Accuracy: 5790/9900 (58.4848%)
Done in 281.4461386203766 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 14, 54, 3, 34, 68, 73, 15, 91, 7, 26, 79, 11, 61, 56, 16, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5015/5308 (94.4800%), train_poison_data_count: 415
Global model norm: 42.67299207847614.
Norm before scaling: 42.6646068393676. Distance: 1.680676191464623
Total norm for 4 adversaries is: 42.6646068393676. distance: 1.680676191464623
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2376, Accuracy: 9328/9900 (94.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5509/5777 (95.3609%), train_poison_data_count: 455
Global model norm: 42.67299207847614.
Norm before scaling: 42.65365577047221. Distance: 1.5997037196021746
Total norm for 4 adversaries is: 42.65365577047221. distance: 1.5997037196021746
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1361, Accuracy: 9567/9900 (96.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4797/5123 (93.6365%), train_poison_data_count: 403
Global model norm: 42.67299207847614.
Norm before scaling: 42.66304461681752. Distance: 1.6730709611261996
Total norm for 4 adversaries is: 42.66304461681752. distance: 1.6730709611261996
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.4303, Accuracy: 8883/9900 (89.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5157/5503 (93.7125%), train_poison_data_count: 430
Global model norm: 42.67299207847614.
Norm before scaling: 42.665598220162984. Distance: 1.7649028280163437
Total norm for 4 adversaries is: 42.665598220162984. distance: 1.7649028280163437
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3209, Accuracy: 9065/9900 (91.5657%)
___Train Local_ResNet_18,  epoch  82, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3927/4196 (93.5891%)
___Train Local_ResNet_18,  epoch  82, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3968/4196 (94.5663%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8698, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch  82, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4984/5645 (88.2905%)
___Train Local_ResNet_18,  epoch  82, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4881/5645 (86.4659%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0870, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4934/5346 (92.2933%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4919/5346 (92.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1104, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  82, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4453/4911 (90.6740%)
___Train Local_ResNet_18,  epoch  82, local model 34, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4422/4911 (90.0428%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0493, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  82, local model 68, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3302/3589 (92.0033%)
___Train Local_ResNet_18,  epoch  82, local model 68, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3154/3589 (87.8796%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0572, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4260/4605 (92.5081%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4308/4605 (93.5505%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8885, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch  82, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5520/6068 (90.9690%)
___Train Local_ResNet_18,  epoch  82, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5536/6068 (91.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0982, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  82, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4037/4527 (89.1761%)
___Train Local_ResNet_18,  epoch  82, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3997/4527 (88.2925%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0298, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4376/4869 (89.8747%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4210/4869 (86.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.5570, Accuracy: 4807/10000 (48.0700%)
___Train Local_ResNet_18,  epoch  82, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3748/4086 (91.7279%)
___Train Local_ResNet_18,  epoch  82, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3829/4086 (93.7102%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8475, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch  82, local model 79, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3730/4111 (90.7322%)
___Train Local_ResNet_18,  epoch  82, local model 79, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3737/4111 (90.9025%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2732, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch  82, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4836/5702 (84.8123%)
___Train Local_ResNet_18,  epoch  82, local model 11, internal_epoch   2,  Average loss: 0.0114, Accuracy: 4415/5702 (77.4290%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1273, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  82, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4092/4485 (91.2375%)
___Train Local_ResNet_18,  epoch  82, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4103/4485 (91.4827%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1432, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  82, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4864/5427 (89.6259%)
___Train Local_ResNet_18,  epoch  82, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4900/5427 (90.2893%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9151, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  82, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4843/5353 (90.4726%)
___Train Local_ResNet_18,  epoch  82, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4785/5353 (89.3891%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1457, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  82, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4844/5489 (88.2492%)
___Train Local_ResNet_18,  epoch  82, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4958/5489 (90.3261%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0525, Accuracy: 5289/10000 (52.8900%)
time spent on training: 243.86677384376526
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1300, Accuracy: 6976/10000 (69.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 1.6766, Accuracy: 6139/9900 (62.0101%)
Done in 270.0830628871918 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 46, 78, 3, 7, 8, 74, 87, 47, 38, 94, 25, 49, 44, 70, 40, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5044/5308 (95.0264%), train_poison_data_count: 415
Global model norm: 42.69579640050572.
Norm before scaling: 42.68261833818451. Distance: 1.6176064358674713
Total norm for 4 adversaries is: 42.68261833818451. distance: 1.6176064358674713
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0996, Accuracy: 9648/9900 (97.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5525/5777 (95.6379%), train_poison_data_count: 455
Global model norm: 42.69579640050572.
Norm before scaling: 42.677302783230836. Distance: 1.5982752862174423
Total norm for 4 adversaries is: 42.677302783230836. distance: 1.5982752862174423
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1344, Accuracy: 9559/9900 (96.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4790/5123 (93.4999%), train_poison_data_count: 403
Global model norm: 42.69579640050572.
Norm before scaling: 42.6860344161845. Distance: 1.6812996158581943
Total norm for 4 adversaries is: 42.6860344161845. distance: 1.6812996158581943
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.4395, Accuracy: 8811/9900 (89.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5179/5503 (94.1123%), train_poison_data_count: 430
Global model norm: 42.69579640050572.
Norm before scaling: 42.68676506962521. Distance: 1.736538611442182
Total norm for 4 adversaries is: 42.68676506962521. distance: 1.736538611442182
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0530, Accuracy: 9760/9900 (98.5859%)
___Train Local_ResNet_18,  epoch  83, local model 46, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4768/5399 (88.3127%)
___Train Local_ResNet_18,  epoch  83, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4737/5399 (87.7385%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2349, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  83, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4019/4368 (92.0101%)
___Train Local_ResNet_18,  epoch  83, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4005/4368 (91.6896%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9284, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  83, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4918/5346 (91.9940%)
___Train Local_ResNet_18,  epoch  83, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4990/5346 (93.3408%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0310, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  83, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4389/4869 (90.1417%)
___Train Local_ResNet_18,  epoch  83, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4148/4869 (85.1920%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2527, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch  83, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4416/4889 (90.3252%)
___Train Local_ResNet_18,  epoch  83, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4445/4889 (90.9184%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0018, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  83, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4278/4797 (89.1807%)
___Train Local_ResNet_18,  epoch  83, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4284/4797 (89.3058%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9606, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  83, local model 87, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3536/3995 (88.5106%)
___Train Local_ResNet_18,  epoch  83, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3597/3995 (90.0375%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0209, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  83, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4553/5123 (88.8737%)
___Train Local_ResNet_18,  epoch  83, local model 47, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4498/5123 (87.8001%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2752, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch  83, local model 38, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5517/6235 (88.4844%)
___Train Local_ResNet_18,  epoch  83, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5504/6235 (88.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2226, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch  83, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4608/5224 (88.2083%)
___Train Local_ResNet_18,  epoch  83, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4644/5224 (88.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9853, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  83, local model 25, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5662/6419 (88.2069%)
___Train Local_ResNet_18,  epoch  83, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5555/6419 (86.5400%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.4409, Accuracy: 4964/10000 (49.6400%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5005/5652 (88.5527%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5044/5652 (89.2427%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0189, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  83, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4648/5075 (91.5862%)
___Train Local_ResNet_18,  epoch  83, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4669/5075 (92.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9486, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  83, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5418/5871 (92.2841%)
___Train Local_ResNet_18,  epoch  83, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5409/5871 (92.1308%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9819, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5475/5939 (92.1872%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5412/5939 (91.1265%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0547, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  83, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4883/5454 (89.5306%)
___Train Local_ResNet_18,  epoch  83, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4855/5454 (89.0172%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1426, Accuracy: 5309/10000 (53.0900%)
time spent on training: 252.05526494979858
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1363, Accuracy: 6952/10000 (69.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 1.4900, Accuracy: 6499/9900 (65.6465%)
Done in 278.60621428489685 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 80, 3, 45, 6, 57, 22, 68, 38, 76, 26, 41, 98, 61, 0, 1, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5037/5308 (94.8945%), train_poison_data_count: 415
Global model norm: 42.72001444041262.
Norm before scaling: 42.70752555765567. Distance: 1.6289290099532157
Total norm for 4 adversaries is: 42.70752555765567. distance: 1.6289290099532157
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1520, Accuracy: 9512/9900 (96.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5521/5777 (95.5686%), train_poison_data_count: 455
Global model norm: 42.72001444041262.
Norm before scaling: 42.70059365210497. Distance: 1.621229492387208
Total norm for 4 adversaries is: 42.70059365210497. distance: 1.621229492387208
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1281, Accuracy: 9588/9900 (96.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4813/5123 (93.9489%), train_poison_data_count: 403
Global model norm: 42.72001444041262.
Norm before scaling: 42.709930737402864. Distance: 1.6672299466365004
Total norm for 4 adversaries is: 42.709930737402864. distance: 1.6672299466365004
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3138, Accuracy: 9112/9900 (92.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5157/5503 (93.7125%), train_poison_data_count: 430
Global model norm: 42.72001444041262.
Norm before scaling: 42.712864501755355. Distance: 1.761693036553617
Total norm for 4 adversaries is: 42.712864501755355. distance: 1.761693036553617
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1496, Accuracy: 9514/9900 (96.1010%)
___Train Local_ResNet_18,  epoch  84, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4946/5461 (90.5695%)
___Train Local_ResNet_18,  epoch  84, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4925/5461 (90.1849%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1893, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  84, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4940/5346 (92.4055%)
___Train Local_ResNet_18,  epoch  84, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4941/5346 (92.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0098, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  84, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4922/5489 (89.6702%)
___Train Local_ResNet_18,  epoch  84, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4940/5489 (89.9982%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2305, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4514/4929 (91.5804%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4488/4929 (91.0530%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0079, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  84, local model 57, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4533/4956 (91.4649%)
___Train Local_ResNet_18,  epoch  84, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4560/4956 (92.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0223, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  84, local model 22, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5161/5696 (90.6074%)
___Train Local_ResNet_18,  epoch  84, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5160/5696 (90.5899%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0576, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  84, local model 68, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3266/3589 (91.0003%)
___Train Local_ResNet_18,  epoch  84, local model 68, internal_epoch   2,  Average loss: 0.0093, Accuracy: 2972/3589 (82.8086%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2041, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch  84, local model 38, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5523/6235 (88.5806%)
___Train Local_ResNet_18,  epoch  84, local model 38, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5536/6235 (88.7891%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2122, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  84, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3527/3959 (89.0882%)
___Train Local_ResNet_18,  epoch  84, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3628/3959 (91.6393%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9920, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3750/4086 (91.7768%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3850/4086 (94.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9409, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  84, local model 41, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4354/4714 (92.3632%)
___Train Local_ResNet_18,  epoch  84, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4311/4714 (91.4510%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1632, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  84, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3814/4161 (91.6607%)
___Train Local_ResNet_18,  epoch  84, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3826/4161 (91.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3049, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch  84, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4089/4485 (91.1706%)
___Train Local_ResNet_18,  epoch  84, local model 61, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3992/4485 (89.0078%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0530, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  84, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4958/5454 (90.9058%)
___Train Local_ResNet_18,  epoch  84, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4965/5454 (91.0341%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9233, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  84, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5056/5422 (93.2497%)
___Train Local_ResNet_18,  epoch  84, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5049/5422 (93.1206%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9692, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  84, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4592/5122 (89.6525%)
___Train Local_ResNet_18,  epoch  84, local model 28, internal_epoch   2,  Average loss: 0.0106, Accuracy: 4115/5122 (80.3397%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3330, Accuracy: 4880/10000 (48.8000%)
time spent on training: 245.9920334815979
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1425, Accuracy: 6940/10000 (69.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 1.2924, Accuracy: 6905/9900 (69.7475%)
Done in 272.43698835372925 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 47, 12, 88, 79, 31, 29, 65, 32, 92, 8, 20, 41, 52, 61, 39, 64].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5049/5308 (95.1206%), train_poison_data_count: 415
Global model norm: 42.74261803498207.
Norm before scaling: 42.72937013654221. Distance: 1.6058891841095433
Total norm for 4 adversaries is: 42.72937013654221. distance: 1.6058891841095433
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1210, Accuracy: 9586/9900 (96.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5532/5777 (95.7590%), train_poison_data_count: 455
Global model norm: 42.74261803498207.
Norm before scaling: 42.72215461698049. Distance: 1.5804031848743105
Total norm for 4 adversaries is: 42.72215461698049. distance: 1.5804031848743105
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2264, Accuracy: 9338/9900 (94.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4798/5123 (93.6561%), train_poison_data_count: 403
Global model norm: 42.74261803498207.
Norm before scaling: 42.729997204924. Distance: 1.654192816514007
Total norm for 4 adversaries is: 42.729997204924. distance: 1.654192816514007
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3150, Accuracy: 9190/9900 (92.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5190/5503 (94.3122%), train_poison_data_count: 430
Global model norm: 42.74261803498207.
Norm before scaling: 42.730451430943106. Distance: 1.7015372758717424
Total norm for 4 adversaries is: 42.730451430943106. distance: 1.7015372758717424
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1488, Accuracy: 9520/9900 (96.1616%)
___Train Local_ResNet_18,  epoch  85, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4590/5123 (89.5959%)
___Train Local_ResNet_18,  epoch  85, local model 47, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4440/5123 (86.6680%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2888, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch  85, local model 12, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4927/5526 (89.1603%)
___Train Local_ResNet_18,  epoch  85, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4904/5526 (88.7441%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2350, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch  85, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4936/5362 (92.0552%)
___Train Local_ResNet_18,  epoch  85, local model 88, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4890/5362 (91.1973%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1285, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  85, local model 79, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3778/4111 (91.8998%)
___Train Local_ResNet_18,  epoch  85, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3797/4111 (92.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9641, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  85, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4169/4537 (91.8889%)
___Train Local_ResNet_18,  epoch  85, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4195/4537 (92.4620%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9043, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  85, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4418/4732 (93.3643%)
___Train Local_ResNet_18,  epoch  85, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4471/4732 (94.4844%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8351, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch  85, local model 65, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4949/5497 (90.0309%)
___Train Local_ResNet_18,  epoch  85, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4978/5497 (90.5585%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1403, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5363/6080 (88.2072%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5328/6080 (87.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1363, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  85, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 6266/6812 (91.9847%)
___Train Local_ResNet_18,  epoch  85, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6224/6812 (91.3682%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0375, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  85, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4449/4889 (91.0002%)
___Train Local_ResNet_18,  epoch  85, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4431/4889 (90.6320%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9696, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  85, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4304/4714 (91.3025%)
___Train Local_ResNet_18,  epoch  85, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4374/4714 (92.7874%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0044, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  85, local model 41, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4325/4714 (91.7480%)
___Train Local_ResNet_18,  epoch  85, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4381/4714 (92.9359%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1671, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  85, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3784/4130 (91.6223%)
___Train Local_ResNet_18,  epoch  85, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3796/4130 (91.9128%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9494, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  85, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4070/4485 (90.7469%)
___Train Local_ResNet_18,  epoch  85, local model 61, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3996/4485 (89.0970%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0919, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  85, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3739/4175 (89.5569%)
___Train Local_ResNet_18,  epoch  85, local model 39, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3750/4175 (89.8204%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0214, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  85, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4364/4894 (89.1704%)
___Train Local_ResNet_18,  epoch  85, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4334/4894 (88.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0952, Accuracy: 5336/10000 (53.3600%)
time spent on training: 245.71964812278748
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1463, Accuracy: 6942/10000 (69.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.1370, Accuracy: 7219/9900 (72.9192%)
Done in 272.24473309516907 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 88, 39, 63, 20, 24, 15, 83, 29, 97, 50, 96, 1, 57, 30, 10, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5039/5308 (94.9322%), train_poison_data_count: 415
Global model norm: 42.76470729970787.
Norm before scaling: 42.7506853015247. Distance: 1.6142808528301278
Total norm for 4 adversaries is: 42.7506853015247. distance: 1.6142808528301278
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1463, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5549/5777 (96.0533%), train_poison_data_count: 455
Global model norm: 42.76470729970787.
Norm before scaling: 42.742041131398075. Distance: 1.5410761174656487
Total norm for 4 adversaries is: 42.742041131398075. distance: 1.5410761174656487
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1801, Accuracy: 9449/9900 (95.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4816/5123 (94.0074%), train_poison_data_count: 403
Global model norm: 42.76470729970787.
Norm before scaling: 42.75340070081414. Distance: 1.6584302119930001
Total norm for 4 adversaries is: 42.75340070081414. distance: 1.6584302119930001
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.2199, Accuracy: 9361/9900 (94.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5225/5503 (94.9482%), train_poison_data_count: 430
Global model norm: 42.76470729970787.
Norm before scaling: 42.75277397569879. Distance: 1.6781168136539077
Total norm for 4 adversaries is: 42.75277397569879. distance: 1.6781168136539077
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0996, Accuracy: 9638/9900 (97.3535%)
___Train Local_ResNet_18,  epoch  86, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4934/5362 (92.0179%)
___Train Local_ResNet_18,  epoch  86, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4876/5362 (90.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9331, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  86, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3758/4175 (90.0120%)
___Train Local_ResNet_18,  epoch  86, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3788/4175 (90.7305%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1898, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3613/3910 (92.4041%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3563/3910 (91.1253%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0487, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  86, local model 20, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4349/4714 (92.2571%)
___Train Local_ResNet_18,  epoch  86, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4412/4714 (93.5936%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7700, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch  86, local model 24, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3927/4313 (91.0503%)
___Train Local_ResNet_18,  epoch  86, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3990/4313 (92.5110%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8575, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch  86, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5518/6068 (90.9361%)
___Train Local_ResNet_18,  epoch  86, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5521/6068 (90.9855%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1123, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  86, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3212/3552 (90.4279%)
___Train Local_ResNet_18,  epoch  86, local model 83, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3268/3552 (92.0045%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9343, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  86, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4371/4732 (92.3711%)
___Train Local_ResNet_18,  epoch  86, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4462/4732 (94.2942%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7860, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch  86, local model 97, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4200/4736 (88.6824%)
___Train Local_ResNet_18,  epoch  86, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4241/4736 (89.5481%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0258, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  86, local model 50, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4351/4757 (91.4652%)
___Train Local_ResNet_18,  epoch  86, local model 50, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4354/4757 (91.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9789, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  86, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4587/5086 (90.1888%)
___Train Local_ResNet_18,  epoch  86, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4613/5086 (90.7000%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0600, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  86, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5049/5422 (93.1206%)
___Train Local_ResNet_18,  epoch  86, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5028/5422 (92.7333%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9881, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  86, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4577/4956 (92.3527%)
___Train Local_ResNet_18,  epoch  86, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4534/4956 (91.4851%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1627, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3483/3774 (92.2893%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3563/3774 (94.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8648, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch  86, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4677/5068 (92.2849%)
___Train Local_ResNet_18,  epoch  86, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4700/5068 (92.7388%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0564, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  86, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4924/5346 (92.1062%)
___Train Local_ResNet_18,  epoch  86, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4923/5346 (92.0875%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1280, Accuracy: 5283/10000 (52.8300%)
time spent on training: 241.66530752182007
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1584, Accuracy: 6927/10000 (69.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.9716, Accuracy: 7591/9900 (76.6768%)
Done in 268.02971744537354 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 47, 33, 81, 59, 32, 96, 60, 88, 7, 69, 95, 21, 51, 35, 93, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5028/5308 (94.7249%), train_poison_data_count: 415
Global model norm: 42.784681027957454.
Norm before scaling: 42.77130631106195. Distance: 1.5964123049962171
Total norm for 4 adversaries is: 42.77130631106195. distance: 1.5964123049962171
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2131, Accuracy: 9365/9900 (94.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5546/5777 (96.0014%), train_poison_data_count: 455
Global model norm: 42.784681027957454.
Norm before scaling: 42.76138314731968. Distance: 1.5217062478629562
Total norm for 4 adversaries is: 42.76138314731968. distance: 1.5217062478629562
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0952, Accuracy: 9657/9900 (97.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4815/5123 (93.9879%), train_poison_data_count: 403
Global model norm: 42.784681027957454.
Norm before scaling: 42.77010617735096. Distance: 1.594825680812469
Total norm for 4 adversaries is: 42.77010617735096. distance: 1.594825680812469
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0935, Accuracy: 9644/9900 (97.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5221/5503 (94.8755%), train_poison_data_count: 430
Global model norm: 42.784681027957454.
Norm before scaling: 42.769533925757976. Distance: 1.6137879986651344
Total norm for 4 adversaries is: 42.769533925757976. distance: 1.6137879986651344
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.3326, Accuracy: 9083/9900 (91.7475%)
___Train Local_ResNet_18,  epoch  87, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4620/5123 (90.1815%)
___Train Local_ResNet_18,  epoch  87, local model 47, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4360/5123 (85.1064%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1164, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch  87, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4319/4818 (89.6430%)
___Train Local_ResNet_18,  epoch  87, local model 33, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4234/4818 (87.8788%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0532, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  87, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4588/5035 (91.1221%)
___Train Local_ResNet_18,  epoch  87, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4610/5035 (91.5591%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1080, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  87, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4168/4397 (94.7919%)
___Train Local_ResNet_18,  epoch  87, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4191/4397 (95.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8096, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch  87, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5280/6080 (86.8421%)
___Train Local_ResNet_18,  epoch  87, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5294/6080 (87.0724%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2388, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch  87, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4623/5086 (90.8966%)
___Train Local_ResNet_18,  epoch  87, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4648/5086 (91.3881%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0552, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3796/4145 (91.5802%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3810/4145 (91.9180%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0781, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  87, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4860/5362 (90.6378%)
___Train Local_ResNet_18,  epoch  87, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4858/5362 (90.6005%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0749, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  87, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4357/4869 (89.4845%)
___Train Local_ResNet_18,  epoch  87, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4079/4869 (83.7749%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2783, Accuracy: 4907/10000 (49.0700%)
___Train Local_ResNet_18,  epoch  87, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3950/4364 (90.5133%)
___Train Local_ResNet_18,  epoch  87, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3991/4364 (91.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8769, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  87, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4447/5018 (88.6210%)
___Train Local_ResNet_18,  epoch  87, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4449/5018 (88.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1241, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  87, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4582/5038 (90.9488%)
___Train Local_ResNet_18,  epoch  87, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4628/5038 (91.8618%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0075, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  87, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3793/4108 (92.3320%)
___Train Local_ResNet_18,  epoch  87, local model 51, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3736/4108 (90.9445%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0240, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  87, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5051/5615 (89.9555%)
___Train Local_ResNet_18,  epoch  87, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5077/5615 (90.4185%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0729, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  87, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4559/5055 (90.1879%)
___Train Local_ResNet_18,  epoch  87, local model 93, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4497/5055 (88.9614%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1032, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  87, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4269/4797 (88.9931%)
___Train Local_ResNet_18,  epoch  87, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4300/4797 (89.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9752, Accuracy: 5505/10000 (55.0500%)
time spent on training: 246.18976855278015
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1640, Accuracy: 6900/10000 (69.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.8563, Accuracy: 7871/9900 (79.5051%)
Done in 272.1422367095947 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 91, 26, 17, 2, 35, 90, 19, 77, 49, 55, 42, 94, 76, 73, 74, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5087/5308 (95.8365%), train_poison_data_count: 415
Global model norm: 42.80669297980384.
Norm before scaling: 42.79188172541098. Distance: 1.557625453054088
Total norm for 4 adversaries is: 42.79188172541098. distance: 1.557625453054088
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1063, Accuracy: 9594/9900 (96.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5520/5777 (95.5513%), train_poison_data_count: 455
Global model norm: 42.80669297980384.
Norm before scaling: 42.787633916950085. Distance: 1.617595528990531
Total norm for 4 adversaries is: 42.787633916950085. distance: 1.617595528990531
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0936, Accuracy: 9663/9900 (97.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4825/5123 (94.1831%), train_poison_data_count: 403
Global model norm: 42.80669297980384.
Norm before scaling: 42.79317680945541. Distance: 1.6234515955939968
Total norm for 4 adversaries is: 42.79317680945541. distance: 1.6234515955939968
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1509, Accuracy: 9484/9900 (95.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5207/5503 (94.6211%), train_poison_data_count: 430
Global model norm: 42.80669297980384.
Norm before scaling: 42.7936303648649. Distance: 1.6689088838640596
Total norm for 4 adversaries is: 42.7936303648649. distance: 1.6689088838640596
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0646, Accuracy: 9724/9900 (98.2222%)
___Train Local_ResNet_18,  epoch  88, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4071/4527 (89.9271%)
___Train Local_ResNet_18,  epoch  88, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4020/4527 (88.8005%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0875, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  88, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3809/4086 (93.2208%)
___Train Local_ResNet_18,  epoch  88, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3808/4086 (93.1963%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0079, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  88, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4369/4903 (89.1087%)
___Train Local_ResNet_18,  epoch  88, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4397/4903 (89.6798%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1418, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  88, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3624/3968 (91.3306%)
___Train Local_ResNet_18,  epoch  88, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3704/3968 (93.3468%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.7256, Accuracy: 5922/10000 (59.2200%)
___Train Local_ResNet_18,  epoch  88, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5113/5615 (91.0597%)
___Train Local_ResNet_18,  epoch  88, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5094/5615 (90.7213%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0217, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4426/4748 (93.2182%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4361/4748 (91.8492%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0346, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  88, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4852/5361 (90.5055%)
___Train Local_ResNet_18,  epoch  88, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4824/5361 (89.9832%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1677, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4463/5050 (88.3762%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4548/5050 (90.0594%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1319, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  88, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5043/5652 (89.2251%)
___Train Local_ResNet_18,  epoch  88, local model 49, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4955/5652 (87.6681%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2500, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4333/4731 (91.5874%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4390/4731 (92.7922%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9346, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5300/5907 (89.7241%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5328/5907 (90.1981%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.3959, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch  88, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4671/5224 (89.4142%)
___Train Local_ResNet_18,  epoch  88, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4710/5224 (90.1608%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0656, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  88, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3585/3959 (90.5532%)
___Train Local_ResNet_18,  epoch  88, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3630/3959 (91.6898%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8932, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  88, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4290/4605 (93.1596%)
___Train Local_ResNet_18,  epoch  88, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4308/4605 (93.5505%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9940, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4334/4797 (90.3481%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4274/4797 (89.0974%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9327, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  88, local model 22, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5221/5696 (91.6608%)
___Train Local_ResNet_18,  epoch  88, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5179/5696 (90.9235%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1027, Accuracy: 5304/10000 (53.0400%)
time spent on training: 244.34024691581726
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1623, Accuracy: 6916/10000 (69.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.8070, Accuracy: 7963/9900 (80.4343%)
Done in 270.7415828704834 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 59, 78, 62, 30, 12, 24, 43, 89, 46, 60, 90, 77, 95, 53, 69, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5045/5308 (95.0452%), train_poison_data_count: 415
Global model norm: 42.828223333068436.
Norm before scaling: 42.81448159191438. Distance: 1.5941535588370501
Total norm for 4 adversaries is: 42.81448159191438. distance: 1.5941535588370501
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.0658, Accuracy: 9725/9900 (98.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5540/5777 (95.8975%), train_poison_data_count: 455
Global model norm: 42.828223333068436.
Norm before scaling: 42.806362185482286. Distance: 1.5719673205465994
Total norm for 4 adversaries is: 42.806362185482286. distance: 1.5719673205465994
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1632, Accuracy: 9485/9900 (95.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4818/5123 (94.0465%), train_poison_data_count: 403
Global model norm: 42.828223333068436.
Norm before scaling: 42.812385948753196. Distance: 1.563540531829822
Total norm for 4 adversaries is: 42.812385948753196. distance: 1.563540531829822
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2885, Accuracy: 9206/9900 (92.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5211/5503 (94.6938%), train_poison_data_count: 430
Global model norm: 42.828223333068436.
Norm before scaling: 42.81168737823674. Distance: 1.6178053260837222
Total norm for 4 adversaries is: 42.81168737823674. distance: 1.6178053260837222
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1330, Accuracy: 9575/9900 (96.7172%)
___Train Local_ResNet_18,  epoch  89, local model 59, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4189/4397 (95.2695%)
___Train Local_ResNet_18,  epoch  89, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4188/4397 (95.2468%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8089, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch  89, local model 78, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4035/4368 (92.3764%)
___Train Local_ResNet_18,  epoch  89, local model 78, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3995/4368 (91.4606%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9631, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  89, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4814/5504 (87.4637%)
___Train Local_ResNet_18,  epoch  89, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4846/5504 (88.0451%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0884, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  89, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3448/3774 (91.3620%)
___Train Local_ResNet_18,  epoch  89, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3510/3774 (93.0048%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9482, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  89, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4973/5526 (89.9928%)
___Train Local_ResNet_18,  epoch  89, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4864/5526 (88.0203%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2213, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3977/4313 (92.2096%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3985/4313 (92.3951%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8627, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch  89, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4489/4979 (90.1587%)
___Train Local_ResNet_18,  epoch  89, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4547/4979 (91.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1161, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  89, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4306/4737 (90.9014%)
___Train Local_ResNet_18,  epoch  89, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4341/4737 (91.6403%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1295, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  89, local model 46, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4776/5399 (88.4608%)
___Train Local_ResNet_18,  epoch  89, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4686/5399 (86.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1096, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3784/4145 (91.2907%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3815/4145 (92.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0135, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4423/4748 (93.1550%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4353/4748 (91.6807%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1014, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  89, local model 77, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4484/5050 (88.7921%)
___Train Local_ResNet_18,  epoch  89, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4515/5050 (89.4059%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1177, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  89, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4459/5018 (88.8601%)
___Train Local_ResNet_18,  epoch  89, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4501/5018 (89.6971%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1795, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch  89, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5874/6664 (88.1453%)
___Train Local_ResNet_18,  epoch  89, local model 53, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5666/6664 (85.0240%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0765, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3998/4364 (91.6132%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4053/4364 (92.8735%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7485, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch  89, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3924/4196 (93.5176%)
___Train Local_ResNet_18,  epoch  89, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3938/4196 (93.8513%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7391, Accuracy: 5958/10000 (59.5800%)
time spent on training: 241.51749396324158
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1642, Accuracy: 6908/10000 (69.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.7361, Accuracy: 8100/9900 (81.8182%)
Done in 267.6055221557617 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 6, 84, 86, 33, 22, 12, 42, 56, 72, 93, 82, 28, 78, 39, 99, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5056/5308 (95.2524%), train_poison_data_count: 415
Global model norm: 42.84794951154314.
Norm before scaling: 42.832345993200626. Distance: 1.5755296270792383
Total norm for 4 adversaries is: 42.832345993200626. distance: 1.5755296270792383
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0436, Accuracy: 9771/9900 (98.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5536/5777 (95.8283%), train_poison_data_count: 455
Global model norm: 42.84794951154314.
Norm before scaling: 42.82721291440321. Distance: 1.5674476111021398
Total norm for 4 adversaries is: 42.82721291440321. distance: 1.5674476111021398
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0641, Accuracy: 9733/9900 (98.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4854/5123 (94.7492%), train_poison_data_count: 403
Global model norm: 42.84794951154314.
Norm before scaling: 42.833996086089435. Distance: 1.5623334414400216
Total norm for 4 adversaries is: 42.833996086089435. distance: 1.5623334414400216
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2600, Accuracy: 9220/9900 (93.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5228/5503 (95.0027%), train_poison_data_count: 430
Global model norm: 42.84794951154314.
Norm before scaling: 42.832259069446565. Distance: 1.6220980922609916
Total norm for 4 adversaries is: 42.832259069446565. distance: 1.6220980922609916
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0903, Accuracy: 9651/9900 (97.4848%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4518/4929 (91.6616%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4451/4929 (90.3023%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2416, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4685/5209 (89.9405%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4629/5209 (88.8654%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9905, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  90, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3530/3929 (89.8447%)
___Train Local_ResNet_18,  epoch  90, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3567/3929 (90.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8796, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch  90, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4354/4818 (90.3694%)
___Train Local_ResNet_18,  epoch  90, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4312/4818 (89.4977%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1378, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  90, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5251/5696 (92.1875%)
___Train Local_ResNet_18,  epoch  90, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5150/5696 (90.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0014, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4985/5526 (90.2099%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4854/5526 (87.8393%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1762, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch  90, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5362/5907 (90.7737%)
___Train Local_ResNet_18,  epoch  90, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5411/5907 (91.6032%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1532, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  90, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4847/5427 (89.3127%)
___Train Local_ResNet_18,  epoch  90, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4881/5427 (89.9392%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9542, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  90, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4715/5193 (90.7953%)
___Train Local_ResNet_18,  epoch  90, local model 72, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4570/5193 (88.0031%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2082, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  90, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4546/5055 (89.9308%)
___Train Local_ResNet_18,  epoch  90, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4578/5055 (90.5638%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0551, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  90, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4902/5298 (92.5255%)
___Train Local_ResNet_18,  epoch  90, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4890/5298 (92.2990%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9293, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  90, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4567/5122 (89.1644%)
___Train Local_ResNet_18,  epoch  90, local model 28, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4174/5122 (81.4916%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3746, Accuracy: 4732/10000 (47.3200%)
___Train Local_ResNet_18,  epoch  90, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4062/4368 (92.9945%)
___Train Local_ResNet_18,  epoch  90, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4063/4368 (93.0174%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9151, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  90, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3776/4175 (90.4431%)
___Train Local_ResNet_18,  epoch  90, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3794/4175 (90.8743%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9987, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  90, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4370/4851 (90.0845%)
___Train Local_ResNet_18,  epoch  90, local model 99, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4372/4851 (90.1257%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9549, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  90, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4864/5353 (90.8649%)
___Train Local_ResNet_18,  epoch  90, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4827/5353 (90.1737%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9231, Accuracy: 5511/10000 (55.1100%)
time spent on training: 246.93115878105164
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1673, Accuracy: 6901/10000 (69.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.6588, Accuracy: 8263/9900 (83.4646%)
Done in 273.2752528190613 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 56, 54, 18, 92, 50, 11, 82, 27, 16, 4, 75, 29, 52, 67, 62, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5065/5308 (95.4220%), train_poison_data_count: 415
Global model norm: 42.87122597502388.
Norm before scaling: 42.85565656718711. Distance: 1.5588594367943702
Total norm for 4 adversaries is: 42.85565656718711. distance: 1.5588594367943702
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0822, Accuracy: 9673/9900 (97.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5551/5777 (96.0879%), train_poison_data_count: 455
Global model norm: 42.87122597502388.
Norm before scaling: 42.8460278729801. Distance: 1.525907421608555
Total norm for 4 adversaries is: 42.8460278729801. distance: 1.525907421608555
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0542, Accuracy: 9764/9900 (98.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4863/5123 (94.9248%), train_poison_data_count: 403
Global model norm: 42.87122597502388.
Norm before scaling: 42.851756921847006. Distance: 1.5119459193463085
Total norm for 4 adversaries is: 42.851756921847006. distance: 1.5119459193463085
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1506, Accuracy: 9515/9900 (96.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5243/5503 (95.2753%), train_poison_data_count: 430
Global model norm: 42.87122597502388.
Norm before scaling: 42.85458840159724. Distance: 1.5908823580787153
Total norm for 4 adversaries is: 42.85458840159724. distance: 1.5908823580787153
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0643, Accuracy: 9721/9900 (98.1919%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4881/5427 (89.9392%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4870/5427 (89.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9813, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  91, local model 54, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5022/5645 (88.9637%)
___Train Local_ResNet_18,  epoch  91, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4967/5645 (87.9894%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1099, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  91, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3869/4249 (91.0567%)
___Train Local_ResNet_18,  epoch  91, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3901/4249 (91.8098%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9238, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6226/6812 (91.3975%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6206/6812 (91.1039%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0685, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  91, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4347/4757 (91.3811%)
___Train Local_ResNet_18,  epoch  91, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4283/4757 (90.0357%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1155, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4902/5702 (85.9698%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4846/5702 (84.9877%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3682, Accuracy: 4918/10000 (49.1800%)
___Train Local_ResNet_18,  epoch  91, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4917/5298 (92.8086%)
___Train Local_ResNet_18,  epoch  91, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4940/5298 (93.2427%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0239, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  91, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4140/4587 (90.2551%)
___Train Local_ResNet_18,  epoch  91, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4153/4587 (90.5385%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0859, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  91, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4807/5353 (89.8001%)
___Train Local_ResNet_18,  epoch  91, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4812/5353 (89.8935%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0341, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  91, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3707/4028 (92.0308%)
___Train Local_ResNet_18,  epoch  91, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3716/4028 (92.2542%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8339, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4272/4672 (91.4384%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4304/4672 (92.1233%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9086, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  91, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4403/4732 (93.0473%)
___Train Local_ResNet_18,  epoch  91, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4437/4732 (93.7658%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9027, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  91, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3801/4130 (92.0339%)
___Train Local_ResNet_18,  epoch  91, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3825/4130 (92.6150%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9187, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  91, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4933/5559 (88.7390%)
___Train Local_ResNet_18,  epoch  91, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4862/5559 (87.4618%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2012, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch  91, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4803/5504 (87.2638%)
___Train Local_ResNet_18,  epoch  91, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4853/5504 (88.1722%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0083, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4569/5123 (89.1860%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4373/5123 (85.3601%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2207, Accuracy: 5143/10000 (51.4300%)
time spent on training: 248.72991681098938
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1679, Accuracy: 6908/10000 (69.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.6147, Accuracy: 8368/9900 (84.5253%)
Done in 275.0701494216919 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 74, 10, 82, 34, 43, 23, 33, 1, 44, 19, 63, 0, 28, 54, 70, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5076/5308 (95.6292%), train_poison_data_count: 415
Global model norm: 42.894357476482995.
Norm before scaling: 42.87447327938123. Distance: 1.500912627109966
Total norm for 4 adversaries is: 42.87447327938123. distance: 1.500912627109966
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0345, Accuracy: 9804/9900 (99.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5566/5777 (96.3476%), train_poison_data_count: 455
Global model norm: 42.894357476482995.
Norm before scaling: 42.869560230260554. Distance: 1.4753759551587755
Total norm for 4 adversaries is: 42.869560230260554. distance: 1.4753759551587755
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2491, Accuracy: 9333/9900 (94.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4857/5123 (94.8077%), train_poison_data_count: 403
Global model norm: 42.894357476482995.
Norm before scaling: 42.87887333314989. Distance: 1.5577293044729543
Total norm for 4 adversaries is: 42.87887333314989. distance: 1.5577293044729543
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1539, Accuracy: 9487/9900 (95.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5242/5503 (95.2571%), train_poison_data_count: 430
Global model norm: 42.894357476482995.
Norm before scaling: 42.87684774170817. Distance: 1.5903926717167192
Total norm for 4 adversaries is: 42.87684774170817. distance: 1.5903926717167192
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2298, Accuracy: 9332/9900 (94.2626%)
___Train Local_ResNet_18,  epoch  92, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4267/4797 (88.9514%)
___Train Local_ResNet_18,  epoch  92, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4236/4797 (88.3052%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0496, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  92, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4689/5068 (92.5217%)
___Train Local_ResNet_18,  epoch  92, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4682/5068 (92.3836%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0146, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  92, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4938/5298 (93.2050%)
___Train Local_ResNet_18,  epoch  92, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4920/5298 (92.8652%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9885, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4495/4911 (91.5292%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4539/4911 (92.4252%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9589, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  92, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4484/4979 (90.0582%)
___Train Local_ResNet_18,  epoch  92, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4523/4979 (90.8415%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0766, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  92, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4262/4549 (93.6909%)
___Train Local_ResNet_18,  epoch  92, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4079/4549 (89.6681%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9391, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  92, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4390/4818 (91.1166%)
___Train Local_ResNet_18,  epoch  92, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4313/4818 (89.5185%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0763, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  92, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5070/5422 (93.5079%)
___Train Local_ResNet_18,  epoch  92, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5060/5422 (93.3235%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8800, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  92, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4662/5075 (91.8621%)
___Train Local_ResNet_18,  epoch  92, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4631/5075 (91.2512%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9691, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  92, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4816/5361 (89.8340%)
___Train Local_ResNet_18,  epoch  92, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4797/5361 (89.4796%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0541, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  92, local model 63, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3556/3910 (90.9463%)
___Train Local_ResNet_18,  epoch  92, local model 63, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3502/3910 (89.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1797, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  92, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4927/5454 (90.3374%)
___Train Local_ResNet_18,  epoch  92, local model 0, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4799/5454 (87.9905%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0052, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  92, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4550/5122 (88.8325%)
___Train Local_ResNet_18,  epoch  92, local model 28, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4329/5122 (84.5178%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.3481, Accuracy: 4931/10000 (49.3100%)
___Train Local_ResNet_18,  epoch  92, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4996/5645 (88.5031%)
___Train Local_ResNet_18,  epoch  92, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4961/5645 (87.8831%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1874, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch  92, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5412/5871 (92.1819%)
___Train Local_ResNet_18,  epoch  92, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5382/5871 (91.6709%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0751, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  92, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6300/6812 (92.4839%)
___Train Local_ResNet_18,  epoch  92, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6214/6812 (91.2214%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0639, Accuracy: 5458/10000 (54.5800%)
time spent on training: 250.5583930015564
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1683, Accuracy: 6898/10000 (68.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.5857, Accuracy: 8442/9900 (85.2727%)
Done in 277.0198495388031 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 92, 14, 45, 16, 59, 87, 19, 95, 47, 66, 6, 7, 82, 69, 79, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5068/5308 (95.4785%), train_poison_data_count: 415
Global model norm: 42.917344250314464.
Norm before scaling: 42.90025222099516. Distance: 1.538588397591165
Total norm for 4 adversaries is: 42.90025222099516. distance: 1.538588397591165
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0689, Accuracy: 9722/9900 (98.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5534/5777 (95.7937%), train_poison_data_count: 455
Global model norm: 42.917344250314464.
Norm before scaling: 42.8929259970212. Distance: 1.5261479450319102
Total norm for 4 adversaries is: 42.8929259970212. distance: 1.5261479450319102
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1122, Accuracy: 9605/9900 (97.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4861/5123 (94.8858%), train_poison_data_count: 403
Global model norm: 42.917344250314464.
Norm before scaling: 42.89957926795072. Distance: 1.5440160359948272
Total norm for 4 adversaries is: 42.89957926795072. distance: 1.5440160359948272
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1511, Accuracy: 9512/9900 (96.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5247/5503 (95.3480%), train_poison_data_count: 430
Global model norm: 42.917344250314464.
Norm before scaling: 42.90039591573209. Distance: 1.5506650174876457
Total norm for 4 adversaries is: 42.90039591573209. distance: 1.5506650174876457
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0864, Accuracy: 9670/9900 (97.6768%)
___Train Local_ResNet_18,  epoch  93, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6296/6812 (92.4251%)
___Train Local_ResNet_18,  epoch  93, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6256/6812 (91.8379%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1385, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  93, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3961/4196 (94.3994%)
___Train Local_ResNet_18,  epoch  93, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3978/4196 (94.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8656, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch  93, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4867/5489 (88.6682%)
___Train Local_ResNet_18,  epoch  93, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4954/5489 (90.2532%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9725, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  93, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4882/5353 (91.2012%)
___Train Local_ResNet_18,  epoch  93, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4795/5353 (89.5759%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9654, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  93, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4144/4397 (94.2461%)
___Train Local_ResNet_18,  epoch  93, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4200/4397 (95.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7860, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch  93, local model 87, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3557/3995 (89.0363%)
___Train Local_ResNet_18,  epoch  93, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3581/3995 (89.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9584, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  93, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4855/5361 (90.5615%)
___Train Local_ResNet_18,  epoch  93, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4759/5361 (88.7708%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1414, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  93, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4542/5018 (90.5141%)
___Train Local_ResNet_18,  epoch  93, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4451/5018 (88.7007%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0655, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  93, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4583/5123 (89.4593%)
___Train Local_ResNet_18,  epoch  93, local model 47, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4298/5123 (83.8962%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3444, Accuracy: 4918/10000 (49.1800%)
___Train Local_ResNet_18,  epoch  93, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4396/4843 (90.7702%)
___Train Local_ResNet_18,  epoch  93, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4428/4843 (91.4309%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9431, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  93, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4548/4929 (92.2702%)
___Train Local_ResNet_18,  epoch  93, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4471/4929 (90.7081%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9956, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4413/4869 (90.6346%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3980/4869 (81.7416%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.4433, Accuracy: 4808/10000 (48.0800%)
___Train Local_ResNet_18,  epoch  93, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4874/5298 (91.9970%)
___Train Local_ResNet_18,  epoch  93, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4905/5298 (92.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9835, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  93, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4000/4364 (91.6590%)
___Train Local_ResNet_18,  epoch  93, local model 69, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3883/4364 (88.9780%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1220, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  93, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3766/4111 (91.6079%)
___Train Local_ResNet_18,  epoch  93, local model 79, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3724/4111 (90.5862%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0948, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  93, local model 4, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3650/4028 (90.6157%)
___Train Local_ResNet_18,  epoch  93, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3726/4028 (92.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8651, Accuracy: 5744/10000 (57.4400%)
time spent on training: 244.0609016418457
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1740, Accuracy: 6879/10000 (68.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.5115, Accuracy: 8636/9900 (87.2323%)
Done in 270.33788800239563 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 14, 82, 18, 47, 52, 43, 16, 75, 27, 28, 33, 5, 17, 67, 48, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5092/5308 (95.9307%), train_poison_data_count: 415
Global model norm: 42.93942607352173.
Norm before scaling: 42.91934802126324. Distance: 1.4887084347858348
Total norm for 4 adversaries is: 42.91934802126324. distance: 1.4887084347858348
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0679, Accuracy: 9727/9900 (98.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5569/5777 (96.3995%), train_poison_data_count: 455
Global model norm: 42.93942607352173.
Norm before scaling: 42.91113609059934. Distance: 1.4427788874408456
Total norm for 4 adversaries is: 42.91113609059934. distance: 1.4427788874408456
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1615, Accuracy: 9492/9900 (95.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4860/5123 (94.8663%), train_poison_data_count: 403
Global model norm: 42.93942607352173.
Norm before scaling: 42.92106729309192. Distance: 1.544950270361679
Total norm for 4 adversaries is: 42.92106729309192. distance: 1.544950270361679
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1462, Accuracy: 9528/9900 (96.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5255/5503 (95.4934%), train_poison_data_count: 430
Global model norm: 42.93942607352173.
Norm before scaling: 42.92194752223578. Distance: 1.5733228079125876
Total norm for 4 adversaries is: 42.92194752223578. distance: 1.5733228079125876
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0852, Accuracy: 9665/9900 (97.6263%)
___Train Local_ResNet_18,  epoch  94, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3960/4196 (94.3756%)
___Train Local_ResNet_18,  epoch  94, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3977/4196 (94.7807%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8006, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4902/5298 (92.5255%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4964/5298 (93.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0810, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  94, local model 18, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3859/4249 (90.8214%)
___Train Local_ResNet_18,  epoch  94, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3879/4249 (91.2921%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9296, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  94, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4627/5123 (90.3182%)
___Train Local_ResNet_18,  epoch  94, local model 47, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4597/5123 (89.7326%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1891, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  94, local model 52, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3825/4130 (92.6150%)
___Train Local_ResNet_18,  epoch  94, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3842/4130 (93.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9351, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  94, local model 43, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4529/4979 (90.9620%)
___Train Local_ResNet_18,  epoch  94, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4513/4979 (90.6407%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8705, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  94, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4880/5353 (91.1638%)
___Train Local_ResNet_18,  epoch  94, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4786/5353 (89.4078%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1017, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4303/4672 (92.1019%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4336/4672 (92.8082%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8470, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4136/4587 (90.1679%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4167/4587 (90.8437%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2516, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  94, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4564/5122 (89.1058%)
___Train Local_ResNet_18,  epoch  94, local model 28, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4333/5122 (84.5959%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2971, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch  94, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4359/4818 (90.4732%)
___Train Local_ResNet_18,  epoch  94, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4382/4818 (90.9506%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2499, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch  94, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4685/4993 (93.8314%)
___Train Local_ResNet_18,  epoch  94, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4639/4993 (92.9101%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0486, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  94, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4439/4903 (90.5364%)
___Train Local_ResNet_18,  epoch  94, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4398/4903 (89.7002%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2247, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  94, local model 67, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4948/5559 (89.0088%)
___Train Local_ResNet_18,  epoch  94, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4920/5559 (88.5051%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1792, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch  94, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4496/4830 (93.0849%)
___Train Local_ResNet_18,  epoch  94, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4530/4830 (93.7888%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9885, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  94, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5180/5696 (90.9410%)
___Train Local_ResNet_18,  epoch  94, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5139/5696 (90.2212%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0137, Accuracy: 5357/10000 (53.5700%)
time spent on training: 244.93070578575134
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1715, Accuracy: 6899/10000 (68.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.4873, Accuracy: 8683/9900 (87.7071%)
Done in 271.3681254386902 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 14, 47, 73, 97, 20, 45, 34, 76, 40, 35, 85, 62, 90, 54, 32, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5062/5308 (95.3655%), train_poison_data_count: 415
Global model norm: 42.96118683438284.
Norm before scaling: 42.94139043737769. Distance: 1.5206360710797786
Total norm for 4 adversaries is: 42.94139043737769. distance: 1.5206360710797786
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0283, Accuracy: 9818/9900 (99.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5563/5777 (96.2957%), train_poison_data_count: 455
Global model norm: 42.96118683438284.
Norm before scaling: 42.93351964811411. Distance: 1.4881155167060793
Total norm for 4 adversaries is: 42.93351964811411. distance: 1.4881155167060793
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1972, Accuracy: 9445/9900 (95.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4829/5123 (94.2612%), train_poison_data_count: 403
Global model norm: 42.96118683438284.
Norm before scaling: 42.94798930283291. Distance: 1.606257854991661
Total norm for 4 adversaries is: 42.94798930283291. distance: 1.606257854991661
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1897, Accuracy: 9411/9900 (95.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5282/5503 (95.9840%), train_poison_data_count: 430
Global model norm: 42.96118683438284.
Norm before scaling: 42.94020927133012. Distance: 1.4732088625589272
Total norm for 4 adversaries is: 42.94020927133012. distance: 1.4732088625589272
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1574, Accuracy: 9487/9900 (95.8283%)
___Train Local_ResNet_18,  epoch  95, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3970/4196 (94.6139%)
___Train Local_ResNet_18,  epoch  95, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3938/4196 (93.8513%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9211, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  95, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4607/5123 (89.9278%)
___Train Local_ResNet_18,  epoch  95, local model 47, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4195/5123 (81.8856%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2820, Accuracy: 4919/10000 (49.1900%)
___Train Local_ResNet_18,  epoch  95, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4268/4605 (92.6819%)
___Train Local_ResNet_18,  epoch  95, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4272/4605 (92.7687%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8806, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch  95, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4239/4736 (89.5059%)
___Train Local_ResNet_18,  epoch  95, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4241/4736 (89.5481%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1010, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  95, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4339/4714 (92.0450%)
___Train Local_ResNet_18,  epoch  95, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4394/4714 (93.2117%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9772, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  95, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4939/5489 (89.9800%)
___Train Local_ResNet_18,  epoch  95, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4924/5489 (89.7067%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3475, Accuracy: 4947/10000 (49.4700%)
___Train Local_ResNet_18,  epoch  95, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4479/4911 (91.2034%)
___Train Local_ResNet_18,  epoch  95, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4515/4911 (91.9365%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2154, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch  95, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3536/3959 (89.3155%)
___Train Local_ResNet_18,  epoch  95, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3615/3959 (91.3109%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0251, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  95, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5444/5939 (91.6653%)
___Train Local_ResNet_18,  epoch  95, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5499/5939 (92.5913%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0521, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  95, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5143/5615 (91.5939%)
___Train Local_ResNet_18,  epoch  95, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5102/5615 (90.8638%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1728, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  95, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6300/6947 (90.6866%)
___Train Local_ResNet_18,  epoch  95, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 6141/6947 (88.3979%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3274, Accuracy: 4981/10000 (49.8100%)
___Train Local_ResNet_18,  epoch  95, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4827/5504 (87.6999%)
___Train Local_ResNet_18,  epoch  95, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4805/5504 (87.3001%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0276, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4401/4748 (92.6917%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4407/4748 (92.8180%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9906, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  95, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4976/5645 (88.1488%)
___Train Local_ResNet_18,  epoch  95, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4955/5645 (87.7768%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2500, Accuracy: 5036/10000 (50.3600%)
___Train Local_ResNet_18,  epoch  95, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5382/6080 (88.5197%)
___Train Local_ResNet_18,  epoch  95, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5331/6080 (87.6809%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1723, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch  95, local model 68, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3307/3589 (92.1427%)
___Train Local_ResNet_18,  epoch  95, local model 68, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3256/3589 (90.7216%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9607, Accuracy: 5624/10000 (56.2400%)
time spent on training: 244.52364444732666
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1714, Accuracy: 6888/10000 (68.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.4658, Accuracy: 8733/9900 (88.2121%)
Done in 271.0243618488312 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 19, 26, 11, 32, 40, 65, 21, 5, 17, 92, 12, 63, 44, 51, 82, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5101/5308 (96.1002%), train_poison_data_count: 415
Global model norm: 42.98277469985433.
Norm before scaling: 42.96003320674927. Distance: 1.4160322096280944
Total norm for 4 adversaries is: 42.96003320674927. distance: 1.4160322096280944
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1252, Accuracy: 9574/9900 (96.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5566/5777 (96.3476%), train_poison_data_count: 455
Global model norm: 42.98277469985433.
Norm before scaling: 42.95730103153668. Distance: 1.5109173525834863
Total norm for 4 adversaries is: 42.95730103153668. distance: 1.5109173525834863
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0495, Accuracy: 9759/9900 (98.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4863/5123 (94.9248%), train_poison_data_count: 403
Global model norm: 42.98277469985433.
Norm before scaling: 42.9651731465803. Distance: 1.5246431714944062
Total norm for 4 adversaries is: 42.9651731465803. distance: 1.5246431714944062
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2861, Accuracy: 9178/9900 (92.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5263/5503 (95.6387%), train_poison_data_count: 430
Global model norm: 42.98277469985433.
Norm before scaling: 42.96401962598326. Distance: 1.5774663173749202
Total norm for 4 adversaries is: 42.96401962598326. distance: 1.5774663173749202
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0900, Accuracy: 9661/9900 (97.5859%)
___Train Local_ResNet_18,  epoch  96, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4830/5361 (90.0951%)
___Train Local_ResNet_18,  epoch  96, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4826/5361 (90.0205%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0870, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  96, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3757/4086 (91.9481%)
___Train Local_ResNet_18,  epoch  96, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3832/4086 (93.7837%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0714, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  96, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4915/5702 (86.1978%)
___Train Local_ResNet_18,  epoch  96, local model 11, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4667/5702 (81.8485%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2374, Accuracy: 5041/10000 (50.4100%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5331/6080 (87.6809%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5323/6080 (87.5493%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1477, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch  96, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5456/5939 (91.8673%)
___Train Local_ResNet_18,  epoch  96, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5464/5939 (92.0020%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9951, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  96, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4923/5497 (89.5579%)
___Train Local_ResNet_18,  epoch  96, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4924/5497 (89.5761%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2833, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18,  epoch  96, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4556/5038 (90.4327%)
___Train Local_ResNet_18,  epoch  96, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4583/5038 (90.9686%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8470, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch  96, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4646/4993 (93.0503%)
___Train Local_ResNet_18,  epoch  96, local model 5, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4575/4993 (91.6283%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1796, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4409/4903 (89.9245%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4438/4903 (90.5160%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1120, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  96, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6298/6812 (92.4545%)
___Train Local_ResNet_18,  epoch  96, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6194/6812 (90.9278%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0941, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  96, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4999/5526 (90.4633%)
___Train Local_ResNet_18,  epoch  96, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4917/5526 (88.9794%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0883, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3596/3910 (91.9693%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3497/3910 (89.4373%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1503, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  96, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4723/5075 (93.0640%)
___Train Local_ResNet_18,  epoch  96, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4634/5075 (91.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1744, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  96, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3765/4108 (91.6504%)
___Train Local_ResNet_18,  epoch  96, local model 51, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3737/4108 (90.9688%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0606, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  96, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4967/5298 (93.7524%)
___Train Local_ResNet_18,  epoch  96, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4964/5298 (93.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1475, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  96, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5007/5422 (92.3460%)
___Train Local_ResNet_18,  epoch  96, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4998/5422 (92.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0658, Accuracy: 5359/10000 (53.5900%)
time spent on training: 250.41201400756836
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1684, Accuracy: 6895/10000 (68.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.4640, Accuracy: 8734/9900 (88.2222%)
Done in 276.86850142478943 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 40, 64, 16, 91, 86, 42, 49, 66, 2, 8, 83, 26, 43, 81, 28, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5113/5308 (96.3263%), train_poison_data_count: 415
Global model norm: 43.006226554546.
Norm before scaling: 42.98389789811558. Distance: 1.4321427238934505
Total norm for 4 adversaries is: 42.98389789811558. distance: 1.4321427238934505
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0538, Accuracy: 9752/9900 (98.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5564/5777 (96.3130%), train_poison_data_count: 455
Global model norm: 43.006226554546.
Norm before scaling: 42.97912942820329. Distance: 1.4655096142862487
Total norm for 4 adversaries is: 42.97912942820329. distance: 1.4655096142862487
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0844, Accuracy: 9666/9900 (97.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4870/5123 (95.0615%), train_poison_data_count: 403
Global model norm: 43.006226554546.
Norm before scaling: 42.98518861689091. Distance: 1.4889678572752265
Total norm for 4 adversaries is: 42.98518861689091. distance: 1.4889678572752265
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2227, Accuracy: 9345/9900 (94.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5246/5503 (95.3298%), train_poison_data_count: 430
Global model norm: 43.006226554546.
Norm before scaling: 42.986199581867986. Distance: 1.542587426303189
Total norm for 4 adversaries is: 42.986199581867986. distance: 1.542587426303189
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1142, Accuracy: 9588/9900 (96.8485%)
___Train Local_ResNet_18,  epoch  97, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5421/5939 (91.2780%)
___Train Local_ResNet_18,  epoch  97, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5410/5939 (91.0928%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.3877, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18,  epoch  97, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4311/4894 (88.0875%)
___Train Local_ResNet_18,  epoch  97, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4321/4894 (88.2918%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1782, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  97, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4833/5353 (90.2858%)
___Train Local_ResNet_18,  epoch  97, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4863/5353 (90.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0312, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  97, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4069/4527 (89.8829%)
___Train Local_ResNet_18,  epoch  97, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4021/4527 (88.8226%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9776, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  97, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3593/3929 (91.4482%)
___Train Local_ResNet_18,  epoch  97, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3621/3929 (92.1609%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8478, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch  97, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5382/5907 (91.1122%)
___Train Local_ResNet_18,  epoch  97, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5312/5907 (89.9272%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2122, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  97, local model 49, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5100/5652 (90.2335%)
___Train Local_ResNet_18,  epoch  97, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5066/5652 (89.6320%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2287, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch  97, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4443/4843 (91.7407%)
___Train Local_ResNet_18,  epoch  97, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4404/4843 (90.9354%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0718, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  97, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3618/3968 (91.1794%)
___Train Local_ResNet_18,  epoch  97, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3680/3968 (92.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8221, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch  97, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4481/4889 (91.6547%)
___Train Local_ResNet_18,  epoch  97, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4481/4889 (91.6547%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2843, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  97, local model 83, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3223/3552 (90.7376%)
___Train Local_ResNet_18,  epoch  97, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3297/3552 (92.8209%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9258, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch  97, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3823/4086 (93.5634%)
___Train Local_ResNet_18,  epoch  97, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3847/4086 (94.1508%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8072, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch  97, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4566/4979 (91.7052%)
___Train Local_ResNet_18,  epoch  97, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4591/4979 (92.2073%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0392, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  97, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4644/5035 (92.2344%)
___Train Local_ResNet_18,  epoch  97, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4660/5035 (92.5521%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9662, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  97, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4621/5122 (90.2187%)
___Train Local_ResNet_18,  epoch  97, local model 28, internal_epoch   2,  Average loss: 0.0133, Accuracy: 3865/5122 (75.4588%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.4509, Accuracy: 4663/10000 (46.6300%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5126/5615 (91.2912%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5177/5615 (92.1995%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2782, Accuracy: 5087/10000 (50.8700%)
time spent on training: 244.5411343574524
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1778, Accuracy: 6875/10000 (68.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.4122, Accuracy: 8853/9900 (89.4242%)
Done in 271.1993029117584 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 48, 89, 35, 76, 39, 12, 31, 24, 1, 54, 37, 22, 21, 17, 10, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5103/5308 (96.1379%), train_poison_data_count: 415
Global model norm: 43.02721165010362.
Norm before scaling: 43.005934194905734. Distance: 1.4874684274352101
Total norm for 4 adversaries is: 43.005934194905734. distance: 1.4874684274352101
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0700, Accuracy: 9711/9900 (98.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5586/5777 (96.6938%), train_poison_data_count: 455
Global model norm: 43.02721165010362.
Norm before scaling: 42.9980567670469. Distance: 1.4488945364419465
Total norm for 4 adversaries is: 42.9980567670469. distance: 1.4488945364419465
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0544, Accuracy: 9746/9900 (98.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4867/5123 (95.0029%), train_poison_data_count: 403
Global model norm: 43.02721165010362.
Norm before scaling: 43.009381357625045. Distance: 1.5233461792791678
Total norm for 4 adversaries is: 43.009381357625045. distance: 1.5233461792791678
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1578, Accuracy: 9508/9900 (96.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5269/5503 (95.7478%), train_poison_data_count: 430
Global model norm: 43.02721165010362.
Norm before scaling: 43.008054466848854. Distance: 1.5414406464688493
Total norm for 4 adversaries is: 43.008054466848854. distance: 1.5414406464688493
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0421, Accuracy: 9786/9900 (98.8485%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4498/4830 (93.1263%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4493/4830 (93.0228%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9577, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  98, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4310/4737 (90.9859%)
___Train Local_ResNet_18,  epoch  98, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4293/4737 (90.6270%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1569, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5106/5615 (90.9350%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5098/5615 (90.7925%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1252, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  98, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3572/3959 (90.2248%)
___Train Local_ResNet_18,  epoch  98, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3615/3959 (91.3109%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0047, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  98, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3834/4175 (91.8323%)
___Train Local_ResNet_18,  epoch  98, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3810/4175 (91.2575%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8673, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch  98, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5094/5526 (92.1824%)
___Train Local_ResNet_18,  epoch  98, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4899/5526 (88.6536%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2564, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch  98, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4183/4537 (92.1975%)
___Train Local_ResNet_18,  epoch  98, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4173/4537 (91.9771%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8399, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch  98, local model 24, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3933/4313 (91.1894%)
___Train Local_ResNet_18,  epoch  98, local model 24, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3959/4313 (91.7923%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9907, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  98, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5073/5422 (93.5633%)
___Train Local_ResNet_18,  epoch  98, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5072/5422 (93.5448%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9072, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch  98, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4989/5645 (88.3791%)
___Train Local_ResNet_18,  epoch  98, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4860/5645 (86.0939%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0661, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  98, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4355/4741 (91.8583%)
___Train Local_ResNet_18,  epoch  98, local model 37, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3897/4741 (82.1978%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.4843, Accuracy: 4771/10000 (47.7100%)
___Train Local_ResNet_18,  epoch  98, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5221/5696 (91.6608%)
___Train Local_ResNet_18,  epoch  98, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5157/5696 (90.5372%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0534, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4565/5038 (90.6114%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4604/5038 (91.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9351, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  98, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4394/4903 (89.6186%)
___Train Local_ResNet_18,  epoch  98, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4465/4903 (91.0667%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0048, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  98, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4688/5068 (92.5020%)
___Train Local_ResNet_18,  epoch  98, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4605/5068 (90.8642%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3248, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch  98, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4416/4748 (93.0076%)
___Train Local_ResNet_18,  epoch  98, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4394/4748 (92.5442%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0054, Accuracy: 5533/10000 (55.3300%)
time spent on training: 245.04325532913208
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1789, Accuracy: 6884/10000 (68.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.3836, Accuracy: 8906/9900 (89.9596%)
Done in 271.0968997478485 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 83, 63, 46, 35, 25, 8, 56, 22, 31, 87, 5, 7, 10, 30, 82, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5096/5308 (96.0060%), train_poison_data_count: 415
Global model norm: 43.048689843776025.
Norm before scaling: 43.02613072081532. Distance: 1.4767428494873314
Total norm for 4 adversaries is: 43.02613072081532. distance: 1.4767428494873314
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0181, Accuracy: 9843/9900 (99.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5553/5777 (96.1226%), train_poison_data_count: 455
Global model norm: 43.048689843776025.
Norm before scaling: 43.02186348015027. Distance: 1.501201783993294
Total norm for 4 adversaries is: 43.02186348015027. distance: 1.501201783993294
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0805, Accuracy: 9686/9900 (97.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4873/5123 (95.1200%), train_poison_data_count: 403
Global model norm: 43.048689843776025.
Norm before scaling: 43.02977342918723. Distance: 1.542077920377326
Total norm for 4 adversaries is: 43.02977342918723. distance: 1.542077920377326
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1298, Accuracy: 9567/9900 (96.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5237/5503 (95.1663%), train_poison_data_count: 430
Global model norm: 43.048689843776025.
Norm before scaling: 43.03053796161076. Distance: 1.554300384632567
Total norm for 4 adversaries is: 43.03053796161076. distance: 1.554300384632567
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1377, Accuracy: 9541/9900 (96.3737%)
___Train Local_ResNet_18,  epoch  99, local model 83, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3226/3552 (90.8221%)
___Train Local_ResNet_18,  epoch  99, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3319/3552 (93.4403%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8399, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch  99, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3641/3910 (93.1202%)
___Train Local_ResNet_18,  epoch  99, local model 63, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3302/3910 (84.4501%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.4191, Accuracy: 4951/10000 (49.5100%)
___Train Local_ResNet_18,  epoch  99, local model 46, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4780/5399 (88.5349%)
___Train Local_ResNet_18,  epoch  99, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4774/5399 (88.4238%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0783, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  99, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5133/5615 (91.4159%)
___Train Local_ResNet_18,  epoch  99, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5191/5615 (92.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1784, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  99, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5697/6419 (88.7521%)
___Train Local_ResNet_18,  epoch  99, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5506/6419 (85.7766%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.3783, Accuracy: 4882/10000 (48.8200%)
___Train Local_ResNet_18,  epoch  99, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4439/4889 (90.7957%)
___Train Local_ResNet_18,  epoch  99, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4415/4889 (90.3048%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0982, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  99, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4889/5427 (90.0866%)
___Train Local_ResNet_18,  epoch  99, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4928/5427 (90.8052%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0654, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  99, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5273/5696 (92.5737%)
___Train Local_ResNet_18,  epoch  99, local model 22, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5237/5696 (91.9417%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0378, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  99, local model 31, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4147/4537 (91.4040%)
___Train Local_ResNet_18,  epoch  99, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4142/4537 (91.2938%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9241, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  99, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3600/3995 (90.1126%)
___Train Local_ResNet_18,  epoch  99, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3558/3995 (89.0613%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0484, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  99, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4694/4993 (94.0116%)
___Train Local_ResNet_18,  epoch  99, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4672/4993 (93.5710%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0664, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  99, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4387/4869 (90.1006%)
___Train Local_ResNet_18,  epoch  99, local model 7, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4372/4869 (89.7926%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0908, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  99, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4720/5068 (93.1334%)
___Train Local_ResNet_18,  epoch  99, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4651/5068 (91.7719%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0946, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3491/3774 (92.5013%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3555/3774 (94.1971%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0036, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  99, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4949/5298 (93.4126%)
___Train Local_ResNet_18,  epoch  99, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4916/5298 (92.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0201, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  99, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4988/5461 (91.3386%)
___Train Local_ResNet_18,  epoch  99, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4992/5461 (91.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2129, Accuracy: 5280/10000 (52.8000%)
time spent on training: 246.8383846282959
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1846, Accuracy: 6869/10000 (68.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.3477, Accuracy: 8991/9900 (90.8182%)
Done in 273.39569997787476 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 87, 99, 81, 52, 95, 3, 6, 0, 51, 78, 18, 89, 92, 40, 42, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5119/5308 (96.4393%), train_poison_data_count: 415
Global model norm: 43.06980729909585.
Norm before scaling: 43.04747901118891. Distance: 1.4220518065135057
Total norm for 4 adversaries is: 43.04747901118891. distance: 1.4220518065135057
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0783, Accuracy: 9702/9900 (98.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5594/5777 (96.8323%), train_poison_data_count: 455
Global model norm: 43.06980729909585.
Norm before scaling: 43.04012537828073. Distance: 1.4235718212546866
Total norm for 4 adversaries is: 43.04012537828073. distance: 1.4235718212546866
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0594, Accuracy: 9744/9900 (98.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4851/5123 (94.6906%), train_poison_data_count: 403
Global model norm: 43.06980729909585.
Norm before scaling: 43.04839351904218. Distance: 1.5095578700897905
Total norm for 4 adversaries is: 43.04839351904218. distance: 1.5095578700897905
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1112, Accuracy: 9613/9900 (97.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5297/5503 (96.2566%), train_poison_data_count: 430
Global model norm: 43.06980729909585.
Norm before scaling: 43.04627239823226. Distance: 1.4842171836079332
Total norm for 4 adversaries is: 43.04627239823226. distance: 1.4842171836079332
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0571, Accuracy: 9732/9900 (98.3030%)
___Train Local_ResNet_18,  epoch 100, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3573/3995 (89.4368%)
___Train Local_ResNet_18,  epoch 100, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3556/3995 (89.0113%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1696, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 100, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4402/4851 (90.7442%)
___Train Local_ResNet_18,  epoch 100, local model 99, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4399/4851 (90.6823%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1500, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 100, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4654/5035 (92.4330%)
___Train Local_ResNet_18,  epoch 100, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4672/5035 (92.7905%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0353, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 100, local model 52, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3816/4130 (92.3971%)
___Train Local_ResNet_18,  epoch 100, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3856/4130 (93.3656%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8929, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 100, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4484/5018 (89.3583%)
___Train Local_ResNet_18,  epoch 100, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4477/5018 (89.2188%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2207, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 100, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4987/5346 (93.2847%)
___Train Local_ResNet_18,  epoch 100, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4962/5346 (92.8171%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0738, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 100, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4574/4929 (92.7977%)
___Train Local_ResNet_18,  epoch 100, local model 6, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4476/4929 (90.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1543, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 100, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4947/5454 (90.7041%)
___Train Local_ResNet_18,  epoch 100, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4879/5454 (89.4573%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1357, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3793/4108 (92.3320%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3778/4108 (91.9669%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9258, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4069/4368 (93.1548%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3973/4368 (90.9570%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0630, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 100, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3904/4249 (91.8804%)
___Train Local_ResNet_18,  epoch 100, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3898/4249 (91.7392%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9559, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 100, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4325/4737 (91.3025%)
___Train Local_ResNet_18,  epoch 100, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4349/4737 (91.8092%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0638, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 100, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6297/6812 (92.4398%)
___Train Local_ResNet_18,  epoch 100, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6269/6812 (92.0288%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0918, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 100, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5487/5939 (92.3893%)
___Train Local_ResNet_18,  epoch 100, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5497/5939 (92.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9524, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5348/5907 (90.5367%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5303/5907 (89.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2760, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 100, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4427/4843 (91.4103%)
___Train Local_ResNet_18,  epoch 100, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4444/4843 (91.7613%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9846, Accuracy: 5449/10000 (54.4900%)
time spent on training: 242.81391978263855
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1863, Accuracy: 6869/10000 (68.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.3053, Accuracy: 9076/9900 (91.6768%)
Done in 268.96023321151733 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 92, 3, 12, 50, 95, 31, 5, 38, 72, 61, 32, 94, 7, 57, 22, 8].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5128/5308 (96.6089%), train_poison_data_count: 415
Global model norm: 43.09062262038575.
Norm before scaling: 43.06754126197086. Distance: 1.4266593841711495
Total norm for 4 adversaries is: 43.06754126197086. distance: 1.4266593841711495
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0483, Accuracy: 9763/9900 (98.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5572/5777 (96.4514%), train_poison_data_count: 455
Global model norm: 43.09062262038575.
Norm before scaling: 43.06096071722767. Distance: 1.4580676608823533
Total norm for 4 adversaries is: 43.06096071722767. distance: 1.4580676608823533
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0482, Accuracy: 9752/9900 (98.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4880/5123 (95.2567%), train_poison_data_count: 403
Global model norm: 43.09062262038575.
Norm before scaling: 43.06934389782438. Distance: 1.480342326138577
Total norm for 4 adversaries is: 43.06934389782438. distance: 1.480342326138577
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1060, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5269/5503 (95.7478%), train_poison_data_count: 430
Global model norm: 43.09062262038575.
Norm before scaling: 43.07018566891357. Distance: 1.5205577530986525
Total norm for 4 adversaries is: 43.07018566891357. distance: 1.5205577530986525
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0262, Accuracy: 9824/9900 (99.2323%)
___Train Local_ResNet_18,  epoch 101, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6305/6812 (92.5573%)
___Train Local_ResNet_18,  epoch 101, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6228/6812 (91.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0628, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4991/5346 (93.3595%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4890/5346 (91.4703%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1854, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 101, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5040/5526 (91.2052%)
___Train Local_ResNet_18,  epoch 101, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4875/5526 (88.2193%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0858, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 101, local model 50, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4419/4757 (92.8947%)
___Train Local_ResNet_18,  epoch 101, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4306/4757 (90.5192%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2092, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 101, local model 95, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4575/5018 (91.1718%)
___Train Local_ResNet_18,  epoch 101, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4480/5018 (89.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1681, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 101, local model 31, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4202/4537 (92.6163%)
___Train Local_ResNet_18,  epoch 101, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4224/4537 (93.1012%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9127, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 101, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4679/4993 (93.7112%)
___Train Local_ResNet_18,  epoch 101, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4624/4993 (92.6097%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9618, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 101, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5576/6235 (89.4306%)
___Train Local_ResNet_18,  epoch 101, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5530/6235 (88.6929%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2797, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch 101, local model 72, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4759/5193 (91.6426%)
___Train Local_ResNet_18,  epoch 101, local model 72, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4426/5193 (85.2301%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.5103, Accuracy: 4758/10000 (47.5800%)
___Train Local_ResNet_18,  epoch 101, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4086/4485 (91.1037%)
___Train Local_ResNet_18,  epoch 101, local model 61, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3786/4485 (84.4147%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3762, Accuracy: 4791/10000 (47.9100%)
___Train Local_ResNet_18,  epoch 101, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5365/6080 (88.2401%)
___Train Local_ResNet_18,  epoch 101, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5392/6080 (88.6842%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1150, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4666/5224 (89.3185%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4697/5224 (89.9119%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0980, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 101, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4412/4869 (90.6141%)
___Train Local_ResNet_18,  epoch 101, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4239/4869 (87.0610%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2158, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 101, local model 57, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4527/4956 (91.3438%)
___Train Local_ResNet_18,  epoch 101, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4413/4956 (89.0436%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1217, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5196/5696 (91.2219%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5138/5696 (90.2037%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0388, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 101, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4497/4889 (91.9820%)
___Train Local_ResNet_18,  epoch 101, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4434/4889 (90.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1266, Accuracy: 5279/10000 (52.7900%)
time spent on training: 250.97919631004333
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1901, Accuracy: 6861/10000 (68.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2873, Accuracy: 9126/9900 (92.1818%)
Done in 277.4858696460724 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 1, 65, 25, 70, 59, 5, 76, 49, 11, 2, 40, 47, 23, 83, 28, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5146/5308 (96.9480%), train_poison_data_count: 415
Global model norm: 43.11557160294222.
Norm before scaling: 43.088060209496405. Distance: 1.3349116887661536
Total norm for 4 adversaries is: 43.088060209496405. distance: 1.3349116887661536
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1260, Accuracy: 9560/9900 (96.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5566/5777 (96.3476%), train_poison_data_count: 455
Global model norm: 43.11557160294222.
Norm before scaling: 43.08717770767192. Distance: 1.4746071114427992
Total norm for 4 adversaries is: 43.08717770767192. distance: 1.4746071114427992
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0620, Accuracy: 9749/9900 (98.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4889/5123 (95.4324%), train_poison_data_count: 403
Global model norm: 43.11557160294222.
Norm before scaling: 43.09517055988916. Distance: 1.5163029992762045
Total norm for 4 adversaries is: 43.09517055988916. distance: 1.5163029992762045
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1283, Accuracy: 9584/9900 (96.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5277/5503 (95.8931%), train_poison_data_count: 430
Global model norm: 43.11557160294222.
Norm before scaling: 43.092091440617764. Distance: 1.5094036344414437
Total norm for 4 adversaries is: 43.092091440617764. distance: 1.5094036344414437
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0397, Accuracy: 9792/9900 (98.9091%)
___Train Local_ResNet_18,  epoch 102, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5044/5422 (93.0284%)
___Train Local_ResNet_18,  epoch 102, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5039/5422 (92.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9526, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 102, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5005/5497 (91.0497%)
___Train Local_ResNet_18,  epoch 102, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4958/5497 (90.1947%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9596, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5700/6419 (88.7989%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5534/6419 (86.2128%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1575, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 102, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5416/5871 (92.2500%)
___Train Local_ResNet_18,  epoch 102, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5359/5871 (91.2792%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1417, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 102, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4140/4397 (94.1551%)
___Train Local_ResNet_18,  epoch 102, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4178/4397 (95.0193%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8129, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 102, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4690/4993 (93.9315%)
___Train Local_ResNet_18,  epoch 102, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4636/4993 (92.8500%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9579, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 102, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3572/3959 (90.2248%)
___Train Local_ResNet_18,  epoch 102, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3593/3959 (90.7552%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9126, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 102, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5049/5652 (89.3312%)
___Train Local_ResNet_18,  epoch 102, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4986/5652 (88.2166%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1469, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 102, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4944/5702 (86.7064%)
___Train Local_ResNet_18,  epoch 102, local model 11, internal_epoch   2,  Average loss: 0.0106, Accuracy: 4506/5702 (79.0249%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.4072, Accuracy: 4912/10000 (49.1200%)
___Train Local_ResNet_18,  epoch 102, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3632/3968 (91.5323%)
___Train Local_ResNet_18,  epoch 102, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3690/3968 (92.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8265, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 102, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5515/5939 (92.8608%)
___Train Local_ResNet_18,  epoch 102, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5505/5939 (92.6924%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0938, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 102, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4620/5123 (90.1815%)
___Train Local_ResNet_18,  epoch 102, local model 47, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4508/5123 (87.9953%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2011, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 102, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4276/4549 (93.9987%)
___Train Local_ResNet_18,  epoch 102, local model 23, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3987/4549 (87.6456%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0239, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 102, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3214/3552 (90.4842%)
___Train Local_ResNet_18,  epoch 102, local model 83, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3286/3552 (92.5113%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9290, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 102, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4580/5122 (89.4182%)
___Train Local_ResNet_18,  epoch 102, local model 28, internal_epoch   2,  Average loss: 0.0110, Accuracy: 4072/5122 (79.5002%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.5841, Accuracy: 4513/10000 (45.1300%)
___Train Local_ResNet_18,  epoch 102, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6320/6812 (92.7775%)
___Train Local_ResNet_18,  epoch 102, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6260/6812 (91.8967%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2533, Accuracy: 5139/10000 (51.3900%)
time spent on training: 249.66062259674072
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1890, Accuracy: 6872/10000 (68.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2715, Accuracy: 9163/9900 (92.5556%)
Done in 276.05300784111023 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 55, 74, 81, 88, 47, 3, 20, 49, 91, 24, 85, 5, 96, 21, 80, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5131/5308 (96.6654%), train_poison_data_count: 415
Global model norm: 43.13745008237477.
Norm before scaling: 43.11206639161115. Distance: 1.3852301546144061
Total norm for 4 adversaries is: 43.11206639161115. distance: 1.3852301546144061
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1202, Accuracy: 9578/9900 (96.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5561/5777 (96.2610%), train_poison_data_count: 455
Global model norm: 43.13745008237477.
Norm before scaling: 43.108324448054695. Distance: 1.4760243075832247
Total norm for 4 adversaries is: 43.108324448054695. distance: 1.4760243075832247
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0891, Accuracy: 9668/9900 (97.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4875/5123 (95.1591%), train_poison_data_count: 403
Global model norm: 43.13745008237477.
Norm before scaling: 43.11587879083819. Distance: 1.5016145758673887
Total norm for 4 adversaries is: 43.11587879083819. distance: 1.5016145758673887
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1623, Accuracy: 9485/9900 (95.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5267/5503 (95.7114%), train_poison_data_count: 430
Global model norm: 43.13745008237477.
Norm before scaling: 43.11368312788369. Distance: 1.5011320610633154
Total norm for 4 adversaries is: 43.11368312788369. distance: 1.5011320610633154
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0359, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 103, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4359/4731 (92.1370%)
___Train Local_ResNet_18,  epoch 103, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4413/4731 (93.2784%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9404, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 103, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4353/4797 (90.7442%)
___Train Local_ResNet_18,  epoch 103, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4322/4797 (90.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9840, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 103, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4660/5035 (92.5521%)
___Train Local_ResNet_18,  epoch 103, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4626/5035 (91.8769%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0705, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 103, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4833/5362 (90.1343%)
___Train Local_ResNet_18,  epoch 103, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4835/5362 (90.1716%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2453, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 103, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4658/5123 (90.9233%)
___Train Local_ResNet_18,  epoch 103, local model 47, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4485/5123 (87.5464%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2492, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 103, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4946/5346 (92.5178%)
___Train Local_ResNet_18,  epoch 103, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4911/5346 (91.8631%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0867, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 103, local model 20, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4392/4714 (93.1693%)
___Train Local_ResNet_18,  epoch 103, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4427/4714 (93.9118%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8774, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 103, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5080/5652 (89.8797%)
___Train Local_ResNet_18,  epoch 103, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4998/5652 (88.4289%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0563, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 103, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4058/4527 (89.6399%)
___Train Local_ResNet_18,  epoch 103, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3955/4527 (87.3647%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0617, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 103, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3989/4313 (92.4878%)
___Train Local_ResNet_18,  epoch 103, local model 24, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4005/4313 (92.8588%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.7415, Accuracy: 5966/10000 (59.6600%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 6267/6947 (90.2116%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 6160/6947 (88.6714%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1176, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 103, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4698/4993 (94.0917%)
___Train Local_ResNet_18,  epoch 103, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4621/4993 (92.5496%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0778, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 103, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4664/5086 (91.7027%)
___Train Local_ResNet_18,  epoch 103, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4704/5086 (92.4892%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1076, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 103, local model 21, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4625/5038 (91.8023%)
___Train Local_ResNet_18,  epoch 103, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4618/5038 (91.6634%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8508, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 103, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4983/5461 (91.2470%)
___Train Local_ResNet_18,  epoch 103, local model 80, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4877/5461 (89.3060%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1190, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 103, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5138/5727 (89.7154%)
___Train Local_ResNet_18,  epoch 103, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5132/5727 (89.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0235, Accuracy: 5420/10000 (54.2000%)
time spent on training: 248.69755506515503
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1862, Accuracy: 6878/10000 (68.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2638, Accuracy: 9178/9900 (92.7071%)
Done in 275.0989887714386 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 24, 64, 59, 90, 22, 56, 73, 1, 70, 49, 88, 11, 44, 15, 92, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5100/5308 (96.0814%), train_poison_data_count: 415
Global model norm: 43.158997864636376.
Norm before scaling: 43.13727463448085. Distance: 1.469907426319584
Total norm for 4 adversaries is: 43.13727463448085. distance: 1.469907426319584
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0792, Accuracy: 9693/9900 (97.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5595/5777 (96.8496%), train_poison_data_count: 455
Global model norm: 43.158997864636376.
Norm before scaling: 43.127994687688066. Distance: 1.4119650528259955
Total norm for 4 adversaries is: 43.127994687688066. distance: 1.4119650528259955
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0696, Accuracy: 9715/9900 (98.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4885/5123 (95.3543%), train_poison_data_count: 403
Global model norm: 43.158997864636376.
Norm before scaling: 43.13815186681477. Distance: 1.462197316465549
Total norm for 4 adversaries is: 43.13815186681477. distance: 1.462197316465549
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2366, Accuracy: 9242/9900 (93.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5300/5503 (96.3111%), train_poison_data_count: 430
Global model norm: 43.158997864636376.
Norm before scaling: 43.13416739064723. Distance: 1.463179555965154
Total norm for 4 adversaries is: 43.13416739064723. distance: 1.463179555965154
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0582, Accuracy: 9737/9900 (98.3535%)
___Train Local_ResNet_18,  epoch 104, local model 24, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3959/4313 (91.7923%)
___Train Local_ResNet_18,  epoch 104, local model 24, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3972/4313 (92.0937%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0052, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 104, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4404/4894 (89.9877%)
___Train Local_ResNet_18,  epoch 104, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4335/4894 (88.5779%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9862, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 104, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4194/4397 (95.3832%)
___Train Local_ResNet_18,  epoch 104, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4223/4397 (96.0428%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.7513, Accuracy: 5955/10000 (59.5500%)
___Train Local_ResNet_18,  epoch 104, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4429/4748 (93.2814%)
___Train Local_ResNet_18,  epoch 104, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4447/4748 (93.6605%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9853, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 104, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5279/5696 (92.6791%)
___Train Local_ResNet_18,  epoch 104, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5171/5696 (90.7830%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9198, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 104, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4922/5427 (90.6947%)
___Train Local_ResNet_18,  epoch 104, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4871/5427 (89.7549%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9710, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 104, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4283/4605 (93.0076%)
___Train Local_ResNet_18,  epoch 104, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4298/4605 (93.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0818, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 104, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5082/5422 (93.7293%)
___Train Local_ResNet_18,  epoch 104, local model 1, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5080/5422 (93.6924%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9582, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5468/5871 (93.1358%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5323/5871 (90.6660%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0693, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5062/5652 (89.5612%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5075/5652 (89.7912%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1796, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 104, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4926/5362 (91.8687%)
___Train Local_ResNet_18,  epoch 104, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4816/5362 (89.8172%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0377, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 104, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4932/5702 (86.4960%)
___Train Local_ResNet_18,  epoch 104, local model 11, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4686/5702 (82.1817%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.3490, Accuracy: 4764/10000 (47.6400%)
___Train Local_ResNet_18,  epoch 104, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4695/5075 (92.5123%)
___Train Local_ResNet_18,  epoch 104, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4613/5075 (90.8966%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0573, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 104, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5551/6068 (91.4799%)
___Train Local_ResNet_18,  epoch 104, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5560/6068 (91.6282%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1592, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 104, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6323/6812 (92.8215%)
___Train Local_ResNet_18,  epoch 104, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6277/6812 (92.1462%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0215, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 104, local model 29, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4404/4732 (93.0685%)
___Train Local_ResNet_18,  epoch 104, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4434/4732 (93.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9076, Accuracy: 5642/10000 (56.4200%)
time spent on training: 249.3300850391388
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1873, Accuracy: 6867/10000 (68.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2638, Accuracy: 9176/9900 (92.6869%)
Done in 275.7027187347412 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 38, 1, 27, 46, 63, 42, 19, 95, 85, 68, 67, 92, 3, 17, 59, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5129/5308 (96.6277%), train_poison_data_count: 415
Global model norm: 43.18084444691231.
Norm before scaling: 43.155513152199774. Distance: 1.379669885749745
Total norm for 4 adversaries is: 43.155513152199774. distance: 1.379669885749745
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1093, Accuracy: 9619/9900 (97.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5599/5777 (96.9188%), train_poison_data_count: 455
Global model norm: 43.18084444691231.
Norm before scaling: 43.149808873961135. Distance: 1.4032779652703935
Total norm for 4 adversaries is: 43.149808873961135. distance: 1.4032779652703935
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0700, Accuracy: 9702/9900 (98.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4897/5123 (95.5885%), train_poison_data_count: 403
Global model norm: 43.18084444691231.
Norm before scaling: 43.15797256247245. Distance: 1.450110148488391
Total norm for 4 adversaries is: 43.15797256247245. distance: 1.450110148488391
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1729, Accuracy: 9439/9900 (95.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5293/5503 (96.1839%), train_poison_data_count: 430
Global model norm: 43.18084444691231.
Norm before scaling: 43.15488519520053. Distance: 1.4623556342968245
Total norm for 4 adversaries is: 43.15488519520053. distance: 1.4623556342968245
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0422, Accuracy: 9783/9900 (98.8182%)
___Train Local_ResNet_18,  epoch 105, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5598/6235 (89.7835%)
___Train Local_ResNet_18,  epoch 105, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5639/6235 (90.4411%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2097, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 105, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5092/5422 (93.9137%)
___Train Local_ResNet_18,  epoch 105, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5016/5422 (92.5120%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8333, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 105, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4126/4587 (89.9499%)
___Train Local_ResNet_18,  epoch 105, local model 27, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4118/4587 (89.7755%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0854, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 105, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4827/5399 (89.4054%)
___Train Local_ResNet_18,  epoch 105, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4761/5399 (88.1830%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2669, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch 105, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3620/3910 (92.5831%)
___Train Local_ResNet_18,  epoch 105, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3598/3910 (92.0205%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0652, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 105, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5373/5907 (90.9599%)
___Train Local_ResNet_18,  epoch 105, local model 42, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5295/5907 (89.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3578, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch 105, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4860/5361 (90.6547%)
___Train Local_ResNet_18,  epoch 105, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4803/5361 (89.5915%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0637, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 105, local model 95, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4539/5018 (90.4544%)
___Train Local_ResNet_18,  epoch 105, local model 95, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4530/5018 (90.2750%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0498, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 105, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6266/6947 (90.1972%)
___Train Local_ResNet_18,  epoch 105, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 6069/6947 (87.3615%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1356, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 105, local model 68, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3280/3589 (91.3904%)
___Train Local_ResNet_18,  epoch 105, local model 68, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3142/3589 (87.5453%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1768, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5051/5559 (90.8617%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4941/5559 (88.8829%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2224, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 105, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 6353/6812 (93.2619%)
___Train Local_ResNet_18,  epoch 105, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6188/6812 (90.8397%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1920, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 105, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4992/5346 (93.3782%)
___Train Local_ResNet_18,  epoch 105, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4983/5346 (93.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0337, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 105, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4391/4903 (89.5574%)
___Train Local_ResNet_18,  epoch 105, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4455/4903 (90.8627%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9989, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 105, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4216/4397 (95.8836%)
___Train Local_ResNet_18,  epoch 105, local model 59, internal_epoch   2,  Average loss: 0.0020, Accuracy: 4239/4397 (96.4066%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.7355, Accuracy: 5976/10000 (59.7600%)
___Train Local_ResNet_18,  epoch 105, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4702/5035 (93.3863%)
___Train Local_ResNet_18,  epoch 105, local model 81, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4708/5035 (93.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8836, Accuracy: 5681/10000 (56.8100%)
time spent on training: 250.91966271400452
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1867, Accuracy: 6878/10000 (68.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2583, Accuracy: 9186/9900 (92.7879%)
Done in 277.272732257843 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 70, 72, 67, 66, 75, 44, 99, 84, 22, 28, 37, 74, 14, 79, 7, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5120/5308 (96.4582%), train_poison_data_count: 415
Global model norm: 43.20361945919578.
Norm before scaling: 43.18005289220287. Distance: 1.4214890343950584
Total norm for 4 adversaries is: 43.18005289220287. distance: 1.4214890343950584
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0302, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5580/5777 (96.5899%), train_poison_data_count: 455
Global model norm: 43.20361945919578.
Norm before scaling: 43.17324916379789. Distance: 1.4303383101571796
Total norm for 4 adversaries is: 43.17324916379789. distance: 1.4303383101571796
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0726, Accuracy: 9714/9900 (98.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4907/5123 (95.7837%), train_poison_data_count: 403
Global model norm: 43.20361945919578.
Norm before scaling: 43.18037516980008. Distance: 1.413268946756991
Total norm for 4 adversaries is: 43.18037516980008. distance: 1.413268946756991
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0887, Accuracy: 9655/9900 (97.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5271/5503 (95.7841%), train_poison_data_count: 430
Global model norm: 43.20361945919578.
Norm before scaling: 43.181137035783635. Distance: 1.505524238074583
Total norm for 4 adversaries is: 43.181137035783635. distance: 1.505524238074583
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0263, Accuracy: 9838/9900 (99.3737%)
___Train Local_ResNet_18,  epoch 106, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5411/5871 (92.1649%)
___Train Local_ResNet_18,  epoch 106, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5328/5871 (90.7511%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1511, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 106, local model 72, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4708/5193 (90.6605%)
___Train Local_ResNet_18,  epoch 106, local model 72, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4496/5193 (86.5781%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3559, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 106, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5013/5559 (90.1781%)
___Train Local_ResNet_18,  epoch 106, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4911/5559 (88.3432%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0941, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4439/4843 (91.6581%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4438/4843 (91.6374%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0158, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 106, local model 75, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4318/4672 (92.4229%)
___Train Local_ResNet_18,  epoch 106, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4347/4672 (93.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.7962, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 106, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4732/5075 (93.2414%)
___Train Local_ResNet_18,  epoch 106, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4694/5075 (92.4926%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2273, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 106, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4424/4851 (91.1977%)
___Train Local_ResNet_18,  epoch 106, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4421/4851 (91.1358%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1036, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 106, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4746/5209 (91.1115%)
___Train Local_ResNet_18,  epoch 106, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4697/5209 (90.1709%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1205, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 106, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5266/5696 (92.4508%)
___Train Local_ResNet_18,  epoch 106, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5169/5696 (90.7479%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3407, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch 106, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4653/5122 (90.8434%)
___Train Local_ResNet_18,  epoch 106, local model 28, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4420/5122 (86.2944%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3039, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch 106, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4324/4741 (91.2044%)
___Train Local_ResNet_18,  epoch 106, local model 37, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4125/4741 (87.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.5433, Accuracy: 4746/10000 (47.4600%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4312/4797 (89.8895%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4258/4797 (88.7638%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2173, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 106, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3970/4196 (94.6139%)
___Train Local_ResNet_18,  epoch 106, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3962/4196 (94.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.7940, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 106, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3761/4111 (91.4863%)
___Train Local_ResNet_18,  epoch 106, local model 79, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3749/4111 (91.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0722, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 106, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4469/4869 (91.7848%)
___Train Local_ResNet_18,  epoch 106, local model 7, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4121/4869 (84.6375%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.4127, Accuracy: 4863/10000 (48.6300%)
___Train Local_ResNet_18,  epoch 106, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5035/5645 (89.1940%)
___Train Local_ResNet_18,  epoch 106, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4981/5645 (88.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0110, Accuracy: 5363/10000 (53.6300%)
time spent on training: 245.8979730606079
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1859, Accuracy: 6886/10000 (68.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2291, Accuracy: 9263/9900 (93.5657%)
Done in 272.22358894348145 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 16, 83, 76, 93, 11, 51, 92, 61, 72, 59, 60, 3, 30, 80, 49, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5129/5308 (96.6277%), train_poison_data_count: 415
Global model norm: 43.226719935778725.
Norm before scaling: 43.201778629563535. Distance: 1.42621603829205
Total norm for 4 adversaries is: 43.201778629563535. distance: 1.42621603829205
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0567, Accuracy: 9749/9900 (98.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5601/5777 (96.9534%), train_poison_data_count: 455
Global model norm: 43.226719935778725.
Norm before scaling: 43.19235710069621. Distance: 1.3699503421137142
Total norm for 4 adversaries is: 43.19235710069621. distance: 1.3699503421137142
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0351, Accuracy: 9801/9900 (99.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4920/5123 (96.0375%), train_poison_data_count: 403
Global model norm: 43.226719935778725.
Norm before scaling: 43.20282408349092. Distance: 1.4329667136298792
Total norm for 4 adversaries is: 43.20282408349092. distance: 1.4329667136298792
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1207, Accuracy: 9586/9900 (96.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5307/5503 (96.4383%), train_poison_data_count: 430
Global model norm: 43.226719935778725.
Norm before scaling: 43.20037287798422. Distance: 1.413914878263272
Total norm for 4 adversaries is: 43.20037287798422. distance: 1.413914878263272
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1118, Accuracy: 9596/9900 (96.9293%)
___Train Local_ResNet_18,  epoch 107, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4894/5353 (91.4254%)
___Train Local_ResNet_18,  epoch 107, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4810/5353 (89.8562%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0171, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 107, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3223/3552 (90.7376%)
___Train Local_ResNet_18,  epoch 107, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3307/3552 (93.1025%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8364, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 107, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3577/3959 (90.3511%)
___Train Local_ResNet_18,  epoch 107, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3621/3959 (91.4625%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8813, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 107, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4583/5055 (90.6627%)
___Train Local_ResNet_18,  epoch 107, local model 93, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4534/5055 (89.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1203, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 107, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4921/5702 (86.3031%)
___Train Local_ResNet_18,  epoch 107, local model 11, internal_epoch   2,  Average loss: 0.0114, Accuracy: 4477/5702 (78.5163%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3467, Accuracy: 4847/10000 (48.4700%)
___Train Local_ResNet_18,  epoch 107, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3800/4108 (92.5024%)
___Train Local_ResNet_18,  epoch 107, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3798/4108 (92.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8621, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 107, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 6270/6812 (92.0435%)
___Train Local_ResNet_18,  epoch 107, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6267/6812 (91.9994%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0331, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 107, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4131/4485 (92.1070%)
___Train Local_ResNet_18,  epoch 107, local model 61, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3999/4485 (89.1639%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0881, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 107, local model 72, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4712/5193 (90.7375%)
___Train Local_ResNet_18,  epoch 107, local model 72, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4478/5193 (86.2315%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2796, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 107, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4152/4397 (94.4280%)
___Train Local_ResNet_18,  epoch 107, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4203/4397 (95.5879%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.6402, Accuracy: 6064/10000 (60.6400%)
___Train Local_ResNet_18,  epoch 107, local model 60, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3795/4145 (91.5561%)
___Train Local_ResNet_18,  epoch 107, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3798/4145 (91.6285%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1053, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 107, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4997/5346 (93.4718%)
___Train Local_ResNet_18,  epoch 107, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4951/5346 (92.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0431, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 107, local model 30, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3484/3774 (92.3158%)
___Train Local_ResNet_18,  epoch 107, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3535/3774 (93.6672%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9577, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 107, local model 80, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5040/5461 (92.2908%)
___Train Local_ResNet_18,  epoch 107, local model 80, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5088/5461 (93.1697%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2918, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 107, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5081/5652 (89.8974%)
___Train Local_ResNet_18,  epoch 107, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4940/5652 (87.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0738, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 107, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5534/5939 (93.1807%)
___Train Local_ResNet_18,  epoch 107, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5527/5939 (93.0628%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0359, Accuracy: 5387/10000 (53.8700%)
time spent on training: 247.64163064956665
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1949, Accuracy: 6861/10000 (68.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2085, Accuracy: 9320/9900 (94.1414%)
Done in 273.55152201652527 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 61, 73, 22, 98, 14, 33, 5, 2, 32, 21, 53, 79, 12, 10, 76, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5137/5308 (96.7784%), train_poison_data_count: 415
Global model norm: 43.246861338425475.
Norm before scaling: 43.22064094516574. Distance: 1.3809870940067366
Total norm for 4 adversaries is: 43.22064094516574. distance: 1.3809870940067366
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0414, Accuracy: 9786/9900 (98.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5587/5777 (96.7111%), train_poison_data_count: 455
Global model norm: 43.246861338425475.
Norm before scaling: 43.213753213495295. Distance: 1.3766607312281554
Total norm for 4 adversaries is: 43.213753213495295. distance: 1.3766607312281554
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0857, Accuracy: 9677/9900 (97.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4919/5123 (96.0180%), train_poison_data_count: 403
Global model norm: 43.246861338425475.
Norm before scaling: 43.22215053505552. Distance: 1.417141171069285
Total norm for 4 adversaries is: 43.22215053505552. distance: 1.417141171069285
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0835, Accuracy: 9697/9900 (97.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5323/5503 (96.7291%), train_poison_data_count: 430
Global model norm: 43.246861338425475.
Norm before scaling: 43.22077227734368. Distance: 1.4395175541572276
Total norm for 4 adversaries is: 43.22077227734368. distance: 1.4395175541572276
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1148, Accuracy: 9596/9900 (96.9293%)
___Train Local_ResNet_18,  epoch 108, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4117/4485 (91.7949%)
___Train Local_ResNet_18,  epoch 108, local model 61, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3925/4485 (87.5139%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0924, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 108, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4309/4605 (93.5722%)
___Train Local_ResNet_18,  epoch 108, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4298/4605 (93.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8671, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 108, local model 22, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5312/5696 (93.2584%)
___Train Local_ResNet_18,  epoch 108, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5198/5696 (91.2570%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9882, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 108, local model 98, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3851/4161 (92.5499%)
___Train Local_ResNet_18,  epoch 108, local model 98, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3803/4161 (91.3963%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2162, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 108, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3974/4196 (94.7092%)
___Train Local_ResNet_18,  epoch 108, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3996/4196 (95.2336%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.7603, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 108, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4387/4818 (91.0544%)
___Train Local_ResNet_18,  epoch 108, local model 33, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4227/4818 (87.7335%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9510, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 108, local model 5, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4671/4993 (93.5510%)
___Train Local_ResNet_18,  epoch 108, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4623/4993 (92.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0908, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 108, local model 2, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3661/3968 (92.2631%)
___Train Local_ResNet_18,  epoch 108, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3654/3968 (92.0867%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8555, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 108, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5375/6080 (88.4046%)
___Train Local_ResNet_18,  epoch 108, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5423/6080 (89.1941%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1385, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 108, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4596/5038 (91.2267%)
___Train Local_ResNet_18,  epoch 108, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4585/5038 (91.0083%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9671, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 108, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5837/6664 (87.5900%)
___Train Local_ResNet_18,  epoch 108, local model 53, internal_epoch   2,  Average loss: 0.0086, Accuracy: 5555/6664 (83.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.8335, Accuracy: 4519/10000 (45.1900%)
___Train Local_ResNet_18,  epoch 108, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3792/4111 (92.2403%)
___Train Local_ResNet_18,  epoch 108, local model 79, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3777/4111 (91.8755%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1103, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 108, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5025/5526 (90.9338%)
___Train Local_ResNet_18,  epoch 108, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4841/5526 (87.6041%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2754, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 108, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4758/5068 (93.8832%)
___Train Local_ResNet_18,  epoch 108, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4607/5068 (90.9037%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1955, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 108, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3603/3959 (91.0078%)
___Train Local_ResNet_18,  epoch 108, local model 76, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3686/3959 (93.1043%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8600, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 108, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4094/4368 (93.7271%)
___Train Local_ResNet_18,  epoch 108, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4055/4368 (92.8342%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9987, Accuracy: 5475/10000 (54.7500%)
time spent on training: 242.93589162826538
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1961, Accuracy: 6857/10000 (68.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1930, Accuracy: 9361/9900 (94.5556%)
Done in 269.2995705604553 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 73, 72, 84, 40, 22, 51, 8, 54, 34, 27, 68, 82, 65, 7, 14, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5139/5308 (96.8161%), train_poison_data_count: 415
Global model norm: 43.266773300940756.
Norm before scaling: 43.240305260525595. Distance: 1.3894382084562462
Total norm for 4 adversaries is: 43.240305260525595. distance: 1.3894382084562462
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1155, Accuracy: 9602/9900 (96.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5601/5777 (96.9534%), train_poison_data_count: 455
Global model norm: 43.266773300940756.
Norm before scaling: 43.23400371407253. Distance: 1.3807863812396037
Total norm for 4 adversaries is: 43.23400371407253. distance: 1.3807863812396037
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0949, Accuracy: 9659/9900 (97.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4911/5123 (95.8618%), train_poison_data_count: 403
Global model norm: 43.266773300940756.
Norm before scaling: 43.24213174680236. Distance: 1.4274363487202597
Total norm for 4 adversaries is: 43.24213174680236. distance: 1.4274363487202597
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0944, Accuracy: 9642/9900 (97.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5309/5503 (96.4747%), train_poison_data_count: 430
Global model norm: 43.266773300940756.
Norm before scaling: 43.241344136988126. Distance: 1.4637018661338053
Total norm for 4 adversaries is: 43.241344136988126. distance: 1.4637018661338053
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1264, Accuracy: 9556/9900 (96.5253%)
___Train Local_ResNet_18,  epoch 109, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4295/4605 (93.2682%)
___Train Local_ResNet_18,  epoch 109, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4269/4605 (92.7036%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8587, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 109, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4748/5193 (91.4308%)
___Train Local_ResNet_18,  epoch 109, local model 72, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4518/5193 (87.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3126, Accuracy: 4980/10000 (49.8000%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4778/5209 (91.7259%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4715/5209 (90.5164%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0612, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 109, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5530/5939 (93.1133%)
___Train Local_ResNet_18,  epoch 109, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5442/5939 (91.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0962, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 109, local model 22, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5313/5696 (93.2760%)
___Train Local_ResNet_18,  epoch 109, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5213/5696 (91.5204%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0979, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 109, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3805/4108 (92.6241%)
___Train Local_ResNet_18,  epoch 109, local model 51, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3683/4108 (89.6543%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0926, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 109, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4455/4889 (91.1229%)
___Train Local_ResNet_18,  epoch 109, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4469/4889 (91.4093%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0386, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 109, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5068/5645 (89.7786%)
___Train Local_ResNet_18,  epoch 109, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4842/5645 (85.7750%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2959, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4518/4911 (91.9976%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4543/4911 (92.5066%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9344, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 109, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4155/4587 (90.5821%)
___Train Local_ResNet_18,  epoch 109, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4195/4587 (91.4541%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1253, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 109, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3332/3589 (92.8392%)
___Train Local_ResNet_18,  epoch 109, local model 68, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3114/3589 (86.7651%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1991, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 109, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4959/5298 (93.6014%)
___Train Local_ResNet_18,  epoch 109, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4908/5298 (92.6387%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9231, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 109, local model 65, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5028/5497 (91.4681%)
___Train Local_ResNet_18,  epoch 109, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4924/5497 (89.5761%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1144, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 109, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4428/4869 (90.9427%)
___Train Local_ResNet_18,  epoch 109, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4175/4869 (85.7466%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3779, Accuracy: 4963/10000 (49.6300%)
___Train Local_ResNet_18,  epoch 109, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3982/4196 (94.8999%)
___Train Local_ResNet_18,  epoch 109, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3973/4196 (94.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7986, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 109, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3677/3968 (92.6663%)
___Train Local_ResNet_18,  epoch 109, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3678/3968 (92.6915%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8303, Accuracy: 5745/10000 (57.4500%)
time spent on training: 244.34423685073853
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1955, Accuracy: 6851/10000 (68.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1972, Accuracy: 9350/9900 (94.4444%)
Done in 270.3801326751709 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 98, 90, 19, 60, 20, 39, 86, 78, 25, 23, 28, 34, 4, 9, 5, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5123/5308 (96.5147%), train_poison_data_count: 415
Global model norm: 43.287892935608305.
Norm before scaling: 43.26233087179813. Distance: 1.4051336731905604
Total norm for 4 adversaries is: 43.26233087179813. distance: 1.4051336731905604
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0356, Accuracy: 9806/9900 (99.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5621/5777 (97.2996%), train_poison_data_count: 455
Global model norm: 43.287892935608305.
Norm before scaling: 43.255283275572246. Distance: 1.361228512330787
Total norm for 4 adversaries is: 43.255283275572246. distance: 1.361228512330787
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0445, Accuracy: 9782/9900 (98.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4889/5123 (95.4324%), train_poison_data_count: 403
Global model norm: 43.287892935608305.
Norm before scaling: 43.263800916315276. Distance: 1.4398093539769634
Total norm for 4 adversaries is: 43.263800916315276. distance: 1.4398093539769634
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2217, Accuracy: 9339/9900 (94.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5319/5503 (96.6564%), train_poison_data_count: 430
Global model norm: 43.287892935608305.
Norm before scaling: 43.259864696444524. Distance: 1.4021024788639995
Total norm for 4 adversaries is: 43.259864696444524. distance: 1.4021024788639995
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0279, Accuracy: 9820/9900 (99.1919%)
___Train Local_ResNet_18,  epoch 110, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3878/4161 (93.1988%)
___Train Local_ResNet_18,  epoch 110, local model 98, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3773/4161 (90.6753%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0793, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4416/4748 (93.0076%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4409/4748 (92.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8714, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 110, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4899/5361 (91.3822%)
___Train Local_ResNet_18,  epoch 110, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4863/5361 (90.7107%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9564, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3804/4145 (91.7732%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3830/4145 (92.4005%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9392, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 110, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4430/4714 (93.9754%)
___Train Local_ResNet_18,  epoch 110, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4399/4714 (93.3178%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0569, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 110, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3825/4175 (91.6168%)
___Train Local_ResNet_18,  epoch 110, local model 39, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3780/4175 (90.5389%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0977, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 110, local model 86, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3578/3929 (91.0664%)
___Train Local_ResNet_18,  epoch 110, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3516/3929 (89.4884%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9624, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 110, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4077/4368 (93.3379%)
___Train Local_ResNet_18,  epoch 110, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4070/4368 (93.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0016, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5740/6419 (89.4220%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5539/6419 (86.2907%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2966, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4296/4549 (94.4383%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3961/4549 (87.0741%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2070, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 110, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4605/5122 (89.9063%)
___Train Local_ResNet_18,  epoch 110, local model 28, internal_epoch   2,  Average loss: 0.0161, Accuracy: 3661/5122 (71.4760%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.6623, Accuracy: 4342/10000 (43.4200%)
___Train Local_ResNet_18,  epoch 110, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4566/4911 (92.9750%)
___Train Local_ResNet_18,  epoch 110, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4562/4911 (92.8935%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0430, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3706/4028 (92.0060%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3699/4028 (91.8322%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9000, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5177/5727 (90.3964%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5068/5727 (88.4931%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0662, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 110, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4690/4993 (93.9315%)
___Train Local_ResNet_18,  epoch 110, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4648/4993 (93.0903%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1908, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 110, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4410/4714 (93.5511%)
___Train Local_ResNet_18,  epoch 110, local model 41, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4402/4714 (93.3814%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0716, Accuracy: 5511/10000 (55.1100%)
time spent on training: 242.3281490802765
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.1920, Accuracy: 6856/10000 (68.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1941, Accuracy: 9367/9900 (94.6162%)
Done in 268.8284478187561 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 80, 69, 20, 50, 3, 73, 15, 77, 35, 56, 55, 18, 47, 21, 5, 43].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5149/5308 (97.0045%), train_poison_data_count: 415
Global model norm: 43.306798077964906.
Norm before scaling: 43.27753819823859. Distance: 1.3095545188184696
Total norm for 4 adversaries is: 43.27753819823859. distance: 1.3095545188184696
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0330, Accuracy: 9815/9900 (99.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5611/5777 (97.1265%), train_poison_data_count: 455
Global model norm: 43.306798077964906.
Norm before scaling: 43.27364554133959. Distance: 1.3711483501637372
Total norm for 4 adversaries is: 43.27364554133959. distance: 1.3711483501637372
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0790, Accuracy: 9698/9900 (97.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4928/5123 (96.1936%), train_poison_data_count: 403
Global model norm: 43.306798077964906.
Norm before scaling: 43.28082411794079. Distance: 1.377887338572852
Total norm for 4 adversaries is: 43.28082411794079. distance: 1.377887338572852
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1047, Accuracy: 9631/9900 (97.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5306/5503 (96.4201%), train_poison_data_count: 430
Global model norm: 43.306798077964906.
Norm before scaling: 43.28234571040845. Distance: 1.476522293754435
Total norm for 4 adversaries is: 43.28234571040845. distance: 1.476522293754435
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1622, Accuracy: 9476/9900 (95.7172%)
___Train Local_ResNet_18,  epoch 111, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4981/5461 (91.2104%)
___Train Local_ResNet_18,  epoch 111, local model 80, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4917/5461 (90.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2954, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 111, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4006/4364 (91.7965%)
___Train Local_ResNet_18,  epoch 111, local model 69, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3899/4364 (89.3446%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0840, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 111, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4426/4714 (93.8905%)
___Train Local_ResNet_18,  epoch 111, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4464/4714 (94.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8570, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 111, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4364/4757 (91.7385%)
___Train Local_ResNet_18,  epoch 111, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4273/4757 (89.8255%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2504, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 111, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5018/5346 (93.8646%)
___Train Local_ResNet_18,  epoch 111, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4932/5346 (92.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9931, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 111, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4294/4605 (93.2465%)
___Train Local_ResNet_18,  epoch 111, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4339/4605 (94.2237%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8519, Accuracy: 5867/10000 (58.6700%)
___Train Local_ResNet_18,  epoch 111, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5541/6068 (91.3151%)
___Train Local_ResNet_18,  epoch 111, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5462/6068 (90.0132%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2575, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 111, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4532/5050 (89.7426%)
___Train Local_ResNet_18,  epoch 111, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4513/5050 (89.3663%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0192, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5127/5615 (91.3090%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5087/5615 (90.5966%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1082, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4933/5427 (90.8974%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4897/5427 (90.2340%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0394, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 111, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4401/4731 (93.0247%)
___Train Local_ResNet_18,  epoch 111, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4340/4731 (91.7354%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9600, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 111, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3935/4249 (92.6100%)
___Train Local_ResNet_18,  epoch 111, local model 18, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3911/4249 (92.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8830, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 111, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4630/5123 (90.3767%)
___Train Local_ResNet_18,  epoch 111, local model 47, internal_epoch   2,  Average loss: 0.0098, Accuracy: 4149/5123 (80.9877%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1811, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 111, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4658/5038 (92.4573%)
___Train Local_ResNet_18,  epoch 111, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4630/5038 (91.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9382, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 111, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4731/4993 (94.7527%)
___Train Local_ResNet_18,  epoch 111, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4642/4993 (92.9702%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2047, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 111, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4599/4979 (92.3679%)
___Train Local_ResNet_18,  epoch 111, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4615/4979 (92.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0946, Accuracy: 5445/10000 (54.4500%)
time spent on training: 245.3660044670105
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.1868, Accuracy: 6869/10000 (68.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1948, Accuracy: 9361/9900 (94.5556%)
Done in 271.8810980319977 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 56, 14, 4, 30, 82, 85, 39, 70, 91, 59, 1, 88, 49, 34, 53, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5141/5308 (96.8538%), train_poison_data_count: 415
Global model norm: 43.32798554115674.
Norm before scaling: 43.29879213546984. Distance: 1.3466606553733538
Total norm for 4 adversaries is: 43.29879213546984. distance: 1.3466606553733538
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0321, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5606/5777 (97.0400%), train_poison_data_count: 455
Global model norm: 43.32798554115674.
Norm before scaling: 43.29341971281187. Distance: 1.364286953526792
Total norm for 4 adversaries is: 43.29341971281187. distance: 1.364286953526792
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0636, Accuracy: 9735/9900 (98.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4928/5123 (96.1936%), train_poison_data_count: 403
Global model norm: 43.32798554115674.
Norm before scaling: 43.302128594565794. Distance: 1.3947722069216355
Total norm for 4 adversaries is: 43.302128594565794. distance: 1.3947722069216355
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0653, Accuracy: 9712/9900 (98.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5302/5503 (96.3474%), train_poison_data_count: 430
Global model norm: 43.32798554115674.
Norm before scaling: 43.30039908068833. Distance: 1.429932620188381
Total norm for 4 adversaries is: 43.30039908068833. distance: 1.429932620188381
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0675, Accuracy: 9722/9900 (98.2020%)
___Train Local_ResNet_18,  epoch 112, local model 56, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4901/5427 (90.3077%)
___Train Local_ResNet_18,  epoch 112, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4875/5427 (89.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1364, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 112, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3966/4196 (94.5186%)
___Train Local_ResNet_18,  epoch 112, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3985/4196 (94.9714%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8926, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 112, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3709/4028 (92.0804%)
___Train Local_ResNet_18,  epoch 112, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3747/4028 (93.0238%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7998, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch 112, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3522/3774 (93.3227%)
___Train Local_ResNet_18,  epoch 112, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3571/3774 (94.6211%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8350, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 112, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4923/5298 (92.9219%)
___Train Local_ResNet_18,  epoch 112, local model 82, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4881/5298 (92.1291%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1143, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 112, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 6318/6947 (90.9457%)
___Train Local_ResNet_18,  epoch 112, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 6082/6947 (87.5486%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2728, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch 112, local model 39, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3819/4175 (91.4731%)
___Train Local_ResNet_18,  epoch 112, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3791/4175 (90.8024%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0796, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 112, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5423/5871 (92.3693%)
___Train Local_ResNet_18,  epoch 112, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5359/5871 (91.2792%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0668, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 112, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4112/4527 (90.8328%)
___Train Local_ResNet_18,  epoch 112, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4041/4527 (89.2644%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9078, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 112, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4167/4397 (94.7692%)
___Train Local_ResNet_18,  epoch 112, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4189/4397 (95.2695%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8043, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5090/5422 (93.8768%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5018/5422 (92.5489%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9568, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 112, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4923/5362 (91.8128%)
___Train Local_ResNet_18,  epoch 112, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4826/5362 (90.0037%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0511, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 112, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5083/5652 (89.9328%)
___Train Local_ResNet_18,  epoch 112, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5048/5652 (89.3135%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0715, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 112, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4544/4911 (92.5270%)
___Train Local_ResNet_18,  epoch 112, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4544/4911 (92.5270%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0208, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 112, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5826/6664 (87.4250%)
___Train Local_ResNet_18,  epoch 112, local model 53, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5676/6664 (85.1741%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.5178, Accuracy: 4579/10000 (45.7900%)
___Train Local_ResNet_18,  epoch 112, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4569/5055 (90.3858%)
___Train Local_ResNet_18,  epoch 112, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4538/5055 (89.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1713, Accuracy: 5324/10000 (53.2400%)
time spent on training: 245.28377842903137
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.1946, Accuracy: 6862/10000 (68.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1804, Accuracy: 9396/9900 (94.9091%)
Done in 272.06274914741516 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 98, 78, 33, 79, 16, 3, 62, 30, 39, 1, 15, 6, 50, 93, 66, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5146/5308 (96.9480%), train_poison_data_count: 415
Global model norm: 43.34821506156208.
Norm before scaling: 43.320393513224516. Distance: 1.377927265124554
Total norm for 4 adversaries is: 43.320393513224516. distance: 1.377927265124554
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0361, Accuracy: 9811/9900 (99.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5593/5777 (96.8150%), train_poison_data_count: 455
Global model norm: 43.34821506156208.
Norm before scaling: 43.316079172101325. Distance: 1.4268904042759625
Total norm for 4 adversaries is: 43.316079172101325. distance: 1.4268904042759625
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0579, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4907/5123 (95.7837%), train_poison_data_count: 403
Global model norm: 43.34821506156208.
Norm before scaling: 43.32306616022736. Distance: 1.432166946067207
Total norm for 4 adversaries is: 43.32306616022736. distance: 1.432166946067207
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0882, Accuracy: 9667/9900 (97.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5299/5503 (96.2929%), train_poison_data_count: 430
Global model norm: 43.34821506156208.
Norm before scaling: 43.321801005761664. Distance: 1.4507360201735124
Total norm for 4 adversaries is: 43.321801005761664. distance: 1.4507360201735124
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0419, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 113, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3890/4161 (93.4871%)
___Train Local_ResNet_18,  epoch 113, local model 98, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3817/4161 (91.7328%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0978, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 113, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4109/4368 (94.0705%)
___Train Local_ResNet_18,  epoch 113, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4066/4368 (93.0861%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9014, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 113, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4320/4818 (89.6638%)
___Train Local_ResNet_18,  epoch 113, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4338/4818 (90.0374%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0612, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 113, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3815/4111 (92.7998%)
___Train Local_ResNet_18,  epoch 113, local model 79, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3814/4111 (92.7755%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1333, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 113, local model 16, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4904/5353 (91.6122%)
___Train Local_ResNet_18,  epoch 113, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4859/5353 (90.7715%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8802, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 113, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5008/5346 (93.6775%)
___Train Local_ResNet_18,  epoch 113, local model 3, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5020/5346 (93.9020%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1533, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 113, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4878/5504 (88.6265%)
___Train Local_ResNet_18,  epoch 113, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4785/5504 (86.9368%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3480, Accuracy: 4960/10000 (49.6000%)
___Train Local_ResNet_18,  epoch 113, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3494/3774 (92.5808%)
___Train Local_ResNet_18,  epoch 113, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3538/3774 (93.7467%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9195, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3843/4175 (92.0479%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3841/4175 (92.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9319, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 113, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5078/5422 (93.6555%)
___Train Local_ResNet_18,  epoch 113, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5045/5422 (93.0468%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9495, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 113, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5601/6068 (92.3039%)
___Train Local_ResNet_18,  epoch 113, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5493/6068 (90.5241%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3428, Accuracy: 5019/10000 (50.1900%)
___Train Local_ResNet_18,  epoch 113, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4554/4929 (92.3920%)
___Train Local_ResNet_18,  epoch 113, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4482/4929 (90.9312%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1166, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 113, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4417/4757 (92.8526%)
___Train Local_ResNet_18,  epoch 113, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4268/4757 (89.7204%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0899, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4635/5055 (91.6914%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4553/5055 (90.0692%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0424, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4467/4843 (92.2362%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4447/4843 (91.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9345, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 113, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4719/5035 (93.7239%)
___Train Local_ResNet_18,  epoch 113, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4695/5035 (93.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9579, Accuracy: 5632/10000 (56.3200%)
time spent on training: 244.23430800437927
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.1990, Accuracy: 6849/10000 (68.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1687, Accuracy: 9426/9900 (95.2121%)
Done in 270.1416540145874 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 33, 91, 10, 81, 5, 93, 90, 24, 64, 16, 9, 18, 27, 2, 67, 82].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5140/5308 (96.8350%), train_poison_data_count: 415
Global model norm: 43.368316927060214.
Norm before scaling: 43.339239412471954. Distance: 1.3470414238091886
Total norm for 4 adversaries is: 43.339239412471954. distance: 1.3470414238091886
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0528, Accuracy: 9757/9900 (98.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5596/5777 (96.8669%), train_poison_data_count: 455
Global model norm: 43.368316927060214.
Norm before scaling: 43.3324226479326. Distance: 1.3385320086693564
Total norm for 4 adversaries is: 43.3324226479326. distance: 1.3385320086693564
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0467, Accuracy: 9780/9900 (98.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4923/5123 (96.0960%), train_poison_data_count: 403
Global model norm: 43.368316927060214.
Norm before scaling: 43.341971450982854. Distance: 1.4169962256575817
Total norm for 4 adversaries is: 43.341971450982854. distance: 1.4169962256575817
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0855, Accuracy: 9686/9900 (97.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5313/5503 (96.5473%), train_poison_data_count: 430
Global model norm: 43.368316927060214.
Norm before scaling: 43.34004777582666. Distance: 1.432560686220727
Total norm for 4 adversaries is: 43.34004777582666. distance: 1.432560686220727
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0535, Accuracy: 9761/9900 (98.5960%)
___Train Local_ResNet_18,  epoch 114, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4403/4818 (91.3865%)
___Train Local_ResNet_18,  epoch 114, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4293/4818 (89.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1151, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 114, local model 91, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4069/4527 (89.8829%)
___Train Local_ResNet_18,  epoch 114, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4058/4527 (89.6399%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0324, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 114, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4711/5068 (92.9558%)
___Train Local_ResNet_18,  epoch 114, local model 10, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4584/5068 (90.4499%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.3095, Accuracy: 4958/10000 (49.5800%)
___Train Local_ResNet_18,  epoch 114, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4699/5035 (93.3267%)
___Train Local_ResNet_18,  epoch 114, local model 81, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4728/5035 (93.9027%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9874, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4757/4993 (95.2734%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4646/4993 (93.0503%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1358, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 114, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4558/5055 (90.1682%)
___Train Local_ResNet_18,  epoch 114, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4568/5055 (90.3660%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0478, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 114, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4437/4748 (93.4499%)
___Train Local_ResNet_18,  epoch 114, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4387/4748 (92.3968%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1147, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 114, local model 24, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3984/4313 (92.3719%)
___Train Local_ResNet_18,  epoch 114, local model 24, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3965/4313 (91.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9568, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 114, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4334/4894 (88.5574%)
___Train Local_ResNet_18,  epoch 114, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4313/4894 (88.1283%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1415, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 114, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4960/5353 (92.6583%)
___Train Local_ResNet_18,  epoch 114, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4824/5353 (90.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0376, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 114, local model 9, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5123/5727 (89.4535%)
___Train Local_ResNet_18,  epoch 114, local model 9, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5013/5727 (87.5327%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.3662, Accuracy: 4853/10000 (48.5300%)
___Train Local_ResNet_18,  epoch 114, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3932/4249 (92.5394%)
___Train Local_ResNet_18,  epoch 114, local model 18, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3949/4249 (92.9395%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9804, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 114, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4166/4587 (90.8219%)
___Train Local_ResNet_18,  epoch 114, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4135/4587 (90.1461%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0914, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 114, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3664/3968 (92.3387%)
___Train Local_ResNet_18,  epoch 114, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3667/3968 (92.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9190, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 114, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4998/5559 (89.9083%)
___Train Local_ResNet_18,  epoch 114, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4963/5559 (89.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1539, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 114, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4930/5298 (93.0540%)
___Train Local_ResNet_18,  epoch 114, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4954/5298 (93.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0770, Accuracy: 5456/10000 (54.5600%)
time spent on training: 244.76576113700867
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.2020, Accuracy: 6845/10000 (68.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1572, Accuracy: 9463/9900 (95.5859%)
Done in 271.10675024986267 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 33, 82, 16, 30, 63, 31, 53, 84, 47, 60, 12, 92, 42, 39, 44, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5153/5308 (97.0799%), train_poison_data_count: 415
Global model norm: 43.38935759537196.
Norm before scaling: 43.35979729524084. Distance: 1.3355049191423238
Total norm for 4 adversaries is: 43.35979729524084. distance: 1.3355049191423238
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0751, Accuracy: 9708/9900 (98.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5614/5777 (97.1785%), train_poison_data_count: 455
Global model norm: 43.38935759537196.
Norm before scaling: 43.3524023109771. Distance: 1.3367969358532372
Total norm for 4 adversaries is: 43.3524023109771. distance: 1.3367969358532372
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0517, Accuracy: 9761/9900 (98.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4927/5123 (96.1741%), train_poison_data_count: 403
Global model norm: 43.38935759537196.
Norm before scaling: 43.36313328306662. Distance: 1.41059205144787
Total norm for 4 adversaries is: 43.36313328306662. distance: 1.41059205144787
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0786, Accuracy: 9692/9900 (97.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5309/5503 (96.4747%), train_poison_data_count: 430
Global model norm: 43.38935759537196.
Norm before scaling: 43.35907657554961. Distance: 1.388352283556054
Total norm for 4 adversaries is: 43.35907657554961. distance: 1.388352283556054
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0456, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4366/4818 (90.6185%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4300/4818 (89.2487%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0395, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 115, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5011/5298 (94.5829%)
___Train Local_ResNet_18,  epoch 115, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4949/5298 (93.4126%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0473, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 115, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4966/5353 (92.7704%)
___Train Local_ResNet_18,  epoch 115, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4851/5353 (90.6221%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0225, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3538/3774 (93.7467%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3489/3774 (92.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9294, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 115, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3623/3910 (92.6598%)
___Train Local_ResNet_18,  epoch 115, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3583/3910 (91.6368%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0198, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 115, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4167/4537 (91.8448%)
___Train Local_ResNet_18,  epoch 115, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4154/4537 (91.5583%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8969, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 115, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5917/6664 (88.7905%)
___Train Local_ResNet_18,  epoch 115, local model 53, internal_epoch   2,  Average loss: 0.0081, Accuracy: 5600/6664 (84.0336%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2447, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4717/5209 (90.5548%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4660/5209 (89.4605%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1061, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 115, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4613/5123 (90.0449%)
___Train Local_ResNet_18,  epoch 115, local model 47, internal_epoch   2,  Average loss: 0.0124, Accuracy: 3951/5123 (77.1228%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3304, Accuracy: 4786/10000 (47.8600%)
___Train Local_ResNet_18,  epoch 115, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3848/4145 (92.8347%)
___Train Local_ResNet_18,  epoch 115, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3795/4145 (91.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9670, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 115, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5082/5526 (91.9653%)
___Train Local_ResNet_18,  epoch 115, local model 12, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4981/5526 (90.1375%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2177, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 115, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 6322/6812 (92.8068%)
___Train Local_ResNet_18,  epoch 115, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6213/6812 (91.2067%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2244, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 115, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5423/5907 (91.8063%)
___Train Local_ResNet_18,  epoch 115, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5349/5907 (90.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2918, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 115, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3866/4175 (92.5988%)
___Train Local_ResNet_18,  epoch 115, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3837/4175 (91.9042%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0420, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4725/5075 (93.1034%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4641/5075 (91.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2553, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 115, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3807/4111 (92.6052%)
___Train Local_ResNet_18,  epoch 115, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3781/4111 (91.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0339, Accuracy: 5396/10000 (53.9600%)
time spent on training: 247.63870763778687
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.2067, Accuracy: 6839/10000 (68.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1507, Accuracy: 9489/9900 (95.8485%)
Done in 273.7184784412384 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 41, 49, 96, 89, 92, 44, 42, 48, 23, 22, 76, 75, 29, 6, 15, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5136/5308 (96.7596%), train_poison_data_count: 415
Global model norm: 43.40981863030097.
Norm before scaling: 43.38026101694684. Distance: 1.3448694578443583
Total norm for 4 adversaries is: 43.38026101694684. distance: 1.3448694578443583
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0514, Accuracy: 9764/9900 (98.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5606/5777 (97.0400%), train_poison_data_count: 455
Global model norm: 43.40981863030097.
Norm before scaling: 43.37616369791637. Distance: 1.4004276967694866
Total norm for 4 adversaries is: 43.37616369791637. distance: 1.4004276967694866
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0565, Accuracy: 9744/9900 (98.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4933/5123 (96.2912%), train_poison_data_count: 403
Global model norm: 43.40981863030097.
Norm before scaling: 43.38218431586433. Distance: 1.3640353677504782
Total norm for 4 adversaries is: 43.38218431586433. distance: 1.3640353677504782
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0910, Accuracy: 9661/9900 (97.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5292/5503 (96.1657%), train_poison_data_count: 430
Global model norm: 43.40981863030097.
Norm before scaling: 43.38408079926178. Distance: 1.4712747828131045
Total norm for 4 adversaries is: 43.38408079926178. distance: 1.4712747828131045
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0340, Accuracy: 9812/9900 (99.1111%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4400/4714 (93.3390%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4392/4714 (93.1693%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1347, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 116, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5031/5652 (89.0127%)
___Train Local_ResNet_18,  epoch 116, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5037/5652 (89.1189%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1874, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 116, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4677/5086 (91.9583%)
___Train Local_ResNet_18,  epoch 116, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4638/5086 (91.1915%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1451, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4298/4737 (90.7325%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4315/4737 (91.0914%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1911, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 6363/6812 (93.4087%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 6275/6812 (92.1169%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2448, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4693/5075 (92.4729%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4719/5075 (92.9852%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0356, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 116, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5426/5907 (91.8571%)
___Train Local_ResNet_18,  epoch 116, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5337/5907 (90.3504%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2255, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 116, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4489/4830 (92.9400%)
___Train Local_ResNet_18,  epoch 116, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4552/4830 (94.2443%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1706, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 116, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4305/4549 (94.6362%)
___Train Local_ResNet_18,  epoch 116, local model 23, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3947/4549 (86.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2318, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch 116, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5255/5696 (92.2577%)
___Train Local_ResNet_18,  epoch 116, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5223/5696 (91.6959%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1124, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 116, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3613/3959 (91.2604%)
___Train Local_ResNet_18,  epoch 116, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3617/3959 (91.3615%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9828, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4360/4672 (93.3219%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4332/4672 (92.7226%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0135, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 116, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4409/4732 (93.1741%)
___Train Local_ResNet_18,  epoch 116, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4416/4732 (93.3221%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8486, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 116, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4560/4929 (92.5137%)
___Train Local_ResNet_18,  epoch 116, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4493/4929 (91.1544%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1457, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 116, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5620/6068 (92.6170%)
___Train Local_ResNet_18,  epoch 116, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5578/6068 (91.9249%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1079, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3593/3995 (89.9374%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3580/3995 (89.6120%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1351, Accuracy: 5326/10000 (53.2600%)
time spent on training: 246.9772527217865
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.2096, Accuracy: 6836/10000 (68.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1458, Accuracy: 9503/9900 (95.9899%)
Done in 273.03504705429077 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 5, 39, 78, 34, 63, 68, 55, 14, 81, 75, 43, 73, 11, 3, 70, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5111/5308 (96.2886%), train_poison_data_count: 415
Global model norm: 43.43121301174853.
Norm before scaling: 43.40407465076364. Distance: 1.3969216255752783
Total norm for 4 adversaries is: 43.40407465076364. distance: 1.3969216255752783
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0655, Accuracy: 9718/9900 (98.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5585/5777 (96.6765%), train_poison_data_count: 455
Global model norm: 43.43121301174853.
Norm before scaling: 43.39878979942514. Distance: 1.413273839050735
Total norm for 4 adversaries is: 43.39878979942514. distance: 1.413273839050735
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0520, Accuracy: 9769/9900 (98.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4908/5123 (95.8032%), train_poison_data_count: 403
Global model norm: 43.43121301174853.
Norm before scaling: 43.4063315558989. Distance: 1.4555527290692116
Total norm for 4 adversaries is: 43.4063315558989. distance: 1.4555527290692116
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0183, Accuracy: 9849/9900 (99.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5333/5503 (96.9108%), train_poison_data_count: 430
Global model norm: 43.43121301174853.
Norm before scaling: 43.400557582103716. Distance: 1.3426131829087216
Total norm for 4 adversaries is: 43.400557582103716. distance: 1.3426131829087216
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0510, Accuracy: 9761/9900 (98.5960%)
___Train Local_ResNet_18,  epoch 117, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4686/4993 (93.8514%)
___Train Local_ResNet_18,  epoch 117, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4626/4993 (92.6497%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0704, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 117, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3835/4175 (91.8563%)
___Train Local_ResNet_18,  epoch 117, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3781/4175 (90.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0384, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 117, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4136/4368 (94.6886%)
___Train Local_ResNet_18,  epoch 117, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4060/4368 (92.9487%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1012, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 117, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4524/4911 (92.1197%)
___Train Local_ResNet_18,  epoch 117, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4441/4911 (90.4296%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1541, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 117, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3632/3910 (92.8900%)
___Train Local_ResNet_18,  epoch 117, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3478/3910 (88.9514%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2059, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 117, local model 68, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3320/3589 (92.5049%)
___Train Local_ResNet_18,  epoch 117, local model 68, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3240/3589 (90.2758%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2652, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 117, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4407/4731 (93.1516%)
___Train Local_ResNet_18,  epoch 117, local model 55, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4377/4731 (92.5174%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9752, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 117, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3990/4196 (95.0906%)
___Train Local_ResNet_18,  epoch 117, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3949/4196 (94.1134%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8713, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 117, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4665/5035 (92.6514%)
___Train Local_ResNet_18,  epoch 117, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4607/5035 (91.4995%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0894, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 117, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4343/4672 (92.9580%)
___Train Local_ResNet_18,  epoch 117, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4365/4672 (93.4289%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8941, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 117, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4577/4979 (91.9261%)
___Train Local_ResNet_18,  epoch 117, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4536/4979 (91.1026%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2651, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch 117, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4290/4605 (93.1596%)
___Train Local_ResNet_18,  epoch 117, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4304/4605 (93.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9554, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 117, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4953/5702 (86.8643%)
___Train Local_ResNet_18,  epoch 117, local model 11, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4753/5702 (83.3567%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0844, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 117, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5043/5346 (94.3322%)
___Train Local_ResNet_18,  epoch 117, local model 3, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5032/5346 (94.1264%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0651, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 117, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5435/5871 (92.5737%)
___Train Local_ResNet_18,  epoch 117, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5356/5871 (91.2281%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1073, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 117, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5075/5645 (89.9026%)
___Train Local_ResNet_18,  epoch 117, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5000/5645 (88.5740%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1496, Accuracy: 5204/10000 (52.0400%)
time spent on training: 243.98444724082947
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.2072, Accuracy: 6849/10000 (68.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1418, Accuracy: 9516/9900 (96.1212%)
Done in 270.3383324146271 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 53, 62, 44, 64, 3, 63, 32, 24, 73, 6, 54, 16, 25, 82, 84, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5159/5308 (97.1929%), train_poison_data_count: 415
Global model norm: 43.451165510026165.
Norm before scaling: 43.420332994840244. Distance: 1.283962123992555
Total norm for 4 adversaries is: 43.420332994840244. distance: 1.283962123992555
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0468, Accuracy: 9776/9900 (98.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5621/5777 (97.2996%), train_poison_data_count: 455
Global model norm: 43.451165510026165.
Norm before scaling: 43.41577975391695. Distance: 1.3576478619074364
Total norm for 4 adversaries is: 43.41577975391695. distance: 1.3576478619074364
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0745, Accuracy: 9684/9900 (97.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4934/5123 (96.3108%), train_poison_data_count: 403
Global model norm: 43.451165510026165.
Norm before scaling: 43.42349987963747. Distance: 1.3722724738467273
Total norm for 4 adversaries is: 43.42349987963747. distance: 1.3722724738467273
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0634, Accuracy: 9742/9900 (98.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5332/5503 (96.8926%), train_poison_data_count: 430
Global model norm: 43.451165510026165.
Norm before scaling: 43.42078421623825. Distance: 1.3585437557066145
Total norm for 4 adversaries is: 43.42078421623825. distance: 1.3585437557066145
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0991, Accuracy: 9622/9900 (97.1919%)
___Train Local_ResNet_18,  epoch 118, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5930/6664 (88.9856%)
___Train Local_ResNet_18,  epoch 118, local model 53, internal_epoch   2,  Average loss: 0.0082, Accuracy: 5630/6664 (84.4838%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.4853, Accuracy: 4690/10000 (46.9000%)
___Train Local_ResNet_18,  epoch 118, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4853/5504 (88.1722%)
___Train Local_ResNet_18,  epoch 118, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4824/5504 (87.6453%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0972, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 118, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4734/5075 (93.2808%)
___Train Local_ResNet_18,  epoch 118, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4679/5075 (92.1970%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1144, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 118, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4378/4894 (89.4565%)
___Train Local_ResNet_18,  epoch 118, local model 64, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4310/4894 (88.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1409, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 118, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5023/5346 (93.9581%)
___Train Local_ResNet_18,  epoch 118, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4954/5346 (92.6674%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1030, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 118, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3620/3910 (92.5831%)
___Train Local_ResNet_18,  epoch 118, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3450/3910 (88.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0786, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 118, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5405/6080 (88.8980%)
___Train Local_ResNet_18,  epoch 118, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5365/6080 (88.2401%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.4510, Accuracy: 4871/10000 (48.7100%)
___Train Local_ResNet_18,  epoch 118, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4038/4313 (93.6239%)
___Train Local_ResNet_18,  epoch 118, local model 24, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3992/4313 (92.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8779, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 118, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4308/4605 (93.5505%)
___Train Local_ResNet_18,  epoch 118, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4339/4605 (94.2237%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7407, Accuracy: 5950/10000 (59.5000%)
___Train Local_ResNet_18,  epoch 118, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4563/4929 (92.5746%)
___Train Local_ResNet_18,  epoch 118, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4513/4929 (91.5602%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0644, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 118, local model 54, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5071/5645 (89.8317%)
___Train Local_ResNet_18,  epoch 118, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4853/5645 (85.9699%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.4430, Accuracy: 4894/10000 (48.9400%)
___Train Local_ResNet_18,  epoch 118, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4937/5353 (92.2287%)
___Train Local_ResNet_18,  epoch 118, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4854/5353 (90.6781%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0364, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 118, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5732/6419 (89.2974%)
___Train Local_ResNet_18,  epoch 118, local model 25, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5499/6419 (85.6675%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.4848, Accuracy: 4935/10000 (49.3500%)
___Train Local_ResNet_18,  epoch 118, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5028/5298 (94.9037%)
___Train Local_ResNet_18,  epoch 118, local model 82, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4997/5298 (94.3186%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9904, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4745/5209 (91.0923%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4724/5209 (90.6892%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1094, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4368/4714 (92.6602%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4357/4714 (92.4268%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1309, Accuracy: 5344/10000 (53.4400%)
time spent on training: 247.595862865448
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.2123, Accuracy: 6843/10000 (68.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1336, Accuracy: 9546/9900 (96.4242%)
Done in 274.1624071598053 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 20, 31, 38, 91, 81, 60, 39, 47, 52, 84, 79, 21, 4, 77, 8, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5164/5308 (97.2871%), train_poison_data_count: 415
Global model norm: 43.47296073917312.
Norm before scaling: 43.439891458449516. Distance: 1.270649625705626
Total norm for 4 adversaries is: 43.439891458449516. distance: 1.270649625705626
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0744, Accuracy: 9705/9900 (98.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5603/5777 (96.9881%), train_poison_data_count: 455
Global model norm: 43.47296073917312.
Norm before scaling: 43.437396020559. Distance: 1.3614427909557378
Total norm for 4 adversaries is: 43.437396020559. distance: 1.3614427909557378
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0648, Accuracy: 9731/9900 (98.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4897/5123 (95.5885%), train_poison_data_count: 403
Global model norm: 43.47296073917312.
Norm before scaling: 43.44828440765814. Distance: 1.4616115055673267
Total norm for 4 adversaries is: 43.44828440765814. distance: 1.4616115055673267
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0899, Accuracy: 9670/9900 (97.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5312/5503 (96.5292%), train_poison_data_count: 430
Global model norm: 43.47296073917312.
Norm before scaling: 43.443340715684634. Distance: 1.3867432068293384
Total norm for 4 adversaries is: 43.443340715684634. distance: 1.3867432068293384
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0274, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 119, local model 20, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4383/4714 (92.9784%)
___Train Local_ResNet_18,  epoch 119, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4377/4714 (92.8511%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9008, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 119, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4219/4537 (92.9910%)
___Train Local_ResNet_18,  epoch 119, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4194/4537 (92.4399%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9008, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 119, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5626/6235 (90.2326%)
___Train Local_ResNet_18,  epoch 119, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5486/6235 (87.9872%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.3913, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18,  epoch 119, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4069/4527 (89.8829%)
___Train Local_ResNet_18,  epoch 119, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4020/4527 (88.8005%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9463, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 119, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4707/5035 (93.4856%)
___Train Local_ResNet_18,  epoch 119, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4700/5035 (93.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9015, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 119, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3781/4145 (91.2183%)
___Train Local_ResNet_18,  epoch 119, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3802/4145 (91.7250%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0733, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3867/4175 (92.6228%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3802/4175 (91.0659%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1305, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 119, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4624/5123 (90.2596%)
___Train Local_ResNet_18,  epoch 119, local model 47, internal_epoch   2,  Average loss: 0.0160, Accuracy: 3683/5123 (71.8915%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.4612, Accuracy: 4675/10000 (46.7500%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3897/4130 (94.3584%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3855/4130 (93.3414%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8805, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 119, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4794/5209 (92.0330%)
___Train Local_ResNet_18,  epoch 119, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4690/5209 (90.0365%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1663, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3831/4111 (93.1890%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3790/4111 (92.1917%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9443, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 119, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4638/5038 (92.0603%)
___Train Local_ResNet_18,  epoch 119, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4640/5038 (92.1000%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9211, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 119, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3762/4028 (93.3962%)
___Train Local_ResNet_18,  epoch 119, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3764/4028 (93.4459%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8096, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 119, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4538/5050 (89.8614%)
___Train Local_ResNet_18,  epoch 119, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4524/5050 (89.5842%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2702, Accuracy: 5041/10000 (50.4100%)
___Train Local_ResNet_18,  epoch 119, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4471/4889 (91.4502%)
___Train Local_ResNet_18,  epoch 119, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4371/4889 (89.4048%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1246, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 119, local model 69, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4049/4364 (92.7819%)
___Train Local_ResNet_18,  epoch 119, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3965/4364 (90.8570%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9692, Accuracy: 5500/10000 (55.0000%)
time spent on training: 240.83430433273315
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.2085, Accuracy: 6852/10000 (68.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1298, Accuracy: 9558/9900 (96.5455%)
Done in 267.23330569267273 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 72, 30, 96, 38, 62, 1, 31, 88, 21, 34, 43, 37, 10, 83, 93, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5164/5308 (97.2871%), train_poison_data_count: 415
Global model norm: 43.492160134489325.
Norm before scaling: 43.46154769367616. Distance: 1.3136160510563561
Total norm for 4 adversaries is: 43.46154769367616. distance: 1.3136160510563561
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0411, Accuracy: 9784/9900 (98.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5624/5777 (97.3516%), train_poison_data_count: 455
Global model norm: 43.492160134489325.
Norm before scaling: 43.4537036998502. Distance: 1.308297149295525
Total norm for 4 adversaries is: 43.4537036998502. distance: 1.308297149295525
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0541, Accuracy: 9755/9900 (98.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4939/5123 (96.4084%), train_poison_data_count: 403
Global model norm: 43.492160134489325.
Norm before scaling: 43.46391114782038. Distance: 1.3667002218282984
Total norm for 4 adversaries is: 43.46391114782038. distance: 1.3667002218282984
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1520, Accuracy: 9508/9900 (96.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5304/5503 (96.3838%), train_poison_data_count: 430
Global model norm: 43.492160134489325.
Norm before scaling: 43.46537297045704. Distance: 1.4291797007123004
Total norm for 4 adversaries is: 43.46537297045704. distance: 1.4291797007123004
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1095, Accuracy: 9604/9900 (97.0101%)
___Train Local_ResNet_18,  epoch 120, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4775/5193 (91.9507%)
___Train Local_ResNet_18,  epoch 120, local model 72, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4534/5193 (87.3098%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2600, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch 120, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3502/3774 (92.7928%)
___Train Local_ResNet_18,  epoch 120, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3490/3774 (92.4748%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8408, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 120, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4656/5086 (91.5454%)
___Train Local_ResNet_18,  epoch 120, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4682/5086 (92.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9509, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5604/6235 (89.8797%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5530/6235 (88.6929%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2991, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4890/5504 (88.8445%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4843/5504 (87.9906%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2338, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch 120, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5104/5422 (94.1350%)
___Train Local_ResNet_18,  epoch 120, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5063/5422 (93.3788%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9488, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 120, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4229/4537 (93.2114%)
___Train Local_ResNet_18,  epoch 120, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4172/4537 (91.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9699, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 120, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4960/5362 (92.5028%)
___Train Local_ResNet_18,  epoch 120, local model 88, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4903/5362 (91.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9643, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 120, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4599/5038 (91.2862%)
___Train Local_ResNet_18,  epoch 120, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4607/5038 (91.4450%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9196, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 120, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4559/4911 (92.8324%)
___Train Local_ResNet_18,  epoch 120, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4588/4911 (93.4229%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0028, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 120, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4615/4979 (92.6893%)
___Train Local_ResNet_18,  epoch 120, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4576/4979 (91.9060%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1563, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 120, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4316/4741 (91.0356%)
___Train Local_ResNet_18,  epoch 120, local model 37, internal_epoch   2,  Average loss: 0.0109, Accuracy: 3777/4741 (79.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.6056, Accuracy: 4497/10000 (44.9700%)
___Train Local_ResNet_18,  epoch 120, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4755/5068 (93.8240%)
___Train Local_ResNet_18,  epoch 120, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4645/5068 (91.6535%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1048, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 120, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3262/3552 (91.8356%)
___Train Local_ResNet_18,  epoch 120, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3269/3552 (92.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7911, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 120, local model 93, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4654/5055 (92.0673%)
___Train Local_ResNet_18,  epoch 120, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4561/5055 (90.2275%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2233, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 120, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3649/3959 (92.1697%)
___Train Local_ResNet_18,  epoch 120, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3643/3959 (92.0182%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9885, Accuracy: 5578/10000 (55.7800%)
time spent on training: 244.67750024795532
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.2110, Accuracy: 6836/10000 (68.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1249, Accuracy: 9566/9900 (96.6263%)
Done in 271.0876033306122 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 86, 74, 94, 24, 51, 84, 63, 26, 28, 88, 55, 2, 33, 98, 34, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5165/5308 (97.3060%), train_poison_data_count: 415
Global model norm: 43.51170875555366.
Norm before scaling: 43.478817748110835. Distance: 1.2697874309582848
Total norm for 4 adversaries is: 43.478817748110835. distance: 1.2697874309582848
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0520, Accuracy: 9766/9900 (98.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5624/5777 (97.3516%), train_poison_data_count: 455
Global model norm: 43.51170875555366.
Norm before scaling: 43.476172926152174. Distance: 1.3401661921396226
Total norm for 4 adversaries is: 43.476172926152174. distance: 1.3401661921396226
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1366, Accuracy: 9567/9900 (96.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4920/5123 (96.0375%), train_poison_data_count: 403
Global model norm: 43.51170875555366.
Norm before scaling: 43.48388373330112. Distance: 1.3972598183724267
Total norm for 4 adversaries is: 43.48388373330112. distance: 1.3972598183724267
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0619, Accuracy: 9730/9900 (98.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5336/5503 (96.9653%), train_poison_data_count: 430
Global model norm: 43.51170875555366.
Norm before scaling: 43.48158032027398. Distance: 1.3585423078663683
Total norm for 4 adversaries is: 43.48158032027398. distance: 1.3585423078663683
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0204, Accuracy: 9859/9900 (99.5859%)
___Train Local_ResNet_18,  epoch 121, local model 86, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3560/3929 (90.6083%)
___Train Local_ResNet_18,  epoch 121, local model 86, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3526/3929 (89.7429%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9487, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 121, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4375/4797 (91.2028%)
___Train Local_ResNet_18,  epoch 121, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4269/4797 (88.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0795, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 121, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4711/5224 (90.1799%)
___Train Local_ResNet_18,  epoch 121, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4714/5224 (90.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1962, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 121, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4036/4313 (93.5776%)
___Train Local_ResNet_18,  epoch 121, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4031/4313 (93.4616%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8208, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 121, local model 51, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3836/4108 (93.3788%)
___Train Local_ResNet_18,  epoch 121, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3835/4108 (93.3544%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9674, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4738/5209 (90.9580%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4706/5209 (90.3436%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1624, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 121, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3649/3910 (93.3248%)
___Train Local_ResNet_18,  epoch 121, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3604/3910 (92.1739%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9949, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3822/4086 (93.5389%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3805/4086 (93.1229%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9815, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 121, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4583/5122 (89.4768%)
___Train Local_ResNet_18,  epoch 121, local model 28, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4281/5122 (83.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.5450, Accuracy: 4711/10000 (47.1100%)
___Train Local_ResNet_18,  epoch 121, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4905/5362 (91.4771%)
___Train Local_ResNet_18,  epoch 121, local model 88, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4816/5362 (89.8172%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2310, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 121, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4397/4731 (92.9402%)
___Train Local_ResNet_18,  epoch 121, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4382/4731 (92.6231%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0047, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 121, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3645/3968 (91.8599%)
___Train Local_ResNet_18,  epoch 121, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3638/3968 (91.6835%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8597, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 121, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4452/4818 (92.4035%)
___Train Local_ResNet_18,  epoch 121, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4327/4818 (89.8090%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2440, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 121, local model 98, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3885/4161 (93.3670%)
___Train Local_ResNet_18,  epoch 121, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3755/4161 (90.2427%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9505, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 121, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4528/4911 (92.2012%)
___Train Local_ResNet_18,  epoch 121, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4497/4911 (91.5699%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9998, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 121, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4745/5068 (93.6267%)
___Train Local_ResNet_18,  epoch 121, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4764/5068 (94.0016%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9961, Accuracy: 5551/10000 (55.5100%)
time spent on training: 234.29865169525146
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.2204, Accuracy: 6818/10000 (68.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1118, Accuracy: 9596/9900 (96.9293%)
Done in 260.7444808483124 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 33, 32, 46, 38, 22, 73, 61, 35, 83, 24, 87, 23, 3, 19, 98, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5172/5308 (97.4378%), train_poison_data_count: 415
Global model norm: 43.53044238303236.
Norm before scaling: 43.49626336546408. Distance: 1.2319870074255872
Total norm for 4 adversaries is: 43.49626336546408. distance: 1.2319870074255872
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0653, Accuracy: 9729/9900 (98.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5619/5777 (97.2650%), train_poison_data_count: 455
Global model norm: 43.53044238303236.
Norm before scaling: 43.49471838446307. Distance: 1.3537629577213832
Total norm for 4 adversaries is: 43.49471838446307. distance: 1.3537629577213832
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0906, Accuracy: 9667/9900 (97.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4928/5123 (96.1936%), train_poison_data_count: 403
Global model norm: 43.53044238303236.
Norm before scaling: 43.5008292283571. Distance: 1.3449152839669767
Total norm for 4 adversaries is: 43.5008292283571. distance: 1.3449152839669767
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1602, Accuracy: 9496/9900 (95.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5322/5503 (96.7109%), train_poison_data_count: 430
Global model norm: 43.53044238303236.
Norm before scaling: 43.5001725818236. Distance: 1.4127652872824907
Total norm for 4 adversaries is: 43.5001725818236. distance: 1.4127652872824907
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0839, Accuracy: 9679/9900 (97.7677%)
___Train Local_ResNet_18,  epoch 122, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4470/4818 (92.7771%)
___Train Local_ResNet_18,  epoch 122, local model 33, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4266/4818 (88.5430%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0344, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 122, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5456/6080 (89.7368%)
___Train Local_ResNet_18,  epoch 122, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5310/6080 (87.3355%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2701, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 122, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4816/5399 (89.2017%)
___Train Local_ResNet_18,  epoch 122, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4712/5399 (87.2754%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2343, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 122, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5600/6235 (89.8156%)
___Train Local_ResNet_18,  epoch 122, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5499/6235 (88.1957%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.3258, Accuracy: 4990/10000 (49.9000%)
___Train Local_ResNet_18,  epoch 122, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5344/5696 (93.8202%)
___Train Local_ResNet_18,  epoch 122, local model 22, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5249/5696 (92.1524%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0237, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 122, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4332/4605 (94.0717%)
___Train Local_ResNet_18,  epoch 122, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4354/4605 (94.5494%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8100, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 122, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4134/4485 (92.1739%)
___Train Local_ResNet_18,  epoch 122, local model 61, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4032/4485 (89.8997%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0952, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 122, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5150/5615 (91.7186%)
___Train Local_ResNet_18,  epoch 122, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5099/5615 (90.8103%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1724, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 122, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3252/3552 (91.5541%)
___Train Local_ResNet_18,  epoch 122, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3311/3552 (93.2151%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7414, Accuracy: 5956/10000 (59.5600%)
___Train Local_ResNet_18,  epoch 122, local model 24, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4023/4313 (93.2761%)
___Train Local_ResNet_18,  epoch 122, local model 24, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4057/4313 (94.0645%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7408, Accuracy: 5928/10000 (59.2800%)
___Train Local_ResNet_18,  epoch 122, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3612/3995 (90.4130%)
___Train Local_ResNet_18,  epoch 122, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3601/3995 (90.1377%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1575, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 122, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4330/4549 (95.1858%)
___Train Local_ResNet_18,  epoch 122, local model 23, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4017/4549 (88.3051%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0624, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 122, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5005/5346 (93.6214%)
___Train Local_ResNet_18,  epoch 122, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4963/5346 (92.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0719, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 122, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4860/5361 (90.6547%)
___Train Local_ResNet_18,  epoch 122, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4794/5361 (89.4236%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1505, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3858/4161 (92.7181%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3816/4161 (91.7087%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1550, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 122, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4392/4714 (93.1693%)
___Train Local_ResNet_18,  epoch 122, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4444/4714 (94.2724%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9886, Accuracy: 5538/10000 (55.3800%)
time spent on training: 245.74501299858093
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.2249, Accuracy: 6822/10000 (68.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1123, Accuracy: 9600/9900 (96.9697%)
Done in 272.3747477531433 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 9, 53, 69, 0, 77, 5, 33, 81, 92, 66, 83, 47, 17, 1, 84, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5172/5308 (97.4378%), train_poison_data_count: 415
Global model norm: 43.550701190896454.
Norm before scaling: 43.51630665983156. Distance: 1.248423870141175
Total norm for 4 adversaries is: 43.51630665983156. distance: 1.248423870141175
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1009, Accuracy: 9637/9900 (97.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5610/5777 (97.1092%), train_poison_data_count: 455
Global model norm: 43.550701190896454.
Norm before scaling: 43.513797369609534. Distance: 1.3813239237478352
Total norm for 4 adversaries is: 43.513797369609534. distance: 1.3813239237478352
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0404, Accuracy: 9789/9900 (98.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4949/5123 (96.6036%), train_poison_data_count: 403
Global model norm: 43.550701190896454.
Norm before scaling: 43.5200850497144. Distance: 1.3412195821194353
Total norm for 4 adversaries is: 43.5200850497144. distance: 1.3412195821194353
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0887, Accuracy: 9674/9900 (97.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5341/5503 (97.0562%), train_poison_data_count: 430
Global model norm: 43.550701190896454.
Norm before scaling: 43.51896306766023. Distance: 1.3592815147789208
Total norm for 4 adversaries is: 43.51896306766023. distance: 1.3592815147789208
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0465, Accuracy: 9772/9900 (98.7071%)
___Train Local_ResNet_18,  epoch 123, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5163/5727 (90.1519%)
___Train Local_ResNet_18,  epoch 123, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5089/5727 (88.8598%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9993, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 123, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5861/6664 (87.9502%)
___Train Local_ResNet_18,  epoch 123, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5818/6664 (87.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1356, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 123, local model 69, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4056/4364 (92.9423%)
___Train Local_ResNet_18,  epoch 123, local model 69, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3921/4364 (89.8488%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9910, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 123, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4987/5454 (91.4375%)
___Train Local_ResNet_18,  epoch 123, local model 0, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4820/5454 (88.3755%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0588, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 123, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4484/5050 (88.7921%)
___Train Local_ResNet_18,  epoch 123, local model 77, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4436/5050 (87.8416%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0808, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 123, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4727/4993 (94.6725%)
___Train Local_ResNet_18,  epoch 123, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4653/4993 (93.1905%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0240, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 123, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4419/4818 (91.7186%)
___Train Local_ResNet_18,  epoch 123, local model 33, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4245/4818 (88.1071%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1131, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 123, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4698/5035 (93.3069%)
___Train Local_ResNet_18,  epoch 123, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4697/5035 (93.2870%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9549, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 123, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6379/6812 (93.6436%)
___Train Local_ResNet_18,  epoch 123, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 6297/6812 (92.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1519, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 123, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4473/4843 (92.3601%)
___Train Local_ResNet_18,  epoch 123, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4477/4843 (92.4427%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9989, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 123, local model 83, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3317/3552 (93.3840%)
___Train Local_ResNet_18,  epoch 123, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3330/3552 (93.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8566, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 123, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4633/5123 (90.4353%)
___Train Local_ResNet_18,  epoch 123, local model 47, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4396/5123 (85.8091%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.4223, Accuracy: 4909/10000 (49.0900%)
___Train Local_ResNet_18,  epoch 123, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4476/4903 (91.2910%)
___Train Local_ResNet_18,  epoch 123, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4417/4903 (90.0877%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1140, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5112/5422 (94.2826%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5086/5422 (93.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8910, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 123, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4752/5209 (91.2267%)
___Train Local_ResNet_18,  epoch 123, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4733/5209 (90.8620%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0786, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5283/5696 (92.7493%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5210/5696 (91.4677%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0473, Accuracy: 5464/10000 (54.6400%)
time spent on training: 249.82731366157532
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.2226, Accuracy: 6834/10000 (68.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1162, Accuracy: 9595/9900 (96.9192%)
Done in 276.07271695137024 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 33, 99, 27, 61, 22, 75, 85, 54, 11, 37, 60, 21, 32, 64, 29, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5140/5308 (96.8350%), train_poison_data_count: 415
Global model norm: 43.57212725398543.
Norm before scaling: 43.54069211803124. Distance: 1.3252007998055608
Total norm for 4 adversaries is: 43.54069211803124. distance: 1.3252007998055608
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1036, Accuracy: 9639/9900 (97.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5626/5777 (97.3862%), train_poison_data_count: 455
Global model norm: 43.57212725398543.
Norm before scaling: 43.53549815506163. Distance: 1.3527554665974788
Total norm for 4 adversaries is: 43.53549815506163. distance: 1.3527554665974788
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0949, Accuracy: 9654/9900 (97.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4948/5123 (96.5840%), train_poison_data_count: 403
Global model norm: 43.57212725398543.
Norm before scaling: 43.54136777833021. Distance: 1.3392833282812753
Total norm for 4 adversaries is: 43.54136777833021. distance: 1.3392833282812753
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1424, Accuracy: 9512/9900 (96.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5319/5503 (96.6564%), train_poison_data_count: 430
Global model norm: 43.57212725398543.
Norm before scaling: 43.54370166945071. Distance: 1.44122975000215
Total norm for 4 adversaries is: 43.54370166945071. distance: 1.44122975000215
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0283, Accuracy: 9829/9900 (99.2828%)
___Train Local_ResNet_18,  epoch 124, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4438/4818 (92.1129%)
___Train Local_ResNet_18,  epoch 124, local model 33, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4252/4818 (88.2524%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0232, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 124, local model 99, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4441/4851 (91.5481%)
___Train Local_ResNet_18,  epoch 124, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4399/4851 (90.6823%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0856, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 124, local model 27, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4250/4587 (92.6532%)
___Train Local_ResNet_18,  epoch 124, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4186/4587 (91.2579%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0683, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 124, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4146/4485 (92.4415%)
___Train Local_ResNet_18,  epoch 124, local model 61, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3949/4485 (88.0491%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0117, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 124, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5317/5696 (93.3462%)
___Train Local_ResNet_18,  epoch 124, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5220/5696 (91.6433%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0888, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 124, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4347/4672 (93.0437%)
___Train Local_ResNet_18,  epoch 124, local model 75, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4293/4672 (91.8878%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9513, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 124, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6284/6947 (90.4563%)
___Train Local_ResNet_18,  epoch 124, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 6049/6947 (87.0736%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3220, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18,  epoch 124, local model 54, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5061/5645 (89.6546%)
___Train Local_ResNet_18,  epoch 124, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4978/5645 (88.1842%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3016, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch 124, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4920/5702 (86.2855%)
___Train Local_ResNet_18,  epoch 124, local model 11, internal_epoch   2,  Average loss: 0.0117, Accuracy: 4403/5702 (77.2185%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3634, Accuracy: 4702/10000 (47.0200%)
___Train Local_ResNet_18,  epoch 124, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4338/4741 (91.4997%)
___Train Local_ResNet_18,  epoch 124, local model 37, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4086/4741 (86.1843%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2620, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 124, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3820/4145 (92.1592%)
___Train Local_ResNet_18,  epoch 124, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3762/4145 (90.7600%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9887, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4671/5038 (92.7154%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4568/5038 (90.6709%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0737, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 124, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5394/6080 (88.7171%)
___Train Local_ResNet_18,  epoch 124, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5277/6080 (86.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1745, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 124, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4425/4894 (90.4168%)
___Train Local_ResNet_18,  epoch 124, local model 64, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4262/4894 (87.0862%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3489, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18,  epoch 124, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4440/4732 (93.8292%)
___Train Local_ResNet_18,  epoch 124, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4486/4732 (94.8014%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9224, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 124, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3944/4249 (92.8218%)
___Train Local_ResNet_18,  epoch 124, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3902/4249 (91.8334%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9951, Accuracy: 5574/10000 (55.7400%)
time spent on training: 247.15159440040588
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.2237, Accuracy: 6823/10000 (68.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1211, Accuracy: 9576/9900 (96.7273%)
Done in 273.31824469566345 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 53, 50, 93, 1, 7, 79, 52, 24, 16, 28, 10, 62, 86, 47, 98, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5163/5308 (97.2683%), train_poison_data_count: 415
Global model norm: 43.593946012104134.
Norm before scaling: 43.5635325940208. Distance: 1.3197074722776858
Total norm for 4 adversaries is: 43.5635325940208. distance: 1.3197074722776858
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0779, Accuracy: 9686/9900 (97.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5608/5777 (97.0746%), train_poison_data_count: 455
Global model norm: 43.593946012104134.
Norm before scaling: 43.557408126911945. Distance: 1.3938429386644662
Total norm for 4 adversaries is: 43.557408126911945. distance: 1.3938429386644662
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0727, Accuracy: 9715/9900 (98.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4939/5123 (96.4084%), train_poison_data_count: 403
Global model norm: 43.593946012104134.
Norm before scaling: 43.56377357580565. Distance: 1.3334682912872013
Total norm for 4 adversaries is: 43.56377357580565. distance: 1.3334682912872013
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0373, Accuracy: 9791/9900 (98.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5331/5503 (96.8744%), train_poison_data_count: 430
Global model norm: 43.593946012104134.
Norm before scaling: 43.56357602688283. Distance: 1.3736482825208827
Total norm for 4 adversaries is: 43.56357602688283. distance: 1.3736482825208827
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0566, Accuracy: 9759/9900 (98.5758%)
___Train Local_ResNet_18,  epoch 125, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5872/6664 (88.1152%)
___Train Local_ResNet_18,  epoch 125, local model 53, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5709/6664 (85.6693%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1245, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 125, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4443/4757 (93.3992%)
___Train Local_ResNet_18,  epoch 125, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4361/4757 (91.6754%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0947, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 125, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4634/5055 (91.6716%)
___Train Local_ResNet_18,  epoch 125, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4567/5055 (90.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1546, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 125, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5134/5422 (94.6883%)
___Train Local_ResNet_18,  epoch 125, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5041/5422 (92.9731%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8886, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 125, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4406/4869 (90.4909%)
___Train Local_ResNet_18,  epoch 125, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4132/4869 (84.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3316, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18,  epoch 125, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3805/4111 (92.5566%)
___Train Local_ResNet_18,  epoch 125, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3782/4111 (91.9971%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1614, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 125, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3883/4130 (94.0194%)
___Train Local_ResNet_18,  epoch 125, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3792/4130 (91.8160%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0740, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4038/4313 (93.6239%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4028/4313 (93.3921%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8067, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4953/5353 (92.5276%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4852/5353 (90.6408%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3039, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch 125, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4643/5122 (90.6482%)
___Train Local_ResNet_18,  epoch 125, local model 28, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4299/5122 (83.9321%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3066, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18,  epoch 125, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4722/5068 (93.1728%)
___Train Local_ResNet_18,  epoch 125, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4705/5068 (92.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1402, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 125, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4898/5504 (88.9898%)
___Train Local_ResNet_18,  epoch 125, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4857/5504 (88.2449%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1349, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 125, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3591/3929 (91.3973%)
___Train Local_ResNet_18,  epoch 125, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3602/3929 (91.6773%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0292, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4680/5123 (91.3527%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4243/5123 (82.8226%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2693, Accuracy: 4984/10000 (49.8400%)
___Train Local_ResNet_18,  epoch 125, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3915/4161 (94.0880%)
___Train Local_ResNet_18,  epoch 125, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3812/4161 (91.6126%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0277, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 125, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4984/5454 (91.3825%)
___Train Local_ResNet_18,  epoch 125, local model 0, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4859/5454 (89.0906%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0281, Accuracy: 5534/10000 (55.3400%)
time spent on training: 245.77042961120605
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.2242, Accuracy: 6828/10000 (68.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1159, Accuracy: 9589/9900 (96.8586%)
Done in 272.1197006702423 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 2, 78, 57, 41, 70, 21, 35, 39, 46, 53, 29, 48, 56, 65, 45, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5173/5308 (97.4567%), train_poison_data_count: 415
Global model norm: 43.61474768722516.
Norm before scaling: 43.5801249989244. Distance: 1.2226831110237046
Total norm for 4 adversaries is: 43.5801249989244. distance: 1.2226831110237046
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1126, Accuracy: 9598/9900 (96.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5622/5777 (97.3169%), train_poison_data_count: 455
Global model norm: 43.61474768722516.
Norm before scaling: 43.57743170163815. Distance: 1.3430088128221849
Total norm for 4 adversaries is: 43.57743170163815. distance: 1.3430088128221849
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0754, Accuracy: 9706/9900 (98.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4946/5123 (96.5450%), train_poison_data_count: 403
Global model norm: 43.61474768722516.
Norm before scaling: 43.585109190686474. Distance: 1.3495459534777228
Total norm for 4 adversaries is: 43.585109190686474. distance: 1.3495459534777228
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1849, Accuracy: 9426/9900 (95.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5327/5503 (96.8017%), train_poison_data_count: 430
Global model norm: 43.61474768722516.
Norm before scaling: 43.58346232777477. Distance: 1.3720946394640554
Total norm for 4 adversaries is: 43.58346232777477. distance: 1.3720946394640554
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0810, Accuracy: 9683/9900 (97.8081%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3699/3968 (93.2208%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3702/3968 (93.2964%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8959, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 126, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4104/4368 (93.9560%)
___Train Local_ResNet_18,  epoch 126, local model 78, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3995/4368 (91.4606%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1410, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 126, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4600/4956 (92.8168%)
___Train Local_ResNet_18,  epoch 126, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4519/4956 (91.1824%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0151, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 126, local model 41, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4399/4714 (93.3178%)
___Train Local_ResNet_18,  epoch 126, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4355/4714 (92.3844%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9560, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5476/5871 (93.2720%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5366/5871 (91.3984%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0351, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 126, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4665/5038 (92.5963%)
___Train Local_ResNet_18,  epoch 126, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4667/5038 (92.6360%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9076, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 126, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5123/5615 (91.2378%)
___Train Local_ResNet_18,  epoch 126, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5098/5615 (90.7925%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1725, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 126, local model 39, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3820/4175 (91.4970%)
___Train Local_ResNet_18,  epoch 126, local model 39, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3740/4175 (89.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0139, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 126, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4851/5399 (89.8500%)
___Train Local_ResNet_18,  epoch 126, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4703/5399 (87.1087%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.4403, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch 126, local model 53, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5860/6664 (87.9352%)
___Train Local_ResNet_18,  epoch 126, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5785/6664 (86.8097%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.3119, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18,  epoch 126, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4442/4732 (93.8715%)
___Train Local_ResNet_18,  epoch 126, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4430/4732 (93.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9505, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 126, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4531/4830 (93.8095%)
___Train Local_ResNet_18,  epoch 126, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4495/4830 (93.0642%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0425, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 126, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4910/5427 (90.4736%)
___Train Local_ResNet_18,  epoch 126, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4800/5427 (88.4467%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0856, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 126, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5093/5497 (92.6505%)
___Train Local_ResNet_18,  epoch 126, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4988/5497 (90.7404%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0443, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 126, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5016/5489 (91.3828%)
___Train Local_ResNet_18,  epoch 126, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4996/5489 (91.0184%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1643, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 126, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4630/5055 (91.5925%)
___Train Local_ResNet_18,  epoch 126, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4591/5055 (90.8210%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2586, Accuracy: 5241/10000 (52.4100%)
time spent on training: 247.89292216300964
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.2246, Accuracy: 6823/10000 (68.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1213, Accuracy: 9579/9900 (96.7576%)
Done in 274.0570557117462 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 55, 61, 17, 94, 19, 54, 21, 96, 8, 84, 97, 57, 90, 95, 73, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5167/5308 (97.3436%), train_poison_data_count: 415
Global model norm: 43.63500232307058.
Norm before scaling: 43.601379820661926. Distance: 1.288064281174563
Total norm for 4 adversaries is: 43.601379820661926. distance: 1.288064281174563
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0618, Accuracy: 9722/9900 (98.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5616/5777 (97.2131%), train_poison_data_count: 455
Global model norm: 43.63500232307058.
Norm before scaling: 43.59785626942066. Distance: 1.359463655935116
Total norm for 4 adversaries is: 43.59785626942066. distance: 1.359463655935116
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0509, Accuracy: 9772/9900 (98.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4944/5123 (96.5060%), train_poison_data_count: 403
Global model norm: 43.63500232307058.
Norm before scaling: 43.60559454905486. Distance: 1.3711762580064715
Total norm for 4 adversaries is: 43.60559454905486. distance: 1.3711762580064715
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0188, Accuracy: 9842/9900 (99.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5322/5503 (96.7109%), train_poison_data_count: 430
Global model norm: 43.63500232307058.
Norm before scaling: 43.60342354588542. Distance: 1.395911935709253
Total norm for 4 adversaries is: 43.60342354588542. distance: 1.395911935709253
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0305, Accuracy: 9825/9900 (99.2424%)
___Train Local_ResNet_18,  epoch 127, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4439/4731 (93.8279%)
___Train Local_ResNet_18,  epoch 127, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4365/4731 (92.2638%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9273, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 127, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4108/4485 (91.5942%)
___Train Local_ResNet_18,  epoch 127, local model 61, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3830/4485 (85.3958%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2287, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 127, local model 17, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4409/4903 (89.9245%)
___Train Local_ResNet_18,  epoch 127, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4380/4903 (89.3331%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1285, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 127, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4761/5224 (91.1371%)
___Train Local_ResNet_18,  epoch 127, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4747/5224 (90.8691%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1133, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4849/5361 (90.4495%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4755/5361 (88.6961%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1095, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 127, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5069/5645 (89.7963%)
___Train Local_ResNet_18,  epoch 127, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4964/5645 (87.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2807, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch 127, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4686/5038 (93.0131%)
___Train Local_ResNet_18,  epoch 127, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4667/5038 (92.6360%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9437, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 127, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4668/5086 (91.7814%)
___Train Local_ResNet_18,  epoch 127, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4628/5086 (90.9949%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1609, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 127, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4484/4889 (91.7161%)
___Train Local_ResNet_18,  epoch 127, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4457/4889 (91.1638%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2004, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 127, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4821/5209 (92.5514%)
___Train Local_ResNet_18,  epoch 127, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4704/5209 (90.3052%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0581, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 127, local model 97, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4243/4736 (89.5904%)
___Train Local_ResNet_18,  epoch 127, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4277/4736 (90.3083%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0043, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4570/4956 (92.2115%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4469/4956 (90.1735%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1389, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 127, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4433/4748 (93.3656%)
___Train Local_ResNet_18,  epoch 127, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4395/4748 (92.5653%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0589, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 127, local model 95, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4515/5018 (89.9761%)
___Train Local_ResNet_18,  epoch 127, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4411/5018 (87.9035%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.3026, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch 127, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4355/4605 (94.5711%)
___Train Local_ResNet_18,  epoch 127, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4343/4605 (94.3105%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9830, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 127, local model 16, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4957/5353 (92.6023%)
___Train Local_ResNet_18,  epoch 127, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4845/5353 (90.5100%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0190, Accuracy: 5497/10000 (54.9700%)
time spent on training: 245.31920909881592
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.2355, Accuracy: 6815/10000 (68.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1053, Accuracy: 9618/9900 (97.1515%)
Done in 271.8911371231079 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 10, 72, 34, 67, 60, 23, 86, 20, 99, 97, 64, 73, 68, 40, 30, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5174/5308 (97.4755%), train_poison_data_count: 415
Global model norm: 43.656058461909815.
Norm before scaling: 43.62290551696651. Distance: 1.265164468123043
Total norm for 4 adversaries is: 43.62290551696651. distance: 1.265164468123043
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0918, Accuracy: 9676/9900 (97.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5617/5777 (97.2304%), train_poison_data_count: 455
Global model norm: 43.656058461909815.
Norm before scaling: 43.61933752873045. Distance: 1.3969686882125356
Total norm for 4 adversaries is: 43.61933752873045. distance: 1.3969686882125356
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0859, Accuracy: 9678/9900 (97.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4950/5123 (96.6231%), train_poison_data_count: 403
Global model norm: 43.656058461909815.
Norm before scaling: 43.625860429820605. Distance: 1.3348328780819145
Total norm for 4 adversaries is: 43.625860429820605. distance: 1.3348328780819145
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1012, Accuracy: 9646/9900 (97.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5343/5503 (97.0925%), train_poison_data_count: 430
Global model norm: 43.656058461909815.
Norm before scaling: 43.62236544023676. Distance: 1.348039964974887
Total norm for 4 adversaries is: 43.62236544023676. distance: 1.348039964974887
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0712, Accuracy: 9701/9900 (97.9899%)
___Train Local_ResNet_18,  epoch 128, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4752/5068 (93.7648%)
___Train Local_ResNet_18,  epoch 128, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4652/5068 (91.7916%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1104, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4723/5193 (90.9494%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4552/5193 (87.6565%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3518, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18,  epoch 128, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4549/4911 (92.6288%)
___Train Local_ResNet_18,  epoch 128, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4472/4911 (91.0609%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0109, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 128, local model 67, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5055/5559 (90.9336%)
___Train Local_ResNet_18,  epoch 128, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4900/5559 (88.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1662, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 128, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3786/4145 (91.3390%)
___Train Local_ResNet_18,  epoch 128, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3815/4145 (92.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0518, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 128, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4290/4549 (94.3064%)
___Train Local_ResNet_18,  epoch 128, local model 23, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4058/4549 (89.2064%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2208, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3574/3929 (90.9646%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3555/3929 (90.4810%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9143, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4422/4714 (93.8057%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4406/4714 (93.4663%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9311, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4444/4851 (91.6100%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4420/4851 (91.1152%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0832, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4303/4736 (90.8573%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4249/4736 (89.7171%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9966, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 128, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4460/4894 (91.1320%)
___Train Local_ResNet_18,  epoch 128, local model 64, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4302/4894 (87.9036%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3184, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch 128, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4345/4605 (94.3540%)
___Train Local_ResNet_18,  epoch 128, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4324/4605 (93.8979%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0646, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 128, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3341/3589 (93.0900%)
___Train Local_ResNet_18,  epoch 128, local model 68, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3032/3589 (84.4804%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3910, Accuracy: 4990/10000 (49.9000%)
___Train Local_ResNet_18,  epoch 128, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5506/5939 (92.7092%)
___Train Local_ResNet_18,  epoch 128, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5461/5939 (91.9515%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1321, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 128, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3514/3774 (93.1108%)
___Train Local_ResNet_18,  epoch 128, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3540/3774 (93.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0272, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 128, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3254/3552 (91.6104%)
___Train Local_ResNet_18,  epoch 128, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3312/3552 (93.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9038, Accuracy: 5759/10000 (57.5900%)
time spent on training: 239.92665696144104
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.2400, Accuracy: 6800/10000 (68.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1030, Accuracy: 9625/9900 (97.2222%)
Done in 266.2468361854553 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 37, 33, 25, 48, 65, 95, 38, 74, 43, 26, 15, 14, 49, 79, 8, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5173/5308 (97.4567%), train_poison_data_count: 415
Global model norm: 43.67486992190489.
Norm before scaling: 43.64072709664033. Distance: 1.2538444052207423
Total norm for 4 adversaries is: 43.64072709664033. distance: 1.2538444052207423
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0933, Accuracy: 9660/9900 (97.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5621/5777 (97.2996%), train_poison_data_count: 455
Global model norm: 43.67486992190489.
Norm before scaling: 43.63915646025367. Distance: 1.3767750726387165
Total norm for 4 adversaries is: 43.63915646025367. distance: 1.3767750726387165
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0303, Accuracy: 9826/9900 (99.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4929/5123 (96.2132%), train_poison_data_count: 403
Global model norm: 43.67486992190489.
Norm before scaling: 43.64480377415363. Distance: 1.33585906216757
Total norm for 4 adversaries is: 43.64480377415363. distance: 1.33585906216757
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1111, Accuracy: 9608/9900 (97.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5347/5503 (97.1652%), train_poison_data_count: 430
Global model norm: 43.67486992190489.
Norm before scaling: 43.64188231047743. Distance: 1.3399937048095183
Total norm for 4 adversaries is: 43.64188231047743. distance: 1.3399937048095183
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0709, Accuracy: 9716/9900 (98.1414%)
___Train Local_ResNet_18,  epoch 129, local model 37, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4363/4741 (92.0270%)
___Train Local_ResNet_18,  epoch 129, local model 37, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4188/4741 (88.3358%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.4479, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch 129, local model 33, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4443/4818 (92.2167%)
___Train Local_ResNet_18,  epoch 129, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4404/4818 (91.4072%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0506, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 129, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5692/6419 (88.6742%)
___Train Local_ResNet_18,  epoch 129, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5545/6419 (86.3842%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2593, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch 129, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4528/4830 (93.7474%)
___Train Local_ResNet_18,  epoch 129, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4558/4830 (94.3685%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1169, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 129, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5066/5497 (92.1594%)
___Train Local_ResNet_18,  epoch 129, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4967/5497 (90.3584%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2384, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 129, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4503/5018 (89.7369%)
___Train Local_ResNet_18,  epoch 129, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4420/5018 (88.0829%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1754, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5679/6235 (91.0826%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5446/6235 (87.3456%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.4318, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4343/4797 (90.5358%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4343/4797 (90.5358%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0354, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 129, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4616/4979 (92.7094%)
___Train Local_ResNet_18,  epoch 129, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4638/4979 (93.1512%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9718, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 129, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3813/4086 (93.3186%)
___Train Local_ResNet_18,  epoch 129, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3825/4086 (93.6123%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9925, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 129, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5590/6068 (92.1226%)
___Train Local_ResNet_18,  epoch 129, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5598/6068 (92.2544%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1782, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3963/4196 (94.4471%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3982/4196 (94.8999%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8348, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 129, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5116/5652 (90.5166%)
___Train Local_ResNet_18,  epoch 129, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5016/5652 (88.7473%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0687, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3837/4111 (93.3350%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3775/4111 (91.8268%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0163, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 129, local model 8, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4519/4889 (92.4320%)
___Train Local_ResNet_18,  epoch 129, local model 8, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4494/4889 (91.9206%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1343, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 129, local model 78, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4083/4368 (93.4753%)
___Train Local_ResNet_18,  epoch 129, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4000/4368 (91.5751%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0565, Accuracy: 5432/10000 (54.3200%)
time spent on training: 246.23399209976196
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.2401, Accuracy: 6801/10000 (68.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1019, Accuracy: 9626/9900 (97.2323%)
Done in 272.58275079727173 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 55, 3, 46, 33, 49, 20, 1, 52, 29, 54, 11, 97, 91, 79, 88, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5176/5308 (97.5132%), train_poison_data_count: 415
Global model norm: 43.69522659454277.
Norm before scaling: 43.662536736403815. Distance: 1.2943728564735983
Total norm for 4 adversaries is: 43.662536736403815. distance: 1.2943728564735983
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0278, Accuracy: 9822/9900 (99.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5598/5777 (96.9015%), train_poison_data_count: 455
Global model norm: 43.69522659454277.
Norm before scaling: 43.65839600800959. Distance: 1.3573102946355955
Total norm for 4 adversaries is: 43.65839600800959. distance: 1.3573102946355955
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0707, Accuracy: 9714/9900 (98.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4935/5123 (96.3303%), train_poison_data_count: 403
Global model norm: 43.69522659454277.
Norm before scaling: 43.6629700782561. Distance: 1.2961944265049476
Total norm for 4 adversaries is: 43.6629700782561. distance: 1.2961944265049476
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1018, Accuracy: 9642/9900 (97.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5339/5503 (97.0198%), train_poison_data_count: 430
Global model norm: 43.69522659454277.
Norm before scaling: 43.66371653445871. Distance: 1.3588364509937598
Total norm for 4 adversaries is: 43.66371653445871. distance: 1.3588364509937598
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0448, Accuracy: 9783/9900 (98.8182%)
___Train Local_ResNet_18,  epoch 130, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4421/4731 (93.4475%)
___Train Local_ResNet_18,  epoch 130, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4362/4731 (92.2004%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1098, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 130, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5007/5346 (93.6588%)
___Train Local_ResNet_18,  epoch 130, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4912/5346 (91.8818%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1412, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 130, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4862/5399 (90.0537%)
___Train Local_ResNet_18,  epoch 130, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4706/5399 (87.1643%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2274, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 130, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4480/4818 (92.9846%)
___Train Local_ResNet_18,  epoch 130, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4406/4818 (91.4487%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1527, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5180/5652 (91.6490%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5027/5652 (88.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1269, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 130, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4433/4714 (94.0390%)
___Train Local_ResNet_18,  epoch 130, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4426/4714 (93.8905%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9358, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 130, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5110/5422 (94.2457%)
___Train Local_ResNet_18,  epoch 130, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5005/5422 (92.3091%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0370, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 130, local model 52, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3859/4130 (93.4383%)
___Train Local_ResNet_18,  epoch 130, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3806/4130 (92.1550%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9571, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 130, local model 29, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4418/4732 (93.3643%)
___Train Local_ResNet_18,  epoch 130, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4422/4732 (93.4489%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8122, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 130, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5099/5645 (90.3277%)
___Train Local_ResNet_18,  epoch 130, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4918/5645 (87.1213%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.3623, Accuracy: 4910/10000 (49.1000%)
___Train Local_ResNet_18,  epoch 130, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4997/5702 (87.6359%)
___Train Local_ResNet_18,  epoch 130, local model 11, internal_epoch   2,  Average loss: 0.0120, Accuracy: 4428/5702 (77.6570%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2932, Accuracy: 4892/10000 (48.9200%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4347/4736 (91.7863%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4324/4736 (91.3007%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1001, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 130, local model 91, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4083/4527 (90.1922%)
___Train Local_ResNet_18,  epoch 130, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4057/4527 (89.6178%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0396, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 130, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3837/4111 (93.3350%)
___Train Local_ResNet_18,  epoch 130, local model 79, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3756/4111 (91.3646%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9374, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 130, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4930/5362 (91.9433%)
___Train Local_ResNet_18,  epoch 130, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4833/5362 (90.1343%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2943, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 130, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5520/5939 (92.9449%)
___Train Local_ResNet_18,  epoch 130, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5365/5939 (90.3351%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1712, Accuracy: 5227/10000 (52.2700%)
time spent on training: 247.13722157478333
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.2358, Accuracy: 6817/10000 (68.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1014, Accuracy: 9629/9900 (97.2626%)
Done in 273.4715347290039 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 44, 96, 65, 90, 49, 43, 69, 8, 56, 63, 2, 72, 42, 7, 64, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5167/5308 (97.3436%), train_poison_data_count: 415
Global model norm: 43.71589072136698.
Norm before scaling: 43.68283348646525. Distance: 1.2724546606534077
Total norm for 4 adversaries is: 43.68283348646525. distance: 1.2724546606534077
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1145, Accuracy: 9627/9900 (97.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5637/5777 (97.5766%), train_poison_data_count: 455
Global model norm: 43.71589072136698.
Norm before scaling: 43.67510330196713. Distance: 1.2934152345107277
Total norm for 4 adversaries is: 43.67510330196713. distance: 1.2934152345107277
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0634, Accuracy: 9730/9900 (98.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4974/5123 (97.0915%), train_poison_data_count: 403
Global model norm: 43.71589072136698.
Norm before scaling: 43.6838311004126. Distance: 1.298087506916773
Total norm for 4 adversaries is: 43.6838311004126. distance: 1.298087506916773
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0753, Accuracy: 9687/9900 (97.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5361/5503 (97.4196%), train_poison_data_count: 430
Global model norm: 43.71589072136698.
Norm before scaling: 43.68117773235902. Distance: 1.3132597677004472
Total norm for 4 adversaries is: 43.68117773235902. distance: 1.3132597677004472
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0570, Accuracy: 9752/9900 (98.5051%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4750/5075 (93.5961%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4583/5075 (90.3054%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1019, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 131, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4678/5086 (91.9780%)
___Train Local_ResNet_18,  epoch 131, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4608/5086 (90.6017%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1605, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5027/5497 (91.4499%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4957/5497 (90.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9876, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 131, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4426/4748 (93.2182%)
___Train Local_ResNet_18,  epoch 131, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4315/4748 (90.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1610, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 131, local model 49, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5110/5652 (90.4105%)
___Train Local_ResNet_18,  epoch 131, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4939/5652 (87.3850%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2678, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch 131, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4601/4979 (92.4081%)
___Train Local_ResNet_18,  epoch 131, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4596/4979 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0382, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 131, local model 69, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4045/4364 (92.6902%)
___Train Local_ResNet_18,  epoch 131, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3999/4364 (91.6361%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1842, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 131, local model 8, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4503/4889 (92.1047%)
___Train Local_ResNet_18,  epoch 131, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4485/4889 (91.7366%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9832, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 131, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4964/5427 (91.4686%)
___Train Local_ResNet_18,  epoch 131, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4886/5427 (90.0313%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1384, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 131, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3648/3910 (93.2992%)
___Train Local_ResNet_18,  epoch 131, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3591/3910 (91.8414%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0638, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 131, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3699/3968 (93.2208%)
___Train Local_ResNet_18,  epoch 131, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3670/3968 (92.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8684, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 131, local model 72, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4800/5193 (92.4321%)
___Train Local_ResNet_18,  epoch 131, local model 72, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4565/5193 (87.9068%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2937, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch 131, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5403/5907 (91.4678%)
___Train Local_ResNet_18,  epoch 131, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5327/5907 (90.1811%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2302, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4483/4869 (92.0723%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4032/4869 (82.8096%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.4907, Accuracy: 4807/10000 (48.0700%)
___Train Local_ResNet_18,  epoch 131, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4443/4894 (90.7846%)
___Train Local_ResNet_18,  epoch 131, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4315/4894 (88.1692%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1000, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5186/5727 (90.5535%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5057/5727 (88.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1081, Accuracy: 5306/10000 (53.0600%)
time spent on training: 245.37374997138977
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.2366, Accuracy: 6826/10000 (68.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1027, Accuracy: 9624/9900 (97.2121%)
Done in 271.71737360954285 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 66, 50, 48, 43, 31, 92, 4, 61, 56, 47, 18, 87, 89, 21, 97, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5164/5308 (97.2871%), train_poison_data_count: 415
Global model norm: 43.73728749457164.
Norm before scaling: 43.703928029358096. Distance: 1.2751757687604584
Total norm for 4 adversaries is: 43.703928029358096. distance: 1.2751757687604584
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0426, Accuracy: 9789/9900 (98.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5628/5777 (97.4208%), train_poison_data_count: 455
Global model norm: 43.73728749457164.
Norm before scaling: 43.696954449080316. Distance: 1.2906259476702076
Total norm for 4 adversaries is: 43.696954449080316. distance: 1.2906259476702076
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0853, Accuracy: 9684/9900 (97.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4954/5123 (96.7012%), train_poison_data_count: 403
Global model norm: 43.73728749457164.
Norm before scaling: 43.70409561623273. Distance: 1.2884169378127175
Total norm for 4 adversaries is: 43.70409561623273. distance: 1.2884169378127175
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0440, Accuracy: 9787/9900 (98.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5369/5503 (97.5650%), train_poison_data_count: 430
Global model norm: 43.73728749457164.
Norm before scaling: 43.70350905936001. Distance: 1.3179934297522338
Total norm for 4 adversaries is: 43.70350905936001. distance: 1.3179934297522338
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0409, Accuracy: 9797/9900 (98.9596%)
___Train Local_ResNet_18,  epoch 132, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4515/4843 (93.2273%)
___Train Local_ResNet_18,  epoch 132, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4432/4843 (91.5135%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0771, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4446/4757 (93.4623%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4372/4757 (91.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8882, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 132, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4515/4830 (93.4783%)
___Train Local_ResNet_18,  epoch 132, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4501/4830 (93.1884%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1014, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 132, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4592/4979 (92.2274%)
___Train Local_ResNet_18,  epoch 132, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4587/4979 (92.1269%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9867, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 132, local model 31, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4211/4537 (92.8146%)
___Train Local_ResNet_18,  epoch 132, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4227/4537 (93.1673%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9269, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 132, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6331/6812 (92.9389%)
___Train Local_ResNet_18,  epoch 132, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6262/6812 (91.9260%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1905, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 132, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3763/4028 (93.4211%)
___Train Local_ResNet_18,  epoch 132, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3751/4028 (93.1231%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9757, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 132, local model 61, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4163/4485 (92.8205%)
___Train Local_ResNet_18,  epoch 132, local model 61, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3955/4485 (88.1828%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2194, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 132, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4977/5427 (91.7081%)
___Train Local_ResNet_18,  epoch 132, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4920/5427 (90.6578%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0846, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 132, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4634/5123 (90.4548%)
___Train Local_ResNet_18,  epoch 132, local model 47, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4256/5123 (83.0763%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3092, Accuracy: 4946/10000 (49.4600%)
___Train Local_ResNet_18,  epoch 132, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3982/4249 (93.7162%)
___Train Local_ResNet_18,  epoch 132, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3887/4249 (91.4803%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1099, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 132, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3629/3995 (90.8385%)
___Train Local_ResNet_18,  epoch 132, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3554/3995 (88.9612%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0860, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 132, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4399/4737 (92.8647%)
___Train Local_ResNet_18,  epoch 132, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4303/4737 (90.8381%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0575, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 132, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4699/5038 (93.2711%)
___Train Local_ResNet_18,  epoch 132, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4626/5038 (91.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9320, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 132, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4324/4736 (91.3007%)
___Train Local_ResNet_18,  epoch 132, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4256/4736 (89.8649%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1267, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5496/5871 (93.6127%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5408/5871 (92.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0510, Accuracy: 5491/10000 (54.9100%)
time spent on training: 244.90940380096436
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.2379, Accuracy: 6819/10000 (68.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0940, Accuracy: 9648/9900 (97.4545%)
Done in 271.30661392211914 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 14, 60, 82, 89, 72, 33, 79, 92, 81, 56, 75, 19, 78, 66, 16, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5203/5308 (98.0219%), train_poison_data_count: 415
Global model norm: 43.75729570865155.
Norm before scaling: 43.7203219651271. Distance: 1.1826011599928072
Total norm for 4 adversaries is: 43.7203219651271. distance: 1.1826011599928072
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0740, Accuracy: 9698/9900 (97.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5617/5777 (97.2304%), train_poison_data_count: 455
Global model norm: 43.75729570865155.
Norm before scaling: 43.72006090556071. Distance: 1.379258453948937
Total norm for 4 adversaries is: 43.72006090556071. distance: 1.379258453948937
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0508, Accuracy: 9775/9900 (98.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4956/5123 (96.7402%), train_poison_data_count: 403
Global model norm: 43.75729570865155.
Norm before scaling: 43.72582898147487. Distance: 1.3185331102972477
Total norm for 4 adversaries is: 43.72582898147487. distance: 1.3185331102972477
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0528, Accuracy: 9769/9900 (98.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5347/5503 (97.1652%), train_poison_data_count: 430
Global model norm: 43.75729570865155.
Norm before scaling: 43.72175427490301. Distance: 1.2723069584532758
Total norm for 4 adversaries is: 43.72175427490301. distance: 1.2723069584532758
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0159, Accuracy: 9858/9900 (99.5758%)
___Train Local_ResNet_18,  epoch 133, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3975/4196 (94.7331%)
___Train Local_ResNet_18,  epoch 133, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3979/4196 (94.8284%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8737, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 133, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3827/4145 (92.3281%)
___Train Local_ResNet_18,  epoch 133, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3808/4145 (91.8697%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9547, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 133, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5003/5298 (94.4319%)
___Train Local_ResNet_18,  epoch 133, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4942/5298 (93.2805%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1385, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 133, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4346/4737 (91.7458%)
___Train Local_ResNet_18,  epoch 133, local model 89, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4355/4737 (91.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0758, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 133, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4715/5193 (90.7953%)
___Train Local_ResNet_18,  epoch 133, local model 72, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4460/5193 (85.8848%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.3482, Accuracy: 5019/10000 (50.1900%)
___Train Local_ResNet_18,  epoch 133, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4490/4818 (93.1922%)
___Train Local_ResNet_18,  epoch 133, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4340/4818 (90.0789%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1568, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 133, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3862/4111 (93.9431%)
___Train Local_ResNet_18,  epoch 133, local model 79, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3868/4111 (94.0890%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9963, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 133, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6333/6812 (92.9683%)
___Train Local_ResNet_18,  epoch 133, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6289/6812 (92.3224%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1671, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 133, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4707/5035 (93.4856%)
___Train Local_ResNet_18,  epoch 133, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4675/5035 (92.8500%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0892, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 133, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4978/5427 (91.7266%)
___Train Local_ResNet_18,  epoch 133, local model 56, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4801/5427 (88.4651%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2224, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch 133, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4342/4672 (92.9366%)
___Train Local_ResNet_18,  epoch 133, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4365/4672 (93.4289%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9210, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 133, local model 19, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4906/5361 (91.5128%)
___Train Local_ResNet_18,  epoch 133, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4806/5361 (89.6475%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0640, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4137/4368 (94.7115%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4123/4368 (94.3910%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8905, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 133, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4486/4843 (92.6285%)
___Train Local_ResNet_18,  epoch 133, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4434/4843 (91.5548%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0579, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 133, local model 16, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4971/5353 (92.8638%)
___Train Local_ResNet_18,  epoch 133, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4761/5353 (88.9408%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0917, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 133, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4448/4714 (94.3572%)
___Train Local_ResNet_18,  epoch 133, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4418/4714 (93.7208%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8479, Accuracy: 5730/10000 (57.3000%)
time spent on training: 244.43150734901428
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.2504, Accuracy: 6791/10000 (67.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0832, Accuracy: 9674/9900 (97.7172%)
Done in 270.47753381729126 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 23, 49, 30, 9, 15, 85, 92, 17, 70, 56, 51, 53, 43, 46, 64, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5181/5308 (97.6074%), train_poison_data_count: 415
Global model norm: 43.77595491266438.
Norm before scaling: 43.73876808946927. Distance: 1.2055067786932356
Total norm for 4 adversaries is: 43.73876808946927. distance: 1.2055067786932356
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0440, Accuracy: 9777/9900 (98.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5637/5777 (97.5766%), train_poison_data_count: 455
Global model norm: 43.77595491266438.
Norm before scaling: 43.736366458321186. Distance: 1.2967856043143076
Total norm for 4 adversaries is: 43.736366458321186. distance: 1.2967856043143076
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0860, Accuracy: 9689/9900 (97.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4973/5123 (97.0720%), train_poison_data_count: 403
Global model norm: 43.77595491266438.
Norm before scaling: 43.742273313230704. Distance: 1.2712104842234369
Total norm for 4 adversaries is: 43.742273313230704. distance: 1.2712104842234369
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1577, Accuracy: 9462/9900 (95.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5347/5503 (97.1652%), train_poison_data_count: 430
Global model norm: 43.77595491266438.
Norm before scaling: 43.74097284101172. Distance: 1.3364213212384475
Total norm for 4 adversaries is: 43.74097284101172. distance: 1.3364213212384475
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0329, Accuracy: 9821/9900 (99.2020%)
___Train Local_ResNet_18,  epoch 134, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4289/4549 (94.2845%)
___Train Local_ResNet_18,  epoch 134, local model 23, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3962/4549 (87.0961%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1276, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch 134, local model 49, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5108/5652 (90.3751%)
___Train Local_ResNet_18,  epoch 134, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4933/5652 (87.2788%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1989, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 134, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3551/3774 (94.0911%)
___Train Local_ResNet_18,  epoch 134, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3586/3774 (95.0185%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8091, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 134, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5224/5727 (91.2170%)
___Train Local_ResNet_18,  epoch 134, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5109/5727 (89.2090%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2333, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5574/6068 (91.8589%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5466/6068 (90.0791%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1716, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 134, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6280/6947 (90.3987%)
___Train Local_ResNet_18,  epoch 134, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 6129/6947 (88.2251%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1867, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 134, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 6338/6812 (93.0417%)
___Train Local_ResNet_18,  epoch 134, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6196/6812 (90.9571%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1695, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 134, local model 17, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4461/4903 (90.9851%)
___Train Local_ResNet_18,  epoch 134, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4464/4903 (91.0463%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1354, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 134, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5471/5871 (93.1869%)
___Train Local_ResNet_18,  epoch 134, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5336/5871 (90.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2112, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 134, local model 56, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4943/5427 (91.0816%)
___Train Local_ResNet_18,  epoch 134, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4924/5427 (90.7315%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0662, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 134, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3844/4108 (93.5735%)
___Train Local_ResNet_18,  epoch 134, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3860/4108 (93.9630%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8821, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 134, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5918/6664 (88.8055%)
___Train Local_ResNet_18,  epoch 134, local model 53, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5671/6664 (85.0990%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1873, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 134, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4611/4979 (92.6090%)
___Train Local_ResNet_18,  epoch 134, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4583/4979 (92.0466%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1083, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 134, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4874/5399 (90.2760%)
___Train Local_ResNet_18,  epoch 134, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4750/5399 (87.9793%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2175, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 134, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4461/4894 (91.1524%)
___Train Local_ResNet_18,  epoch 134, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4311/4894 (88.0875%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1960, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 134, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3714/3968 (93.5988%)
___Train Local_ResNet_18,  epoch 134, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3698/3968 (93.1956%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8472, Accuracy: 5713/10000 (57.1300%)
time spent on training: 252.65254521369934
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.2520, Accuracy: 6796/10000 (67.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0904, Accuracy: 9653/9900 (97.5051%)
Done in 278.99963092803955 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 49, 57, 40, 46, 85, 37, 51, 30, 8, 73, 21, 28, 82, 80, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5169/5308 (97.3813%), train_poison_data_count: 415
Global model norm: 43.79852638030117.
Norm before scaling: 43.7624061651022. Distance: 1.2658688345663203
Total norm for 4 adversaries is: 43.7624061651022. distance: 1.2658688345663203
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0416, Accuracy: 9792/9900 (98.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5630/5777 (97.4554%), train_poison_data_count: 455
Global model norm: 43.79852638030117.
Norm before scaling: 43.75956368683879. Distance: 1.3230526271049672
Total norm for 4 adversaries is: 43.75956368683879. distance: 1.3230526271049672
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0392, Accuracy: 9800/9900 (98.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4944/5123 (96.5060%), train_poison_data_count: 403
Global model norm: 43.79852638030117.
Norm before scaling: 43.76674484242074. Distance: 1.3257934300004235
Total norm for 4 adversaries is: 43.76674484242074. distance: 1.3257934300004235
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.2081, Accuracy: 9395/9900 (94.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5341/5503 (97.0562%), train_poison_data_count: 430
Global model norm: 43.79852638030117.
Norm before scaling: 43.766067083183145. Distance: 1.3679134948132858
Total norm for 4 adversaries is: 43.766067083183145. distance: 1.3679134948132858
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0143, Accuracy: 9864/9900 (99.6364%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 6333/6812 (92.9683%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6187/6812 (90.8250%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1549, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5142/5652 (90.9766%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5096/5652 (90.1628%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1948, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 135, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4599/4956 (92.7966%)
___Train Local_ResNet_18,  epoch 135, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4549/4956 (91.7877%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0942, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 135, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5509/5939 (92.7597%)
___Train Local_ResNet_18,  epoch 135, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5458/5939 (91.9010%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0370, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4835/5399 (89.5536%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4722/5399 (87.4606%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1073, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 135, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6257/6947 (90.0677%)
___Train Local_ResNet_18,  epoch 135, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 6000/6947 (86.3682%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1972, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 135, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4398/4741 (92.7652%)
___Train Local_ResNet_18,  epoch 135, local model 37, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4239/4741 (89.4115%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3016, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 135, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3858/4108 (93.9143%)
___Train Local_ResNet_18,  epoch 135, local model 51, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3790/4108 (92.2590%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0505, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 135, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3535/3774 (93.6672%)
___Train Local_ResNet_18,  epoch 135, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3569/3774 (94.5681%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8626, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 135, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4540/4889 (92.8615%)
___Train Local_ResNet_18,  epoch 135, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4478/4889 (91.5934%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0975, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 135, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4361/4605 (94.7014%)
___Train Local_ResNet_18,  epoch 135, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4311/4605 (93.6156%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9940, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 135, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4685/5038 (92.9933%)
___Train Local_ResNet_18,  epoch 135, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4650/5038 (92.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9290, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4639/5122 (90.5701%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4367/5122 (85.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.4448, Accuracy: 4797/10000 (47.9700%)
___Train Local_ResNet_18,  epoch 135, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4967/5298 (93.7524%)
___Train Local_ResNet_18,  epoch 135, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4926/5298 (92.9785%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9629, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 135, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5058/5461 (92.6204%)
___Train Local_ResNet_18,  epoch 135, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5006/5461 (91.6682%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2122, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4513/4830 (93.4369%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4489/4830 (92.9400%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1781, Accuracy: 5303/10000 (53.0300%)
time spent on training: 249.23106360435486
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.2609, Accuracy: 6778/10000 (67.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0820, Accuracy: 9686/9900 (97.8384%)
Done in 275.6933159828186 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 32, 67, 70, 18, 87, 0, 98, 29, 99, 28, 40, 75, 92, 80, 64, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5152/5308 (97.0610%), train_poison_data_count: 415
Global model norm: 43.81826147923375.
Norm before scaling: 43.78493164614754. Distance: 1.3184531849581191
Total norm for 4 adversaries is: 43.78493164614754. distance: 1.3184531849581191
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0413, Accuracy: 9793/9900 (98.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5631/5777 (97.4727%), train_poison_data_count: 455
Global model norm: 43.81826147923375.
Norm before scaling: 43.77992977354535. Distance: 1.3349764306063059
Total norm for 4 adversaries is: 43.77992977354535. distance: 1.3349764306063059
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0409, Accuracy: 9796/9900 (98.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4948/5123 (96.5840%), train_poison_data_count: 403
Global model norm: 43.81826147923375.
Norm before scaling: 43.78469327555436. Distance: 1.2925974148428894
Total norm for 4 adversaries is: 43.78469327555436. distance: 1.2925974148428894
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1823, Accuracy: 9467/9900 (95.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5346/5503 (97.1470%), train_poison_data_count: 430
Global model norm: 43.81826147923375.
Norm before scaling: 43.78376208442606. Distance: 1.3173864773189619
Total norm for 4 adversaries is: 43.78376208442606. distance: 1.3173864773189619
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0429, Accuracy: 9786/9900 (98.8485%)
___Train Local_ResNet_18,  epoch 136, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5395/6080 (88.7336%)
___Train Local_ResNet_18,  epoch 136, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5295/6080 (87.0888%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2494, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5012/5559 (90.1601%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4823/5559 (86.7602%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2189, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 136, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5475/5871 (93.2550%)
___Train Local_ResNet_18,  epoch 136, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5373/5871 (91.5176%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0906, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 136, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3975/4249 (93.5514%)
___Train Local_ResNet_18,  epoch 136, local model 18, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3912/4249 (92.0687%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9958, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 136, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3644/3995 (91.2140%)
___Train Local_ResNet_18,  epoch 136, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3613/3995 (90.4380%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2707, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 136, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5018/5454 (92.0059%)
___Train Local_ResNet_18,  epoch 136, local model 0, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4802/5454 (88.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2717, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 136, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3890/4161 (93.4871%)
___Train Local_ResNet_18,  epoch 136, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3864/4161 (92.8623%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0031, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 136, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4499/4732 (95.0761%)
___Train Local_ResNet_18,  epoch 136, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4472/4732 (94.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8084, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 136, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4421/4851 (91.1358%)
___Train Local_ResNet_18,  epoch 136, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4434/4851 (91.4038%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0327, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4656/5122 (90.9020%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0116, Accuracy: 4060/5122 (79.2659%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.6465, Accuracy: 4510/10000 (45.1000%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5491/5939 (92.4566%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5475/5939 (92.1872%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1412, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 136, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4424/4672 (94.6918%)
___Train Local_ResNet_18,  epoch 136, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4355/4672 (93.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9451, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6380/6812 (93.6583%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6221/6812 (91.3241%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1646, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 136, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5081/5461 (93.0416%)
___Train Local_ResNet_18,  epoch 136, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5037/5461 (92.2359%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0653, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 136, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4474/4894 (91.4181%)
___Train Local_ResNet_18,  epoch 136, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4320/4894 (88.2714%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1988, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 136, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3871/4175 (92.7186%)
___Train Local_ResNet_18,  epoch 136, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3817/4175 (91.4251%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9488, Accuracy: 5627/10000 (56.2700%)
time spent on training: 249.75388050079346
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.2713, Accuracy: 6743/10000 (67.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0800, Accuracy: 9684/9900 (97.8182%)
Done in 275.93826627731323 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 94, 74, 82, 63, 27, 55, 92, 11, 34, 79, 60, 59, 43, 16, 78, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5190/5308 (97.7769%), train_poison_data_count: 415
Global model norm: 43.838870396226994.
Norm before scaling: 43.80054975887503. Distance: 1.189070917367905
Total norm for 4 adversaries is: 43.80054975887503. distance: 1.189070917367905
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0589, Accuracy: 9732/9900 (98.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5638/5777 (97.5939%), train_poison_data_count: 455
Global model norm: 43.838870396226994.
Norm before scaling: 43.79912699347585. Distance: 1.2999747127127617
Total norm for 4 adversaries is: 43.79912699347585. distance: 1.2999747127127617
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0728, Accuracy: 9720/9900 (98.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4953/5123 (96.6816%), train_poison_data_count: 403
Global model norm: 43.838870396226994.
Norm before scaling: 43.80625150476171. Distance: 1.319055082638764
Total norm for 4 adversaries is: 43.80625150476171. distance: 1.319055082638764
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0500, Accuracy: 9766/9900 (98.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5354/5503 (97.2924%), train_poison_data_count: 430
Global model norm: 43.838870396226994.
Norm before scaling: 43.805499117458844. Distance: 1.3498137522191467
Total norm for 4 adversaries is: 43.805499117458844. distance: 1.3498137522191467
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0746, Accuracy: 9709/9900 (98.0707%)
___Train Local_ResNet_18,  epoch 137, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4787/5224 (91.6348%)
___Train Local_ResNet_18,  epoch 137, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4716/5224 (90.2757%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2624, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 137, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4365/4797 (90.9944%)
___Train Local_ResNet_18,  epoch 137, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4332/4797 (90.3064%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0878, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 137, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5019/5298 (94.7339%)
___Train Local_ResNet_18,  epoch 137, local model 82, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4959/5298 (93.6014%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9175, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 137, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3671/3910 (93.8875%)
___Train Local_ResNet_18,  epoch 137, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3431/3910 (87.7494%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2379, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4221/4587 (92.0209%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4226/4587 (92.1299%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0719, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 137, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4419/4731 (93.4052%)
___Train Local_ResNet_18,  epoch 137, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4402/4731 (93.0459%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0390, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 137, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 6424/6812 (94.3042%)
___Train Local_ResNet_18,  epoch 137, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6226/6812 (91.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0321, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 137, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5001/5702 (87.7061%)
___Train Local_ResNet_18,  epoch 137, local model 11, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4768/5702 (83.6198%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1820, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 137, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4564/4911 (92.9342%)
___Train Local_ResNet_18,  epoch 137, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4567/4911 (92.9953%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0710, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 137, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3806/4111 (92.5809%)
___Train Local_ResNet_18,  epoch 137, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3755/4111 (91.3403%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0277, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 137, local model 60, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3848/4145 (92.8347%)
___Train Local_ResNet_18,  epoch 137, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3882/4145 (93.6550%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0375, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 137, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4208/4397 (95.7016%)
___Train Local_ResNet_18,  epoch 137, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4197/4397 (95.4514%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7839, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch 137, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4586/4979 (92.1068%)
___Train Local_ResNet_18,  epoch 137, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4564/4979 (91.6650%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0873, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 137, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5007/5353 (93.5363%)
___Train Local_ResNet_18,  epoch 137, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4822/5353 (90.0803%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1928, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4130/4368 (94.5513%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4096/4368 (93.7729%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9712, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 137, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5031/5346 (94.1077%)
___Train Local_ResNet_18,  epoch 137, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4950/5346 (92.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1275, Accuracy: 5358/10000 (53.5800%)
time spent on training: 243.24593043327332
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.2712, Accuracy: 6748/10000 (67.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0770, Accuracy: 9698/9900 (97.9596%)
Done in 269.88343715667725 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 45, 90, 54, 95, 30, 48, 61, 73, 15, 85, 88, 94, 78, 18, 0, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5196/5308 (97.8900%), train_poison_data_count: 415
Global model norm: 43.85756865268525.
Norm before scaling: 43.81952205005564. Distance: 1.1888012031253872
Total norm for 4 adversaries is: 43.81952205005564. distance: 1.1888012031253872
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1096, Accuracy: 9609/9900 (97.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5634/5777 (97.5247%), train_poison_data_count: 455
Global model norm: 43.85756865268525.
Norm before scaling: 43.817432686392785. Distance: 1.3050081692728581
Total norm for 4 adversaries is: 43.817432686392785. distance: 1.3050081692728581
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0897, Accuracy: 9648/9900 (97.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4955/5123 (96.7207%), train_poison_data_count: 403
Global model norm: 43.85756865268525.
Norm before scaling: 43.82525196688477. Distance: 1.3160292994127607
Total norm for 4 adversaries is: 43.82525196688477. distance: 1.3160292994127607
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1538, Accuracy: 9522/9900 (96.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5347/5503 (97.1652%), train_poison_data_count: 430
Global model norm: 43.85756865268525.
Norm before scaling: 43.823866214655226. Distance: 1.3569327591560272
Total norm for 4 adversaries is: 43.823866214655226. distance: 1.3569327591560272
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0683, Accuracy: 9727/9900 (98.2525%)
___Train Local_ResNet_18,  epoch 138, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5028/5489 (91.6014%)
___Train Local_ResNet_18,  epoch 138, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4999/5489 (91.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1426, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 138, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4483/4748 (94.4187%)
___Train Local_ResNet_18,  epoch 138, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4422/4748 (93.1340%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0370, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 138, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5091/5645 (90.1860%)
___Train Local_ResNet_18,  epoch 138, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4901/5645 (86.8202%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.3279, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch 138, local model 95, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4571/5018 (91.0921%)
___Train Local_ResNet_18,  epoch 138, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4490/5018 (89.4779%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2315, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3549/3774 (94.0382%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3541/3774 (93.8262%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0325, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 138, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4546/4830 (94.1201%)
___Train Local_ResNet_18,  epoch 138, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4493/4830 (93.0228%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0502, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 138, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4150/4485 (92.5307%)
___Train Local_ResNet_18,  epoch 138, local model 61, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3752/4485 (83.6566%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.4093, Accuracy: 4837/10000 (48.3700%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4324/4605 (93.8979%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4247/4605 (92.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9144, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 138, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5613/6068 (92.5016%)
___Train Local_ResNet_18,  epoch 138, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5526/6068 (91.0679%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1833, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 138, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6340/6947 (91.2624%)
___Train Local_ResNet_18,  epoch 138, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 6097/6947 (87.7645%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.4134, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 138, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4929/5362 (91.9247%)
___Train Local_ResNet_18,  epoch 138, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4847/5362 (90.3954%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0753, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 138, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4769/5224 (91.2902%)
___Train Local_ResNet_18,  epoch 138, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4709/5224 (90.1417%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1552, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4163/4368 (95.3068%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4100/4368 (93.8645%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9996, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 138, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4000/4249 (94.1398%)
___Train Local_ResNet_18,  epoch 138, local model 18, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3913/4249 (92.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9225, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 138, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4971/5454 (91.1441%)
___Train Local_ResNet_18,  epoch 138, local model 0, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4822/5454 (88.4122%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2089, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 138, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5507/5939 (92.7260%)
___Train Local_ResNet_18,  epoch 138, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5456/5939 (91.8673%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0206, Accuracy: 5407/10000 (54.0700%)
time spent on training: 249.4114236831665
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.2780, Accuracy: 6747/10000 (67.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0813, Accuracy: 9683/9900 (97.8081%)
Done in 275.9599771499634 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 59, 30, 64, 19, 12, 82, 16, 74, 70, 85, 50, 67, 57, 72, 18, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5170/5308 (97.4002%), train_poison_data_count: 415
Global model norm: 43.87807147368717.
Norm before scaling: 43.84551376308. Distance: 1.3131187887648579
Total norm for 4 adversaries is: 43.84551376308. distance: 1.3131187887648579
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0532, Accuracy: 9766/9900 (98.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5638/5777 (97.5939%), train_poison_data_count: 455
Global model norm: 43.87807147368717.
Norm before scaling: 43.83775518085837. Distance: 1.3192790574717161
Total norm for 4 adversaries is: 43.83775518085837. distance: 1.3192790574717161
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0228, Accuracy: 9834/9900 (99.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4979/5123 (97.1891%), train_poison_data_count: 403
Global model norm: 43.87807147368717.
Norm before scaling: 43.84327946557916. Distance: 1.2498493580645265
Total norm for 4 adversaries is: 43.84327946557916. distance: 1.2498493580645265
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0821, Accuracy: 9696/9900 (97.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5352/5503 (97.2560%), train_poison_data_count: 430
Global model norm: 43.87807147368717.
Norm before scaling: 43.84481355623775. Distance: 1.3725335801816276
Total norm for 4 adversaries is: 43.84481355623775. distance: 1.3725335801816276
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0478, Accuracy: 9777/9900 (98.7576%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4157/4397 (94.5417%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4197/4397 (95.4514%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7745, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 139, local model 30, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3581/3774 (94.8861%)
___Train Local_ResNet_18,  epoch 139, local model 30, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3619/3774 (95.8930%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7266, Accuracy: 5979/10000 (59.7900%)
___Train Local_ResNet_18,  epoch 139, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4450/4894 (90.9277%)
___Train Local_ResNet_18,  epoch 139, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4286/4894 (87.5766%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3632, Accuracy: 4980/10000 (49.8000%)
___Train Local_ResNet_18,  epoch 139, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4845/5361 (90.3749%)
___Train Local_ResNet_18,  epoch 139, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4788/5361 (89.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1134, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 139, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5067/5526 (91.6938%)
___Train Local_ResNet_18,  epoch 139, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4872/5526 (88.1650%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2118, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 139, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5007/5298 (94.5074%)
___Train Local_ResNet_18,  epoch 139, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4957/5298 (93.5636%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1434, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 139, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4923/5353 (91.9671%)
___Train Local_ResNet_18,  epoch 139, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4787/5353 (89.4265%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1252, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 139, local model 74, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4399/4797 (91.7031%)
___Train Local_ResNet_18,  epoch 139, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4311/4797 (89.8687%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2727, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch 139, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5469/5871 (93.1528%)
___Train Local_ResNet_18,  epoch 139, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5321/5871 (90.6319%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2890, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 139, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6350/6947 (91.4064%)
___Train Local_ResNet_18,  epoch 139, local model 85, internal_epoch   2,  Average loss: 0.0059, Accuracy: 6129/6947 (88.2251%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2008, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 139, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4422/4757 (92.9577%)
___Train Local_ResNet_18,  epoch 139, local model 50, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4413/4757 (92.7686%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8818, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 139, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5059/5559 (91.0056%)
___Train Local_ResNet_18,  epoch 139, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4931/5559 (88.7030%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2553, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4603/4956 (92.8773%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4544/4956 (91.6868%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1751, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 139, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4755/5193 (91.5656%)
___Train Local_ResNet_18,  epoch 139, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4541/5193 (87.4446%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.4324, Accuracy: 4917/10000 (49.1700%)
___Train Local_ResNet_18,  epoch 139, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3977/4249 (93.5985%)
___Train Local_ResNet_18,  epoch 139, local model 18, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3922/4249 (92.3041%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9978, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 139, local model 46, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4849/5399 (89.8129%)
___Train Local_ResNet_18,  epoch 139, local model 46, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4679/5399 (86.6642%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1703, Accuracy: 5174/10000 (51.7400%)
time spent on training: 249.07566475868225
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.2845, Accuracy: 6722/10000 (67.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0791, Accuracy: 9690/9900 (97.8788%)
Done in 275.23074555397034 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 18, 76, 66, 22, 96, 54, 1, 88, 32, 97, 26, 2, 77, 68, 42, 5].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5187/5308 (97.7204%), train_poison_data_count: 415
Global model norm: 43.899329414546585.
Norm before scaling: 43.863706868816244. Distance: 1.28694061423275
Total norm for 4 adversaries is: 43.863706868816244. distance: 1.28694061423275
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0161, Accuracy: 9849/9900 (99.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5638/5777 (97.5939%), train_poison_data_count: 455
Global model norm: 43.899329414546585.
Norm before scaling: 43.85958791585299. Distance: 1.3334409352435537
Total norm for 4 adversaries is: 43.85958791585299. distance: 1.3334409352435537
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0241, Accuracy: 9834/9900 (99.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4937/5123 (96.3693%), train_poison_data_count: 403
Global model norm: 43.899329414546585.
Norm before scaling: 43.86799656978735. Distance: 1.3564522552861829
Total norm for 4 adversaries is: 43.86799656978735. distance: 1.3564522552861829
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0468, Accuracy: 9777/9900 (98.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5355/5503 (97.3106%), train_poison_data_count: 430
Global model norm: 43.899329414546585.
Norm before scaling: 43.86460296816429. Distance: 1.3479206655090228
Total norm for 4 adversaries is: 43.86460296816429. distance: 1.3479206655090228
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0364, Accuracy: 9809/9900 (99.0808%)
___Train Local_ResNet_18,  epoch 140, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4025/4249 (94.7282%)
___Train Local_ResNet_18,  epoch 140, local model 18, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3963/4249 (93.2690%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8867, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3610/3959 (91.1846%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3644/3959 (92.0434%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0007, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 140, local model 66, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4533/4843 (93.5990%)
___Train Local_ResNet_18,  epoch 140, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4487/4843 (92.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9425, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 140, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5319/5696 (93.3813%)
___Train Local_ResNet_18,  epoch 140, local model 22, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5290/5696 (92.8722%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9726, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4694/5086 (92.2926%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4654/5086 (91.5061%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0878, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 140, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5090/5645 (90.1683%)
___Train Local_ResNet_18,  epoch 140, local model 54, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4804/5645 (85.1019%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2457, Accuracy: 5036/10000 (50.3600%)
___Train Local_ResNet_18,  epoch 140, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5131/5422 (94.6330%)
___Train Local_ResNet_18,  epoch 140, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5018/5422 (92.5489%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9303, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 140, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4953/5362 (92.3722%)
___Train Local_ResNet_18,  epoch 140, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4832/5362 (90.1156%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0562, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 140, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5497/6080 (90.4112%)
___Train Local_ResNet_18,  epoch 140, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5344/6080 (87.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2509, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch 140, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4316/4736 (91.1318%)
___Train Local_ResNet_18,  epoch 140, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4285/4736 (90.4772%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0110, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 140, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3867/4086 (94.6402%)
___Train Local_ResNet_18,  epoch 140, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3866/4086 (94.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8416, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 140, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3711/3968 (93.5232%)
___Train Local_ResNet_18,  epoch 140, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3679/3968 (92.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8964, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 140, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4549/5050 (90.0792%)
___Train Local_ResNet_18,  epoch 140, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4524/5050 (89.5842%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0572, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 140, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3333/3589 (92.8671%)
___Train Local_ResNet_18,  epoch 140, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3302/3589 (92.0033%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9974, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 140, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5355/5907 (90.6552%)
___Train Local_ResNet_18,  epoch 140, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5390/5907 (91.2477%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1880, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch 140, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4694/4993 (94.0116%)
___Train Local_ResNet_18,  epoch 140, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4688/4993 (93.8914%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9479, Accuracy: 5783/10000 (57.8300%)
time spent on training: 245.26745629310608
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.2917, Accuracy: 6715/10000 (67.1500%)
