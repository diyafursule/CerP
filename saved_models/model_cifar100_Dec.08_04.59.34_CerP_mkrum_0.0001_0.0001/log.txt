current path: saved_models/model_cifar100_Dec.08_04.59.34_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4311/4885 (88.2497%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.439894596008514. Distance: 2.292863625711224
Total norm for 4 adversaries is: 42.439894596008514. distance: 2.292863625711224
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4465, Accuracy: 8819/9900 (89.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.435300879600085. Distance: 2.2508747731527143
Total norm for 4 adversaries is: 42.435300879600085. distance: 2.2508747731527143
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7271, Accuracy: 8316/9900 (84.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4179/4717 (88.5944%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43869659579568. Distance: 2.177758241531215
Total norm for 4 adversaries is: 42.43869659579568. distance: 2.177758241531215
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4263, Accuracy: 8886/9900 (89.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4451/5066 (87.8602%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44025700957833. Distance: 2.303192274335205
Total norm for 4 adversaries is: 42.44025700957833. distance: 2.303192274335205
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6065, Accuracy: 8503/9900 (85.8889%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3837/4356 (88.0854%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3693/4356 (84.7796%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.3856, Accuracy: 4737/10000 (47.3700%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3938/4465 (88.1971%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4087/4465 (91.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0003, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4048/4647 (87.1100%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4152/4647 (89.3480%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9707, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4449/5055 (88.0119%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4508/5055 (89.1790%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1480, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4439/5116 (86.7670%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4453/5116 (87.0407%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9795, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3633/4126 (88.0514%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3749/4126 (90.8628%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9487, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3084/3472 (88.8249%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3222/3472 (92.7995%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0421, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4426/4986 (88.7686%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4443/4986 (89.1095%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0841, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3541/4013 (88.2382%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3669/4013 (91.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8071, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4034/4618 (87.3538%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4065/4618 (88.0251%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0386, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4430/5083 (87.1533%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4432/5083 (87.1926%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0996, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3964/4511 (87.8741%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4018/4511 (89.0712%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2100, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3332/3797 (87.7535%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3395/3797 (89.4127%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9680, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4996/5582 (89.5020%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5060/5582 (90.6485%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1047, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3153/3616 (87.1958%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3218/3616 (88.9934%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0430, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4827/5455 (88.4876%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4849/5455 (88.8909%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9155, Accuracy: 5465/10000 (54.6500%)
time spent on training: 266.165629863739
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1047, Accuracy: 7049/10000 (70.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.0715, Accuracy: 115/9900 (1.1616%)
Done in 295.8847634792328 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4400/4885 (90.0716%), train_poison_data_count: 385
Global model norm: 42.45481570980052.
Norm before scaling: 42.46076141292835. Distance: 2.111764077657312
Total norm for 4 adversaries is: 42.46076141292835. distance: 2.111764077657312
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2513, Accuracy: 9246/9900 (93.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 42.45481570980052.
Norm before scaling: 42.45828605452062. Distance: 2.16746204400186
Total norm for 4 adversaries is: 42.45828605452062. distance: 2.16746204400186
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.5699, Accuracy: 8515/9900 (86.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4181/4717 (88.6368%), train_poison_data_count: 370
Global model norm: 42.45481570980052.
Norm before scaling: 42.46205365943294. Distance: 2.165328554062823
Total norm for 4 adversaries is: 42.46205365943294. distance: 2.165328554062823
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2360, Accuracy: 9328/9900 (94.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4498/5066 (88.7880%), train_poison_data_count: 400
Global model norm: 42.45481570980052.
Norm before scaling: 42.46482344798751. Distance: 2.2917562525029207
Total norm for 4 adversaries is: 42.46482344798751. distance: 2.2917562525029207
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2801, Accuracy: 9151/9900 (92.4343%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3602/4025 (89.4907%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3718/4025 (92.3727%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9587, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3342/3797 (88.0169%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3394/3797 (89.3864%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0830, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3939/4625 (85.1676%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3999/4625 (86.4649%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1729, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3861/4481 (86.1638%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3867/4481 (86.2977%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1058, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3865/4315 (89.5713%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4007/4315 (92.8621%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9857, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3709/4235 (87.5797%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3836/4235 (90.5785%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9747, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3375/3828 (88.1661%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3487/3828 (91.0920%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9322, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3824/4416 (86.5942%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3984/4416 (90.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8893, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3153/3638 (86.6685%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3294/3638 (90.5443%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9387, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4548/5265 (86.3818%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4548/5265 (86.3818%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0199, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3359/3781 (88.8389%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3326/3781 (87.9661%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1818, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3980/4441 (89.6195%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4017/4441 (90.4526%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1328, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3971/4433 (89.5782%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4039/4433 (91.1121%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9518, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4430/5083 (87.1533%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4393/5083 (86.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1692, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4328/4928 (87.8247%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4405/4928 (89.3872%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0252, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4179/4793 (87.1897%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4342/4793 (90.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0650, Accuracy: 5358/10000 (53.5800%)
time spent on training: 263.8895137310028
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0956, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 8.0911, Accuracy: 223/9900 (2.2525%)
Done in 293.63338565826416 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 42.47730178568535.
Norm before scaling: 42.47768974387099. Distance: 2.015819096645731
Total norm for 4 adversaries is: 42.47768974387099. distance: 2.015819096645731
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2438, Accuracy: 9243/9900 (93.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4790/5305 (90.2922%), train_poison_data_count: 415
Global model norm: 42.47730178568535.
Norm before scaling: 42.47849726028673. Distance: 2.0937944094374927
Total norm for 4 adversaries is: 42.47849726028673. distance: 2.0937944094374927
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0882, Accuracy: 9663/9900 (97.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4258/4717 (90.2692%), train_poison_data_count: 370
Global model norm: 42.47730178568535.
Norm before scaling: 42.47896998074459. Distance: 1.9881098285517103
Total norm for 4 adversaries is: 42.47896998074459. distance: 1.9881098285517103
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2074, Accuracy: 9368/9900 (94.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4509/5066 (89.0051%), train_poison_data_count: 400
Global model norm: 42.47730178568535.
Norm before scaling: 42.48362649901504. Distance: 2.16514180395176
Total norm for 4 adversaries is: 42.48362649901504. distance: 2.16514180395176
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1468, Accuracy: 9522/9900 (96.1818%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3157/3616 (87.3064%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3297/3616 (91.1781%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8330, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3408/3837 (88.8194%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3493/3837 (91.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9146, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4171/4679 (89.1430%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4274/4679 (91.3443%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0606, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3088/3638 (84.8818%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3251/3638 (89.3623%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0325, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3645/4046 (90.0890%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3645/4046 (90.0890%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9753, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4000/4518 (88.5347%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4074/4518 (90.1726%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0691, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3390/3797 (89.2810%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3416/3797 (89.9658%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0639, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4426/5025 (88.0796%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4460/5025 (88.7562%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2923, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3915/4362 (89.7524%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3960/4362 (90.7840%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0780, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3996/4558 (87.6700%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4035/4558 (88.5257%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1137, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3209/3672 (87.3911%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3267/3672 (88.9706%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0707, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4326/4874 (88.7567%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4351/4874 (89.2696%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2072, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3612/4025 (89.7391%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3710/4025 (92.1739%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9214, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4093/4663 (87.7761%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4247/4663 (91.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0944, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3464/3911 (88.5707%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3440/3911 (87.9570%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0442, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4445/5017 (88.5988%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4554/5017 (90.7714%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8597, Accuracy: 5679/10000 (56.7900%)
time spent on training: 262.73256039619446
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0907, Accuracy: 7059/10000 (70.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 7.1182, Accuracy: 419/9900 (4.2323%)
Done in 292.516238451004 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4436/4885 (90.8086%), train_poison_data_count: 385
Global model norm: 42.49765905777193.
Norm before scaling: 42.49969554118888. Distance: 1.9697600906990904
Total norm for 4 adversaries is: 42.49969554118888. distance: 1.9697600906990904
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5308, Accuracy: 8682/9900 (87.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4845/5305 (91.3289%), train_poison_data_count: 415
Global model norm: 42.49765905777193.
Norm before scaling: 42.49558369747452. Distance: 2.0165651479763094
Total norm for 4 adversaries is: 42.49558369747452. distance: 2.0165651479763094
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0765, Accuracy: 9688/9900 (97.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4264/4717 (90.3964%), train_poison_data_count: 370
Global model norm: 42.49765905777193.
Norm before scaling: 42.49923310429407. Distance: 1.9575007745344206
Total norm for 4 adversaries is: 42.49923310429407. distance: 1.9575007745344206
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1384, Accuracy: 9544/9900 (96.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4536/5066 (89.5381%), train_poison_data_count: 400
Global model norm: 42.49765905777193.
Norm before scaling: 42.50345085944125. Distance: 2.118554268857419
Total norm for 4 adversaries is: 42.50345085944125. distance: 2.118554268857419
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3328, Accuracy: 9056/9900 (91.4747%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5256/6124 (85.8263%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5315/6124 (86.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1598, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3879/4356 (89.0496%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3649/4356 (83.7695%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.4190, Accuracy: 4879/10000 (48.7900%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3544/4158 (85.2333%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3619/4158 (87.0370%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1013, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4907/5455 (89.9542%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4911/5455 (90.0275%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9853, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3929/4511 (87.0982%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4087/4511 (90.6008%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9726, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4530/5232 (86.5826%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4542/5232 (86.8119%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0625, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4497/5244 (85.7551%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4539/5244 (86.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1043, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4392/4918 (89.3046%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4378/4918 (89.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0857, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3628/4126 (87.9302%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3731/4126 (90.4266%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8752, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4354/4928 (88.3523%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4386/4928 (89.0016%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0571, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3739/4223 (88.5390%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3821/4223 (90.4807%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9296, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4528/5195 (87.1607%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4615/5195 (88.8354%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1819, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4155/4679 (88.8010%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4102/4679 (87.6683%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0786, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3208/3646 (87.9868%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3294/3646 (90.3456%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8576, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3189/3616 (88.1914%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3218/3616 (88.9934%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9765, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4070/4716 (86.3020%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4081/4716 (86.5352%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0047, Accuracy: 5418/10000 (54.1800%)
time spent on training: 269.28937458992004
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0874, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 6.4497, Accuracy: 695/9900 (7.0202%)
Done in 299.0374891757965 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 42.52260715361447.
Norm before scaling: 42.525464854987916. Distance: 1.9577982421745526
Total norm for 4 adversaries is: 42.525464854987916. distance: 1.9577982421745526
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1755, Accuracy: 9479/9900 (95.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4867/5305 (91.7436%), train_poison_data_count: 415
Global model norm: 42.52260715361447.
Norm before scaling: 42.51763047686439. Distance: 1.9849493442096624
Total norm for 4 adversaries is: 42.51763047686439. distance: 1.9849493442096624
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1285, Accuracy: 9575/9900 (96.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4279/4717 (90.7144%), train_poison_data_count: 370
Global model norm: 42.52260715361447.
Norm before scaling: 42.523301861119336. Distance: 1.917877878806134
Total norm for 4 adversaries is: 42.523301861119336. distance: 1.917877878806134
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2047, Accuracy: 9361/9900 (94.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4561/5066 (90.0316%), train_poison_data_count: 400
Global model norm: 42.52260715361447.
Norm before scaling: 42.53010623691689. Distance: 2.084073952320074
Total norm for 4 adversaries is: 42.53010623691689. distance: 2.084073952320074
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2658, Accuracy: 9237/9900 (93.3030%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5290/6124 (86.3815%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5354/6124 (87.4265%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9790, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3959/4433 (89.3075%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4045/4433 (91.2475%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9973, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3373/3781 (89.2092%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3230/3781 (85.4271%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3965, Accuracy: 4858/10000 (48.5800%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3567/3969 (89.8715%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3591/3969 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0041, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4470/5025 (88.9552%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4539/5025 (90.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1085, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4182/4679 (89.3781%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4247/4679 (90.7673%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0275, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4161/4707 (88.4003%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4232/4707 (89.9086%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0344, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4436/4986 (88.9691%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4455/4986 (89.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9316, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3913/4315 (90.6837%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3958/4315 (91.7265%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8325, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3870/4416 (87.6359%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3934/4416 (89.0851%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0085, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4235/4804 (88.1557%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4126/4804 (85.8868%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1842, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4176/4793 (87.1271%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4245/4793 (88.5667%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0366, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4536/5232 (86.6972%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4546/5232 (86.8884%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0412, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4113/4662 (88.2239%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4190/4662 (89.8756%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0733, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4238/4956 (85.5125%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4305/4956 (86.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.4083, Accuracy: 4816/10000 (48.1600%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3825/4368 (87.5687%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3838/4368 (87.8663%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9653, Accuracy: 5420/10000 (54.2000%)
time spent on training: 269.75499963760376
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0867, Accuracy: 7075/10000 (70.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.7593, Accuracy: 1066/9900 (10.7677%)
Done in 299.69973492622375 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4472/4885 (91.5455%), train_poison_data_count: 385
Global model norm: 42.54690512531067.
Norm before scaling: 42.547367044069986. Distance: 1.9252171183424454
Total norm for 4 adversaries is: 42.547367044069986. distance: 1.9252171183424454
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2857, Accuracy: 9196/9900 (92.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4853/5305 (91.4797%), train_poison_data_count: 415
Global model norm: 42.54690512531067.
Norm before scaling: 42.543700246500215. Distance: 1.953875710219334
Total norm for 4 adversaries is: 42.543700246500215. distance: 1.953875710219334
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2114, Accuracy: 9361/9900 (94.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4316/4717 (91.4988%), train_poison_data_count: 370
Global model norm: 42.54690512531067.
Norm before scaling: 42.54673154584703. Distance: 1.8646091551742012
Total norm for 4 adversaries is: 42.54673154584703. distance: 1.8646091551742012
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2249, Accuracy: 9323/9900 (94.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4614/5066 (91.0778%), train_poison_data_count: 400
Global model norm: 42.54690512531067.
Norm before scaling: 42.55141220528483. Distance: 2.015668528478633
Total norm for 4 adversaries is: 42.55141220528483. distance: 2.015668528478633
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1096, Accuracy: 9612/9900 (97.0909%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5363/6124 (87.5735%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5359/6124 (87.5082%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0769, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5159/5902 (87.4110%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5139/5902 (87.0722%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0986, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4183/4707 (88.8676%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4199/4707 (89.2076%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9947, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4092/4647 (88.0568%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4160/4647 (89.5201%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9322, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2971/3297 (90.1122%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3022/3297 (91.6591%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8155, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5563/6263 (88.8232%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5675/6263 (90.6115%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3005, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4174/4663 (89.5132%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4227/4663 (90.6498%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0985, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4346/4956 (87.6917%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4368/4956 (88.1356%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2395, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3625/4046 (89.5947%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3717/4046 (91.8685%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9465, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3715/4184 (88.7906%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3778/4184 (90.2964%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8289, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4885/5591 (87.3726%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4911/5591 (87.8376%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1309, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4110/4634 (88.6923%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4147/4634 (89.4907%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8985, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3394/3828 (88.6625%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3509/3828 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9563, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3152/3638 (86.6410%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3268/3638 (89.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8926, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3398/3781 (89.8704%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3384/3781 (89.5001%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1761, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3429/3837 (89.3667%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3525/3837 (91.8686%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8530, Accuracy: 5761/10000 (57.6100%)
time spent on training: 262.1389584541321
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0848, Accuracy: 7085/10000 (70.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 5.1817, Accuracy: 1430/9900 (14.4444%)
Done in 292.0129246711731 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4479/4885 (91.6888%), train_poison_data_count: 385
Global model norm: 42.57035479558369.
Norm before scaling: 42.56852242634809. Distance: 1.8537288820449018
Total norm for 4 adversaries is: 42.56852242634809. distance: 1.8537288820449018
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2740, Accuracy: 9239/9900 (93.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4875/5305 (91.8944%), train_poison_data_count: 415
Global model norm: 42.57035479558369.
Norm before scaling: 42.567901582262515. Distance: 1.9405806875775042
Total norm for 4 adversaries is: 42.567901582262515. distance: 1.9405806875775042
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1615, Accuracy: 9517/9900 (96.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4285/4717 (90.8416%), train_poison_data_count: 370
Global model norm: 42.57035479558369.
Norm before scaling: 42.572268805985225. Distance: 1.8861452735662265
Total norm for 4 adversaries is: 42.572268805985225. distance: 1.8861452735662265
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1479, Accuracy: 9517/9900 (96.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4625/5066 (91.2949%), train_poison_data_count: 400
Global model norm: 42.57035479558369.
Norm before scaling: 42.57219282069576. Distance: 1.9510845665017904
Total norm for 4 adversaries is: 42.57219282069576. distance: 1.9510845665017904
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2323, Accuracy: 9341/9900 (94.3535%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3911/4501 (86.8918%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3950/4501 (87.7583%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0941, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3714/4175 (88.9581%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3759/4175 (90.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9674, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3165/3616 (87.5277%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3235/3616 (89.4635%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8888, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4076/4634 (87.9586%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4116/4634 (88.8218%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9787, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4036/4558 (88.5476%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3990/4558 (87.5384%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2088, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4559/5167 (88.2330%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4625/5167 (89.5104%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1215, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3910/4356 (89.7612%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3816/4356 (87.6033%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1976, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4150/4716 (87.9983%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4218/4716 (89.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9977, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5397/6124 (88.1287%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5312/6124 (86.7407%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0333, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4465/5055 (88.3284%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4549/5055 (89.9901%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9658, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4524/5025 (90.0299%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4563/5025 (90.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0969, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4375/4918 (88.9589%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4386/4918 (89.1826%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1546, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3761/4223 (89.0599%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3801/4223 (90.0071%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9260, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3932/4481 (87.7483%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3843/4481 (85.7621%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0892, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3204/3638 (88.0704%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3280/3638 (90.1594%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8962, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3591/4013 (89.4842%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3678/4013 (91.6521%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8295, Accuracy: 5697/10000 (56.9700%)
time spent on training: 268.09157061576843
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0868, Accuracy: 7099/10000 (70.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 4.6261, Accuracy: 1969/9900 (19.8889%)
Done in 297.942830324173 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4513/4885 (92.3849%), train_poison_data_count: 385
Global model norm: 42.593678351920666.
Norm before scaling: 42.59129383508882. Distance: 1.834917539983756
Total norm for 4 adversaries is: 42.59129383508882. distance: 1.834917539983756
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2455, Accuracy: 9286/9900 (93.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4859/5305 (91.5928%), train_poison_data_count: 415
Global model norm: 42.593678351920666.
Norm before scaling: 42.590610268083886. Distance: 1.9225453393994403
Total norm for 4 adversaries is: 42.590610268083886. distance: 1.9225453393994403
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2205, Accuracy: 9370/9900 (94.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4325/4717 (91.6896%), train_poison_data_count: 370
Global model norm: 42.593678351920666.
Norm before scaling: 42.59255919327709. Distance: 1.7827617186686888
Total norm for 4 adversaries is: 42.59255919327709. distance: 1.7827617186686888
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.4236, Accuracy: 8871/9900 (89.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4613/5066 (91.0580%), train_poison_data_count: 400
Global model norm: 42.593678351920666.
Norm before scaling: 42.5949106820947. Distance: 1.9534097692791157
Total norm for 4 adversaries is: 42.5949106820947. distance: 1.9534097692791157
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1306, Accuracy: 9565/9900 (96.6162%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3207/3646 (87.9594%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3326/3646 (91.2233%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7941, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3947/4501 (87.6916%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4006/4501 (89.0024%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1126, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4115/4651 (88.4756%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4187/4651 (90.0237%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9936, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4596/5167 (88.9491%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4649/5167 (89.9748%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0612, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4902/5455 (89.8625%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4901/5455 (89.8442%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1141, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4912/5591 (87.8555%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4827/5591 (86.3352%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1536, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4220/4679 (90.1902%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4214/4679 (90.0620%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9747, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4481/5017 (89.3163%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4538/5017 (90.4525%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9112, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4270/4793 (89.0883%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4307/4793 (89.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0527, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4031/4456 (90.4623%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4097/4456 (91.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8687, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4822/5424 (88.9012%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4910/5424 (90.5236%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1963, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3683/4175 (88.2156%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3699/4175 (88.5988%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9471, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4540/5116 (88.7412%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4546/5116 (88.8585%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9988, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3305/3704 (89.2279%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3369/3704 (90.9557%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9181, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4528/5232 (86.5443%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4667/5232 (89.2011%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.3103, Accuracy: 5007/10000 (50.0700%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3097/3472 (89.1993%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3179/3472 (91.5611%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9601, Accuracy: 5606/10000 (56.0600%)
time spent on training: 268.09610629081726
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.0894, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 4.1277, Accuracy: 2543/9900 (25.6869%)
Done in 298.29453778266907 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4516/4885 (92.4463%), train_poison_data_count: 385
Global model norm: 42.61726984982878.
Norm before scaling: 42.615125838079045. Distance: 1.8047982714457047
Total norm for 4 adversaries is: 42.615125838079045. distance: 1.8047982714457047
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2000, Accuracy: 9404/9900 (94.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4884/5305 (92.0641%), train_poison_data_count: 415
Global model norm: 42.61726984982878.
Norm before scaling: 42.61118699163328. Distance: 1.8819672519416966
Total norm for 4 adversaries is: 42.61118699163328. distance: 1.8819672519416966
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2048, Accuracy: 9418/9900 (95.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4325/4717 (91.6896%), train_poison_data_count: 370
Global model norm: 42.61726984982878.
Norm before scaling: 42.614349556058436. Distance: 1.7880028664226726
Total norm for 4 adversaries is: 42.614349556058436. distance: 1.7880028664226726
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1375, Accuracy: 9561/9900 (96.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4646/5066 (91.7094%), train_poison_data_count: 400
Global model norm: 42.61726984982878.
Norm before scaling: 42.618633253432996. Distance: 1.9218138398153983
Total norm for 4 adversaries is: 42.618633253432996. distance: 1.9218138398153983
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3259, Accuracy: 9082/9900 (91.7374%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3245/3590 (90.3900%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3326/3590 (92.6462%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0090, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3862/4368 (88.4158%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3840/4368 (87.9121%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8712, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3296/3704 (88.9849%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3364/3704 (90.8207%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9731, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4367/4928 (88.6161%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4378/4928 (88.8393%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0730, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3918/4356 (89.9449%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3879/4356 (89.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1184, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3501/3911 (89.5167%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3355/3911 (85.7837%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2346, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4147/4651 (89.1636%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4177/4651 (89.8086%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0710, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3756/4184 (89.7706%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3784/4184 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9063, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3934/4346 (90.5200%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3992/4346 (91.8546%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8444, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4233/4793 (88.3163%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4399/4793 (91.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9746, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3424/3804 (90.0105%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3493/3804 (91.8244%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9357, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4494/4986 (90.1324%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4482/4986 (89.8917%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8601, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5381/6124 (87.8674%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5316/6124 (86.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1062, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4177/4707 (88.7402%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4224/4707 (89.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9509, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3828/4235 (90.3896%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3755/4235 (88.6659%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0977, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3656/4046 (90.3609%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3702/4046 (91.4978%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0467, Accuracy: 5295/10000 (52.9500%)
time spent on training: 257.4110059738159
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.0918, Accuracy: 7057/10000 (70.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 3.6808, Accuracy: 3112/9900 (31.4343%)
Done in 287.16903614997864 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4556/4885 (93.2651%), train_poison_data_count: 385
Global model norm: 42.63952281921082.
Norm before scaling: 42.633748071326956. Distance: 1.76962077943784
Total norm for 4 adversaries is: 42.633748071326956. distance: 1.76962077943784
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0647, Accuracy: 9733/9900 (98.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4894/5305 (92.2526%), train_poison_data_count: 415
Global model norm: 42.63952281921082.
Norm before scaling: 42.635120968974185. Distance: 1.8457045459237256
Total norm for 4 adversaries is: 42.635120968974185. distance: 1.8457045459237256
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1030, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4353/4717 (92.2832%), train_poison_data_count: 370
Global model norm: 42.63952281921082.
Norm before scaling: 42.63649811698526. Distance: 1.7485798795680174
Total norm for 4 adversaries is: 42.63649811698526. distance: 1.7485798795680174
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3267, Accuracy: 9155/9900 (92.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4628/5066 (91.3541%), train_poison_data_count: 400
Global model norm: 42.63952281921082.
Norm before scaling: 42.6408869426729. Distance: 1.9371839696264612
Total norm for 4 adversaries is: 42.6408869426729. distance: 1.9371839696264612
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1768, Accuracy: 9452/9900 (95.4747%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4452/4986 (89.2900%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4485/4986 (89.9519%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0897, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4073/4634 (87.8938%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4149/4634 (89.5339%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9484, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4154/4716 (88.0831%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4177/4716 (88.5708%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2400, Accuracy: 5029/10000 (50.2900%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5364/6124 (87.5898%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5458/6124 (89.1248%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9674, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4400/4918 (89.4673%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4532/4918 (92.1513%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9395, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3398/3797 (89.4917%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3428/3797 (90.2818%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0413, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5006/5582 (89.6811%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5072/5582 (90.8635%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1380, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4351/4956 (87.7926%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4354/4956 (87.8531%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0840, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4025/4433 (90.7963%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4045/4433 (91.2475%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9067, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3891/4354 (89.3661%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3496/4354 (80.2940%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.4285, Accuracy: 4776/10000 (47.7600%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4355/4928 (88.3726%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4431/4928 (89.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8958, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3502/3911 (89.5423%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3492/3911 (89.2866%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0053, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3856/4481 (86.0522%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3850/4481 (85.9183%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0478, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4594/5197 (88.3972%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4573/5197 (87.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0687, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4855/5455 (89.0009%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4905/5455 (89.9175%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0397, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3851/4361 (88.3054%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3795/4361 (87.0213%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1814, Accuracy: 5128/10000 (51.2800%)
time spent on training: 272.19665336608887
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.0976, Accuracy: 7043/10000 (70.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 3.2935, Accuracy: 3656/9900 (36.9293%)
Done in 301.9987082481384 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4535/4885 (92.8352%), train_poison_data_count: 385
Global model norm: 42.664935871622816.
Norm before scaling: 42.66438223763178. Distance: 1.7749674243355547
Total norm for 4 adversaries is: 42.66438223763178. distance: 1.7749674243355547
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1648, Accuracy: 9505/9900 (96.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4914/5305 (92.6296%), train_poison_data_count: 415
Global model norm: 42.664935871622816.
Norm before scaling: 42.65803710771058. Distance: 1.8304056792519567
Total norm for 4 adversaries is: 42.65803710771058. distance: 1.8304056792519567
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1523, Accuracy: 9498/9900 (95.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4365/4717 (92.5376%), train_poison_data_count: 370
Global model norm: 42.664935871622816.
Norm before scaling: 42.658909887307686. Distance: 1.708295969050488
Total norm for 4 adversaries is: 42.658909887307686. distance: 1.708295969050488
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0682, Accuracy: 9719/9900 (98.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4624/5066 (91.2752%), train_poison_data_count: 400
Global model norm: 42.664935871622816.
Norm before scaling: 42.6678555640836. Distance: 1.910811235899269
Total norm for 4 adversaries is: 42.6678555640836. distance: 1.910811235899269
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1686, Accuracy: 9484/9900 (95.7980%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4340/4928 (88.0682%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4375/4928 (88.7784%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8737, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3798/4184 (90.7744%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3821/4184 (91.3241%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8653, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4255/4707 (90.3973%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4252/4707 (90.3335%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1120, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3446/3828 (90.0209%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3533/3828 (92.2936%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9859, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4031/4503 (89.5181%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4030/4503 (89.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9255, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4203/4662 (90.1544%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4224/4662 (90.6049%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9663, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3791/4235 (89.5159%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3818/4235 (90.1535%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0650, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4445/5244 (84.7635%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4471/5244 (85.2593%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9613, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4276/4793 (89.2134%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4347/4793 (90.6948%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0516, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3994/4481 (89.1319%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3878/4481 (86.5432%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2554, Accuracy: 5050/10000 (50.5000%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3969/4346 (91.3254%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4023/4346 (92.5679%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7468, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3854/4361 (88.3742%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3726/4361 (85.4391%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2357, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4567/5055 (90.3462%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4540/5055 (89.8121%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9275, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4583/5195 (88.2194%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4554/5195 (87.6612%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1758, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3936/4315 (91.2167%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3999/4315 (92.6767%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9479, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4221/4663 (90.5211%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4274/4663 (91.6577%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0358, Accuracy: 5455/10000 (54.5500%)
time spent on training: 267.13475036621094
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1024, Accuracy: 7035/10000 (70.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.8922, Accuracy: 4216/9900 (42.5859%)
Done in 297.31054306030273 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4551/4885 (93.1627%), train_poison_data_count: 385
Global model norm: 42.68829067944525.
Norm before scaling: 42.68444723939637. Distance: 1.6970949427357986
Total norm for 4 adversaries is: 42.68444723939637. distance: 1.6970949427357986
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1766, Accuracy: 9486/9900 (95.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4923/5305 (92.7992%), train_poison_data_count: 415
Global model norm: 42.68829067944525.
Norm before scaling: 42.683369069430164. Distance: 1.8135404560129622
Total norm for 4 adversaries is: 42.683369069430164. distance: 1.8135404560129622
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2263, Accuracy: 9347/9900 (94.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4378/4717 (92.8132%), train_poison_data_count: 370
Global model norm: 42.68829067944525.
Norm before scaling: 42.68262405809154. Distance: 1.6717072162039541
Total norm for 4 adversaries is: 42.68262405809154. distance: 1.6717072162039541
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1790, Accuracy: 9477/9900 (95.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4673/5066 (92.2424%), train_poison_data_count: 400
Global model norm: 42.68829067944525.
Norm before scaling: 42.688459393959015. Distance: 1.8426920554946387
Total norm for 4 adversaries is: 42.688459393959015. distance: 1.8426920554946387
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1444, Accuracy: 9526/9900 (96.2222%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3978/4315 (92.1900%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3962/4315 (91.8192%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9042, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3280/3590 (91.3649%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3195/3590 (88.9972%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1140, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4213/4679 (90.0406%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4257/4679 (90.9810%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0084, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4637/5167 (89.7426%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4646/5167 (89.9168%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0861, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3387/3775 (89.7219%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3527/3775 (93.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8131, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3449/3828 (90.0993%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3482/3828 (90.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9390, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3803/4235 (89.7993%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3833/4235 (90.5077%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9272, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4157/4647 (89.4556%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4228/4647 (90.9834%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9412, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4422/4918 (89.9146%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4474/4918 (90.9719%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0783, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4016/4433 (90.5933%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4014/4433 (90.5482%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0438, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3980/4481 (88.8195%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3886/4481 (86.7217%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1009, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3841/4295 (89.4296%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3674/4295 (85.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1961, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4025/4503 (89.3849%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4020/4503 (89.2738%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9661, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3855/4354 (88.5393%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0098, Accuracy: 3571/4354 (82.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.4578, Accuracy: 4676/10000 (46.7600%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4500/4986 (90.2527%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4447/4986 (89.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0694, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5600/6263 (89.4140%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5683/6263 (90.7393%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1151, Accuracy: 5269/10000 (52.6900%)
time spent on training: 268.05574679374695
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1134, Accuracy: 7009/10000 (70.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 2.6040, Accuracy: 4692/9900 (47.3939%)
Done in 297.5430874824524 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4528/4885 (92.6919%), train_poison_data_count: 385
Global model norm: 42.71142979755609.
Norm before scaling: 42.706809551068666. Distance: 1.736145147201901
Total norm for 4 adversaries is: 42.706809551068666. distance: 1.736145147201901
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1655, Accuracy: 9496/9900 (95.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4905/5305 (92.4599%), train_poison_data_count: 415
Global model norm: 42.71142979755609.
Norm before scaling: 42.70700534647756. Distance: 1.8701721980119037
Total norm for 4 adversaries is: 42.70700534647756. distance: 1.8701721980119037
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0823, Accuracy: 9687/9900 (97.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4391/4717 (93.0888%), train_poison_data_count: 370
Global model norm: 42.71142979755609.
Norm before scaling: 42.703686707337546. Distance: 1.6518351897264312
Total norm for 4 adversaries is: 42.703686707337546. distance: 1.6518351897264312
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1650, Accuracy: 9506/9900 (96.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4686/5066 (92.4990%), train_poison_data_count: 400
Global model norm: 42.71142979755609.
Norm before scaling: 42.709707803086175. Distance: 1.8249280967656967
Total norm for 4 adversaries is: 42.709707803086175. distance: 1.8249280967656967
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0641, Accuracy: 9742/9900 (98.4040%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3772/4223 (89.3204%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3844/4223 (91.0253%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9188, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4936/5455 (90.4858%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4862/5455 (89.1292%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1473, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5099/5582 (91.3472%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5087/5582 (91.1322%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3321, Accuracy: 4969/10000 (49.6900%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4023/4465 (90.1008%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4071/4465 (91.1758%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8386, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4965/5591 (88.8034%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4957/5591 (88.6603%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0918, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3545/3911 (90.6418%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3372/3911 (86.2184%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0234, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3929/4356 (90.1974%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0131, Accuracy: 3371/4356 (77.3875%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.7378, Accuracy: 4344/10000 (43.4400%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4481/5037 (88.9617%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4533/5037 (89.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9156, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4244/4679 (90.7031%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4220/4679 (90.1902%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1258, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4003/4362 (91.7698%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3935/4362 (90.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1362, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4124/4518 (91.2793%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4166/4518 (92.2089%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9922, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4536/5083 (89.2386%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4527/5083 (89.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1003, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3599/4013 (89.6835%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3721/4013 (92.7236%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7760, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4629/5197 (89.0706%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4687/5197 (90.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2105, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2977/3297 (90.2942%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3048/3297 (92.4477%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7676, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4041/4441 (90.9930%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4040/4441 (90.9705%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0423, Accuracy: 5415/10000 (54.1500%)
time spent on training: 270.19732880592346
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1154, Accuracy: 7008/10000 (70.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 2.3526, Accuracy: 5084/9900 (51.3535%)
Done in 300.0494952201843 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4544/4885 (93.0194%), train_poison_data_count: 385
Global model norm: 42.734394995424935.
Norm before scaling: 42.7293558524172. Distance: 1.7225323760113975
Total norm for 4 adversaries is: 42.7293558524172. distance: 1.7225323760113975
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.0826, Accuracy: 9702/9900 (98.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4917/5305 (92.6861%), train_poison_data_count: 415
Global model norm: 42.734394995424935.
Norm before scaling: 42.7260946616826. Distance: 1.745887692985243
Total norm for 4 adversaries is: 42.7260946616826. distance: 1.745887692985243
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2910, Accuracy: 9245/9900 (93.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4401/4717 (93.3008%), train_poison_data_count: 370
Global model norm: 42.734394995424935.
Norm before scaling: 42.727584583907856. Distance: 1.6557555270269073
Total norm for 4 adversaries is: 42.727584583907856. distance: 1.6557555270269073
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2960, Accuracy: 9152/9900 (92.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4668/5066 (92.1437%), train_poison_data_count: 400
Global model norm: 42.734394995424935.
Norm before scaling: 42.73324952814114. Distance: 1.830817823221347
Total norm for 4 adversaries is: 42.73324952814114. distance: 1.830817823221347
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1782, Accuracy: 9444/9900 (95.3939%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4043/4501 (89.8245%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4065/4501 (90.3133%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9867, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4026/4511 (89.2485%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4102/4511 (90.9333%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9317, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3905/4354 (89.6876%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0119, Accuracy: 3405/4354 (78.2040%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5439, Accuracy: 4532/10000 (45.3200%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3968/4346 (91.3023%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4024/4346 (92.5909%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8569, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4247/4707 (90.2273%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4274/4707 (90.8009%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9122, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4939/5591 (88.3384%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4899/5591 (87.6230%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0380, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4136/4647 (89.0037%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4218/4647 (90.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8407, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4110/4538 (90.5685%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4166/4538 (91.8026%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9196, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4374/4934 (88.6502%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4381/4934 (88.7921%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0989, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4316/4804 (89.8418%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4219/4804 (87.8226%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0646, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5702/6263 (91.0426%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5685/6263 (90.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1759, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3966/4481 (88.5070%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3934/4481 (87.7929%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9811, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4455/5063 (87.9913%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4392/5063 (86.7470%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9501, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3757/4223 (88.9652%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3874/4223 (91.7357%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9200, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4060/4441 (91.4209%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4115/4441 (92.6593%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9921, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3412/3756 (90.8413%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3479/3756 (92.6251%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8837, Accuracy: 5645/10000 (56.4500%)
time spent on training: 269.1530532836914
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1191, Accuracy: 7013/10000 (70.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 2.1447, Accuracy: 5440/9900 (54.9495%)
Done in 299.04867672920227 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4582/4885 (93.7973%), train_poison_data_count: 385
Global model norm: 42.75796737935589.
Norm before scaling: 42.750778101928304. Distance: 1.6714300116042569
Total norm for 4 adversaries is: 42.750778101928304. distance: 1.6714300116042569
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1296, Accuracy: 9579/9900 (96.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4938/5305 (93.0820%), train_poison_data_count: 415
Global model norm: 42.75796737935589.
Norm before scaling: 42.754646985645756. Distance: 1.844963579516195
Total norm for 4 adversaries is: 42.754646985645756. distance: 1.844963579516195
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0661, Accuracy: 9730/9900 (98.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4393/4717 (93.1312%), train_poison_data_count: 370
Global model norm: 42.75796737935589.
Norm before scaling: 42.75131062958041. Distance: 1.6198635351136055
Total norm for 4 adversaries is: 42.75131062958041. distance: 1.6198635351136055
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2063, Accuracy: 9394/9900 (94.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4723/5066 (93.2294%), train_poison_data_count: 400
Global model norm: 42.75796737935589.
Norm before scaling: 42.75237566498498. Distance: 1.7558169418146792
Total norm for 4 adversaries is: 42.75237566498498. distance: 1.7558169418146792
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1996, Accuracy: 9401/9900 (94.9596%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4488/5244 (85.5835%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4580/5244 (87.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9658, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4436/4928 (90.0162%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4451/4928 (90.3206%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9732, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3433/3804 (90.2471%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3487/3804 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9376, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3643/4013 (90.7800%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3680/4013 (91.7020%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9240, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3652/4158 (87.8307%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3630/4158 (87.3016%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9127, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5116/5582 (91.6517%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5055/5582 (90.5589%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0291, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4903/5455 (89.8808%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4929/5455 (90.3575%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9743, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3913/4354 (89.8714%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0108, Accuracy: 3508/4354 (80.5696%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.6981, Accuracy: 4475/10000 (44.7500%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4029/4433 (90.8865%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4043/4433 (91.2023%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9974, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3242/3646 (88.9194%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3334/3646 (91.4427%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8621, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4092/4518 (90.5710%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4098/4518 (90.7039%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0029, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3873/4235 (91.4522%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3780/4235 (89.2562%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2557, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4001/4362 (91.7240%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3895/4362 (89.2939%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0953, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4868/5392 (90.2819%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4731/5392 (87.7411%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1401, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4935/5591 (88.2669%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4914/5591 (87.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2146, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3407/3756 (90.7082%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3476/3756 (92.5453%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9718, Accuracy: 5640/10000 (56.4000%)
time spent on training: 268.273086309433
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1258, Accuracy: 6987/10000 (69.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.9132, Accuracy: 5852/9900 (59.1111%)
Done in 298.537255525589 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4561/4885 (93.3675%), train_poison_data_count: 385
Global model norm: 42.781205772895326.
Norm before scaling: 42.77311429672412. Distance: 1.679007104087282
Total norm for 4 adversaries is: 42.77311429672412. distance: 1.679007104087282
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0897, Accuracy: 9664/9900 (97.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4932/5305 (92.9689%), train_poison_data_count: 415
Global model norm: 42.781205772895326.
Norm before scaling: 42.77306149948893. Distance: 1.7868614149828101
Total norm for 4 adversaries is: 42.77306149948893. distance: 1.7868614149828101
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0193, Accuracy: 9846/9900 (99.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4394/4717 (93.1524%), train_poison_data_count: 370
Global model norm: 42.781205772895326.
Norm before scaling: 42.77377068934156. Distance: 1.6370774197036735
Total norm for 4 adversaries is: 42.77377068934156. distance: 1.6370774197036735
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1190, Accuracy: 9611/9900 (97.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4685/5066 (92.4793%), train_poison_data_count: 400
Global model norm: 42.781205772895326.
Norm before scaling: 42.77660162383607. Distance: 1.7994479789920326
Total norm for 4 adversaries is: 42.77660162383607. distance: 1.7994479789920326
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1356, Accuracy: 9574/9900 (96.7071%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4224/4634 (91.1524%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4185/4634 (90.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0026, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4086/4503 (90.7395%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4044/4503 (89.8068%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9978, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4393/4928 (89.1437%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4487/4928 (91.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8296, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3414/3804 (89.7476%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3463/3804 (91.0358%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0237, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3291/3590 (91.6713%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3106/3590 (86.5181%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.3209, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4174/4647 (89.8214%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4258/4647 (91.6290%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9361, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4039/4625 (87.3297%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4059/4625 (87.7622%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1488, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3950/4356 (90.6795%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3951/4356 (90.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1597, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3456/3797 (91.0192%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3506/3797 (92.3361%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9404, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4065/4456 (91.2253%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4090/4456 (91.7864%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9551, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3640/4025 (90.4348%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3718/4025 (92.3727%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8455, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3170/3472 (91.3018%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3147/3472 (90.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0352, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2958/3297 (89.7179%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3015/3297 (91.4468%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8253, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3917/4416 (88.7002%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3988/4416 (90.3080%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0847, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3964/4356 (91.0009%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4033/4356 (92.5849%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0916, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3239/3638 (89.0324%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3345/3638 (91.9461%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8455, Accuracy: 5612/10000 (56.1200%)
time spent on training: 256.95341992378235
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1318, Accuracy: 6972/10000 (69.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.7029, Accuracy: 6254/9900 (63.1717%)
Done in 287.06708693504333 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4558/4885 (93.3060%), train_poison_data_count: 385
Global model norm: 42.80118891410538.
Norm before scaling: 42.79535611351788. Distance: 1.6954757682128412
Total norm for 4 adversaries is: 42.79535611351788. distance: 1.6954757682128412
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1661, Accuracy: 9496/9900 (95.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4948/5305 (93.2705%), train_poison_data_count: 415
Global model norm: 42.80118891410538.
Norm before scaling: 42.79107299115523. Distance: 1.7391123638561805
Total norm for 4 adversaries is: 42.79107299115523. distance: 1.7391123638561805
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1034, Accuracy: 9648/9900 (97.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4385/4717 (92.9616%), train_poison_data_count: 370
Global model norm: 42.80118891410538.
Norm before scaling: 42.79205145782041. Distance: 1.6230860956734567
Total norm for 4 adversaries is: 42.79205145782041. distance: 1.6230860956734567
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1103, Accuracy: 9625/9900 (97.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4730/5066 (93.3675%), train_poison_data_count: 400
Global model norm: 42.80118891410538.
Norm before scaling: 42.79407678420578. Distance: 1.7517189030914744
Total norm for 4 adversaries is: 42.79407678420578. distance: 1.7517189030914744
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0872, Accuracy: 9674/9900 (97.7172%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3727/4175 (89.2695%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3712/4175 (88.9102%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9837, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4366/4956 (88.0952%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4452/4956 (89.8305%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0209, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4456/5037 (88.4654%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4595/5037 (91.2249%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9620, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4313/4793 (89.9854%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4328/4793 (90.2984%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1313, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3407/3804 (89.5636%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3417/3804 (89.8265%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1013, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4860/5392 (90.1335%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4864/5392 (90.2077%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0109, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4074/4465 (91.2430%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4094/4465 (91.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9180, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4171/4596 (90.7528%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4230/4596 (92.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9841, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5400/6124 (88.1777%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5406/6124 (88.2756%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9803, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2929/3271 (89.5445%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2961/3271 (90.5228%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9038, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3252/3590 (90.5850%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3284/3590 (91.4763%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0566, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3955/4501 (87.8694%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4001/4501 (88.8914%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1041, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4652/5232 (88.9144%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4630/5232 (88.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0188, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3282/3672 (89.3791%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3299/3672 (89.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9860, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3825/4223 (90.5754%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3857/4223 (91.3332%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0717, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3929/4354 (90.2389%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0176, Accuracy: 3008/4354 (69.0859%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.6075, Accuracy: 4274/10000 (42.7400%)
time spent on training: 267.02579641342163
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1397, Accuracy: 6979/10000 (69.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 1.5238, Accuracy: 6582/9900 (66.4848%)
Done in 297.0492832660675 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4630/4885 (94.7799%), train_poison_data_count: 385
Global model norm: 42.824103126554206.
Norm before scaling: 42.81117983822246. Distance: 1.5708278740232329
Total norm for 4 adversaries is: 42.81117983822246. distance: 1.5708278740232329
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2788, Accuracy: 9226/9900 (93.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4968/5305 (93.6475%), train_poison_data_count: 415
Global model norm: 42.824103126554206.
Norm before scaling: 42.81114704750899. Distance: 1.701425947274473
Total norm for 4 adversaries is: 42.81114704750899. distance: 1.701425947274473
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0578, Accuracy: 9753/9900 (98.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4402/4717 (93.3220%), train_poison_data_count: 370
Global model norm: 42.824103126554206.
Norm before scaling: 42.8161936704991. Distance: 1.6477111373159168
Total norm for 4 adversaries is: 42.8161936704991. distance: 1.6477111373159168
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0708, Accuracy: 9717/9900 (98.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4733/5066 (93.4268%), train_poison_data_count: 400
Global model norm: 42.824103126554206.
Norm before scaling: 42.815848694310176. Distance: 1.680868966414107
Total norm for 4 adversaries is: 42.815848694310176. distance: 1.680868966414107
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1878, Accuracy: 9431/9900 (95.2626%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5111/5582 (91.5622%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5023/5582 (89.9857%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0862, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4172/4647 (89.7784%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4207/4647 (90.5315%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0171, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4048/4465 (90.6607%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4115/4465 (92.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8743, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4552/5083 (89.5534%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4466/5083 (87.8615%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0622, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3870/4416 (87.6359%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3955/4416 (89.5607%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8802, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4402/4956 (88.8216%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4404/4956 (88.8620%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1291, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4031/4362 (92.4117%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3892/4362 (89.2251%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0208, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3956/4356 (90.8173%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3826/4356 (87.8329%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2520, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3416/3781 (90.3465%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3448/3781 (91.1928%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0787, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3286/3590 (91.5320%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3299/3590 (91.8942%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9512, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4216/4651 (90.6472%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4260/4651 (91.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9709, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4220/4662 (90.5191%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4219/4662 (90.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9143, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3169/3472 (91.2730%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3228/3472 (92.9724%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8480, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4904/5424 (90.4130%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4971/5424 (91.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2322, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2963/3271 (90.5839%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2904/3271 (88.7802%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0375, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4494/5037 (89.2198%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4538/5037 (90.0933%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9767, Accuracy: 5527/10000 (55.2700%)
time spent on training: 264.6269602775574
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1408, Accuracy: 6971/10000 (69.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 1.4585, Accuracy: 6696/9900 (67.6364%)
Done in 294.72075748443604 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4626/4885 (94.6981%), train_poison_data_count: 385
Global model norm: 42.84598086369216.
Norm before scaling: 42.837968587858775. Distance: 1.5976505046265506
Total norm for 4 adversaries is: 42.837968587858775. distance: 1.5976505046265506
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1651, Accuracy: 9500/9900 (95.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4964/5305 (93.5721%), train_poison_data_count: 415
Global model norm: 42.84598086369216.
Norm before scaling: 42.83667913250935. Distance: 1.731332051229804
Total norm for 4 adversaries is: 42.83667913250935. distance: 1.731332051229804
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.0938, Accuracy: 9662/9900 (97.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4430/4717 (93.9156%), train_poison_data_count: 370
Global model norm: 42.84598086369216.
Norm before scaling: 42.83394621374719. Distance: 1.57545888059098
Total norm for 4 adversaries is: 42.83394621374719. distance: 1.57545888059098
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1991, Accuracy: 9409/9900 (95.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4698/5066 (92.7359%), train_poison_data_count: 400
Global model norm: 42.84598086369216.
Norm before scaling: 42.84083517163414. Distance: 1.767139291822487
Total norm for 4 adversaries is: 42.84083517163414. distance: 1.767139291822487
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2575, Accuracy: 9277/9900 (93.7071%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4404/4989 (88.2742%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4435/4989 (88.8956%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0964, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3656/4013 (91.1039%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3741/4013 (93.2220%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8007, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4611/5195 (88.7584%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4440/5195 (85.4668%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0897, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3601/3969 (90.7281%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3583/3969 (90.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9474, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3977/4356 (91.2994%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3812/4356 (87.5115%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1291, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4067/4441 (91.5785%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4069/4441 (91.6235%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9481, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4103/4518 (90.8145%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4121/4518 (91.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0764, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3538/3911 (90.4628%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3271/3911 (83.6359%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1852, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4015/4362 (92.0449%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3916/4362 (89.7753%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1542, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3457/3804 (90.8780%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3482/3804 (91.5352%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1178, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3808/4223 (90.1729%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3890/4223 (92.1146%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0251, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4205/4634 (90.7423%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4228/4634 (91.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8632, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3957/4354 (90.8819%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0156, Accuracy: 3148/4354 (72.3013%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.7662, Accuracy: 4155/10000 (41.5500%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4517/5244 (86.1365%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4544/5244 (86.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9893, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4493/5037 (89.1999%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4590/5037 (91.1257%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9869, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3333/3704 (89.9838%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3360/3704 (90.7127%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8560, Accuracy: 5666/10000 (56.6600%)
time spent on training: 266.58577013015747
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1404, Accuracy: 6977/10000 (69.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 1.3820, Accuracy: 6852/9900 (69.2121%)
Done in 296.2690043449402 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4616/4885 (94.4933%), train_poison_data_count: 385
Global model norm: 42.86869031560213.
Norm before scaling: 42.857808483949285. Distance: 1.5860618955938204
Total norm for 4 adversaries is: 42.857808483949285. distance: 1.5860618955938204
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1428, Accuracy: 9539/9900 (96.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4965/5305 (93.5910%), train_poison_data_count: 415
Global model norm: 42.86869031560213.
Norm before scaling: 42.85656947161077. Distance: 1.693364725247459
Total norm for 4 adversaries is: 42.85656947161077. distance: 1.693364725247459
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0809, Accuracy: 9694/9900 (97.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4414/4717 (93.5764%), train_poison_data_count: 370
Global model norm: 42.86869031560213.
Norm before scaling: 42.85671331281206. Distance: 1.5448411614207382
Total norm for 4 adversaries is: 42.85671331281206. distance: 1.5448411614207382
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0993, Accuracy: 9643/9900 (97.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4740/5066 (93.5649%), train_poison_data_count: 400
Global model norm: 42.86869031560213.
Norm before scaling: 42.85945047614572. Distance: 1.651537109872759
Total norm for 4 adversaries is: 42.85945047614572. distance: 1.651537109872759
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1922, Accuracy: 9439/9900 (95.3434%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3925/4416 (88.8813%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3988/4416 (90.3080%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9921, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4633/5197 (89.1476%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4583/5197 (88.1855%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9379, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4424/4918 (89.9553%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4471/4918 (90.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2030, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5682/6263 (90.7233%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5721/6263 (91.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1121, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3279/3646 (89.9342%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3322/3646 (91.1135%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8058, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4308/4707 (91.5233%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4321/4707 (91.7994%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9565, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4460/5063 (88.0901%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4306/5063 (85.0484%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2025, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3832/4295 (89.2200%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3848/4295 (89.5925%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9919, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4328/4793 (90.2984%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4353/4793 (90.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1087, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4130/4538 (91.0093%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4239/4538 (93.4112%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8482, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4555/5083 (89.6124%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4526/5083 (89.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9834, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3251/3638 (89.3623%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3285/3638 (90.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.7862, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5464/6124 (89.2227%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5399/6124 (88.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0721, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4181/4618 (90.5370%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3967/4618 (85.9030%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1212, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3621/3969 (91.2320%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3607/3969 (90.8793%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8601, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3613/4158 (86.8927%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3653/4158 (87.8547%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9122, Accuracy: 5517/10000 (55.1700%)
time spent on training: 262.84556317329407
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1419, Accuracy: 6979/10000 (69.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 1.3038, Accuracy: 7002/9900 (70.7273%)
Done in 292.7985055446625 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4591/4885 (93.9816%), train_poison_data_count: 385
Global model norm: 42.89232977030975.
Norm before scaling: 42.88220545776389. Distance: 1.554587202814556
Total norm for 4 adversaries is: 42.88220545776389. distance: 1.554587202814556
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1952, Accuracy: 9443/9900 (95.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4945/5305 (93.2139%), train_poison_data_count: 415
Global model norm: 42.89232977030975.
Norm before scaling: 42.88083050734909. Distance: 1.7372381273699193
Total norm for 4 adversaries is: 42.88083050734909. distance: 1.7372381273699193
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1666, Accuracy: 9474/9900 (95.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4444/4717 (94.2124%), train_poison_data_count: 370
Global model norm: 42.89232977030975.
Norm before scaling: 42.880981383978664. Distance: 1.5481314902387089
Total norm for 4 adversaries is: 42.880981383978664. distance: 1.5481314902387089
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0857, Accuracy: 9670/9900 (97.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4714/5066 (93.0517%), train_poison_data_count: 400
Global model norm: 42.89232977030975.
Norm before scaling: 42.884976574790294. Distance: 1.7234322320437394
Total norm for 4 adversaries is: 42.884976574790294. distance: 1.7234322320437394
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3024, Accuracy: 9177/9900 (92.6970%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4165/4716 (88.3164%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4173/4716 (88.4860%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0667, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4008/4481 (89.4443%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3893/4481 (86.8779%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2486, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3923/4361 (89.9564%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3779/4361 (86.6544%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0970, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4373/4793 (91.2372%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4410/4793 (92.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9399, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3915/4295 (91.1525%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3748/4295 (87.2643%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1081, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4591/5244 (87.5477%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4571/5244 (87.1663%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9835, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4437/4989 (88.9357%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4476/4989 (89.7174%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9629, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4628/5197 (89.0514%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4638/5197 (89.2438%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9906, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3945/4356 (90.5647%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3690/4356 (84.7107%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2647, Accuracy: 4876/10000 (48.7600%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4159/4647 (89.4986%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4168/4647 (89.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9351, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3663/4013 (91.2783%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3711/4013 (92.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8157, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4152/4538 (91.4941%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4177/4538 (92.0450%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7798, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4290/4707 (91.1409%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4304/4707 (91.4383%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7908, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5658/6263 (90.3401%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5658/6263 (90.3401%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1272, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3863/4235 (91.2161%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3758/4235 (88.7367%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9578, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3480/3861 (90.1321%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3487/3861 (90.3134%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1217, Accuracy: 5312/10000 (53.1200%)
time spent on training: 270.4692862033844
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1441, Accuracy: 6994/10000 (69.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 1.2420, Accuracy: 7118/9900 (71.8990%)
Done in 300.5275971889496 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4592/4885 (94.0020%), train_poison_data_count: 385
Global model norm: 42.91624917626627.
Norm before scaling: 42.908147604614385. Distance: 1.6313774702173136
Total norm for 4 adversaries is: 42.908147604614385. distance: 1.6313774702173136
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1162, Accuracy: 9620/9900 (97.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4974/5305 (93.7606%), train_poison_data_count: 415
Global model norm: 42.91624917626627.
Norm before scaling: 42.904592727917105. Distance: 1.704257273733054
Total norm for 4 adversaries is: 42.904592727917105. distance: 1.704257273733054
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1189, Accuracy: 9586/9900 (96.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4417/4717 (93.6400%), train_poison_data_count: 370
Global model norm: 42.91624917626627.
Norm before scaling: 42.90486017186383. Distance: 1.5391259349782052
Total norm for 4 adversaries is: 42.90486017186383. distance: 1.5391259349782052
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1462, Accuracy: 9524/9900 (96.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4728/5066 (93.3281%), train_poison_data_count: 400
Global model norm: 42.91624917626627.
Norm before scaling: 42.91032960393977. Distance: 1.713935698528266
Total norm for 4 adversaries is: 42.91032960393977. distance: 1.713935698528266
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0925, Accuracy: 9655/9900 (97.5253%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4603/5055 (91.0584%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4608/5055 (91.1573%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9872, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3482/3828 (90.9613%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3587/3828 (93.7043%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8984, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3920/4361 (89.8876%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3880/4361 (88.9704%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9180, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3654/4013 (91.0541%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3742/4013 (93.2469%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8513, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4114/4518 (91.0580%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4165/4518 (92.1868%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9000, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4099/4558 (89.9298%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4055/4558 (88.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1081, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3724/4126 (90.2569%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3787/4126 (91.7838%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9186, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4271/4679 (91.2802%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3883/4679 (82.9878%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1990, Accuracy: 4971/10000 (49.7100%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3920/4235 (92.5620%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3813/4235 (90.0354%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9339, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4486/5037 (89.0609%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4631/5037 (91.9396%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9169, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3297/3672 (89.7876%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3352/3672 (91.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8905, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4434/4928 (89.9756%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4419/4928 (89.6713%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9095, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3980/4356 (91.3682%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3829/4356 (87.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1653, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4075/4456 (91.4497%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4111/4456 (92.2576%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0250, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4320/4793 (90.1314%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4402/4793 (91.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9789, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4536/5025 (90.2687%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4537/5025 (90.2886%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0384, Accuracy: 5361/10000 (53.6100%)
time spent on training: 261.8111832141876
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1431, Accuracy: 6986/10000 (69.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 1.1383, Accuracy: 7320/9900 (73.9394%)
Done in 291.2942340373993 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4643/4885 (95.0461%), train_poison_data_count: 385
Global model norm: 42.938000360985605.
Norm before scaling: 42.92689438707102. Distance: 1.540522932962188
Total norm for 4 adversaries is: 42.92689438707102. distance: 1.540522932962188
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0977, Accuracy: 9643/9900 (97.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4992/5305 (94.0999%), train_poison_data_count: 415
Global model norm: 42.938000360985605.
Norm before scaling: 42.926054071671466. Distance: 1.692631161226604
Total norm for 4 adversaries is: 42.926054071671466. distance: 1.692631161226604
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0751, Accuracy: 9688/9900 (97.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4457/4717 (94.4880%), train_poison_data_count: 370
Global model norm: 42.938000360985605.
Norm before scaling: 42.92336665819024. Distance: 1.4870254144196335
Total norm for 4 adversaries is: 42.92336665819024. distance: 1.4870254144196335
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1665, Accuracy: 9500/9900 (95.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4734/5066 (93.4465%), train_poison_data_count: 400
Global model norm: 42.938000360985605.
Norm before scaling: 42.93098482457411. Distance: 1.6849599017344243
Total norm for 4 adversaries is: 42.93098482457411. distance: 1.6849599017344243
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1186, Accuracy: 9588/9900 (96.8485%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3984/4346 (91.6705%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4031/4346 (92.7520%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9398, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3801/4184 (90.8461%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3791/4184 (90.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9088, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3950/4356 (90.6795%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0125, Accuracy: 3390/4356 (77.8237%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3864, Accuracy: 4859/10000 (48.5900%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3304/3646 (90.6199%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3366/3646 (92.3204%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7547, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4583/5083 (90.1633%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4578/5083 (90.0649%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0735, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3970/4356 (91.1387%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3913/4356 (89.8301%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0875, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4098/4558 (89.9079%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4073/4558 (89.3594%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0055, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3755/4175 (89.9401%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3727/4175 (89.2695%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0034, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3198/3472 (92.1083%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3141/3472 (90.4666%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1824, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4096/4501 (91.0020%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4094/4501 (90.9576%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9596, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4910/5424 (90.5236%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4966/5424 (91.5560%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1982, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4027/4481 (89.8683%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4026/4481 (89.8460%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0414, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4924/5455 (90.2658%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4932/5455 (90.4125%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1841, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4696/5232 (89.7554%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4670/5232 (89.2584%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1033, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5591/6391 (87.4824%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5502/6391 (86.0898%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0970, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3488/3775 (92.3974%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3580/3775 (94.8344%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8263, Accuracy: 5811/10000 (58.1100%)
time spent on training: 268.13371992111206
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1512, Accuracy: 6969/10000 (69.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 1.0290, Accuracy: 7543/9900 (76.1919%)
Done in 298.1725115776062 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4603/4885 (94.2272%), train_poison_data_count: 385
Global model norm: 42.961372946283824.
Norm before scaling: 42.95133169683159. Distance: 1.6373894894415522
Total norm for 4 adversaries is: 42.95133169683159. distance: 1.6373894894415522
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0795, Accuracy: 9676/9900 (97.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5001/5305 (94.2696%), train_poison_data_count: 415
Global model norm: 42.961372946283824.
Norm before scaling: 42.94715366368882. Distance: 1.6471424529838798
Total norm for 4 adversaries is: 42.94715366368882. distance: 1.6471424529838798
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0396, Accuracy: 9785/9900 (98.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
