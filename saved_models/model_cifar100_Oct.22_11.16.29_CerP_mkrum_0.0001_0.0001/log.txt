current path: saved_models/model_cifar100_Oct.22_11.16.29_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4309/4885 (88.2088%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.439937740643394. Distance: 2.294175202667544
Total norm for 4 adversaries is: 42.439937740643394. distance: 2.294175202667544
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4454, Accuracy: 8819/9900 (89.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43527642830756. Distance: 2.25067255776585
Total norm for 4 adversaries is: 42.43527642830756. distance: 2.25067255776585
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7267, Accuracy: 8319/9900 (84.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4184/4717 (88.7004%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43864482071441. Distance: 2.1774059099263123
Total norm for 4 adversaries is: 42.43864482071441. distance: 2.1774059099263123
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4243, Accuracy: 8893/9900 (89.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4454/5066 (87.9195%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44030878269281. Distance: 2.3034104769421506
Total norm for 4 adversaries is: 42.44030878269281. distance: 2.3034104769421506
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6083, Accuracy: 8493/9900 (85.7879%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3838/4356 (88.1084%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3682/4356 (84.5271%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4210, Accuracy: 4680/10000 (46.8000%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3936/4465 (88.1523%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4098/4465 (91.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9555, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4041/4647 (86.9593%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4148/4647 (89.2619%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9599, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4442/5055 (87.8734%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4532/5055 (89.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0855, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4428/5116 (86.5520%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4456/5116 (87.0993%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9759, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3633/4126 (88.0514%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3759/4126 (91.1052%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9582, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3083/3472 (88.7961%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3223/3472 (92.8283%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0520, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4435/4986 (88.9491%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4447/4986 (89.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0291, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3543/4013 (88.2881%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3685/4013 (91.8266%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8482, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4030/4618 (87.2672%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4081/4618 (88.3716%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0982, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4429/5083 (87.1336%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4430/5083 (87.1533%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1161, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3972/4511 (88.0514%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4035/4511 (89.4480%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1522, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3335/3797 (87.8325%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3394/3797 (89.3864%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9558, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5001/5582 (89.5915%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5050/5582 (90.4694%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0945, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3154/3616 (87.2235%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3200/3616 (88.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0322, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4834/5455 (88.6159%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4867/5455 (89.2209%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9151, Accuracy: 5353/10000 (53.5300%)
time spent on training: 255.78765726089478
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1263, Accuracy: 7029/10000 (70.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 10.1467, Accuracy: 29/9900 (0.2929%)
Done in 279.3809711933136 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4351/4885 (89.0686%), train_poison_data_count: 385
Global model norm: 42.464280140968185.
Norm before scaling: 42.46636565464559. Distance: 2.2114752125706065
Total norm for 4 adversaries is: 42.46636565464559. distance: 2.2114752125706065
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1995, Accuracy: 9405/9900 (95.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4758/5305 (89.6890%), train_poison_data_count: 415
Global model norm: 42.464280140968185.
Norm before scaling: 42.469846552712404. Distance: 2.235019404179871
Total norm for 4 adversaries is: 42.469846552712404. distance: 2.235019404179871
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.3375, Accuracy: 9077/9900 (91.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4196/4717 (88.9548%), train_poison_data_count: 370
Global model norm: 42.464280140968185.
Norm before scaling: 42.4718340721604. Distance: 2.154035896547623
Total norm for 4 adversaries is: 42.4718340721604. distance: 2.154035896547623
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.3182, Accuracy: 9115/9900 (92.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4469/5066 (88.2156%), train_poison_data_count: 400
Global model norm: 42.464280140968185.
Norm before scaling: 42.4748403239715. Distance: 2.3020987761887173
Total norm for 4 adversaries is: 42.4748403239715. distance: 2.3020987761887173
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.3327, Accuracy: 9088/9900 (91.7980%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3595/4025 (89.3168%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3711/4025 (92.1988%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8067, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3390/3797 (89.2810%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3467/3797 (91.3089%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9968, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4026/4625 (87.0486%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4017/4625 (86.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1456, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3826/4481 (85.3827%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3869/4481 (86.3423%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1708, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3867/4315 (89.6176%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3956/4315 (91.6802%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0699, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3709/4235 (87.5797%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3790/4235 (89.4923%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0364, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3381/3828 (88.3229%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3498/3828 (91.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8140, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3824/4416 (86.5942%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3947/4416 (89.3795%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1146, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3146/3638 (86.4761%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3292/3638 (90.4893%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9809, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4553/5265 (86.4767%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4549/5265 (86.4008%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0770, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3335/3781 (88.2042%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3393/3781 (89.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1324, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3970/4441 (89.3943%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4041/4441 (90.9930%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0452, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3959/4433 (89.3075%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3979/4433 (89.7586%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9285, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4419/5083 (86.9368%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4409/5083 (86.7401%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1384, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4286/4928 (86.9724%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4410/4928 (89.4886%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9351, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4164/4793 (86.8767%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4318/4793 (90.0897%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0752, Accuracy: 5278/10000 (52.7800%)
time spent on training: 253.6292610168457
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1585, Accuracy: 6942/10000 (69.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 10.2343, Accuracy: 24/9900 (0.2424%)
Done in 277.89011120796204 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4399/4885 (90.0512%), train_poison_data_count: 385
Global model norm: 42.49062971151699.
Norm before scaling: 42.48973192826636. Distance: 2.1186771571598046
Total norm for 4 adversaries is: 42.48973192826636. distance: 2.1186771571598046
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2734, Accuracy: 9250/9900 (93.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 42.49062971151699.
Norm before scaling: 42.495282079584285. Distance: 2.2039877642864787
Total norm for 4 adversaries is: 42.495282079584285. distance: 2.2039877642864787
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1543, Accuracy: 9517/9900 (96.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4193/4717 (88.8912%), train_poison_data_count: 370
Global model norm: 42.49062971151699.
Norm before scaling: 42.4958278627701. Distance: 2.137535706160504
Total norm for 4 adversaries is: 42.4958278627701. distance: 2.137535706160504
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3423, Accuracy: 9066/9900 (91.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4508/5066 (88.9854%), train_poison_data_count: 400
Global model norm: 42.49062971151699.
Norm before scaling: 42.49460558595938. Distance: 2.220242173156928
Total norm for 4 adversaries is: 42.49460558595938. distance: 2.220242173156928
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3831, Accuracy: 8967/9900 (90.5758%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3138/3616 (86.7810%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3255/3616 (90.0166%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9366, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3359/3837 (87.5424%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3539/3837 (92.2335%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0146, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4099/4679 (87.6042%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4009/4679 (85.6807%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1680, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3115/3638 (85.6240%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3296/3638 (90.5992%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9771, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3630/4046 (89.7182%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3704/4046 (91.5472%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8887, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3988/4518 (88.2691%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4055/4518 (89.7521%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9915, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3359/3797 (88.4646%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3397/3797 (89.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9525, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4410/5025 (87.7612%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4486/5025 (89.2736%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0543, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3848/4362 (88.2164%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3981/4362 (91.2655%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8786, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3978/4558 (87.2751%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4012/4558 (88.0211%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3899, Accuracy: 4886/10000 (48.8600%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3168/3672 (86.2745%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3353/3672 (91.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9452, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4286/4874 (87.9360%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4246/4874 (87.1153%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3217, Accuracy: 4910/10000 (49.1000%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3594/4025 (89.2919%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3694/4025 (91.7764%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8921, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4108/4663 (88.0978%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4222/4663 (90.5426%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0381, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3435/3911 (87.8292%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3445/3911 (88.0849%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0938, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4416/5017 (88.0207%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4477/5017 (89.2366%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8658, Accuracy: 5542/10000 (55.4200%)
time spent on training: 230.94836950302124
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1462, Accuracy: 6935/10000 (69.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.7709, Accuracy: 26/9900 (0.2626%)
Done in 251.88635778427124 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4389/4885 (89.8465%), train_poison_data_count: 385
Global model norm: 42.52362624544737.
Norm before scaling: 42.52765644260215. Distance: 2.126813339249824
Total norm for 4 adversaries is: 42.52765644260215. distance: 2.126813339249824
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1067, Accuracy: 9631/9900 (97.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4763/5305 (89.7832%), train_poison_data_count: 415
Global model norm: 42.52362624544737.
Norm before scaling: 42.52732778341989. Distance: 2.2253603182726565
Total norm for 4 adversaries is: 42.52732778341989. distance: 2.2253603182726565
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0778, Accuracy: 9705/9900 (98.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4199/4717 (89.0184%), train_poison_data_count: 370
Global model norm: 42.52362624544737.
Norm before scaling: 42.528227643347364. Distance: 2.079746961424266
Total norm for 4 adversaries is: 42.528227643347364. distance: 2.079746961424266
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3462, Accuracy: 9064/9900 (91.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4472/5066 (88.2748%), train_poison_data_count: 400
Global model norm: 42.52362624544737.
Norm before scaling: 42.52945612950952. Distance: 2.261403959567412
Total norm for 4 adversaries is: 42.52945612950952. distance: 2.261403959567412
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1187, Accuracy: 9586/9900 (96.8283%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5236/6124 (85.4997%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5266/6124 (85.9895%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0769, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3804/4356 (87.3278%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3716/4356 (85.3076%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1258, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3570/4158 (85.8586%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3617/4158 (86.9889%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9628, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4789/5455 (87.7910%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4876/5455 (89.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0808, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3935/4511 (87.2312%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4066/4511 (90.1352%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.7773, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4529/5232 (86.5635%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4568/5232 (87.3089%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0682, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4409/5244 (84.0770%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4576/5244 (87.2616%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1982, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4297/4918 (87.3729%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4429/4918 (90.0569%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1126, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3607/4126 (87.4212%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3704/4126 (89.7722%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9353, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4312/4928 (87.5000%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4393/4928 (89.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9485, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3689/4223 (87.3550%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3855/4223 (91.2858%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0005, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4507/5195 (86.7565%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4537/5195 (87.3340%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0808, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4093/4679 (87.4760%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4188/4679 (89.5063%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1081, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3207/3646 (87.9594%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3342/3646 (91.6621%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8933, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3140/3616 (86.8363%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3275/3616 (90.5697%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0014, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4080/4716 (86.5140%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4187/4716 (88.7829%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0185, Accuracy: 5305/10000 (53.0500%)
time spent on training: 234.97434639930725
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.1654, Accuracy: 6933/10000 (69.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 10.1285, Accuracy: 18/9900 (0.1818%)
Done in 255.98022150993347 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4373/4885 (89.5189%), train_poison_data_count: 385
Global model norm: 42.555696501026745.
Norm before scaling: 42.55977672317563. Distance: 2.128940854972478
Total norm for 4 adversaries is: 42.55977672317563. distance: 2.128940854972478
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2607, Accuracy: 9220/9900 (93.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4768/5305 (89.8775%), train_poison_data_count: 415
Global model norm: 42.555696501026745.
Norm before scaling: 42.55898365614186. Distance: 2.1629660131823916
Total norm for 4 adversaries is: 42.55898365614186. distance: 2.1629660131823916
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2043, Accuracy: 9375/9900 (94.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 42.555696501026745.
Norm before scaling: 42.55433825242219. Distance: 2.032524413352825
Total norm for 4 adversaries is: 42.55433825242219. distance: 2.032524413352825
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.0655, Accuracy: 9707/9900 (98.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 42.555696501026745.
Norm before scaling: 42.56281404757488. Distance: 2.233621750422932
Total norm for 4 adversaries is: 42.56281404757488. distance: 2.233621750422932
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1734, Accuracy: 9446/9900 (95.4141%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5254/6124 (85.7936%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5242/6124 (85.5976%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1046, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3969/4433 (89.5330%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4015/4433 (90.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9273, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3388/3781 (89.6059%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3291/3781 (87.0405%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1669, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3538/3969 (89.1408%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3566/3969 (89.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0318, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4426/5025 (88.0796%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4548/5025 (90.5075%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1659, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4270/4679 (91.2588%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4212/4679 (90.0192%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0153, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4151/4707 (88.1878%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4281/4707 (90.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0471, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4380/4986 (87.8460%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4469/4986 (89.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0175, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3868/4315 (89.6408%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3968/4315 (91.9583%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9987, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3836/4416 (86.8659%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3883/4416 (87.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9565, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4208/4804 (87.5937%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4042/4804 (84.1382%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3750, Accuracy: 4890/10000 (48.9000%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4145/4793 (86.4803%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4290/4793 (89.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9755, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4504/5232 (86.0856%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4626/5232 (88.4174%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0876, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4151/4662 (89.0390%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4209/4662 (90.2831%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0099, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4271/4956 (86.1784%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4338/4956 (87.5303%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2346, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3793/4368 (86.8361%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3878/4368 (88.7821%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0296, Accuracy: 5327/10000 (53.2700%)
time spent on training: 234.9765453338623
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.1834, Accuracy: 6900/10000 (69.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.9881, Accuracy: 22/9900 (0.2222%)
Done in 255.91218209266663 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 42.59343618052038.
Norm before scaling: 42.595446591302455. Distance: 2.102749740881763
Total norm for 4 adversaries is: 42.595446591302455. distance: 2.102749740881763
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2724, Accuracy: 9229/9900 (93.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4757/5305 (89.6701%), train_poison_data_count: 415
Global model norm: 42.59343618052038.
Norm before scaling: 42.59380731837669. Distance: 2.202868832243884
Total norm for 4 adversaries is: 42.59380731837669. distance: 2.202868832243884
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2697, Accuracy: 9239/9900 (93.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4242/4717 (89.9300%), train_poison_data_count: 370
Global model norm: 42.59343618052038.
Norm before scaling: 42.592470347156876. Distance: 2.015744701054452
Total norm for 4 adversaries is: 42.592470347156876. distance: 2.015744701054452
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1495, Accuracy: 9511/9900 (96.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 42.59343618052038.
Norm before scaling: 42.59797845619775. Distance: 2.2461573318106693
Total norm for 4 adversaries is: 42.59797845619775. distance: 2.2461573318106693
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1782, Accuracy: 9417/9900 (95.1212%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0076, Accuracy: 5203/6124 (84.9608%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5384/6124 (87.9164%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0458, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0077, Accuracy: 5046/5902 (85.4964%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0080, Accuracy: 5000/5902 (84.7170%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1774, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4172/4707 (88.6339%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4302/4707 (91.3958%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8362, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4060/4647 (87.3682%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4225/4647 (90.9189%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9403, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2911/3297 (88.2924%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3047/3297 (92.4173%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8283, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5520/6263 (88.1367%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5634/6263 (89.9569%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2381, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4150/4663 (88.9985%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4245/4663 (91.0358%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9995, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4257/4956 (85.8959%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4330/4956 (87.3688%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1794, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3624/4046 (89.5699%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3642/4046 (90.0148%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0336, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3675/4184 (87.8346%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3736/4184 (89.2925%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9306, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4828/5591 (86.3531%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4859/5591 (86.9075%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1937, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4067/4634 (87.7644%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4101/4634 (88.4981%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0747, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3392/3828 (88.6102%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3497/3828 (91.3532%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9049, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3157/3638 (86.7784%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3304/3638 (90.8191%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0015, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3407/3781 (90.1084%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3320/3781 (87.8075%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1050, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3396/3837 (88.5066%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3499/3837 (91.1910%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0262, Accuracy: 5444/10000 (54.4400%)
time spent on training: 234.45911383628845
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1853, Accuracy: 6900/10000 (69.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.8928, Accuracy: 29/9900 (0.2929%)
Done in 255.4307074546814 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4356/4885 (89.1709%), train_poison_data_count: 385
Global model norm: 42.63132857161796.
Norm before scaling: 42.63502362210924. Distance: 2.155800703480315
Total norm for 4 adversaries is: 42.63502362210924. distance: 2.155800703480315
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.3381, Accuracy: 9066/9900 (91.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4749/5305 (89.5193%), train_poison_data_count: 415
Global model norm: 42.63132857161796.
Norm before scaling: 42.63163352204337. Distance: 2.19398409472032
Total norm for 4 adversaries is: 42.63163352204337. distance: 2.19398409472032
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1111, Accuracy: 9612/9900 (97.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4208/4717 (89.2092%), train_poison_data_count: 370
Global model norm: 42.63132857161796.
Norm before scaling: 42.633176852712815. Distance: 2.0669385372301257
Total norm for 4 adversaries is: 42.633176852712815. distance: 2.0669385372301257
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.0392, Accuracy: 9779/9900 (98.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4502/5066 (88.8670%), train_poison_data_count: 400
Global model norm: 42.63132857161796.
Norm before scaling: 42.63801264212853. Distance: 2.2396488505398264
Total norm for 4 adversaries is: 42.63801264212853. distance: 2.2396488505398264
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1122, Accuracy: 9591/9900 (96.8788%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3915/4501 (86.9807%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4006/4501 (89.0024%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0222, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3638/4175 (87.1377%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3715/4175 (88.9820%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9297, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3146/3616 (87.0022%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3247/3616 (89.7954%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0021, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4128/4634 (89.0807%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4183/4634 (90.2676%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0067, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3997/4558 (87.6920%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4006/4558 (87.8894%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1133, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4508/5167 (87.2460%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4632/5167 (89.6458%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.3171, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3900/4356 (89.5317%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3955/4356 (90.7943%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2732, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4086/4716 (86.6412%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4186/4716 (88.7617%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9421, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5275/6124 (86.1365%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5338/6124 (87.1653%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0355, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4432/5055 (87.6756%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4538/5055 (89.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8878, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4423/5025 (88.0199%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4586/5025 (91.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9263, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4358/4918 (88.6133%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4408/4918 (89.6299%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0241, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3716/4223 (87.9943%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3871/4223 (91.6647%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0210, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0083, Accuracy: 3848/4481 (85.8737%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3820/4481 (85.2488%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1023, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3150/3638 (86.5860%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3277/3638 (90.0770%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8735, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3559/4013 (88.6868%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3682/4013 (91.7518%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8543, Accuracy: 5553/10000 (55.5300%)
time spent on training: 233.40392351150513
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1909, Accuracy: 6909/10000 (69.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 9.7823, Accuracy: 42/9900 (0.4242%)
Done in 254.5888819694519 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 42.66551953998905.
Norm before scaling: 42.665955855488576. Distance: 2.11922590374205
Total norm for 4 adversaries is: 42.665955855488576. distance: 2.11922590374205
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1691, Accuracy: 9463/9900 (95.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 42.66551953998905.
Norm before scaling: 42.66366836821246. Distance: 2.187855500898096
Total norm for 4 adversaries is: 42.66366836821246. distance: 2.187855500898096
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1704, Accuracy: 9467/9900 (95.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4238/4717 (89.8452%), train_poison_data_count: 370
Global model norm: 42.66551953998905.
Norm before scaling: 42.663696980443014. Distance: 2.0348307812416673
Total norm for 4 adversaries is: 42.663696980443014. distance: 2.0348307812416673
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2041, Accuracy: 9354/9900 (94.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4511/5066 (89.0446%), train_poison_data_count: 400
Global model norm: 42.66551953998905.
Norm before scaling: 42.66995687514299. Distance: 2.208350403437827
Total norm for 4 adversaries is: 42.66995687514299. distance: 2.208350403437827
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1668, Accuracy: 9467/9900 (95.6263%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3227/3646 (88.5080%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3337/3646 (91.5250%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8210, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3895/4501 (86.5363%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4044/4501 (89.8467%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1205, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4105/4651 (88.2606%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4171/4651 (89.6796%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1169, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4552/5167 (88.0975%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4612/5167 (89.2588%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2158, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4871/5455 (89.2942%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4855/5455 (89.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0616, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4829/5591 (86.3710%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4883/5591 (87.3368%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2175, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4249/4679 (90.8100%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4216/4679 (90.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0923, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4556/5017 (90.8112%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4552/5017 (90.7315%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0324, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4155/4793 (86.6889%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4280/4793 (89.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0301, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3961/4456 (88.8914%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4053/4456 (90.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9905, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4778/5424 (88.0900%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4857/5424 (89.5465%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2830, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3663/4175 (87.7365%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3682/4175 (88.1916%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0062, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4516/5116 (88.2721%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4523/5116 (88.4089%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9957, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3288/3704 (88.7689%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3345/3704 (90.3078%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9777, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4648/5232 (88.8379%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4657/5232 (89.0099%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2323, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3096/3472 (89.1705%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3194/3472 (91.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9362, Accuracy: 5636/10000 (56.3600%)
time spent on training: 234.94607877731323
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.2147, Accuracy: 6819/10000 (68.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 9.6524, Accuracy: 54/9900 (0.5455%)
Done in 256.0845355987549 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4403/4885 (90.1331%), train_poison_data_count: 385
Global model norm: 42.69611661525481.
Norm before scaling: 42.69630674162579. Distance: 2.0944312965706677
Total norm for 4 adversaries is: 42.69630674162579. distance: 2.0944312965706677
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2566, Accuracy: 9249/9900 (93.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4744/5305 (89.4251%), train_poison_data_count: 415
Global model norm: 42.69611661525481.
Norm before scaling: 42.70126402366504. Distance: 2.238459022479215
Total norm for 4 adversaries is: 42.70126402366504. distance: 2.238459022479215
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1487, Accuracy: 9500/9900 (95.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4213/4717 (89.3152%), train_poison_data_count: 370
Global model norm: 42.69611661525481.
Norm before scaling: 42.69429536185499. Distance: 2.0783258785592342
Total norm for 4 adversaries is: 42.69429536185499. distance: 2.0783258785592342
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1505, Accuracy: 9494/9900 (95.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4469/5066 (88.2156%), train_poison_data_count: 400
Global model norm: 42.69611661525481.
Norm before scaling: 42.7040397359035. Distance: 2.3121379878237263
Total norm for 4 adversaries is: 42.7040397359035. distance: 2.3121379878237263
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.0642, Accuracy: 9723/9900 (98.2121%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3192/3590 (88.9136%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3053/3590 (85.0418%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2525, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3784/4368 (86.6300%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3851/4368 (88.1639%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0358, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3285/3704 (88.6879%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3356/3704 (90.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8328, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4353/4928 (88.3320%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4469/4928 (90.6859%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8411, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3853/4356 (88.4527%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3517/4356 (80.7392%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.3719, Accuracy: 4831/10000 (48.3100%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3457/3911 (88.3917%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3438/3911 (87.9059%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0965, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4082/4651 (87.7661%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4139/4651 (88.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.3052, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3667/4184 (87.6434%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3764/4184 (89.9618%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0969, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3840/4346 (88.3571%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4001/4346 (92.0617%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8842, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4142/4793 (86.4177%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4304/4793 (89.7976%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1292, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3339/3804 (87.7760%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3417/3804 (89.8265%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0468, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4409/4986 (88.4276%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4452/4986 (89.2900%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9348, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5316/6124 (86.8060%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5321/6124 (86.8877%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1407, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4110/4707 (87.3168%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4223/4707 (89.7174%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8721, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3723/4235 (87.9103%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3775/4235 (89.1381%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9643, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3663/4046 (90.5339%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3653/4046 (90.2867%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0327, Accuracy: 5449/10000 (54.4900%)
time spent on training: 230.71290230751038
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.2038, Accuracy: 6828/10000 (68.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.3951, Accuracy: 74/9900 (0.7475%)
Done in 251.7542073726654 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4423/4885 (90.5425%), train_poison_data_count: 385
Global model norm: 42.72577181454347.
Norm before scaling: 42.73030573633089. Distance: 2.120072317329479
Total norm for 4 adversaries is: 42.73030573633089. distance: 2.120072317329479
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3669, Accuracy: 9026/9900 (91.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 42.72577181454347.
Norm before scaling: 42.730267170026856. Distance: 2.239126847933742
Total norm for 4 adversaries is: 42.730267170026856. distance: 2.239126847933742
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0500, Accuracy: 9773/9900 (98.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 42.72577181454347.
Norm before scaling: 42.72584181258164. Distance: 2.0349366990350313
Total norm for 4 adversaries is: 42.72584181258164. distance: 2.0349366990350313
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.4167, Accuracy: 8852/9900 (89.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4520/5066 (89.2223%), train_poison_data_count: 400
Global model norm: 42.72577181454347.
Norm before scaling: 42.73148841942043. Distance: 2.2364562685038525
Total norm for 4 adversaries is: 42.73148841942043. distance: 2.2364562685038525
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1824, Accuracy: 9440/9900 (95.3535%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4400/4986 (88.2471%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4448/4986 (89.2098%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9891, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4110/4634 (88.6923%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4130/4634 (89.1239%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9488, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4241/4716 (89.9279%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4231/4716 (89.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9232, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5297/6124 (86.4958%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5353/6124 (87.4102%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0921, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4386/4918 (89.1826%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4437/4918 (90.2196%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9184, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3372/3797 (88.8070%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3450/3797 (90.8612%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9878, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5045/5582 (90.3798%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5013/5582 (89.8065%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1885, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4364/4956 (88.0549%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4400/4956 (88.7813%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1024, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3973/4433 (89.6233%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4057/4433 (91.5182%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8527, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3844/4354 (88.2866%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0109, Accuracy: 3494/4354 (80.2480%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.7329, Accuracy: 4377/10000 (43.7700%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4349/4928 (88.2508%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4451/4928 (90.3206%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9731, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3432/3911 (87.7525%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3482/3911 (89.0309%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1579, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3889/4481 (86.7887%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3883/4481 (86.6548%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3217, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4605/5197 (88.6088%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4595/5197 (88.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0213, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4843/5455 (88.7809%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4890/5455 (89.6425%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0884, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3801/4361 (87.1589%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3888/4361 (89.1539%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0605, Accuracy: 5347/10000 (53.4700%)
time spent on training: 235.5299689769745
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.2315, Accuracy: 6773/10000 (67.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 8.9409, Accuracy: 119/9900 (1.2020%)
Done in 256.6687536239624 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4408/4885 (90.2354%), train_poison_data_count: 385
Global model norm: 42.754325781689914.
Norm before scaling: 42.75926349059128. Distance: 2.129171876347309
Total norm for 4 adversaries is: 42.75926349059128. distance: 2.129171876347309
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2462, Accuracy: 9294/9900 (93.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4750/5305 (89.5382%), train_poison_data_count: 415
Global model norm: 42.754325781689914.
Norm before scaling: 42.75830140296954. Distance: 2.2452205121463775
Total norm for 4 adversaries is: 42.75830140296954. distance: 2.2452205121463775
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1099, Accuracy: 9618/9900 (97.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4233/4717 (89.7392%), train_poison_data_count: 370
Global model norm: 42.754325781689914.
Norm before scaling: 42.7593705464808. Distance: 2.118182071874799
Total norm for 4 adversaries is: 42.7593705464808. distance: 2.118182071874799
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0881, Accuracy: 9661/9900 (97.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4550/5066 (89.8144%), train_poison_data_count: 400
Global model norm: 42.754325781689914.
Norm before scaling: 42.757359278385486. Distance: 2.1594959098210147
Total norm for 4 adversaries is: 42.757359278385486. distance: 2.1594959098210147
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2431, Accuracy: 9292/9900 (93.8586%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4251/4928 (86.2622%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4417/4928 (89.6307%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0123, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3684/4184 (88.0497%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3706/4184 (88.5755%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0222, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4119/4707 (87.5080%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4244/4707 (90.1636%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9679, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3391/3828 (88.5841%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3498/3828 (91.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7830, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4022/4503 (89.3182%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4065/4503 (90.2732%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0085, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4128/4662 (88.5457%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4213/4662 (90.3689%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9581, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3773/4235 (89.0909%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3801/4235 (89.7521%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9678, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4440/5244 (84.6682%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4518/5244 (86.1556%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9634, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4174/4793 (87.0853%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4362/4793 (91.0077%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9249, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3900/4481 (87.0341%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3898/4481 (86.9895%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0397, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3888/4346 (89.4616%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4024/4346 (92.5909%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8408, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3817/4361 (87.5258%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3786/4361 (86.8150%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0426, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4473/5055 (88.4866%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4557/5055 (90.1484%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1228, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4534/5195 (87.2762%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4568/5195 (87.9307%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1306, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3873/4315 (89.7567%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3954/4315 (91.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9724, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4152/4663 (89.0414%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4241/4663 (90.9500%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0560, Accuracy: 5297/10000 (52.9700%)
time spent on training: 236.5625352859497
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.2245, Accuracy: 6837/10000 (68.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 9.1876, Accuracy: 97/9900 (0.9798%)
Done in 261.06409978866577 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4408/4885 (90.2354%), train_poison_data_count: 385
Global model norm: 42.783987711434605.
Norm before scaling: 42.783732351283355. Distance: 2.0674473928564674
Total norm for 4 adversaries is: 42.783732351283355. distance: 2.0674473928564674
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1243, Accuracy: 9576/9900 (96.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 42.783987711434605.
Norm before scaling: 42.787669578615166. Distance: 2.1963665695389025
Total norm for 4 adversaries is: 42.787669578615166. distance: 2.1963665695389025
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1628, Accuracy: 9498/9900 (95.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4221/4717 (89.4848%), train_poison_data_count: 370
Global model norm: 42.783987711434605.
Norm before scaling: 42.78756972587804. Distance: 2.0993057102353756
Total norm for 4 adversaries is: 42.78756972587804. distance: 2.0993057102353756
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1673, Accuracy: 9469/9900 (95.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4517/5066 (89.1630%), train_poison_data_count: 400
Global model norm: 42.783987711434605.
Norm before scaling: 42.79116998301898. Distance: 2.2723187712365562
Total norm for 4 adversaries is: 42.79116998301898. distance: 2.2723187712365562
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1732, Accuracy: 9454/9900 (95.4949%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3891/4315 (90.1738%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3998/4315 (92.6535%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7853, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3196/3590 (89.0251%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3023/3590 (84.2061%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2633, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4336/4679 (92.6694%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4284/4679 (91.5580%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9655, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4587/5167 (88.7749%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4647/5167 (89.9361%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0933, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3374/3775 (89.3775%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3487/3775 (92.3709%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8637, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3427/3828 (89.5246%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3494/3828 (91.2748%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8855, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3860/4235 (91.1452%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3845/4235 (90.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9090, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4067/4647 (87.5188%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4172/4647 (89.7784%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9921, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4331/4918 (88.0643%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4443/4918 (90.3416%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0095, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3928/4433 (88.6082%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4043/4433 (91.2023%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9986, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3842/4481 (85.7398%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3898/4481 (86.9895%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0868, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3770/4295 (87.7765%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3830/4295 (89.1735%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9803, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3955/4503 (87.8303%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4047/4503 (89.8734%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0868, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3842/4354 (88.2407%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3662/4354 (84.1066%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.3540, Accuracy: 4910/10000 (49.1000%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4355/4986 (87.3446%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4460/4986 (89.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0210, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5566/6263 (88.8711%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5630/6263 (89.8930%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2815, Accuracy: 5143/10000 (51.4300%)
time spent on training: 257.1962208747864
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.2261, Accuracy: 6827/10000 (68.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 9.4802, Accuracy: 83/9900 (0.8384%)
Done in 281.5579113960266 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4428/4885 (90.6448%), train_poison_data_count: 385
Global model norm: 42.82505233414053.
Norm before scaling: 42.825253289804806. Distance: 2.07610343181517
Total norm for 4 adversaries is: 42.825253289804806. distance: 2.07610343181517
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.2279, Accuracy: 9358/9900 (94.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 42.82505233414053.
Norm before scaling: 42.8266371503691. Distance: 2.204014050897579
Total norm for 4 adversaries is: 42.8266371503691. distance: 2.204014050897579
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1833, Accuracy: 9432/9900 (95.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 42.82505233414053.
Norm before scaling: 42.82726136943909. Distance: 2.0596256456679134
Total norm for 4 adversaries is: 42.82726136943909. distance: 2.0596256456679134
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.4449, Accuracy: 8810/9900 (88.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4486/5066 (88.5511%), train_poison_data_count: 400
Global model norm: 42.82505233414053.
Norm before scaling: 42.830697261773444. Distance: 2.261460996181397
Total norm for 4 adversaries is: 42.830697261773444. distance: 2.261460996181397
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.2445, Accuracy: 9284/9900 (93.7778%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3713/4223 (87.9233%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3851/4223 (91.1911%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0501, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4831/5455 (88.5610%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4784/5455 (87.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0661, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5004/5582 (89.6453%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4947/5582 (88.6241%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1935, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3959/4465 (88.6674%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4058/4465 (90.8847%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8663, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4813/5591 (86.0848%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4889/5591 (87.4441%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1084, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3562/3911 (91.0765%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3554/3911 (90.8719%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9505, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3850/4356 (88.3838%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3629/4356 (83.3104%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3536, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4414/5037 (87.6315%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4478/5037 (88.9021%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1035, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4349/4679 (92.9472%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4304/4679 (91.9855%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1301, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3925/4362 (89.9817%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3923/4362 (89.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1432, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4066/4518 (89.9956%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4124/4518 (91.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9926, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4473/5083 (87.9992%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4446/5083 (87.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1208, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3588/4013 (89.4094%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3693/4013 (92.0259%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0702, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4578/5197 (88.0893%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4548/5197 (87.5120%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1739, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2934/3297 (88.9900%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3058/3297 (92.7510%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7297, Accuracy: 5951/10000 (59.5100%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4013/4441 (90.3625%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4103/4441 (92.3891%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0430, Accuracy: 5445/10000 (54.4500%)
time spent on training: 255.75214171409607
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.2327, Accuracy: 6787/10000 (67.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 9.1816, Accuracy: 93/9900 (0.9394%)
Done in 279.87440037727356 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4449/4885 (91.0747%), train_poison_data_count: 385
Global model norm: 42.862492196612735.
Norm before scaling: 42.86325828880502. Distance: 2.0694664719993043
Total norm for 4 adversaries is: 42.86325828880502. distance: 2.0694664719993043
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2766, Accuracy: 9242/9900 (93.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 42.862492196612735.
Norm before scaling: 42.86333233416486. Distance: 2.1608067890169336
Total norm for 4 adversaries is: 42.86333233416486. distance: 2.1608067890169336
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2844, Accuracy: 9216/9900 (93.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4278/4717 (90.6932%), train_poison_data_count: 370
Global model norm: 42.862492196612735.
Norm before scaling: 42.861204903061086. Distance: 2.0135216199018715
Total norm for 4 adversaries is: 42.861204903061086. distance: 2.0135216199018715
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1282, Accuracy: 9559/9900 (96.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4485/5066 (88.5314%), train_poison_data_count: 400
Global model norm: 42.862492196612735.
Norm before scaling: 42.86826603003526. Distance: 2.279751742884692
Total norm for 4 adversaries is: 42.86826603003526. distance: 2.279751742884692
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2061, Accuracy: 9357/9900 (94.5152%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3943/4501 (87.6028%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3972/4501 (88.2471%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2614, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3962/4511 (87.8297%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4064/4511 (90.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9510, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3824/4354 (87.8273%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0133, Accuracy: 3356/4354 (77.0785%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5952, Accuracy: 4377/10000 (43.7700%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3912/4346 (90.0138%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4016/4346 (92.4068%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9542, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4194/4707 (89.1013%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4262/4707 (90.5460%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9226, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4868/5591 (87.0685%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4939/5591 (88.3384%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1195, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4078/4647 (87.7555%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4197/4647 (90.3163%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9624, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4064/4538 (89.5549%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4175/4538 (92.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8652, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4305/4934 (87.2517%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4226/4934 (85.6506%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0797, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4215/4804 (87.7394%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4200/4804 (87.4271%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2308, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5718/6263 (91.2981%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5720/6263 (91.3300%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9842, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0082, Accuracy: 3870/4481 (86.3647%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3946/4481 (88.0607%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2655, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4379/5063 (86.4902%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4451/5063 (87.9123%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2119, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3702/4223 (87.6628%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3894/4223 (92.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8440, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3990/4441 (89.8446%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4080/4441 (91.8712%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0217, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3380/3756 (89.9894%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3482/3756 (92.7050%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8927, Accuracy: 5698/10000 (56.9800%)
time spent on training: 247.46357250213623
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.3008, Accuracy: 6729/10000 (67.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 9.1642, Accuracy: 77/9900 (0.7778%)
Done in 268.58377170562744 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4444/4885 (90.9724%), train_poison_data_count: 385
Global model norm: 42.89801422004797.
Norm before scaling: 42.8954274975237. Distance: 2.0707475313132555
Total norm for 4 adversaries is: 42.8954274975237. distance: 2.0707475313132555
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2788, Accuracy: 9239/9900 (93.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4779/5305 (90.0848%), train_poison_data_count: 415
Global model norm: 42.89801422004797.
Norm before scaling: 42.89883232039218. Distance: 2.1832485847429246
Total norm for 4 adversaries is: 42.89883232039218. distance: 2.1832485847429246
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2923, Accuracy: 9235/9900 (93.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4201/4717 (89.0608%), train_poison_data_count: 370
Global model norm: 42.89801422004797.
Norm before scaling: 42.90066480855075. Distance: 2.1011077502299047
Total norm for 4 adversaries is: 42.90066480855075. distance: 2.1011077502299047
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1944, Accuracy: 9372/9900 (94.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4506/5066 (88.9459%), train_poison_data_count: 400
Global model norm: 42.89801422004797.
Norm before scaling: 42.90323556645014. Distance: 2.2672197714256463
Total norm for 4 adversaries is: 42.90323556645014. distance: 2.2672197714256463
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1599, Accuracy: 9483/9900 (95.7879%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4521/5244 (86.2128%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4595/5244 (87.6240%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0117, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4344/4928 (88.1494%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4358/4928 (88.4334%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0262, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3352/3804 (88.1178%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3448/3804 (90.6414%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9221, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3596/4013 (89.6088%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3694/4013 (92.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.7818, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3551/4158 (85.4016%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3588/4158 (86.2915%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0621, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5112/5582 (91.5801%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5144/5582 (92.1534%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0669, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4835/5455 (88.6343%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4806/5455 (88.1027%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9935, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3789/4354 (87.0234%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0116, Accuracy: 3392/4354 (77.9054%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.3702, Accuracy: 4762/10000 (47.6200%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4042/4433 (91.1798%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4053/4433 (91.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8894, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3179/3646 (87.1914%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3313/3646 (90.8667%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8379, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4024/4518 (89.0660%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4155/4518 (91.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9222, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3861/4235 (91.1688%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3781/4235 (89.2798%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9158, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3934/4362 (90.1880%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3941/4362 (90.3485%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0887, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4797/5392 (88.9651%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4816/5392 (89.3175%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0859, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4866/5591 (87.0327%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4934/5591 (88.2490%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0985, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3364/3756 (89.5634%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3482/3756 (92.7050%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1028, Accuracy: 5455/10000 (54.5500%)
time spent on training: 233.3056299686432
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.2813, Accuracy: 6739/10000 (67.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 9.3907, Accuracy: 56/9900 (0.5657%)
Done in 254.23999691009521 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4419/4885 (90.4606%), train_poison_data_count: 385
Global model norm: 42.935306587444.
Norm before scaling: 42.935298058077315. Distance: 2.1024304267539558
Total norm for 4 adversaries is: 42.935298058077315. distance: 2.1024304267539558
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.3423, Accuracy: 9045/9900 (91.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 42.935306587444.
Norm before scaling: 42.93559942800598. Distance: 2.2118410885796362
Total norm for 4 adversaries is: 42.93559942800598. distance: 2.2118410885796362
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.2920, Accuracy: 9213/9900 (93.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 42.935306587444.
Norm before scaling: 42.93467683131404. Distance: 2.0599187246048176
Total norm for 4 adversaries is: 42.93467683131404. distance: 2.0599187246048176
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1856, Accuracy: 9446/9900 (95.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4494/5066 (88.7090%), train_poison_data_count: 400
Global model norm: 42.935306587444.
Norm before scaling: 42.93890298608521. Distance: 2.230842839551965
Total norm for 4 adversaries is: 42.93890298608521. distance: 2.230842839551965
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1084, Accuracy: 9619/9900 (97.1616%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4168/4634 (89.9439%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4194/4634 (90.5050%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8528, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4004/4503 (88.9185%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4089/4503 (90.8061%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9586, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4349/4928 (88.2508%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4450/4928 (90.3003%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9689, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3377/3804 (88.7750%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3449/3804 (90.6677%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1113, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3231/3590 (90.0000%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3050/3590 (84.9582%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.4036, Accuracy: 4743/10000 (47.4300%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4070/4647 (87.5834%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4200/4647 (90.3809%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9170, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4043/4625 (87.4162%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4065/4625 (87.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9961, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3836/4356 (88.0624%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3525/4356 (80.9229%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2577, Accuracy: 4885/10000 (48.8500%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3381/3797 (89.0440%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3433/3797 (90.4135%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8510, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4014/4456 (90.0808%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4081/4456 (91.5844%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9746, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3618/4025 (89.8882%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3749/4025 (93.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9284, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3124/3472 (89.9770%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3216/3472 (92.6267%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0053, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2953/3297 (89.5663%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3037/3297 (92.1140%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7855, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3842/4416 (87.0018%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3949/4416 (89.4248%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8949, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3889/4356 (89.2792%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3782/4356 (86.8228%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2102, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3173/3638 (87.2183%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3301/3638 (90.7367%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0101, Accuracy: 5489/10000 (54.8900%)
time spent on training: 253.7800796031952
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.2671, Accuracy: 6757/10000 (67.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 9.1240, Accuracy: 84/9900 (0.8485%)
Done in 278.45174288749695 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 42.96859801109483.
Norm before scaling: 42.96958806000908. Distance: 2.084472370304062
Total norm for 4 adversaries is: 42.96958806000908. distance: 2.084472370304062
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2047, Accuracy: 9398/9900 (94.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4755/5305 (89.6324%), train_poison_data_count: 415
Global model norm: 42.96859801109483.
Norm before scaling: 42.97009941062942. Distance: 2.2094878171959125
Total norm for 4 adversaries is: 42.97009941062942. distance: 2.2094878171959125
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2010, Accuracy: 9413/9900 (95.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4236/4717 (89.8028%), train_poison_data_count: 370
Global model norm: 42.96859801109483.
Norm before scaling: 42.972215769320066. Distance: 2.0851733919127255
Total norm for 4 adversaries is: 42.972215769320066. distance: 2.0851733919127255
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2290, Accuracy: 9325/9900 (94.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4544/5066 (89.6960%), train_poison_data_count: 400
Global model norm: 42.96859801109483.
Norm before scaling: 42.97000992471013. Distance: 2.208256042375463
Total norm for 4 adversaries is: 42.97000992471013. distance: 2.208256042375463
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1321, Accuracy: 9545/9900 (96.4141%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3600/4175 (86.2275%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3691/4175 (88.4072%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0800, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4457/4956 (89.9314%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4440/4956 (89.5884%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1256, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4370/5037 (86.7580%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4533/5037 (89.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9158, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4226/4793 (88.1702%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4341/4793 (90.5696%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0844, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3366/3804 (88.4858%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3446/3804 (90.5889%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8784, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4908/5392 (91.0237%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4848/5392 (89.9110%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0419, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4008/4465 (89.7648%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4087/4465 (91.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9303, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4057/4596 (88.2724%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4171/4596 (90.7528%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0250, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5267/6124 (86.0059%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5403/6124 (88.2266%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8778, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2866/3271 (87.6185%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2973/3271 (90.8896%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9425, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3210/3590 (89.4150%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3114/3590 (86.7409%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2399, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3917/4501 (87.0251%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3984/4501 (88.5137%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0092, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4664/5232 (89.1437%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4692/5232 (89.6789%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0392, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3246/3672 (88.3987%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3339/3672 (90.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8214, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3737/4223 (88.4916%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3789/4223 (89.7229%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0421, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3837/4354 (88.1259%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0168, Accuracy: 3068/4354 (70.4639%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.5246, Accuracy: 4431/10000 (44.3100%)
time spent on training: 259.50621271133423
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.2662, Accuracy: 6789/10000 (67.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 9.6289, Accuracy: 43/9900 (0.4343%)
Done in 284.0379636287689 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4391/4885 (89.8874%), train_poison_data_count: 385
Global model norm: 43.00400968087526.
Norm before scaling: 43.00292532972684. Distance: 2.1548797012703567
Total norm for 4 adversaries is: 43.00292532972684. distance: 2.1548797012703567
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2080, Accuracy: 9377/9900 (94.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4726/5305 (89.0858%), train_poison_data_count: 415
Global model norm: 43.00400968087526.
Norm before scaling: 43.00510393945991. Distance: 2.2739459645704816
Total norm for 4 adversaries is: 43.00510393945991. distance: 2.2739459645704816
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1504, Accuracy: 9505/9900 (96.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4237/4717 (89.8240%), train_poison_data_count: 370
Global model norm: 43.00400968087526.
Norm before scaling: 43.00331280389192. Distance: 2.0912559800139463
Total norm for 4 adversaries is: 43.00331280389192. distance: 2.0912559800139463
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1676, Accuracy: 9475/9900 (95.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4566/5066 (90.1303%), train_poison_data_count: 400
Global model norm: 43.00400968087526.
Norm before scaling: 43.004788863966944. Distance: 2.1569316726353387
Total norm for 4 adversaries is: 43.004788863966944. distance: 2.1569316726353387
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1937, Accuracy: 9421/9900 (95.1616%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5138/5582 (92.0459%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5130/5582 (91.9025%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9448, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4092/4647 (88.0568%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4195/4647 (90.2733%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0501, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4006/4465 (89.7200%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4058/4465 (90.8847%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9991, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4500/5083 (88.5304%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4498/5083 (88.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1585, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3841/4416 (86.9792%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3939/4416 (89.1984%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9799, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4374/4956 (88.2567%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4451/4956 (89.8103%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0901, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3950/4362 (90.5548%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4004/4362 (91.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9271, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3894/4356 (89.3939%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3796/4356 (87.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1725, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3420/3781 (90.4523%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3442/3781 (91.0341%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0518, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3227/3590 (89.8886%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3192/3590 (88.9136%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0379, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4196/4651 (90.2172%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4207/4651 (90.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1207, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4124/4662 (88.4599%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4265/4662 (91.4843%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8946, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3095/3472 (89.1417%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3150/3472 (90.7258%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0008, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4848/5424 (89.3805%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4976/5424 (91.7404%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.3426, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2899/3271 (88.6273%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2938/3271 (89.8196%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9202, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4436/5037 (88.0683%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4531/5037 (89.9543%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9274, Accuracy: 5552/10000 (55.5200%)
time spent on training: 261.36555194854736
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.2697, Accuracy: 6802/10000 (68.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 9.6391, Accuracy: 55/9900 (0.5556%)
Done in 286.01106905937195 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 43.037942868673305.
Norm before scaling: 43.033432849047. Distance: 2.077531887686504
Total norm for 4 adversaries is: 43.033432849047. distance: 2.077531887686504
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2283, Accuracy: 9362/9900 (94.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 43.037942868673305.
Norm before scaling: 43.03789465083722. Distance: 2.1874775476665835
Total norm for 4 adversaries is: 43.03789465083722. distance: 2.1874775476665835
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2609, Accuracy: 9267/9900 (93.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4228/4717 (89.6332%), train_poison_data_count: 370
Global model norm: 43.037942868673305.
Norm before scaling: 43.03559289540897. Distance: 2.06599615458955
Total norm for 4 adversaries is: 43.03559289540897. distance: 2.06599615458955
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1418, Accuracy: 9533/9900 (96.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4556/5066 (89.9329%), train_poison_data_count: 400
Global model norm: 43.037942868673305.
Norm before scaling: 43.03836973598384. Distance: 2.1451987528808543
Total norm for 4 adversaries is: 43.03836973598384. distance: 2.1451987528808543
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3137, Accuracy: 9134/9900 (92.2626%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4382/4989 (87.8332%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4449/4989 (89.1762%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8954, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3635/4013 (90.5806%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3721/4013 (92.7236%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8393, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4579/5195 (88.1424%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4630/5195 (89.1242%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2383, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3586/3969 (90.3502%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3657/3969 (92.1391%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7763, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3915/4356 (89.8760%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3897/4356 (89.4628%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0830, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4022/4441 (90.5652%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4087/4441 (92.0288%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1054, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4041/4518 (89.4422%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4119/4518 (91.1687%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1075, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3512/3911 (89.7980%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3490/3911 (89.2355%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.3305, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3948/4362 (90.5089%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4000/4362 (91.7011%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9707, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3364/3804 (88.4332%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3464/3804 (91.0620%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8595, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3782/4223 (89.5572%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3888/4223 (92.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0713, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4094/4634 (88.3470%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4146/4634 (89.4691%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9961, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3800/4354 (87.2761%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3749/4354 (86.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.4870, Accuracy: 4873/10000 (48.7300%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4498/5244 (85.7742%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4546/5244 (86.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9808, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4424/5037 (87.8301%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4568/5037 (90.6889%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9925, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3253/3704 (87.8240%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3383/3704 (91.3337%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8299, Accuracy: 5809/10000 (58.0900%)
time spent on training: 246.91323232650757
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.2817, Accuracy: 6814/10000 (68.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 9.7738, Accuracy: 50/9900 (0.5051%)
Done in 268.79287362098694 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 43.066509530771846.
Norm before scaling: 43.068137897442526. Distance: 2.1364334166989707
Total norm for 4 adversaries is: 43.068137897442526. distance: 2.1364334166989707
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1833, Accuracy: 9460/9900 (95.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4755/5305 (89.6324%), train_poison_data_count: 415
Global model norm: 43.066509530771846.
Norm before scaling: 43.06705232650303. Distance: 2.2517419006330743
Total norm for 4 adversaries is: 43.06705232650303. distance: 2.2517419006330743
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1387, Accuracy: 9539/9900 (96.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 43.066509530771846.
Norm before scaling: 43.06518156563664. Distance: 2.02681788568429
Total norm for 4 adversaries is: 43.06518156563664. distance: 2.02681788568429
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2095, Accuracy: 9395/9900 (94.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4537/5066 (89.5578%), train_poison_data_count: 400
Global model norm: 43.066509530771846.
Norm before scaling: 43.068604146012646. Distance: 2.1809324585374927
Total norm for 4 adversaries is: 43.068604146012646. distance: 2.1809324585374927
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1979, Accuracy: 9360/9900 (94.5455%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3841/4416 (86.9792%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3957/4416 (89.6060%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0256, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4572/5197 (87.9738%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4664/5197 (89.7441%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0340, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4398/4918 (89.4266%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4467/4918 (90.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1143, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5685/6263 (90.7712%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5713/6263 (91.2183%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0213, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3221/3646 (88.3434%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3327/3646 (91.2507%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8517, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4154/4707 (88.2515%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4260/4707 (90.5035%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9829, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4509/5063 (89.0579%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4493/5063 (88.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1940, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3776/4295 (87.9162%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3771/4295 (87.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1235, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4170/4793 (87.0019%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4383/4793 (91.4459%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0201, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4072/4538 (89.7312%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4190/4538 (92.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9058, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4483/5083 (88.1959%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4469/5083 (87.9205%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0624, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3148/3638 (86.5311%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3333/3638 (91.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8629, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5311/6124 (86.7244%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5327/6124 (86.9856%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9287, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4188/4618 (90.6886%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4305/4618 (93.2222%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8727, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3547/3969 (89.3676%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3619/3969 (91.1817%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9319, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3563/4158 (85.6902%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3692/4158 (88.7927%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9989, Accuracy: 5421/10000 (54.2100%)
time spent on training: 235.2665560245514
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.2442, Accuracy: 6846/10000 (68.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 10.0443, Accuracy: 29/9900 (0.2929%)
Done in 256.37177658081055 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4412/4885 (90.3173%), train_poison_data_count: 385
Global model norm: 43.10017826193921.
Norm before scaling: 43.09934132508582. Distance: 2.087916432034732
Total norm for 4 adversaries is: 43.09934132508582. distance: 2.087916432034732
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2036, Accuracy: 9384/9900 (94.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4771/5305 (89.9340%), train_poison_data_count: 415
Global model norm: 43.10017826193921.
Norm before scaling: 43.10159436173374. Distance: 2.198561033073656
Total norm for 4 adversaries is: 43.10159436173374. distance: 2.198561033073656
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2189, Accuracy: 9354/9900 (94.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4273/4717 (90.5872%), train_poison_data_count: 370
Global model norm: 43.10017826193921.
Norm before scaling: 43.1008480829409. Distance: 2.048733980908705
Total norm for 4 adversaries is: 43.1008480829409. distance: 2.048733980908705
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0963, Accuracy: 9650/9900 (97.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4541/5066 (89.6368%), train_poison_data_count: 400
Global model norm: 43.10017826193921.
Norm before scaling: 43.10191014564349. Distance: 2.2275983575925493
Total norm for 4 adversaries is: 43.10191014564349. distance: 2.2275983575925493
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2068, Accuracy: 9383/9900 (94.7778%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4152/4716 (88.0407%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4181/4716 (88.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0894, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3924/4481 (87.5697%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3935/4481 (87.8152%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1997, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3832/4361 (87.8698%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3898/4361 (89.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0158, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4185/4793 (87.3148%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4352/4793 (90.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9758, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3790/4295 (88.2421%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3782/4295 (88.0559%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1351, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4517/5244 (86.1365%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4559/5244 (86.9375%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1155, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4373/4989 (87.6528%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4490/4989 (89.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0278, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4702/5197 (90.4753%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4687/5197 (90.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1203, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3935/4356 (90.3352%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4063/4356 (93.2736%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0399, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4148/4647 (89.2619%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4205/4647 (90.4885%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9085, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3568/4013 (88.9110%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3692/4013 (92.0010%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0393, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4095/4538 (90.2380%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4203/4538 (92.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8208, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4177/4707 (88.7402%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4261/4707 (90.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9200, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5628/6263 (89.8611%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5727/6263 (91.4418%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1505, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3862/4235 (91.1924%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3928/4235 (92.7509%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9208, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3443/3861 (89.1738%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3544/3861 (91.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8632, Accuracy: 5633/10000 (56.3300%)
time spent on training: 235.68908596038818
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.2595, Accuracy: 6796/10000 (67.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 10.2223, Accuracy: 34/9900 (0.3434%)
Done in 256.7563645839691 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 43.13345280610587.
Norm before scaling: 43.13402447468602. Distance: 2.0936093638999655
Total norm for 4 adversaries is: 43.13402447468602. distance: 2.0936093638999655
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1949, Accuracy: 9397/9900 (94.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 43.13345280610587.
Norm before scaling: 43.130393401416335. Distance: 2.1882779509176644
Total norm for 4 adversaries is: 43.130393401416335. distance: 2.1882779509176644
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2055, Accuracy: 9396/9900 (94.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 43.13345280610587.
Norm before scaling: 43.12756304657078. Distance: 1.9902818129466715
Total norm for 4 adversaries is: 43.12756304657078. distance: 1.9902818129466715
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1397, Accuracy: 9526/9900 (96.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4555/5066 (89.9131%), train_poison_data_count: 400
Global model norm: 43.13345280610587.
Norm before scaling: 43.13212265681823. Distance: 2.1633377789695136
Total norm for 4 adversaries is: 43.13212265681823. distance: 2.1633377789695136
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.3357, Accuracy: 9127/9900 (92.1919%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4517/5055 (89.3571%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4571/5055 (90.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0361, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3396/3828 (88.7147%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3474/3828 (90.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0164, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3837/4361 (87.9844%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3736/4361 (85.6684%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0725, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3594/4013 (89.5589%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3692/4013 (92.0010%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8266, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4046/4518 (89.5529%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4130/4518 (91.4121%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1455, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4080/4558 (89.5129%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4066/4558 (89.2058%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0768, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3720/4126 (90.1600%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3810/4126 (92.3413%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8863, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4351/4679 (92.9900%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4257/4679 (90.9810%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0030, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3900/4235 (92.0897%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3788/4235 (89.4451%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0848, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4460/5037 (88.5448%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4498/5037 (89.2992%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0760, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3252/3672 (88.5621%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3336/3672 (90.8497%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0798, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4480/4928 (90.9091%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4528/4928 (91.8831%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0100, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3891/4356 (89.3251%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3905/4356 (89.6465%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0328, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4017/4456 (90.1481%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4077/4456 (91.4946%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0049, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4211/4793 (87.8573%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4342/4793 (90.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0387, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4485/5025 (89.2537%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4552/5025 (90.5871%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2586, Accuracy: 5127/10000 (51.2700%)
time spent on training: 231.8847839832306
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.2512, Accuracy: 6838/10000 (68.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 10.3783, Accuracy: 28/9900 (0.2828%)
Done in 253.03483963012695 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4436/4885 (90.8086%), train_poison_data_count: 385
Global model norm: 43.16366586356226.
Norm before scaling: 43.16197322432314. Distance: 2.0774479960739334
Total norm for 4 adversaries is: 43.16197322432314. distance: 2.0774479960739334
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2131, Accuracy: 9369/9900 (94.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4797/5305 (90.4241%), train_poison_data_count: 415
Global model norm: 43.16366586356226.
Norm before scaling: 43.1610908196513. Distance: 2.158003494903308
Total norm for 4 adversaries is: 43.1610908196513. distance: 2.158003494903308
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2235, Accuracy: 9374/9900 (94.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4235/4717 (89.7816%), train_poison_data_count: 370
Global model norm: 43.16366586356226.
Norm before scaling: 43.16387231292942. Distance: 2.068840338356629
Total norm for 4 adversaries is: 43.16387231292942. distance: 2.068840338356629
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2859, Accuracy: 9225/9900 (93.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 43.16366586356226.
Norm before scaling: 43.16720364701801. Distance: 2.278988278769346
Total norm for 4 adversaries is: 43.16720364701801. distance: 2.278988278769346
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2451, Accuracy: 9277/9900 (93.7071%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3895/4346 (89.6226%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4039/4346 (92.9360%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8411, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3747/4184 (89.5554%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3814/4184 (91.1568%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9368, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3920/4356 (89.9908%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3535/4356 (81.1524%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3979, Accuracy: 4784/10000 (47.8400%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3183/3646 (87.3012%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3289/3646 (90.2084%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8874, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4505/5083 (88.6288%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4559/5083 (89.6911%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0610, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3941/4356 (90.4729%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3695/4356 (84.8255%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1811, Accuracy: 4996/10000 (49.9600%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4039/4558 (88.6134%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3972/4558 (87.1435%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1693, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3722/4175 (89.1497%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3700/4175 (88.6228%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9703, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3125/3472 (90.0058%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3211/3472 (92.4827%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8878, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3991/4501 (88.6692%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3980/4501 (88.4248%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9176, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4879/5424 (89.9521%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4941/5424 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1458, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3869/4481 (86.3423%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3885/4481 (86.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0818, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4851/5455 (88.9276%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4929/5455 (90.3575%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0328, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4642/5232 (88.7232%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4688/5232 (89.6024%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9820, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5580/6391 (87.3103%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5617/6391 (87.8892%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0838, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3436/3775 (91.0199%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3547/3775 (93.9603%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8650, Accuracy: 5735/10000 (57.3500%)
time spent on training: 233.89917063713074
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.2558, Accuracy: 6814/10000 (68.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 10.6813, Accuracy: 31/9900 (0.3131%)
Done in 255.05608582496643 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4420/4885 (90.4811%), train_poison_data_count: 385
Global model norm: 43.19732810340748.
Norm before scaling: 43.196651300694015. Distance: 2.088685928905285
Total norm for 4 adversaries is: 43.196651300694015. distance: 2.088685928905285
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.2063, Accuracy: 9425/9900 (95.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 43.19732810340748.
Norm before scaling: 43.196307949960406. Distance: 2.199799537195427
Total norm for 4 adversaries is: 43.196307949960406. distance: 2.199799537195427
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.2253, Accuracy: 9352/9900 (94.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4245/4717 (89.9936%), train_poison_data_count: 370
Global model norm: 43.19732810340748.
Norm before scaling: 43.19705540546861. Distance: 2.0382280652033202
Total norm for 4 adversaries is: 43.19705540546861. distance: 2.0382280652033202
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1925, Accuracy: 9412/9900 (95.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4565/5066 (90.1105%), train_poison_data_count: 400
Global model norm: 43.19732810340748.
Norm before scaling: 43.196264147818674. Distance: 2.179162731373761
Total norm for 4 adversaries is: 43.196264147818674. distance: 2.179162731373761
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.2277, Accuracy: 9345/9900 (94.3939%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3655/4025 (90.8075%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3725/4025 (92.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8401, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3749/4223 (88.7758%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3802/4223 (90.0308%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0613, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3182/3638 (87.4656%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3302/3638 (90.7642%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8624, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4493/5063 (88.7419%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4350/5063 (85.9174%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3926, Accuracy: 4846/10000 (48.4600%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4307/4874 (88.3668%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4243/4874 (87.0538%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2323, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4341/4804 (90.3622%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4307/4804 (89.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0347, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3595/4158 (86.4598%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3667/4158 (88.1914%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9662, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4051/4518 (89.6636%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4098/4518 (90.7039%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0157, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3887/4235 (91.7828%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3888/4235 (91.8064%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9489, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4340/4934 (87.9611%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4050/4934 (82.0835%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2193, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5534/6391 (86.5905%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5538/6391 (86.6531%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2771, Accuracy: 4994/10000 (49.9400%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3856/4295 (89.7788%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3804/4295 (88.5681%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9030, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3418/3756 (91.0011%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3426/3756 (91.2141%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1083, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3833/4481 (85.5389%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3941/4481 (87.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1822, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3697/4175 (88.5509%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3646/4175 (87.3293%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0145, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3234/3590 (90.0836%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3288/3590 (91.5877%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1596, Accuracy: 5368/10000 (53.6800%)
time spent on training: 248.6043906211853
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.2523, Accuracy: 6798/10000 (67.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 10.3805, Accuracy: 32/9900 (0.3232%)
Done in 273.1305351257324 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4429/4885 (90.6653%), train_poison_data_count: 385
Global model norm: 43.23298301427395.
Norm before scaling: 43.233314779645774. Distance: 2.089391698699232
Total norm for 4 adversaries is: 43.233314779645774. distance: 2.089391698699232
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2959, Accuracy: 9190/9900 (92.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4773/5305 (89.9717%), train_poison_data_count: 415
Global model norm: 43.23298301427395.
Norm before scaling: 43.23268936450172. Distance: 2.2062711503957537
Total norm for 4 adversaries is: 43.23268936450172. distance: 2.2062711503957537
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1589, Accuracy: 9510/9900 (96.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4236/4717 (89.8028%), train_poison_data_count: 370
Global model norm: 43.23298301427395.
Norm before scaling: 43.232316652303055. Distance: 2.0556797199151333
Total norm for 4 adversaries is: 43.232316652303055. distance: 2.0556797199151333
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2184, Accuracy: 9321/9900 (94.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4536/5066 (89.5381%), train_poison_data_count: 400
Global model norm: 43.23298301427395.
Norm before scaling: 43.239187311233515. Distance: 2.266498686605999
Total norm for 4 adversaries is: 43.239187311233515. distance: 2.266498686605999
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1496, Accuracy: 9511/9900 (96.0707%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3447/3828 (90.0470%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3557/3828 (92.9206%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8172, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3645/3911 (93.1987%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3590/3911 (91.7924%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8798, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3967/4362 (90.9445%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4056/4362 (92.9849%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9487, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4704/5197 (90.5138%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4716/5197 (90.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0371, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4297/4679 (91.8359%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4341/4679 (92.7762%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9522, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4242/4793 (88.5041%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4304/4793 (89.7976%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0907, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4562/5116 (89.1712%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4484/5116 (87.6466%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1100, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4021/4625 (86.9405%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3966/4625 (85.7514%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1736, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4163/4618 (90.1472%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4220/4618 (91.3816%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9118, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2923/3271 (89.3611%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0055, Accuracy: 2926/3271 (89.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0313, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3710/4175 (88.8623%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3694/4175 (88.4790%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0909, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3187/3616 (88.1361%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3306/3616 (91.4270%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8704, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3983/4481 (88.8864%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3952/4481 (88.1946%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9783, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3942/4368 (90.2473%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3999/4368 (91.5522%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0016, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5077/5740 (88.4495%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5159/5740 (89.8780%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1873, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4138/4647 (89.0467%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4215/4647 (90.7037%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0854, Accuracy: 5369/10000 (53.6900%)
time spent on training: 256.8471677303314
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.2724, Accuracy: 6788/10000 (67.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 10.3359, Accuracy: 29/9900 (0.2929%)
Done in 281.0170683860779 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4419/4885 (90.4606%), train_poison_data_count: 385
Global model norm: 43.26494221201936.
Norm before scaling: 43.26015533997841. Distance: 2.1113505966585695
Total norm for 4 adversaries is: 43.26015533997841. distance: 2.1113505966585695
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2781, Accuracy: 9208/9900 (93.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 43.26494221201936.
Norm before scaling: 43.263891205329216. Distance: 2.1726954166156305
Total norm for 4 adversaries is: 43.263891205329216. distance: 2.1726954166156305
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2074, Accuracy: 9419/9900 (95.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4263/4717 (90.3752%), train_poison_data_count: 370
Global model norm: 43.26494221201936.
Norm before scaling: 43.26303909525789. Distance: 2.060458936215918
Total norm for 4 adversaries is: 43.26303909525789. distance: 2.060458936215918
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0902, Accuracy: 9645/9900 (97.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4544/5066 (89.6960%), train_poison_data_count: 400
Global model norm: 43.26494221201936.
Norm before scaling: 43.268684717107334. Distance: 2.2254026370120235
Total norm for 4 adversaries is: 43.268684717107334. distance: 2.2254026370120235
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1487, Accuracy: 9514/9900 (96.1010%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4903/5591 (87.6945%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4978/5591 (89.0360%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0606, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4537/4956 (91.5456%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4498/4956 (90.7587%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0655, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4004/4511 (88.7608%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4057/4511 (89.9357%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9348, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3641/4013 (90.7301%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3722/4013 (92.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8518, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3231/3590 (90.0000%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3299/3590 (91.8942%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0053, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4240/4793 (88.4623%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4324/4793 (90.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0232, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3396/3804 (89.2744%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3464/3804 (91.0620%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9930, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3465/3837 (90.3049%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3543/3837 (92.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8523, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3846/4361 (88.1908%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3788/4361 (86.8608%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2258, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4540/5063 (89.6702%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4280/5063 (84.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1333, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3901/4368 (89.3086%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3967/4368 (90.8196%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9001, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4341/4679 (92.7762%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4231/4679 (90.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1365, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4663/5265 (88.5660%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4655/5265 (88.4141%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9982, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4182/4767 (87.7281%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4264/4767 (89.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1742, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5083/5902 (86.1233%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5125/5902 (86.8350%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2475, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3710/4223 (87.8522%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3858/4223 (91.3569%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9794, Accuracy: 5489/10000 (54.8900%)
time spent on training: 253.2445158958435
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.2712, Accuracy: 6777/10000 (67.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 10.2054, Accuracy: 34/9900 (0.3434%)
Done in 277.1165015697479 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4437/4885 (90.8291%), train_poison_data_count: 385
Global model norm: 43.30182977558873.
Norm before scaling: 43.298226871262436. Distance: 2.0898754652237157
Total norm for 4 adversaries is: 43.298226871262436. distance: 2.0898754652237157
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2127, Accuracy: 9356/9900 (94.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4790/5305 (90.2922%), train_poison_data_count: 415
Global model norm: 43.30182977558873.
Norm before scaling: 43.29753472972653. Distance: 2.156991471777315
Total norm for 4 adversaries is: 43.29753472972653. distance: 2.156991471777315
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.5066, Accuracy: 8707/9900 (87.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 43.30182977558873.
Norm before scaling: 43.301019289208135. Distance: 2.0552952088911507
Total norm for 4 adversaries is: 43.301019289208135. distance: 2.0552952088911507
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.3625, Accuracy: 9070/9900 (91.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4518/5066 (89.1828%), train_poison_data_count: 400
Global model norm: 43.30182977558873.
Norm before scaling: 43.30077684511705. Distance: 2.2154613353718977
Total norm for 4 adversaries is: 43.30077684511705. distance: 2.2154613353718977
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1619, Accuracy: 9470/9900 (95.6566%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3399/3797 (89.5180%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3421/3797 (90.0974%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0158, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3411/3861 (88.3450%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3471/3861 (89.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9544, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4188/4707 (88.9739%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4299/4707 (91.3321%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9412, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4089/4518 (90.5046%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4146/4518 (91.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9806, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3641/4013 (90.7301%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3712/4013 (92.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8810, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4578/5167 (88.6007%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4680/5167 (90.5748%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0060, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3584/3969 (90.2998%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3660/3969 (92.2147%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8973, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4019/4441 (90.4976%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4068/4441 (91.6010%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0206, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4138/4558 (90.7854%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4175/4558 (91.5972%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9021, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4045/4465 (90.5935%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4118/4465 (92.2284%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8826, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3211/3638 (88.2628%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3308/3638 (90.9291%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8286, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4120/4538 (90.7889%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4206/4538 (92.6840%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.7593, Accuracy: 5888/10000 (58.8800%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5082/5740 (88.5366%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5126/5740 (89.3031%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1590, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3475/3837 (90.5655%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3572/3837 (93.0936%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8206, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3871/4361 (88.7640%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3862/4361 (88.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9868, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4254/4793 (88.7544%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4360/4793 (90.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9753, Accuracy: 5518/10000 (55.1800%)
time spent on training: 229.01373982429504
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.2729, Accuracy: 6760/10000 (67.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 9.8259, Accuracy: 74/9900 (0.7475%)
Done in 250.1448619365692 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 43.32987594505738.
Norm before scaling: 43.32780523006777. Distance: 2.107052916576994
Total norm for 4 adversaries is: 43.32780523006777. distance: 2.107052916576994
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1064, Accuracy: 9625/9900 (97.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 43.32987594505738.
Norm before scaling: 43.328027801459676. Distance: 2.204222926363494
Total norm for 4 adversaries is: 43.328027801459676. distance: 2.204222926363494
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1311, Accuracy: 9560/9900 (96.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4232/4717 (89.7180%), train_poison_data_count: 370
Global model norm: 43.32987594505738.
Norm before scaling: 43.33162400224431. Distance: 2.089533645581728
Total norm for 4 adversaries is: 43.33162400224431. distance: 2.089533645581728
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1470, Accuracy: 9524/9900 (96.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 43.32987594505738.
Norm before scaling: 43.32913500670983. Distance: 2.1877944748082405
Total norm for 4 adversaries is: 43.32913500670983. distance: 2.1877944748082405
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2039, Accuracy: 9377/9900 (94.7172%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4199/4767 (88.0847%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4277/4767 (89.7210%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2656, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4030/4441 (90.7453%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4075/4441 (91.7586%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1610, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3927/4356 (90.1515%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3951/4356 (90.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0224, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5571/6391 (87.1695%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5538/6391 (86.6531%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1594, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3734/4184 (89.2447%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3786/4184 (90.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9434, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3932/4346 (90.4740%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4033/4346 (92.7980%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8102, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4569/5037 (90.7088%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4671/5037 (92.7338%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9417, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4148/4634 (89.5123%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4235/4634 (91.3897%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8860, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4355/4934 (88.2651%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4058/4934 (82.2456%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2409, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4884/5424 (90.0442%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4961/5424 (91.4639%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1271, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3431/3781 (90.7432%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3495/3781 (92.4359%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9329, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3450/3861 (89.3551%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3537/3861 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8400, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4512/5055 (89.2582%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4594/5055 (90.8803%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0519, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4048/4433 (91.3151%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4017/4433 (90.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8164, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4601/5167 (89.0459%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4708/5167 (91.1167%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9588, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3219/3590 (89.6657%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3155/3590 (87.8830%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1224, Accuracy: 5355/10000 (53.5500%)
time spent on training: 234.68897342681885
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.2863, Accuracy: 6762/10000 (67.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 10.1463, Accuracy: 39/9900 (0.3939%)
Done in 255.7416751384735 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4453/4885 (91.1566%), train_poison_data_count: 385
Global model norm: 43.360450437113485.
Norm before scaling: 43.361055710669106. Distance: 2.0571820451205474
Total norm for 4 adversaries is: 43.361055710669106. distance: 2.0571820451205474
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2613, Accuracy: 9223/9900 (93.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4806/5305 (90.5938%), train_poison_data_count: 415
Global model norm: 43.360450437113485.
Norm before scaling: 43.358976631052855. Distance: 2.201868767752532
Total norm for 4 adversaries is: 43.358976631052855. distance: 2.201868767752532
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2042, Accuracy: 9403/9900 (94.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4250/4717 (90.0996%), train_poison_data_count: 370
Global model norm: 43.360450437113485.
Norm before scaling: 43.35553051650029. Distance: 2.021509260678645
Total norm for 4 adversaries is: 43.35553051650029. distance: 2.021509260678645
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1689, Accuracy: 9447/9900 (95.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4576/5066 (90.3277%), train_poison_data_count: 400
Global model norm: 43.360450437113485.
Norm before scaling: 43.359376407657635. Distance: 2.1534879381326046
Total norm for 4 adversaries is: 43.359376407657635. distance: 2.1534879381326046
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.3412, Accuracy: 9041/9900 (91.3232%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3974/4368 (90.9799%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3963/4368 (90.7280%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9422, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3463/3828 (90.4650%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3525/3828 (92.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8871, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3941/4356 (90.4729%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3693/4356 (84.7796%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1133, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3441/3861 (89.1220%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3477/3861 (90.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0478, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3122/3472 (89.9194%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3226/3472 (92.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9198, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4086/4538 (90.0397%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4150/4538 (91.4500%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9348, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4957/5392 (91.9325%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4859/5392 (90.1150%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0592, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3835/4295 (89.2899%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3866/4295 (90.0116%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0032, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3884/4235 (91.7119%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3906/4235 (92.2314%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9567, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4019/4456 (90.1930%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4106/4456 (92.1454%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0117, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4806/5265 (91.2821%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4771/5265 (90.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9774, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4056/4441 (91.3308%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4164/4441 (93.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9901, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3646/4013 (90.8547%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3741/4013 (93.2220%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8162, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4026/4465 (90.1680%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4128/4465 (92.4524%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8166, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5679/6263 (90.6754%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5676/6263 (90.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9738, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4497/4986 (90.1925%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4525/4986 (90.7541%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8821, Accuracy: 5683/10000 (56.8300%)
time spent on training: 232.81358766555786
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.2807, Accuracy: 6808/10000 (68.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 10.1135, Accuracy: 44/9900 (0.4444%)
Done in 253.9671814441681 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4444/4885 (90.9724%), train_poison_data_count: 385
Global model norm: 43.39373216503666.
Norm before scaling: 43.39153227580454. Distance: 2.086020135849995
Total norm for 4 adversaries is: 43.39153227580454. distance: 2.086020135849995
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2243, Accuracy: 9353/9900 (94.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4769/5305 (89.8963%), train_poison_data_count: 415
Global model norm: 43.39373216503666.
Norm before scaling: 43.393886884506124. Distance: 2.214910812304555
Total norm for 4 adversaries is: 43.393886884506124. distance: 2.214910812304555
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.3334, Accuracy: 9115/9900 (92.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 43.39373216503666.
Norm before scaling: 43.3937813940186. Distance: 2.0928871312589825
Total norm for 4 adversaries is: 43.3937813940186. distance: 2.0928871312589825
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1653, Accuracy: 9494/9900 (95.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4565/5066 (90.1105%), train_poison_data_count: 400
Global model norm: 43.39373216503666.
Norm before scaling: 43.39379686597282. Distance: 2.175416980980358
Total norm for 4 adversaries is: 43.39379686597282. distance: 2.175416980980358
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0775, Accuracy: 9696/9900 (97.9394%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3631/4158 (87.3256%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3717/4158 (89.3939%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9486, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4626/5167 (89.5297%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4676/5167 (90.4974%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1242, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3412/3828 (89.1327%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3497/3828 (91.3532%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9253, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4259/4663 (91.3360%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4263/4663 (91.4218%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1185, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3996/4433 (90.1421%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4008/4433 (90.4128%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9414, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3750/4184 (89.6272%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3727/4184 (89.0774%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8848, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4297/4716 (91.1154%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4306/4716 (91.3062%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8943, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3786/4223 (89.6519%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3869/4223 (91.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9193, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4303/4679 (91.9641%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4249/4679 (90.8100%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0871, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3322/3704 (89.6868%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3395/3704 (91.6577%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9217, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3442/3837 (89.7055%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3536/3837 (92.1553%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9354, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3403/3861 (88.1378%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3437/3861 (89.0184%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0702, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4846/5424 (89.3437%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4987/5424 (91.9432%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2605, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4126/4576 (90.1661%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4200/4576 (91.7832%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9265, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3654/4025 (90.7826%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3757/4025 (93.3416%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9420, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3417/3775 (90.5166%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3533/3775 (93.5894%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9392, Accuracy: 5673/10000 (56.7300%)
time spent on training: 227.34294414520264
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.2653, Accuracy: 6838/10000 (68.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 9.9589, Accuracy: 51/9900 (0.5152%)
Done in 248.31237626075745 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4429/4885 (90.6653%), train_poison_data_count: 385
Global model norm: 43.42132539459658.
Norm before scaling: 43.42060147916539. Distance: 2.1259867677106348
Total norm for 4 adversaries is: 43.42060147916539. distance: 2.1259867677106348
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1702, Accuracy: 9473/9900 (95.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4789/5305 (90.2733%), train_poison_data_count: 415
Global model norm: 43.42132539459658.
Norm before scaling: 43.42142519558317. Distance: 2.2122476423063246
Total norm for 4 adversaries is: 43.42142519558317. distance: 2.2122476423063246
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0637, Accuracy: 9720/9900 (98.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4278/4717 (90.6932%), train_poison_data_count: 370
Global model norm: 43.42132539459658.
Norm before scaling: 43.41659372119792. Distance: 2.022846268104313
Total norm for 4 adversaries is: 43.41659372119792. distance: 2.022846268104313
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2411, Accuracy: 9293/9900 (93.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4555/5066 (89.9131%), train_poison_data_count: 400
Global model norm: 43.42132539459658.
Norm before scaling: 43.420858716516506. Distance: 2.174787366273075
Total norm for 4 adversaries is: 43.420858716516506. distance: 2.174787366273075
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2621, Accuracy: 9248/9900 (93.4141%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4130/4576 (90.2535%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4228/4576 (92.3951%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8309, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3285/3672 (89.4608%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3338/3672 (90.9041%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8887, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4179/4618 (90.4937%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4253/4618 (92.0961%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9389, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4142/4538 (91.2737%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4173/4538 (91.9568%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9621, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4495/5025 (89.4527%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4575/5025 (91.0448%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0317, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3223/3590 (89.7772%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3326/3590 (92.6462%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0508, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4184/4707 (88.8889%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4240/4707 (90.0786%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8336, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4397/4918 (89.4063%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4507/4918 (91.6429%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1538, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3879/4336 (89.4603%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3966/4336 (91.4668%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1889, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5142/5902 (87.1230%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5113/5902 (86.6317%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0802, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4075/4441 (91.7586%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4115/4441 (92.6593%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0275, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4664/5232 (89.1437%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4704/5232 (89.9083%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9629, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4299/4804 (89.4879%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4273/4804 (88.9467%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1013, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3604/3969 (90.8037%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3684/3969 (92.8193%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9373, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5011/5392 (92.9340%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5004/5392 (92.8042%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9931, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3436/3828 (89.7597%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3521/3828 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9471, Accuracy: 5508/10000 (55.0800%)
time spent on training: 235.01164627075195
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.2740, Accuracy: 6821/10000 (68.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 10.0303, Accuracy: 50/9900 (0.5051%)
Done in 255.95460486412048 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4449/4885 (91.0747%), train_poison_data_count: 385
Global model norm: 43.447759017835146.
Norm before scaling: 43.443994006471996. Distance: 2.080208673096694
Total norm for 4 adversaries is: 43.443994006471996. distance: 2.080208673096694
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1029, Accuracy: 9620/9900 (97.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 43.447759017835146.
Norm before scaling: 43.44568970682319. Distance: 2.2072113233714816
Total norm for 4 adversaries is: 43.44568970682319. distance: 2.2072113233714816
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.3003, Accuracy: 9178/9900 (92.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4296/4717 (91.0748%), train_poison_data_count: 370
Global model norm: 43.447759017835146.
Norm before scaling: 43.440908701684926. Distance: 1.9920984584880705
Total norm for 4 adversaries is: 43.440908701684926. distance: 1.9920984584880705
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1841, Accuracy: 9427/9900 (95.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4527/5066 (89.3604%), train_poison_data_count: 400
Global model norm: 43.447759017835146.
Norm before scaling: 43.44823804998814. Distance: 2.2327975593638296
Total norm for 4 adversaries is: 43.44823804998814. distance: 2.2327975593638296
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1763, Accuracy: 9435/9900 (95.3030%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4621/5232 (88.3219%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4615/5232 (88.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0231, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4470/4956 (90.1937%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4412/4956 (89.0234%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1933, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4510/5063 (89.0776%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4498/5063 (88.8406%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0710, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3647/4025 (90.6087%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3767/4025 (93.5901%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8382, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4026/4441 (90.6553%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4054/4441 (91.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0692, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4012/4625 (86.7459%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4092/4625 (88.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1020, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4916/5591 (87.9270%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4942/5591 (88.3921%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1560, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5103/5582 (91.4188%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5066/5582 (90.7560%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0569, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5139/5902 (87.0722%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5080/5902 (86.0725%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1569, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4153/4538 (91.5161%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4190/4538 (92.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9634, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4500/5025 (89.5522%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4607/5025 (91.6816%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1504, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3811/4223 (90.2439%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3880/4223 (91.8778%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7955, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3865/4361 (88.6265%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3813/4361 (87.4341%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1262, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3895/4354 (89.4580%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3556/4354 (81.6720%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3976, Accuracy: 4792/10000 (47.9200%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3294/3672 (89.7059%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3352/3672 (91.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8473, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3953/4356 (90.7484%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3911/4356 (89.7842%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2118, Accuracy: 5197/10000 (51.9700%)
time spent on training: 235.9726824760437
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.2834, Accuracy: 6804/10000 (68.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 10.0682, Accuracy: 52/9900 (0.5253%)
Done in 256.94577407836914 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4463/4885 (91.3613%), train_poison_data_count: 385
Global model norm: 43.48491679055221.
Norm before scaling: 43.48131080876516. Distance: 2.0754633328758327
Total norm for 4 adversaries is: 43.48131080876516. distance: 2.0754633328758327
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1467, Accuracy: 9489/9900 (95.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4731/5305 (89.1800%), train_poison_data_count: 415
Global model norm: 43.48491679055221.
Norm before scaling: 43.485008024048504. Distance: 2.251846403585688
Total norm for 4 adversaries is: 43.485008024048504. distance: 2.251846403585688
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2524, Accuracy: 9276/9900 (93.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4262/4717 (90.3540%), train_poison_data_count: 370
Global model norm: 43.48491679055221.
Norm before scaling: 43.47871386748132. Distance: 2.007268928540258
Total norm for 4 adversaries is: 43.47871386748132. distance: 2.007268928540258
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2069, Accuracy: 9401/9900 (94.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4576/5066 (90.3277%), train_poison_data_count: 400
Global model norm: 43.48491679055221.
Norm before scaling: 43.48712178038675. Distance: 2.205732817723759
Total norm for 4 adversaries is: 43.48712178038675. distance: 2.205732817723759
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1515, Accuracy: 9510/9900 (96.0606%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3468/3828 (90.5956%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3553/3828 (92.8161%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0187, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3870/4235 (91.3813%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3890/4235 (91.8536%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9015, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3263/3704 (88.0940%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3357/3704 (90.6317%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8272, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3634/4046 (89.8171%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3627/4046 (89.6441%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9463, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4497/4928 (91.2541%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4538/4928 (92.0860%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8621, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5048/5740 (87.9443%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5155/5740 (89.8084%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0960, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4486/5083 (88.2550%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4543/5083 (89.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9985, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4111/4576 (89.8383%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4186/4576 (91.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9726, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4172/4647 (89.7784%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4246/4647 (91.3708%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9097, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4911/5424 (90.5420%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4937/5424 (91.0214%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0830, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4023/4503 (89.3404%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4058/4503 (90.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0800, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5528/6391 (86.4966%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5559/6391 (86.9817%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1711, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3966/4511 (87.9184%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4071/4511 (90.2461%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9427, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4085/4456 (91.6741%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4074/4456 (91.4273%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9275, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4285/4804 (89.1965%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4307/4804 (89.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0763, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3415/3804 (89.7739%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3528/3804 (92.7445%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9132, Accuracy: 5678/10000 (56.7800%)
time spent on training: 235.34741497039795
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.2939, Accuracy: 6757/10000 (67.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 9.8518, Accuracy: 64/9900 (0.6465%)
Done in 256.5437242984772 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4448/4885 (91.0542%), train_poison_data_count: 385
Global model norm: 43.514630542945696.
Norm before scaling: 43.51011943403583. Distance: 2.0786037037122256
Total norm for 4 adversaries is: 43.51011943403583. distance: 2.0786037037122256
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2727, Accuracy: 9252/9900 (93.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 43.514630542945696.
Norm before scaling: 43.51599107790362. Distance: 2.2307730498900975
Total norm for 4 adversaries is: 43.51599107790362. distance: 2.2307730498900975
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.3169, Accuracy: 9120/9900 (92.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4264/4717 (90.3964%), train_poison_data_count: 370
Global model norm: 43.514630542945696.
Norm before scaling: 43.510176948006944. Distance: 2.0246381695403786
Total norm for 4 adversaries is: 43.510176948006944. distance: 2.0246381695403786
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1077, Accuracy: 9603/9900 (97.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4598/5066 (90.7619%), train_poison_data_count: 400
Global model norm: 43.514630542945696.
Norm before scaling: 43.51202436854022. Distance: 2.147905873500619
Total norm for 4 adversaries is: 43.51202436854022. distance: 2.147905873500619
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0819, Accuracy: 9680/9900 (97.7778%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4476/4928 (90.8279%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4515/4928 (91.6193%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8274, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4517/5037 (89.6764%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4529/5037 (89.9146%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9806, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4981/5392 (92.3776%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4859/5392 (90.1150%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0064, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3982/4501 (88.4692%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4031/4501 (89.5579%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0606, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3433/3804 (90.2471%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3539/3804 (93.0336%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8243, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3451/3837 (89.9401%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3519/3837 (91.7123%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9149, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4517/5063 (89.2159%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4430/5063 (87.4975%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1850, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4034/4481 (90.0245%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3969/4481 (88.5740%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9654, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4105/4518 (90.8588%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4172/4518 (92.3417%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9247, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3208/3638 (88.1803%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3314/3638 (91.0940%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8979, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4242/4663 (90.9715%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4294/4663 (92.0866%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1647, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4051/4625 (87.5892%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3978/4625 (86.0108%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0328, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4775/5197 (91.8799%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4808/5197 (92.5149%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9998, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4545/5083 (89.4157%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4492/5083 (88.3730%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0264, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3432/3828 (89.6552%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3518/3828 (91.9018%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8273, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3309/3704 (89.3359%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3392/3704 (91.5767%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9523, Accuracy: 5595/10000 (55.9500%)
time spent on training: 232.71548581123352
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.3079, Accuracy: 6752/10000 (67.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 9.9412, Accuracy: 45/9900 (0.4545%)
Done in 253.74558305740356 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4415/4885 (90.3787%), train_poison_data_count: 385
Global model norm: 43.54759261159708.
Norm before scaling: 43.545602331600314. Distance: 2.1618366569125094
Total norm for 4 adversaries is: 43.545602331600314. distance: 2.1618366569125094
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0591, Accuracy: 9740/9900 (98.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4794/5305 (90.3676%), train_poison_data_count: 415
Global model norm: 43.54759261159708.
Norm before scaling: 43.54221584332698. Distance: 2.200346689650743
Total norm for 4 adversaries is: 43.54221584332698. distance: 2.200346689650743
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1360, Accuracy: 9558/9900 (96.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4264/4717 (90.3964%), train_poison_data_count: 370
Global model norm: 43.54759261159708.
Norm before scaling: 43.541178538432156. Distance: 2.02841822498539
Total norm for 4 adversaries is: 43.541178538432156. distance: 2.02841822498539
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1242, Accuracy: 9581/9900 (96.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4583/5066 (90.4659%), train_poison_data_count: 400
Global model norm: 43.54759261159708.
Norm before scaling: 43.54550421685343. Distance: 2.164133339283644
Total norm for 4 adversaries is: 43.54550421685343. distance: 2.164133339283644
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.3222, Accuracy: 9178/9900 (92.7071%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3471/3861 (89.8990%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3553/3861 (92.0228%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8100, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3858/4184 (92.2084%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3847/4184 (91.9455%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8889, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4483/5037 (89.0014%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4566/5037 (90.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9436, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4783/5197 (92.0339%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4681/5197 (90.0712%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0453, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4503/5025 (89.6119%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4576/5025 (91.0647%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0369, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4499/5116 (87.9398%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4547/5116 (88.8780%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0093, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3980/4481 (88.8195%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3946/4481 (88.0607%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1152, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4156/4576 (90.8217%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4201/4576 (91.8051%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9862, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4640/5232 (88.6850%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4724/5232 (90.2905%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0207, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3822/4354 (87.7814%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3725/4354 (85.5535%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2572, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2914/3271 (89.0859%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0059, Accuracy: 2914/3271 (89.0859%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9901, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4863/5455 (89.1476%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4813/5455 (88.2310%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0124, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3686/4126 (89.3359%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3767/4126 (91.2991%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9362, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3415/3797 (89.9394%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3454/3797 (90.9666%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9048, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3308/3704 (89.3089%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3378/3704 (91.1987%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9746, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4315/4934 (87.4544%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4060/4934 (82.2862%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1669, Accuracy: 5100/10000 (51.0000%)
time spent on training: 236.31350135803223
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.3065, Accuracy: 6734/10000 (67.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 9.8558, Accuracy: 62/9900 (0.6263%)
Done in 260.60581636428833 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4435/4885 (90.7881%), train_poison_data_count: 385
Global model norm: 43.58524082500219.
Norm before scaling: 43.580374292076705. Distance: 2.076620604288437
Total norm for 4 adversaries is: 43.580374292076705. distance: 2.076620604288437
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2317, Accuracy: 9338/9900 (94.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 43.58524082500219.
Norm before scaling: 43.58073702507149. Distance: 2.174884385291776
Total norm for 4 adversaries is: 43.58073702507149. distance: 2.174884385291776
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1392, Accuracy: 9536/9900 (96.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4258/4717 (90.2692%), train_poison_data_count: 370
Global model norm: 43.58524082500219.
Norm before scaling: 43.581360246526266. Distance: 2.040367790240746
Total norm for 4 adversaries is: 43.581360246526266. distance: 2.040367790240746
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2711, Accuracy: 9206/9900 (92.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4550/5066 (89.8144%), train_poison_data_count: 400
Global model norm: 43.58524082500219.
Norm before scaling: 43.583628977446914. Distance: 2.183713851655726
Total norm for 4 adversaries is: 43.583628977446914. distance: 2.183713851655726
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0919, Accuracy: 9650/9900 (97.4747%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4330/4618 (93.7635%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4298/4618 (93.0706%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9624, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4036/4625 (87.2649%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4055/4625 (87.6757%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1188, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5119/5740 (89.1812%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5193/5740 (90.4704%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1735, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3908/4416 (88.4964%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3939/4416 (89.1984%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9875, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3681/4126 (89.2147%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3822/4126 (92.6321%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9261, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3194/3616 (88.3296%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3295/3616 (91.1228%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8982, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3619/4158 (87.0370%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3683/4158 (88.5762%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9781, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3962/4346 (91.1643%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4032/4346 (92.7750%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8648, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4291/4874 (88.0386%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4287/4874 (87.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1732, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4827/5265 (91.6809%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4817/5265 (91.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9648, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3647/4025 (90.6087%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3741/4025 (92.9441%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8956, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4145/4651 (89.1206%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4212/4651 (90.5612%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0252, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3409/3837 (88.8455%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3542/3837 (92.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0280, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3259/3638 (89.5822%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3294/3638 (90.5443%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9646, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3125/3472 (90.0058%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3176/3472 (91.4747%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9003, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4088/4456 (91.7415%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4096/4456 (91.9210%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9100, Accuracy: 5665/10000 (56.6500%)
time spent on training: 255.4718039035797
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.4137, Accuracy: 6538/10000 (65.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 3.4685, Accuracy: 3406/9900 (34.4040%)
Done in 279.1848659515381 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4502/4885 (92.1597%), train_poison_data_count: 385
Global model norm: 43.592691519407815.
Norm before scaling: 43.58819829120536. Distance: 1.8884716539262922
Total norm for 4 adversaries is: 43.58819829120536. distance: 1.8884716539262922
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2830, Accuracy: 9192/9900 (92.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4841/5305 (91.2535%), train_poison_data_count: 415
Global model norm: 43.592691519407815.
Norm before scaling: 43.59135018036118. Distance: 2.0517160955197946
Total norm for 4 adversaries is: 43.59135018036118. distance: 2.0517160955197946
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1786, Accuracy: 9438/9900 (95.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4310/4717 (91.3716%), train_poison_data_count: 370
Global model norm: 43.592691519407815.
Norm before scaling: 43.589941589918425. Distance: 1.8635391280823488
Total norm for 4 adversaries is: 43.589941589918425. distance: 1.8635391280823488
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2122, Accuracy: 9370/9900 (94.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4686/5066 (92.4990%), train_poison_data_count: 400
Global model norm: 43.592691519407815.
Norm before scaling: 43.586922628453024. Distance: 1.8568937270774728
Total norm for 4 adversaries is: 43.586922628453024. distance: 1.8568937270774728
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1319, Accuracy: 9564/9900 (96.6061%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4874/5424 (89.8599%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4914/5424 (90.5973%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2155, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4483/4986 (89.9118%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4538/4986 (91.0148%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9040, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4538/5167 (87.8266%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4670/5167 (90.3813%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2173, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4275/4716 (90.6489%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4279/4716 (90.7337%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9630, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3896/4368 (89.1941%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3845/4368 (88.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0892, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3982/4356 (91.4141%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3821/4356 (87.7181%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.4117, Accuracy: 4790/10000 (47.9000%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4273/4804 (88.9467%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4104/4804 (85.4288%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2936, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3996/4481 (89.1765%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3938/4481 (87.8822%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1471, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3640/4025 (90.4348%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3719/4025 (92.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8650, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4521/5017 (90.1136%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4603/5017 (91.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9610, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3182/3616 (87.9978%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3279/3616 (90.6803%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8630, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3742/4184 (89.4359%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3818/4184 (91.2524%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8118, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4584/5195 (88.2387%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4602/5195 (88.5852%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1725, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3911/4361 (89.6813%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3795/4361 (87.0213%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3255, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3393/3756 (90.3355%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3485/3756 (92.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0108, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5054/5591 (90.3953%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5055/5591 (90.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0506, Accuracy: 5401/10000 (54.0100%)
time spent on training: 254.46043610572815
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.4215, Accuracy: 6515/10000 (65.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 4.0929, Accuracy: 2623/9900 (26.4949%)
Done in 278.6781921386719 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4501/4885 (92.1392%), train_poison_data_count: 385
Global model norm: 43.62880954668529.
Norm before scaling: 43.62443056800642. Distance: 1.903217279611678
Total norm for 4 adversaries is: 43.62443056800642. distance: 1.903217279611678
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2004, Accuracy: 9436/9900 (95.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4841/5305 (91.2535%), train_poison_data_count: 415
Global model norm: 43.62880954668529.
Norm before scaling: 43.62319094341836. Distance: 2.0267734203121806
Total norm for 4 adversaries is: 43.62319094341836. distance: 2.0267734203121806
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1163, Accuracy: 9616/9900 (97.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4325/4717 (91.6896%), train_poison_data_count: 370
Global model norm: 43.62880954668529.
Norm before scaling: 43.620848712316594. Distance: 1.8022307480804955
Total norm for 4 adversaries is: 43.620848712316594. distance: 1.8022307480804955
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2475, Accuracy: 9292/9900 (93.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4694/5066 (92.6569%), train_poison_data_count: 400
Global model norm: 43.62880954668529.
Norm before scaling: 43.62207161330073. Distance: 1.8557850136509562
Total norm for 4 adversaries is: 43.62207161330073. distance: 1.8557850136509562
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1756, Accuracy: 9485/9900 (95.8081%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3722/4175 (89.1497%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3776/4175 (90.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9899, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4865/5455 (89.1842%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4934/5455 (90.4491%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9745, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3272/3704 (88.3369%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3372/3704 (91.0367%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9126, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4400/4989 (88.1940%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4419/4989 (88.5749%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0602, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4486/4928 (91.0308%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4510/4928 (91.5179%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9173, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3387/3804 (89.0379%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3496/3804 (91.9033%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8983, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3844/4336 (88.6531%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3883/4336 (89.5526%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1311, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3660/4046 (90.4597%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3679/4046 (90.9293%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0409, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4275/4793 (89.1926%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4360/4793 (90.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9362, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3436/3756 (91.4803%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3490/3756 (92.9180%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0073, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5564/6391 (87.0599%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5603/6391 (87.6702%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1911, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3279/3672 (89.2974%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3345/3672 (91.0948%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0433, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4199/4558 (92.1237%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4186/4558 (91.8385%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0319, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4114/4576 (89.9038%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4129/4576 (90.2316%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9295, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4078/4456 (91.5171%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4099/4456 (91.9883%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9856, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3905/4356 (89.6465%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3973/4356 (91.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0376, Accuracy: 5525/10000 (55.2500%)
time spent on training: 239.67455863952637
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.3686, Accuracy: 6587/10000 (65.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 4.7438, Accuracy: 1938/9900 (19.5758%)
Done in 261.008828163147 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4511/4885 (92.3439%), train_poison_data_count: 385
Global model norm: 43.65761031568909.
Norm before scaling: 43.6513732064926. Distance: 1.8871458845608275
Total norm for 4 adversaries is: 43.6513732064926. distance: 1.8871458845608275
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1948, Accuracy: 9428/9900 (95.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4872/5305 (91.8379%), train_poison_data_count: 415
Global model norm: 43.65761031568909.
Norm before scaling: 43.65270011739322. Distance: 2.0325061142044727
Total norm for 4 adversaries is: 43.65270011739322. distance: 2.0325061142044727
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1257, Accuracy: 9582/9900 (96.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4309/4717 (91.3504%), train_poison_data_count: 370
Global model norm: 43.65761031568909.
Norm before scaling: 43.65459603389788. Distance: 1.899102051514357
Total norm for 4 adversaries is: 43.65459603389788. distance: 1.899102051514357
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1235, Accuracy: 9587/9900 (96.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4688/5066 (92.5385%), train_poison_data_count: 400
Global model norm: 43.65761031568909.
Norm before scaling: 43.64750969458696. Distance: 1.8605806945507788
Total norm for 4 adversaries is: 43.64750969458696. distance: 1.8605806945507788
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1922, Accuracy: 9449/9900 (95.4444%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4663/5116 (91.1454%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4602/5116 (89.9531%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0246, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5124/5582 (91.7951%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5028/5582 (90.0752%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1040, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4347/4928 (88.2102%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4409/4928 (89.4683%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0340, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3707/4126 (89.8449%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3770/4126 (91.3718%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8804, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3613/4158 (86.8927%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3691/4158 (88.7686%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0431, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4566/5063 (90.1837%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4358/5063 (86.0754%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3244, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5358/6124 (87.4918%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5444/6124 (88.8961%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9786, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3841/4354 (88.2177%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0150, Accuracy: 3151/4354 (72.3702%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.6252, Accuracy: 4372/10000 (43.7200%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4516/5025 (89.8706%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4560/5025 (90.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1327, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4304/4679 (91.9855%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4143/4679 (88.5446%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1344, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4368/4793 (91.1329%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4433/4793 (92.4890%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8841, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4070/4518 (90.0841%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4142/4518 (91.6777%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1064, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4602/5167 (89.0652%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4700/5167 (90.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1519, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4011/4433 (90.4805%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4042/4433 (91.1798%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9027, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4132/4503 (91.7610%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4121/4503 (91.5168%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8779, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4209/4707 (89.4200%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4234/4707 (89.9511%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8167, Accuracy: 5721/10000 (57.2100%)
time spent on training: 237.02881813049316
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.3603, Accuracy: 6606/10000 (66.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 4.9138, Accuracy: 1835/9900 (18.5354%)
Done in 258.1444561481476 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4496/4885 (92.0368%), train_poison_data_count: 385
Global model norm: 43.69217998448779.
Norm before scaling: 43.68678189234559. Distance: 1.932407207753363
Total norm for 4 adversaries is: 43.68678189234559. distance: 1.932407207753363
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1974, Accuracy: 9423/9900 (95.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4844/5305 (91.3101%), train_poison_data_count: 415
Global model norm: 43.69217998448779.
Norm before scaling: 43.68909823614468. Distance: 2.054424196495039
Total norm for 4 adversaries is: 43.68909823614468. distance: 2.054424196495039
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.3829, Accuracy: 9053/9900 (91.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4304/4717 (91.2444%), train_poison_data_count: 370
Global model norm: 43.69217998448779.
Norm before scaling: 43.68623561966844. Distance: 1.8903758617848911
Total norm for 4 adversaries is: 43.68623561966844. distance: 1.8903758617848911
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1498, Accuracy: 9526/9900 (96.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4680/5066 (92.3806%), train_poison_data_count: 400
Global model norm: 43.69217998448779.
Norm before scaling: 43.688950150288285. Distance: 1.9420295190738224
Total norm for 4 adversaries is: 43.688950150288285. distance: 1.9420295190738224
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1947, Accuracy: 9405/9900 (95.0000%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3302/3704 (89.1469%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3393/3704 (91.6037%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8065, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4997/5392 (92.6743%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4912/5392 (91.0979%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0988, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3998/4362 (91.6552%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4065/4362 (93.1912%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8131, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4170/4538 (91.8907%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4217/4538 (92.9264%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9616, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3834/4184 (91.6348%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3880/4184 (92.7342%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8340, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3446/3756 (91.7465%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3481/3756 (92.6784%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9354, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4327/4679 (92.4770%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4270/4679 (91.2588%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0725, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3181/3472 (91.6187%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3166/3472 (91.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9107, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5552/6391 (86.8722%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5623/6391 (87.9831%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0738, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4829/5265 (91.7189%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4764/5265 (90.4843%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0943, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5157/5902 (87.3772%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5147/5902 (87.2077%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0749, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5398/6124 (88.1450%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5406/6124 (88.2756%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0136, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4568/5083 (89.8682%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4591/5083 (90.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0020, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4048/4465 (90.6607%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4134/4465 (92.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9721, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3430/3804 (90.1682%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3480/3804 (91.4826%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0223, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4399/4918 (89.4469%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4482/4918 (91.1346%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9958, Accuracy: 5419/10000 (54.1900%)
time spent on training: 236.93995714187622
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.4000, Accuracy: 6514/10000 (65.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 4.7880, Accuracy: 1976/9900 (19.9596%)
Done in 257.90499234199524 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4484/4885 (91.7912%), train_poison_data_count: 385
Global model norm: 43.72074915014609.
Norm before scaling: 43.71851266465243. Distance: 1.9602928773860846
Total norm for 4 adversaries is: 43.71851266465243. distance: 1.9602928773860846
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1996, Accuracy: 9398/9900 (94.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 43.72074915014609.
Norm before scaling: 43.71666419702703. Distance: 2.072891184076711
Total norm for 4 adversaries is: 43.71666419702703. distance: 2.072891184076711
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2806, Accuracy: 9217/9900 (93.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 43.72074915014609.
Norm before scaling: 43.71317786372106. Distance: 1.8896792860248461
Total norm for 4 adversaries is: 43.71317786372106. distance: 1.8896792860248461
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1892, Accuracy: 9428/9900 (95.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4660/5066 (91.9858%), train_poison_data_count: 400
Global model norm: 43.72074915014609.
Norm before scaling: 43.712538369925255. Distance: 1.905822831116454
Total norm for 4 adversaries is: 43.712538369925255. distance: 1.905822831116454
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1308, Accuracy: 9593/9900 (96.8990%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4087/4538 (90.0617%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4176/4538 (92.0229%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9661, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4409/4989 (88.3744%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4447/4989 (89.1361%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9421, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4409/4793 (91.9883%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4417/4793 (92.1552%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9345, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3637/4158 (87.4699%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3713/4158 (89.2977%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1718, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3466/3861 (89.7695%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3544/3861 (91.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8760, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4655/5232 (88.9717%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4701/5232 (89.8509%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0285, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4179/4663 (89.6204%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4263/4663 (91.4218%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0133, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4691/5197 (90.2636%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4654/5197 (89.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1593, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4603/5167 (89.0846%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4698/5167 (90.9232%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1004, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3906/4416 (88.4511%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4022/4416 (91.0779%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8391, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3890/4354 (89.3431%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3729/4354 (85.6454%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.3441, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4894/5455 (89.7159%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4952/5455 (90.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1337, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4001/4456 (89.7890%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4086/4456 (91.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.7767, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2931/3271 (89.6056%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0045, Accuracy: 2968/3271 (90.7368%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8537, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2976/3297 (90.2639%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3060/3297 (92.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9260, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5057/5591 (90.4489%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5015/5591 (89.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9852, Accuracy: 5507/10000 (55.0700%)
time spent on training: 235.16644978523254
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.3864, Accuracy: 6541/10000 (65.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 5.2025, Accuracy: 1546/9900 (15.6162%)
Done in 256.3061189651489 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4509/4885 (92.3030%), train_poison_data_count: 385
Global model norm: 43.75461192209485.
Norm before scaling: 43.750309708725204. Distance: 1.9358917452598516
Total norm for 4 adversaries is: 43.750309708725204. distance: 1.9358917452598516
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1392, Accuracy: 9550/9900 (96.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4844/5305 (91.3101%), train_poison_data_count: 415
Global model norm: 43.75461192209485.
Norm before scaling: 43.74905690947806. Distance: 2.0721494190880287
Total norm for 4 adversaries is: 43.74905690947806. distance: 2.0721494190880287
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0404, Accuracy: 9802/9900 (99.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4336/4717 (91.9228%), train_poison_data_count: 370
Global model norm: 43.75461192209485.
Norm before scaling: 43.74869975746422. Distance: 1.8631330707097555
Total norm for 4 adversaries is: 43.74869975746422. distance: 1.8631330707097555
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1261, Accuracy: 9585/9900 (96.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4663/5066 (92.0450%), train_poison_data_count: 400
Global model norm: 43.75461192209485.
Norm before scaling: 43.74888251921056. Distance: 1.9824721456834253
Total norm for 4 adversaries is: 43.74888251921056. distance: 1.9824721456834253
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.2181, Accuracy: 9337/9900 (94.3131%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4638/5167 (89.7620%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4711/5167 (91.1748%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0409, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3465/3775 (91.7881%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3552/3775 (94.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.6956, Accuracy: 5925/10000 (59.2500%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4707/5195 (90.6064%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4656/5195 (89.6246%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1354, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3765/4126 (91.2506%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3787/4126 (91.7838%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9004, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3582/3911 (91.5878%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3569/3911 (91.2554%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0147, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4030/4433 (90.9091%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4102/4433 (92.5333%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7508, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2924/3271 (89.3916%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0044, Accuracy: 2993/3271 (91.5011%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7623, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3224/3590 (89.8050%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3294/3590 (91.7549%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0003, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4471/4918 (90.9109%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4486/4918 (91.2159%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9882, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4496/4986 (90.1725%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4559/4986 (91.4360%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9084, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3238/3616 (89.5465%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3293/3616 (91.0675%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9047, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3858/4295 (89.8254%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3753/4295 (87.3807%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1124, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3909/4356 (89.7383%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3950/4356 (90.6795%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9399, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4387/4793 (91.5293%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4457/4793 (92.9898%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0399, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3940/4315 (91.3094%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3975/4315 (92.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8802, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4305/4804 (89.6128%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4209/4804 (87.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1022, Accuracy: 5387/10000 (53.8700%)
time spent on training: 233.50743198394775
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.4549, Accuracy: 6435/10000 (64.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 5.2827, Accuracy: 1430/9900 (14.4444%)
Done in 257.4671549797058 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 43.78027691191976.
Norm before scaling: 43.776809587008366. Distance: 1.9830574407409882
Total norm for 4 adversaries is: 43.776809587008366. distance: 1.9830574407409882
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1380, Accuracy: 9566/9900 (96.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 43.78027691191976.
Norm before scaling: 43.77565932809436. Distance: 2.05386533351813
Total norm for 4 adversaries is: 43.77565932809436. distance: 2.05386533351813
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.2339, Accuracy: 9319/9900 (94.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4316/4717 (91.4988%), train_poison_data_count: 370
Global model norm: 43.78027691191976.
Norm before scaling: 43.7741813753053. Distance: 1.8908162926614511
Total norm for 4 adversaries is: 43.7741813753053. distance: 1.8908162926614511
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.2375, Accuracy: 9335/9900 (94.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4640/5066 (91.5910%), train_poison_data_count: 400
Global model norm: 43.78027691191976.
Norm before scaling: 43.77461779485844. Distance: 1.9463026598480744
Total norm for 4 adversaries is: 43.77461779485844. distance: 1.9463026598480744
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.2211, Accuracy: 9389/9900 (94.8384%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4106/4503 (91.1837%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4117/4503 (91.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0235, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4284/4934 (86.8261%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4138/4934 (83.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1360, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4252/4804 (88.5096%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0101, Accuracy: 3902/4804 (81.2240%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.4186, Accuracy: 4849/10000 (48.4900%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4035/4456 (90.5521%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4102/4456 (92.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0289, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4195/4651 (90.1957%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4197/4651 (90.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9647, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3817/4184 (91.2285%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3825/4184 (91.4197%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9585, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4368/4928 (88.6364%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4372/4928 (88.7175%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1251, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3450/3775 (91.3907%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3510/3775 (92.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9169, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4562/5083 (89.7501%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4528/5083 (89.0813%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9725, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4888/5455 (89.6059%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4907/5455 (89.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0581, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3219/3638 (88.4827%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3325/3638 (91.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9095, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3680/3911 (94.0936%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3465/3911 (88.5963%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1141, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3410/3837 (88.8715%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3515/3837 (91.6080%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8881, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3989/4501 (88.6248%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3966/4501 (88.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8684, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4718/5197 (90.7831%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4627/5197 (89.0321%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0306, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3463/3861 (89.6918%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3512/3861 (90.9609%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8518, Accuracy: 5721/10000 (57.2100%)
time spent on training: 234.98812103271484
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.4846, Accuracy: 6390/10000 (63.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 5.8150, Accuracy: 1086/9900 (10.9697%)
Done in 256.0638279914856 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4505/4885 (92.2211%), train_poison_data_count: 385
Global model norm: 43.81398501852034.
Norm before scaling: 43.80888893820522. Distance: 1.8912293910424633
Total norm for 4 adversaries is: 43.80888893820522. distance: 1.8912293910424633
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.3805, Accuracy: 9013/9900 (91.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4838/5305 (91.1970%), train_poison_data_count: 415
Global model norm: 43.81398501852034.
Norm before scaling: 43.8098655703149. Distance: 2.083776948110406
Total norm for 4 adversaries is: 43.8098655703149. distance: 2.083776948110406
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1162, Accuracy: 9599/9900 (96.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4287/4717 (90.8840%), train_poison_data_count: 370
Global model norm: 43.81398501852034.
Norm before scaling: 43.80980566340856. Distance: 1.9452186776328377
Total norm for 4 adversaries is: 43.80980566340856. distance: 1.9452186776328377
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2718, Accuracy: 9242/9900 (93.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4652/5066 (91.8279%), train_poison_data_count: 400
Global model norm: 43.81398501852034.
Norm before scaling: 43.80708190241262. Distance: 1.9643602022687188
Total norm for 4 adversaries is: 43.80708190241262. distance: 1.9643602022687188
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2297, Accuracy: 9363/9900 (94.5758%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2917/3271 (89.1776%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3001/3271 (91.7456%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9140, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4026/4511 (89.2485%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4064/4511 (90.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0168, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3255/3638 (89.4722%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3336/3638 (91.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.7841, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5170/5582 (92.6191%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5152/5582 (92.2967%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1367, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4050/4456 (90.8887%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4127/4456 (92.6167%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0185, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5201/5902 (88.1227%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5080/5902 (86.0725%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1080, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3892/4416 (88.1341%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4020/4416 (91.0326%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9200, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4376/4934 (88.6907%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4109/4934 (83.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2574, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4138/4596 (90.0348%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4222/4596 (91.8625%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9804, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3406/3837 (88.7673%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3534/3837 (92.1032%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9766, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5554/6391 (86.9035%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5603/6391 (87.6702%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1085, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3924/4368 (89.8352%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3952/4368 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9389, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3438/3804 (90.3785%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3447/3804 (90.6151%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8912, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5704/6263 (91.0746%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5683/6263 (90.7393%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1435, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4354/4793 (90.8408%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4413/4793 (92.0718%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9245, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4879/5424 (89.9521%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4950/5424 (91.2611%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1958, Accuracy: 5220/10000 (52.2000%)
time spent on training: 236.2341012954712
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.4664, Accuracy: 6430/10000 (64.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 6.4804, Accuracy: 777/9900 (7.8485%)
Done in 257.0702884197235 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4501/4885 (92.1392%), train_poison_data_count: 385
Global model norm: 43.843691531500575.
Norm before scaling: 43.83555947417647. Distance: 1.8946958490030774
Total norm for 4 adversaries is: 43.83555947417647. distance: 1.8946958490030774
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2156, Accuracy: 9380/9900 (94.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4848/5305 (91.3855%), train_poison_data_count: 415
Global model norm: 43.843691531500575.
Norm before scaling: 43.842478988615454. Distance: 2.113815719512259
Total norm for 4 adversaries is: 43.842478988615454. distance: 2.113815719512259
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1108, Accuracy: 9605/9900 (97.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4324/4717 (91.6684%), train_poison_data_count: 370
Global model norm: 43.843691531500575.
Norm before scaling: 43.83683486316402. Distance: 1.9115702694193533
Total norm for 4 adversaries is: 43.83683486316402. distance: 1.9115702694193533
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1536, Accuracy: 9518/9900 (96.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4636/5066 (91.5120%), train_poison_data_count: 400
Global model norm: 43.843691531500575.
Norm before scaling: 43.838750661604315. Distance: 1.9958458912666055
Total norm for 4 adversaries is: 43.838750661604315. distance: 1.9958458912666055
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1613, Accuracy: 9532/9900 (96.2828%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4542/5055 (89.8516%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4603/5055 (91.0584%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0673, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3777/4184 (90.2725%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3864/4184 (92.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.7790, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3493/3861 (90.4688%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3531/3861 (91.4530%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9641, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4341/4804 (90.3622%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4266/4804 (88.8010%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0843, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3099/3472 (89.2569%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3137/3472 (90.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0183, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3592/3969 (90.5014%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3635/3969 (91.5848%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8805, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4428/4989 (88.7553%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4505/4989 (90.2987%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8391, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5204/5582 (93.2282%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5185/5582 (92.8879%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9703, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4359/4793 (90.9451%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4364/4793 (91.0494%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0018, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4215/4662 (90.4118%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4285/4662 (91.9133%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9558, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4390/4934 (88.9745%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4156/4934 (84.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3742, Accuracy: 4834/10000 (48.3400%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4476/4986 (89.7714%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4508/4986 (90.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8985, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4031/4433 (90.9316%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4054/4433 (91.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0630, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4252/4716 (90.1612%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4256/4716 (90.2460%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0547, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4189/4596 (91.1445%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4243/4596 (92.3194%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0100, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3908/4354 (89.7565%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3726/4354 (85.5765%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.5729, Accuracy: 4832/10000 (48.3200%)
time spent on training: 237.30032992362976
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.4903, Accuracy: 6404/10000 (64.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 6.8254, Accuracy: 591/9900 (5.9697%)
Done in 258.2137076854706 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4499/4885 (92.0983%), train_poison_data_count: 385
Global model norm: 43.87239853843901.
Norm before scaling: 43.86531816475645. Distance: 1.9480860903357164
Total norm for 4 adversaries is: 43.86531816475645. distance: 1.9480860903357164
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.2764, Accuracy: 9218/9900 (93.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 43.87239853843901.
Norm before scaling: 43.866555121221054. Distance: 2.1136453988188846
Total norm for 4 adversaries is: 43.866555121221054. distance: 2.1136453988188846
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0711, Accuracy: 9733/9900 (98.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4321/4717 (91.6048%), train_poison_data_count: 370
Global model norm: 43.87239853843901.
Norm before scaling: 43.86542391267936. Distance: 1.9066327445585005
Total norm for 4 adversaries is: 43.86542391267936. distance: 1.9066327445585005
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1180, Accuracy: 9595/9900 (96.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4648/5066 (91.7489%), train_poison_data_count: 400
Global model norm: 43.87239853843901.
Norm before scaling: 43.86814405123609. Distance: 1.9894049865782881
Total norm for 4 adversaries is: 43.86814405123609. distance: 1.9894049865782881
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1790, Accuracy: 9488/9900 (95.8384%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4664/5116 (91.1650%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4631/5116 (90.5199%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9089, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4192/4662 (89.9185%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4254/4662 (91.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0170, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5141/5902 (87.1061%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5079/5902 (86.0556%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3042, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4463/5063 (88.1493%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4419/5063 (87.2803%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1834, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3919/4354 (90.0092%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3642/4354 (83.6472%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3112, Accuracy: 4940/10000 (49.4000%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4655/5195 (89.6054%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4661/5195 (89.7209%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0073, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3914/4356 (89.8531%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3800/4356 (87.2360%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2385, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3846/4295 (89.5460%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3743/4295 (87.1478%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0326, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5684/6263 (90.7552%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5745/6263 (91.7292%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0017, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4008/4511 (88.8495%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4083/4511 (90.5121%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0106, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4201/4663 (90.0922%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4299/4663 (92.1939%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1381, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3887/4336 (89.6448%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3969/4336 (91.5360%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2158, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4321/4928 (87.6826%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4411/4928 (89.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1152, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3701/4046 (91.4731%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3586/4046 (88.6307%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0238, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3306/3672 (90.0327%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3359/3672 (91.4760%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8540, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3967/4356 (91.0698%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3879/4356 (89.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2792, Accuracy: 5080/10000 (50.8000%)
time spent on training: 264.5306384563446
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.4844, Accuracy: 6441/10000 (64.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 7.2629, Accuracy: 409/9900 (4.1313%)
Done in 285.9132902622223 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4511/4885 (92.3439%), train_poison_data_count: 385
Global model norm: 43.90896621936259.
Norm before scaling: 43.90209889184542. Distance: 1.9345895996364724
Total norm for 4 adversaries is: 43.90209889184542. distance: 1.9345895996364724
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1739, Accuracy: 9484/9900 (95.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4841/5305 (91.2535%), train_poison_data_count: 415
Global model norm: 43.90896621936259.
Norm before scaling: 43.90417310479295. Distance: 2.047746545575646
Total norm for 4 adversaries is: 43.90417310479295. distance: 2.047746545575646
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0665, Accuracy: 9722/9900 (98.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4319/4717 (91.5624%), train_poison_data_count: 370
Global model norm: 43.90896621936259.
Norm before scaling: 43.90039718552527. Distance: 1.8679334355569608
Total norm for 4 adversaries is: 43.90039718552527. distance: 1.8679334355569608
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1327, Accuracy: 9575/9900 (96.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4649/5066 (91.7687%), train_poison_data_count: 400
Global model norm: 43.90896621936259.
Norm before scaling: 43.903167985689684. Distance: 1.9841789689444327
Total norm for 4 adversaries is: 43.903167985689684. distance: 1.9841789689444327
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2763, Accuracy: 9210/9900 (93.0303%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4526/5037 (89.8551%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4654/5037 (92.3963%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9158, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4131/4647 (88.8961%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4202/4647 (90.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9748, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4228/4663 (90.6712%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4294/4663 (92.0866%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0271, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3903/4336 (90.0138%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3917/4336 (90.3367%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0389, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3429/3756 (91.2939%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3519/3756 (93.6901%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8693, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4068/4625 (87.9568%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4067/4625 (87.9351%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1342, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3979/4362 (91.2196%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3996/4362 (91.6094%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9995, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4361/4874 (89.4748%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4116/4874 (84.4481%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.4991, Accuracy: 4970/10000 (49.7000%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4265/4767 (89.4693%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4278/4767 (89.7420%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.3063, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3459/3775 (91.6291%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3526/3775 (93.4040%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8295, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4199/4662 (90.0686%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4259/4662 (91.3556%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0302, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5430/6124 (88.6675%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5442/6124 (88.8635%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9539, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4013/4511 (88.9603%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4071/4511 (90.2461%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8860, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3667/3911 (93.7612%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3538/3911 (90.4628%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9367, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4965/5591 (88.8034%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5003/5591 (89.4831%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1109, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3725/4126 (90.2811%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3759/4126 (91.1052%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9918, Accuracy: 5562/10000 (55.6200%)
time spent on training: 234.95120477676392
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.5401, Accuracy: 6344/10000 (63.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 7.6725, Accuracy: 306/9900 (3.0909%)
Done in 255.8896129131317 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4484/4885 (91.7912%), train_poison_data_count: 385
Global model norm: 43.93336156941627.
Norm before scaling: 43.92645359228665. Distance: 1.9785847327014756
Total norm for 4 adversaries is: 43.92645359228665. distance: 1.9785847327014756
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1335, Accuracy: 9561/9900 (96.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4830/5305 (91.0462%), train_poison_data_count: 415
Global model norm: 43.93336156941627.
Norm before scaling: 43.92842939577612. Distance: 2.1058584783230563
Total norm for 4 adversaries is: 43.92842939577612. distance: 2.1058584783230563
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1636, Accuracy: 9486/9900 (95.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4300/4717 (91.1596%), train_poison_data_count: 370
Global model norm: 43.93336156941627.
Norm before scaling: 43.927555440214576. Distance: 1.9036062073834221
Total norm for 4 adversaries is: 43.927555440214576. distance: 1.9036062073834221
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.4015, Accuracy: 8952/9900 (90.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4675/5066 (92.2819%), train_poison_data_count: 400
Global model norm: 43.93336156941627.
Norm before scaling: 43.926414686684396. Distance: 1.9611793156195372
Total norm for 4 adversaries is: 43.926414686684396. distance: 1.9611793156195372
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.2709, Accuracy: 9229/9900 (93.2222%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4507/5025 (89.6915%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4598/5025 (91.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1104, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4642/5116 (90.7349%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4615/5116 (90.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0047, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4603/5167 (89.0846%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4669/5167 (90.3619%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2420, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4206/4558 (92.2773%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4146/4558 (90.9609%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0970, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4175/4651 (89.7656%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4247/4651 (91.3137%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1753, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3868/4336 (89.2066%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3941/4336 (90.8902%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9990, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4538/5055 (89.7725%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4606/5055 (91.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0164, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3454/3775 (91.4967%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3536/3775 (93.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8608, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4847/5265 (92.0608%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4803/5265 (91.2251%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8498, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3614/4025 (89.7888%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3729/4025 (92.6460%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8491, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4406/4989 (88.3143%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4432/4989 (88.8354%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0063, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4369/4793 (91.1538%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4421/4793 (92.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9474, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3432/3804 (90.2208%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3507/3804 (92.1924%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9268, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3411/3797 (89.8341%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3494/3797 (92.0200%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9838, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4039/4433 (91.1121%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4081/4433 (92.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9588, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4199/4707 (89.2076%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4269/4707 (90.6947%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9365, Accuracy: 5533/10000 (55.3300%)
time spent on training: 239.94404244422913
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.4934, Accuracy: 6423/10000 (64.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 7.5795, Accuracy: 310/9900 (3.1313%)
Done in 261.1493422985077 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4524/4885 (92.6100%), train_poison_data_count: 385
Global model norm: 43.96321510338572.
Norm before scaling: 43.95514126196588. Distance: 1.9204569601625525
Total norm for 4 adversaries is: 43.95514126196588. distance: 1.9204569601625525
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.2711, Accuracy: 9274/9900 (93.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4854/5305 (91.4986%), train_poison_data_count: 415
Global model norm: 43.96321510338572.
Norm before scaling: 43.95833487608607. Distance: 2.052287044838124
Total norm for 4 adversaries is: 43.95833487608607. distance: 2.052287044838124
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1818, Accuracy: 9462/9900 (95.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4297/4717 (91.0960%), train_poison_data_count: 370
Global model norm: 43.96321510338572.
Norm before scaling: 43.95658535969753. Distance: 1.9344720252235958
Total norm for 4 adversaries is: 43.95658535969753. distance: 1.9344720252235958
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.2095, Accuracy: 9421/9900 (95.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4645/5066 (91.6897%), train_poison_data_count: 400
Global model norm: 43.96321510338572.
Norm before scaling: 43.958748640415706. Distance: 2.0583077798510745
Total norm for 4 adversaries is: 43.958748640415706. distance: 2.0583077798510745
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1213, Accuracy: 9589/9900 (96.8586%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5024/5392 (93.1751%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4934/5392 (91.5059%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0431, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4232/4663 (90.7570%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4283/4663 (91.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8987, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3446/3797 (90.7559%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3527/3797 (92.8891%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9062, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5276/5582 (94.5181%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5238/5582 (93.8373%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0012, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4617/5167 (89.3555%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4665/5167 (90.2845%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1654, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3440/3781 (90.9812%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3511/3781 (92.8590%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2551, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3598/3969 (90.6526%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3608/3969 (90.9045%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9608, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3468/3837 (90.3831%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3553/3837 (92.5984%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9124, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5219/5902 (88.4277%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5100/5902 (86.4114%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1366, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4805/5455 (88.0843%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4826/5455 (88.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0210, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4538/5037 (90.0933%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4673/5037 (92.7735%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9859, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4558/5017 (90.8511%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4558/5017 (90.8511%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9035, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4409/4986 (88.4276%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4511/4986 (90.4733%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9118, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4729/5197 (90.9948%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4655/5197 (89.5709%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1736, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3908/4361 (89.6125%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3817/4361 (87.5258%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9445, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5723/6263 (91.3779%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5698/6263 (90.9788%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2111, Accuracy: 5194/10000 (51.9400%)
time spent on training: 238.35519695281982
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.5364, Accuracy: 6337/10000 (63.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 7.6049, Accuracy: 283/9900 (2.8586%)
Done in 259.31902265548706 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4496/4885 (92.0368%), train_poison_data_count: 385
Global model norm: 43.99663600199665.
Norm before scaling: 43.98857245735462. Distance: 1.969741813664928
Total norm for 4 adversaries is: 43.98857245735462. distance: 1.969741813664928
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1256, Accuracy: 9564/9900 (96.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4824/5305 (90.9331%), train_poison_data_count: 415
Global model norm: 43.99663600199665.
Norm before scaling: 43.993361926030246. Distance: 2.119191477644457
Total norm for 4 adversaries is: 43.993361926030246. distance: 2.119191477644457
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2437, Accuracy: 9299/9900 (93.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4317/4717 (91.5200%), train_poison_data_count: 370
Global model norm: 43.99663600199665.
Norm before scaling: 43.988133997899794. Distance: 1.8719288151158644
Total norm for 4 adversaries is: 43.988133997899794. distance: 1.8719288151158644
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.3078, Accuracy: 9206/9900 (92.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4626/5066 (91.3146%), train_poison_data_count: 400
Global model norm: 43.99663600199665.
Norm before scaling: 43.99074665217249. Distance: 2.0054272684905134
Total norm for 4 adversaries is: 43.99074665217249. distance: 2.0054272684905134
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2693, Accuracy: 9256/9900 (93.4949%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4583/5017 (91.3494%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4610/5017 (91.8876%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8366, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4357/4928 (88.4131%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4388/4928 (89.0422%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0198, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3797/4184 (90.7505%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3841/4184 (91.8021%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9389, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4350/4793 (90.7574%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4422/4793 (92.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9631, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5068/5740 (88.2927%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5185/5740 (90.3310%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1491, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3450/3756 (91.8530%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3496/3756 (93.0777%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0022, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3872/4235 (91.4286%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3900/4235 (92.0897%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9736, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3774/4223 (89.3677%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3900/4223 (92.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8890, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4620/5063 (91.2502%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4610/5063 (91.0527%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0575, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4407/4989 (88.3343%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4513/4989 (90.4590%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9340, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4493/4928 (91.1729%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4493/4928 (91.1729%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9387, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5184/5902 (87.8346%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5167/5902 (87.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1391, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4076/4456 (91.4722%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4116/4456 (92.3698%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9349, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5340/6124 (87.1979%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5405/6124 (88.2593%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0606, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3463/3828 (90.4650%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3538/3828 (92.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8766, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3231/3616 (89.3529%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3309/3616 (91.5100%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8802, Accuracy: 5670/10000 (56.7000%)
time spent on training: 243.2144594192505
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.6178, Accuracy: 6225/10000 (62.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 7.8870, Accuracy: 240/9900 (2.4242%)
Done in 264.1123995780945 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4492/4885 (91.9550%), train_poison_data_count: 385
Global model norm: 44.02623452183794.
Norm before scaling: 44.02203788258714. Distance: 1.982172005977874
Total norm for 4 adversaries is: 44.02203788258714. distance: 1.982172005977874
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0860, Accuracy: 9713/9900 (98.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4811/5305 (90.6880%), train_poison_data_count: 415
Global model norm: 44.02623452183794.
Norm before scaling: 44.01929813614067. Distance: 2.104066172802959
Total norm for 4 adversaries is: 44.01929813614067. distance: 2.104066172802959
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1894, Accuracy: 9415/9900 (95.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4321/4717 (91.6048%), train_poison_data_count: 370
Global model norm: 44.02623452183794.
Norm before scaling: 44.01510915565671. Distance: 1.8974082888427286
Total norm for 4 adversaries is: 44.01510915565671. distance: 1.8974082888427286
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.4461, Accuracy: 8875/9900 (89.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4606/5066 (90.9199%), train_poison_data_count: 400
Global model norm: 44.02623452183794.
Norm before scaling: 44.02310960947102. Distance: 2.0505704644278238
Total norm for 4 adversaries is: 44.02310960947102. distance: 2.0505704644278238
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.3392, Accuracy: 9094/9900 (91.8586%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3800/4223 (89.9834%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3935/4223 (93.1802%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0601, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4003/4362 (91.7698%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4057/4362 (93.0078%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9146, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5541/6391 (86.7000%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5649/6391 (88.3899%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1492, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4333/4793 (90.4027%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4383/4793 (91.4459%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9952, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3391/3756 (90.2822%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3480/3756 (92.6518%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8850, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4283/4618 (92.7458%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4195/4618 (90.8402%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9450, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3675/4025 (91.3043%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3732/4025 (92.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8475, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3236/3638 (88.9500%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3340/3638 (91.8087%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9286, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3937/4315 (91.2399%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4012/4315 (92.9780%)
