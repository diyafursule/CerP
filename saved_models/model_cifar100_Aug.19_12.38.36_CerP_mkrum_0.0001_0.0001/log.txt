current path: saved_models/model_cifar100_Aug.19_12.38.36_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 85, 4, 97, 76, 38, 94, 86, 10, 29, 34, 7, 18, 6, 22, 69, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4749/5308 (89.4687%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43918270320041. Distance: 2.281878763580771
Total norm for 4 adversaries is: 42.43918270320041. distance: 2.281878763580771
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5547, Accuracy: 8606/9900 (86.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5305/5777 (91.8297%), train_poison_data_count: 455
Global model norm: 42.432124970265015.
Norm before scaling: 42.429581770030296. Distance: 2.174501217180176
Total norm for 4 adversaries is: 42.429581770030296. distance: 2.174501217180176
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5880, Accuracy: 8551/9900 (86.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4579/5123 (89.3812%), train_poison_data_count: 403
Global model norm: 42.432124970265015.
Norm before scaling: 42.439188455917424. Distance: 2.264398598059709
Total norm for 4 adversaries is: 42.439188455917424. distance: 2.264398598059709
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4698, Accuracy: 8753/9900 (88.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4942/5503 (89.8056%), train_poison_data_count: 430
Global model norm: 42.432124970265015.
Norm before scaling: 42.43934234080816. Distance: 2.306685173515358
Total norm for 4 adversaries is: 42.43934234080816. distance: 2.306685173515358
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5176, Accuracy: 8625/9900 (87.1212%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 6172/6947 (88.8441%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 6160/6947 (88.6714%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0425, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3577/4028 (88.8034%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3706/4028 (92.0060%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8973, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4114/4736 (86.8666%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4247/4736 (89.6748%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0156, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3446/3959 (87.0422%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3570/3959 (90.1743%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9065, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5479/6235 (87.8749%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5454/6235 (87.4739%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2707, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4528/5224 (86.6769%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4733/5224 (90.6011%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9772, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3454/3929 (87.9104%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3571/3929 (90.8883%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9199, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4572/5068 (90.2131%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4665/5068 (92.0481%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0058, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4307/4732 (91.0186%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4419/4732 (93.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.7182, Accuracy: 5924/10000 (59.2400%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4429/4911 (90.1853%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4488/4911 (91.3867%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9299, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4283/4869 (87.9647%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   2,  Average loss: 0.0094, Accuracy: 3998/4869 (82.1113%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.5050, Accuracy: 4660/10000 (46.6000%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3752/4249 (88.3031%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3846/4249 (90.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9872, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4413/4929 (89.5313%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4471/4929 (90.7081%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0008, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5123/5696 (89.9403%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5100/5696 (89.5365%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0635, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3913/4364 (89.6654%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3910/4364 (89.5967%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9955, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4526/5035 (89.8908%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4649/5035 (92.3337%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0439, Accuracy: 5324/10000 (53.2400%)
time spent on training: 291.3449273109436
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1040, Accuracy: 7047/10000 (70.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 8.8429, Accuracy: 137/9900 (1.3838%)
Done in 318.3037996292114 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 47, 10, 95, 98, 64, 57, 27, 85, 93, 6, 74, 54, 88, 45, 51, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4874/5308 (91.8237%), train_poison_data_count: 415
Global model norm: 42.45325870654322.
Norm before scaling: 42.455235501459356. Distance: 2.064688937055487
Total norm for 4 adversaries is: 42.455235501459356. distance: 2.064688937055487
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2219, Accuracy: 9334/9900 (94.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5375/5777 (93.0414%), train_poison_data_count: 455
Global model norm: 42.45325870654322.
Norm before scaling: 42.44512484428424. Distance: 1.9891763107690346
Total norm for 4 adversaries is: 42.44512484428424. distance: 1.9891763107690346
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2325, Accuracy: 9314/9900 (94.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4601/5123 (89.8107%), train_poison_data_count: 403
Global model norm: 42.45325870654322.
Norm before scaling: 42.457485341497055. Distance: 2.148351383217253
Total norm for 4 adversaries is: 42.457485341497055. distance: 2.148351383217253
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1176, Accuracy: 9592/9900 (96.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5042/5503 (91.6228%), train_poison_data_count: 430
Global model norm: 42.45325870654322.
Norm before scaling: 42.455757359960174. Distance: 2.104865219440546
Total norm for 4 adversaries is: 42.455757359960174. distance: 2.104865219440546
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2901, Accuracy: 9177/9900 (92.6970%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4495/5123 (87.7416%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   2,  Average loss: 0.0098, Accuracy: 4160/5123 (81.2024%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1939, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4540/5068 (89.5817%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4614/5068 (91.0418%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1012, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4349/5018 (86.6680%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4460/5018 (88.8800%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2673, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3757/4161 (90.2908%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3776/4161 (90.7474%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0767, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4308/4894 (88.0262%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4328/4894 (88.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0944, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4416/4956 (89.1041%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4563/4956 (92.0702%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0382, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4086/4587 (89.0778%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4159/4587 (90.6693%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0053, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 6206/6947 (89.3335%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   2,  Average loss: 0.0056, Accuracy: 6213/6947 (89.4343%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1432, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4491/5055 (88.8427%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4605/5055 (91.0979%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0965, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4423/4929 (89.7342%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4450/4929 (90.2820%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2308, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4212/4797 (87.8049%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4274/4797 (89.0974%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9815, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4866/5645 (86.2002%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4924/5645 (87.2276%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3455, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4834/5362 (90.1529%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4893/5362 (91.2533%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0231, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4784/5489 (87.1561%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4916/5489 (89.5609%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1001, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3685/4108 (89.7030%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3823/4108 (93.0623%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9422, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3726/4130 (90.2179%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3789/4130 (91.7433%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9990, Accuracy: 5526/10000 (55.2600%)
time spent on training: 297.0125951766968
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0972, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 7.4613, Accuracy: 339/9900 (3.4242%)
Done in 323.68679571151733 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 31, 47, 14, 73, 99, 60, 81, 39, 40, 78, 27, 59, 7, 22, 83, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4887/5308 (92.0686%), train_poison_data_count: 415
Global model norm: 42.47616519149298.
Norm before scaling: 42.47546827609364. Distance: 1.978763304983147
Total norm for 4 adversaries is: 42.47546827609364. distance: 1.978763304983147
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3165, Accuracy: 9116/9900 (92.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5394/5777 (93.3703%), train_poison_data_count: 455
Global model norm: 42.47616519149298.
Norm before scaling: 42.46947576872491. Distance: 1.959430252099267
Total norm for 4 adversaries is: 42.46947576872491. distance: 1.959430252099267
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3069, Accuracy: 9111/9900 (92.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4676/5123 (91.2746%), train_poison_data_count: 403
Global model norm: 42.47616519149298.
Norm before scaling: 42.47414051284249. Distance: 1.9654529150517446
Total norm for 4 adversaries is: 42.47414051284249. distance: 1.9654529150517446
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2942, Accuracy: 9189/9900 (92.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5013/5503 (91.0958%), train_poison_data_count: 430
Global model norm: 42.47616519149298.
Norm before scaling: 42.475430915357556. Distance: 2.0833534494064634
Total norm for 4 adversaries is: 42.475430915357556. distance: 2.0833534494064634
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1108, Accuracy: 9627/9900 (97.2424%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4094/4537 (90.2358%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4161/4537 (91.7126%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8349, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4552/5123 (88.8542%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4448/5123 (86.8241%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1626, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3845/4196 (91.6349%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3943/4196 (93.9704%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8040, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4127/4605 (89.6200%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4250/4605 (92.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8975, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4329/4851 (89.2393%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4419/4851 (91.0946%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8801, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3675/4145 (88.6610%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3795/4145 (91.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0058, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4554/5035 (90.4469%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4652/5035 (92.3932%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9074, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3687/4175 (88.3114%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3752/4175 (89.8683%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9993, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5450/5939 (91.7663%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5497/5939 (92.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9901, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4001/4368 (91.5980%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4067/4368 (93.1090%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0509, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4016/4587 (87.5518%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4149/4587 (90.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1096, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4124/4397 (93.7912%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4204/4397 (95.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.7372, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4285/4869 (88.0058%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4229/4869 (86.8556%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2088, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5177/5696 (90.8883%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5156/5696 (90.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0907, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3162/3552 (89.0203%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3280/3552 (92.3423%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8197, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4150/4736 (87.6267%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4297/4736 (90.7306%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9530, Accuracy: 5529/10000 (55.2900%)
time spent on training: 276.2773377895355
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0912, Accuracy: 7097/10000 (70.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 6.3899, Accuracy: 682/9900 (6.8889%)
Done in 302.8552906513214 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 10, 76, 15, 42, 57, 17, 9, 3, 70, 8, 65, 33, 59, 52, 69, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4909/5308 (92.4830%), train_poison_data_count: 415
Global model norm: 42.49621708807591.
Norm before scaling: 42.496922280564185. Distance: 1.9512671828261792
Total norm for 4 adversaries is: 42.496922280564185. distance: 1.9512671828261792
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1150, Accuracy: 9614/9900 (97.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5396/5777 (93.4049%), train_poison_data_count: 455
Global model norm: 42.49621708807591.
Norm before scaling: 42.486687942739785. Distance: 1.9398592459358923
Total norm for 4 adversaries is: 42.486687942739785. distance: 1.9398592459358923
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1313, Accuracy: 9553/9900 (96.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4632/5123 (90.4158%), train_poison_data_count: 403
Global model norm: 42.49621708807591.
Norm before scaling: 42.49974580576556. Distance: 2.062748287168316
Total norm for 4 adversaries is: 42.49974580576556. distance: 2.062748287168316
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1613, Accuracy: 9475/9900 (95.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5054/5503 (91.8408%), train_poison_data_count: 430
Global model norm: 42.49621708807591.
Norm before scaling: 42.49778687941806. Distance: 2.0112862427589167
Total norm for 4 adversaries is: 42.49778687941806. distance: 2.0112862427589167
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1833, Accuracy: 9428/9900 (95.2323%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4633/5068 (91.4167%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4523/5068 (89.2463%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2705, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3473/3959 (87.7242%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3593/3959 (90.7552%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8857, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5491/6068 (90.4911%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5486/6068 (90.4087%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0637, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5329/5907 (90.2150%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5364/5907 (90.8075%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2153, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4516/4956 (91.1219%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4563/4956 (92.0702%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9321, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4239/4903 (86.4573%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4406/4903 (89.8633%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1025, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5009/5727 (87.4629%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5078/5727 (88.6677%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0633, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4892/5346 (91.5077%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4946/5346 (92.5178%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1425, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5382/5871 (91.6709%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5361/5871 (91.3132%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0603, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4333/4889 (88.6275%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4391/4889 (89.8139%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0961, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4843/5497 (88.1026%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4942/5497 (89.9036%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9936, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4258/4818 (88.3769%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4288/4818 (88.9996%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9319, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4127/4397 (93.8594%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4202/4397 (95.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8577, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3733/4130 (90.3874%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3795/4130 (91.8886%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9156, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3995/4364 (91.5445%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3950/4364 (90.5133%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0235, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4838/5702 (84.8474%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4613/5702 (80.9014%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0799, Accuracy: 5186/10000 (51.8600%)
time spent on training: 288.9725618362427
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0927, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 5.5093, Accuracy: 1135/9900 (11.4646%)
Done in 315.598828792572 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 57, 60, 74, 72, 70, 14, 43, 88, 9, 80, 22, 73, 66, 82, 56, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4924/5308 (92.7656%), train_poison_data_count: 415
Global model norm: 42.51906167201659.
Norm before scaling: 42.51306669535556. Distance: 1.8758907109821057
Total norm for 4 adversaries is: 42.51306669535556. distance: 1.8758907109821057
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2137, Accuracy: 9373/9900 (94.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5444/5777 (94.2358%), train_poison_data_count: 455
Global model norm: 42.51906167201659.
Norm before scaling: 42.50683825960389. Distance: 1.8240930158589421
Total norm for 4 adversaries is: 42.50683825960389. distance: 1.8240930158589421
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2065, Accuracy: 9403/9900 (94.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4655/5123 (90.8647%), train_poison_data_count: 403
Global model norm: 42.51906167201659.
Norm before scaling: 42.52017271708365. Distance: 1.992319199939822
Total norm for 4 adversaries is: 42.52017271708365. distance: 1.992319199939822
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1740, Accuracy: 9476/9900 (95.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5105/5503 (92.7676%), train_poison_data_count: 430
Global model norm: 42.51906167201659.
Norm before scaling: 42.51649352521545. Distance: 1.937583367799869
Total norm for 4 adversaries is: 42.51649352521545. distance: 1.937583367799869
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1041, Accuracy: 9615/9900 (97.1212%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4568/4956 (92.1711%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4547/4956 (91.7474%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0580, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3677/4145 (88.7093%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3751/4145 (90.4946%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9622, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4233/4797 (88.2427%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4328/4797 (90.2231%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9423, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4638/5193 (89.3125%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4637/5193 (89.2933%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1989, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5427/5871 (92.4374%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5360/5871 (91.2962%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2142, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3858/4196 (91.9447%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3946/4196 (94.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9990, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4434/4979 (89.0540%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4511/4979 (90.6005%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0548, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4845/5362 (90.3581%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4854/5362 (90.5259%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0035, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5054/5727 (88.2486%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5052/5727 (88.2137%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0929, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4912/5461 (89.9469%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4944/5461 (90.5329%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1443, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5122/5696 (89.9228%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5164/5696 (90.6601%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9618, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4171/4605 (90.5755%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4278/4605 (92.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8918, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4352/4843 (89.8617%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4389/4843 (90.6256%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1855, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4887/5298 (92.2424%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4924/5298 (92.9407%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9741, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4843/5427 (89.2390%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4868/5427 (89.6996%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9698, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4428/4830 (91.6770%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4451/4830 (92.1532%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1774, Accuracy: 5348/10000 (53.4800%)
time spent on training: 304.5087339878082
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0968, Accuracy: 7051/10000 (70.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 4.6739, Accuracy: 1800/9900 (18.1818%)
Done in 331.2231249809265 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 69, 16, 75, 60, 24, 8, 77, 11, 80, 28, 41, 2, 76, 57, 33, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4941/5308 (93.0859%), train_poison_data_count: 415
Global model norm: 42.541487964599774.
Norm before scaling: 42.53815928219259. Distance: 1.839838825713288
Total norm for 4 adversaries is: 42.53815928219259. distance: 1.839838825713288
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2210, Accuracy: 9368/9900 (94.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5460/5777 (94.5127%), train_poison_data_count: 455
Global model norm: 42.541487964599774.
Norm before scaling: 42.528511805684545. Distance: 1.7796463691171733
Total norm for 4 adversaries is: 42.528511805684545. distance: 1.7796463691171733
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.0977, Accuracy: 9660/9900 (97.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4684/5123 (91.4308%), train_poison_data_count: 403
Global model norm: 42.541487964599774.
Norm before scaling: 42.54136027425986. Distance: 1.9322750642651043
Total norm for 4 adversaries is: 42.54136027425986. distance: 1.9322750642651043
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1428, Accuracy: 9533/9900 (96.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5077/5503 (92.2588%), train_poison_data_count: 430
Global model norm: 42.541487964599774.
Norm before scaling: 42.54307760550989. Distance: 1.963609675706099
Total norm for 4 adversaries is: 42.54307760550989. distance: 1.963609675706099
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1450, Accuracy: 9523/9900 (96.1919%)
___Train Local_ResNet_18,  epoch  76, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3962/4364 (90.7883%)
___Train Local_ResNet_18,  epoch  76, local model 69, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3982/4364 (91.2466%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8986, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  76, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4793/5353 (89.5386%)
___Train Local_ResNet_18,  epoch  76, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4790/5353 (89.4825%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0010, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  76, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4221/4672 (90.3467%)
___Train Local_ResNet_18,  epoch  76, local model 75, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4289/4672 (91.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8585, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  76, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3709/4145 (89.4813%)
___Train Local_ResNet_18,  epoch  76, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3766/4145 (90.8565%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0258, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  76, local model 24, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3932/4313 (91.1662%)
___Train Local_ResNet_18,  epoch  76, local model 24, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3969/4313 (92.0241%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9239, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  76, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4359/4889 (89.1593%)
___Train Local_ResNet_18,  epoch  76, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4419/4889 (90.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0302, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4403/5050 (87.1881%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4522/5050 (89.5446%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9847, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  76, local model 11, internal_epoch   1,  Average loss: 0.0085, Accuracy: 4806/5702 (84.2862%)
___Train Local_ResNet_18,  epoch  76, local model 11, internal_epoch   2,  Average loss: 0.0103, Accuracy: 4579/5702 (80.3052%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1638, Accuracy: 5016/10000 (50.1600%)
___Train Local_ResNet_18,  epoch  76, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4938/5461 (90.4230%)
___Train Local_ResNet_18,  epoch  76, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4927/5461 (90.2216%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1767, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  76, local model 28, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4534/5122 (88.5201%)
___Train Local_ResNet_18,  epoch  76, local model 28, internal_epoch   2,  Average loss: 0.0118, Accuracy: 4092/5122 (79.8907%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3639, Accuracy: 4788/10000 (47.8800%)
___Train Local_ResNet_18,  epoch  76, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4280/4714 (90.7934%)
___Train Local_ResNet_18,  epoch  76, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4324/4714 (91.7268%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1950, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch  76, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3548/3968 (89.4153%)
___Train Local_ResNet_18,  epoch  76, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3620/3968 (91.2298%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8952, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3489/3959 (88.1283%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3626/3959 (91.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9571, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  76, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4519/4956 (91.1824%)
___Train Local_ResNet_18,  epoch  76, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4557/4956 (91.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1124, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  76, local model 33, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4271/4818 (88.6467%)
___Train Local_ResNet_18,  epoch  76, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4313/4818 (89.5185%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0581, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  76, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3979/4368 (91.0943%)
___Train Local_ResNet_18,  epoch  76, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4008/4368 (91.7582%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1098, Accuracy: 5246/10000 (52.4600%)
time spent on training: 301.6552550792694
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1028, Accuracy: 7035/10000 (70.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 3.9841, Accuracy: 2552/9900 (25.7778%)
Done in 328.06657576560974 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 29, 81, 74, 11, 98, 12, 65, 40, 72, 67, 2, 26, 91, 61, 25, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4943/5308 (93.1236%), train_poison_data_count: 415
Global model norm: 42.56276385747876.
Norm before scaling: 42.55802564587554. Distance: 1.8466650338400956
Total norm for 4 adversaries is: 42.55802564587554. distance: 1.8466650338400956
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1004, Accuracy: 9639/9900 (97.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5478/5777 (94.8243%), train_poison_data_count: 455
Global model norm: 42.56276385747876.
Norm before scaling: 42.5514853589155. Distance: 1.7290621653159552
Total norm for 4 adversaries is: 42.5514853589155. distance: 1.7290621653159552
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1886, Accuracy: 9421/9900 (95.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4736/5123 (92.4458%), train_poison_data_count: 403
Global model norm: 42.56276385747876.
Norm before scaling: 42.559152883259145. Distance: 1.8557694683325665
Total norm for 4 adversaries is: 42.559152883259145. distance: 1.8557694683325665
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2024, Accuracy: 9394/9900 (94.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5123/5503 (93.0947%), train_poison_data_count: 430
Global model norm: 42.56276385747876.
Norm before scaling: 42.5597136225423. Distance: 1.8800786221073778
Total norm for 4 adversaries is: 42.5597136225423. distance: 1.8800786221073778
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2195, Accuracy: 9337/9900 (94.3131%)
___Train Local_ResNet_18,  epoch  77, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4365/4732 (92.2443%)
___Train Local_ResNet_18,  epoch  77, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4390/4732 (92.7726%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9591, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  77, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4550/5035 (90.3674%)
___Train Local_ResNet_18,  epoch  77, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4566/5035 (90.6852%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9007, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  77, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4276/4797 (89.1390%)
___Train Local_ResNet_18,  epoch  77, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4277/4797 (89.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1407, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  77, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4769/5702 (83.6373%)
___Train Local_ResNet_18,  epoch  77, local model 11, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4703/5702 (82.4798%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.3130, Accuracy: 4907/10000 (49.0700%)
___Train Local_ResNet_18,  epoch  77, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3795/4161 (91.2040%)
___Train Local_ResNet_18,  epoch  77, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3826/4161 (91.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9016, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch  77, local model 12, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4899/5526 (88.6536%)
___Train Local_ResNet_18,  epoch  77, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4892/5526 (88.5270%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0019, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4900/5497 (89.1395%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4892/5497 (88.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2525, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch  77, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5450/5939 (91.7663%)
___Train Local_ResNet_18,  epoch  77, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5501/5939 (92.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1236, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  77, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4635/5193 (89.2548%)
___Train Local_ResNet_18,  epoch  77, local model 72, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4476/5193 (86.1930%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2136, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch  77, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4856/5559 (87.3538%)
___Train Local_ResNet_18,  epoch  77, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4849/5559 (87.2279%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0460, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  77, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3546/3968 (89.3649%)
___Train Local_ResNet_18,  epoch  77, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3638/3968 (91.6835%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8736, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  77, local model 26, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3744/4086 (91.6300%)
___Train Local_ResNet_18,  epoch  77, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3822/4086 (93.5389%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9940, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  77, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4043/4527 (89.3086%)
___Train Local_ResNet_18,  epoch  77, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4031/4527 (89.0435%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9320, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  77, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4036/4485 (89.9889%)
___Train Local_ResNet_18,  epoch  77, local model 61, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3823/4485 (85.2397%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0576, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  77, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5665/6419 (88.2536%)
___Train Local_ResNet_18,  epoch  77, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5530/6419 (86.1505%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2406, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch  77, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4865/5489 (88.6318%)
___Train Local_ResNet_18,  epoch  77, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4959/5489 (90.3443%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0397, Accuracy: 5360/10000 (53.6000%)
time spent on training: 287.89531564712524
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1064, Accuracy: 7046/10000 (70.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 3.4576, Accuracy: 3259/9900 (32.9192%)
Done in 314.5403256416321 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 56, 90, 54, 63, 94, 10, 96, 45, 38, 59, 6, 85, 55, 32, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4954/5308 (93.3308%), train_poison_data_count: 415
Global model norm: 42.58646850590792.
Norm before scaling: 42.58388005830742. Distance: 1.8154058511286488
Total norm for 4 adversaries is: 42.58388005830742. distance: 1.8154058511286488
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2045, Accuracy: 9420/9900 (95.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5489/5777 (95.0147%), train_poison_data_count: 455
Global model norm: 42.58646850590792.
Norm before scaling: 42.571486007637056. Distance: 1.705567734240286
Total norm for 4 adversaries is: 42.571486007637056. distance: 1.705567734240286
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2002, Accuracy: 9396/9900 (94.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4719/5123 (92.1140%), train_poison_data_count: 403
Global model norm: 42.58646850590792.
Norm before scaling: 42.58346296814498. Distance: 1.8381296908394302
Total norm for 4 adversaries is: 42.58346296814498. distance: 1.8381296908394302
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1973, Accuracy: 9389/9900 (94.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5116/5503 (92.9675%), train_poison_data_count: 430
Global model norm: 42.58646850590792.
Norm before scaling: 42.58328237113715. Distance: 1.8713871799455088
Total norm for 4 adversaries is: 42.58328237113715. distance: 1.8713871799455088
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1353, Accuracy: 9559/9900 (96.5556%)
___Train Local_ResNet_18,  epoch  78, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4837/5427 (89.1284%)
___Train Local_ResNet_18,  epoch  78, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4919/5427 (90.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9460, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  78, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4379/4748 (92.2283%)
___Train Local_ResNet_18,  epoch  78, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4351/4748 (91.6386%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9843, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  78, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4915/5645 (87.0682%)
___Train Local_ResNet_18,  epoch  78, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4814/5645 (85.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1935, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch  78, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3573/3910 (91.3811%)
___Train Local_ResNet_18,  epoch  78, local model 63, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3442/3910 (88.0307%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0981, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  78, local model 94, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4634/5224 (88.7060%)
___Train Local_ResNet_18,  epoch  78, local model 94, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4769/5224 (91.2902%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9290, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  78, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4602/5068 (90.8051%)
___Train Local_ResNet_18,  epoch  78, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4605/5068 (90.8642%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2128, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4589/5086 (90.2281%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4641/5086 (91.2505%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0472, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  78, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4892/5489 (89.1237%)
___Train Local_ResNet_18,  epoch  78, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4972/5489 (90.5812%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1097, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  78, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5508/6235 (88.3400%)
___Train Local_ResNet_18,  epoch  78, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5509/6235 (88.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2018, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  78, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4151/4397 (94.4053%)
___Train Local_ResNet_18,  epoch  78, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4198/4397 (95.4742%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7888, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch  78, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4443/4929 (90.1400%)
___Train Local_ResNet_18,  epoch  78, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4448/4929 (90.2414%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0841, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  78, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 6225/6947 (89.6070%)
___Train Local_ResNet_18,  epoch  78, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 6150/6947 (88.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0196, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  78, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4284/4731 (90.5517%)
___Train Local_ResNet_18,  epoch  78, local model 55, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4342/4731 (91.7776%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9127, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5297/6080 (87.1217%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5332/6080 (87.6974%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2088, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch  78, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3190/3552 (89.8086%)
___Train Local_ResNet_18,  epoch  78, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3284/3552 (92.4550%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7826, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch  78, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4312/4737 (91.0281%)
___Train Local_ResNet_18,  epoch  78, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4303/4737 (90.8381%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0024, Accuracy: 5447/10000 (54.4700%)
time spent on training: 294.95996928215027
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1124, Accuracy: 7031/10000 (70.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 2.8861, Accuracy: 4035/9900 (40.7576%)
Done in 321.7516963481903 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 23, 89, 83, 1, 0, 90, 46, 70, 48, 5, 17, 96, 79, 7, 63, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4974/5308 (93.7076%), train_poison_data_count: 415
Global model norm: 42.6081273309264.
Norm before scaling: 42.60442994773988. Distance: 1.7826551282666676
Total norm for 4 adversaries is: 42.60442994773988. distance: 1.7826551282666676
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1765, Accuracy: 9459/9900 (95.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5476/5777 (94.7897%), train_poison_data_count: 455
Global model norm: 42.6081273309264.
Norm before scaling: 42.59695111320322. Distance: 1.7669734700429005
Total norm for 4 adversaries is: 42.59695111320322. distance: 1.7669734700429005
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1971, Accuracy: 9445/9900 (95.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4727/5123 (92.2702%), train_poison_data_count: 403
Global model norm: 42.6081273309264.
Norm before scaling: 42.60159330298721. Distance: 1.819031031024607
Total norm for 4 adversaries is: 42.60159330298721. distance: 1.819031031024607
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3492, Accuracy: 9005/9900 (90.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5124/5503 (93.1128%), train_poison_data_count: 430
Global model norm: 42.6081273309264.
Norm before scaling: 42.602805347036714. Distance: 1.8167364005024291
Total norm for 4 adversaries is: 42.602805347036714. distance: 1.8167364005024291
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3465, Accuracy: 8971/9900 (90.6162%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4257/4549 (93.5810%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4276/4549 (93.9987%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.7406, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch  79, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4270/4737 (90.1414%)
___Train Local_ResNet_18,  epoch  79, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4290/4737 (90.5636%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1772, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  79, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3214/3552 (90.4842%)
___Train Local_ResNet_18,  epoch  79, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3310/3552 (93.1869%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9254, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5024/5422 (92.6595%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4993/5422 (92.0878%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9447, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  79, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4865/5454 (89.2006%)
___Train Local_ResNet_18,  epoch  79, local model 0, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4778/5454 (87.6054%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0172, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  79, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4336/4748 (91.3227%)
___Train Local_ResNet_18,  epoch  79, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4368/4748 (91.9966%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9309, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  79, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4681/5399 (86.7012%)
___Train Local_ResNet_18,  epoch  79, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4759/5399 (88.1460%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1313, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  79, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5429/5871 (92.4715%)
___Train Local_ResNet_18,  epoch  79, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5377/5871 (91.5858%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1691, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  79, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4464/4830 (92.4224%)
___Train Local_ResNet_18,  epoch  79, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4556/4830 (94.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0622, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  79, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4631/4993 (92.7498%)
___Train Local_ResNet_18,  epoch  79, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4648/4993 (93.0903%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9022, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  79, local model 17, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4295/4903 (87.5994%)
___Train Local_ResNet_18,  epoch  79, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4358/4903 (88.8844%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1647, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch  79, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4598/5086 (90.4050%)
___Train Local_ResNet_18,  epoch  79, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4677/5086 (91.9583%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8766, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  79, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3734/4111 (90.8295%)
___Train Local_ResNet_18,  epoch  79, local model 79, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3677/4111 (89.4430%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1090, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  79, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4352/4869 (89.3818%)
___Train Local_ResNet_18,  epoch  79, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4107/4869 (84.3500%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.3860, Accuracy: 4966/10000 (49.6600%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3530/3910 (90.2813%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3556/3910 (90.9463%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9650, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  79, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3733/4175 (89.4132%)
___Train Local_ResNet_18,  epoch  79, local model 39, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3745/4175 (89.7006%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9993, Accuracy: 5438/10000 (54.3800%)
time spent on training: 286.00634002685547
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1183, Accuracy: 7001/10000 (70.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 2.5339, Accuracy: 4617/9900 (46.6364%)
Done in 312.7629609107971 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 44, 30, 66, 73, 76, 81, 22, 46, 17, 34, 96, 31, 95, 40, 53, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4969/5308 (93.6134%), train_poison_data_count: 415
Global model norm: 42.62933417068507.
Norm before scaling: 42.622791937860256. Distance: 1.7586210976587922
Total norm for 4 adversaries is: 42.622791937860256. distance: 1.7586210976587922
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1383, Accuracy: 9562/9900 (96.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5484/5777 (94.9282%), train_poison_data_count: 455
Global model norm: 42.62933417068507.
Norm before scaling: 42.61371792132347. Distance: 1.670905571927346
Total norm for 4 adversaries is: 42.61371792132347. distance: 1.670905571927346
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1197, Accuracy: 9598/9900 (96.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4746/5123 (92.6410%), train_poison_data_count: 403
Global model norm: 42.62933417068507.
Norm before scaling: 42.62230649251853. Distance: 1.7923847651982798
Total norm for 4 adversaries is: 42.62230649251853. distance: 1.7923847651982798
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2713, Accuracy: 9225/9900 (93.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5143/5503 (93.4581%), train_poison_data_count: 430
Global model norm: 42.62933417068507.
Norm before scaling: 42.622787641908026. Distance: 1.8098841239129613
Total norm for 4 adversaries is: 42.622787641908026. distance: 1.8098841239129613
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2018, Accuracy: 9393/9900 (94.8788%)
___Train Local_ResNet_18,  epoch  80, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4647/5075 (91.5665%)
___Train Local_ResNet_18,  epoch  80, local model 44, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4562/5075 (89.8916%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0703, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  80, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3416/3774 (90.5140%)
___Train Local_ResNet_18,  epoch  80, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3493/3774 (92.5543%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8146, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch  80, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4375/4843 (90.3366%)
___Train Local_ResNet_18,  epoch  80, local model 66, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4416/4843 (91.1832%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0323, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  80, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4249/4605 (92.2693%)
___Train Local_ResNet_18,  epoch  80, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4220/4605 (91.6395%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8941, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  80, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3491/3959 (88.1788%)
___Train Local_ResNet_18,  epoch  80, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3593/3959 (90.7552%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0682, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  80, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4563/5035 (90.6256%)
___Train Local_ResNet_18,  epoch  80, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4629/5035 (91.9364%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0612, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  80, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5211/5696 (91.4853%)
___Train Local_ResNet_18,  epoch  80, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5201/5696 (91.3097%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0866, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4653/5399 (86.1826%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4652/5399 (86.1641%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0800, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  80, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4347/4903 (88.6600%)
___Train Local_ResNet_18,  epoch  80, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4376/4903 (89.2515%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2010, Accuracy: 5069/10000 (50.6900%)
___Train Local_ResNet_18,  epoch  80, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4477/4911 (91.1627%)
___Train Local_ResNet_18,  epoch  80, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4485/4911 (91.3256%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0130, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  80, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4595/5086 (90.3460%)
___Train Local_ResNet_18,  epoch  80, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4605/5086 (90.5427%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1085, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  80, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4115/4537 (90.6987%)
___Train Local_ResNet_18,  epoch  80, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4171/4537 (91.9330%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9278, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  80, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4461/5018 (88.9000%)
___Train Local_ResNet_18,  epoch  80, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4469/5018 (89.0594%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1694, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5482/5939 (92.3051%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5499/5939 (92.5913%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0083, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5794/6664 (86.9448%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0079, Accuracy: 5650/6664 (84.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2250, Accuracy: 4905/10000 (49.0500%)
___Train Local_ResNet_18,  epoch  80, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4854/5702 (85.1280%)
___Train Local_ResNet_18,  epoch  80, local model 11, internal_epoch   2,  Average loss: 0.0109, Accuracy: 4543/5702 (79.6738%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3485, Accuracy: 4847/10000 (48.4700%)
time spent on training: 300.6978392601013
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1247, Accuracy: 6985/10000 (69.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 2.1601, Accuracy: 5261/9900 (53.1414%)
Done in 327.0939302444458 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 69, 64, 10, 24, 15, 54, 35, 59, 42, 72, 84, 92, 73, 76, 29, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5003/5308 (94.2540%), train_poison_data_count: 415
Global model norm: 42.65131896865119.
Norm before scaling: 42.64144231307218. Distance: 1.6701942623244062
Total norm for 4 adversaries is: 42.64144231307218. distance: 1.6701942623244062
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1017, Accuracy: 9641/9900 (97.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5512/5777 (95.4128%), train_poison_data_count: 455
Global model norm: 42.65131896865119.
Norm before scaling: 42.63252545372488. Distance: 1.640789060109986
Total norm for 4 adversaries is: 42.63252545372488. distance: 1.640789060109986
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1026, Accuracy: 9642/9900 (97.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4772/5123 (93.1485%), train_poison_data_count: 403
Global model norm: 42.65131896865119.
Norm before scaling: 42.64404444195212. Distance: 1.745106326145726
Total norm for 4 adversaries is: 42.64404444195212. distance: 1.745106326145726
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1636, Accuracy: 9464/9900 (95.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5182/5503 (94.1668%), train_poison_data_count: 430
Global model norm: 42.65131896865119.
Norm before scaling: 42.642832138736985. Distance: 1.7516731710461406
Total norm for 4 adversaries is: 42.642832138736985. distance: 1.7516731710461406
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1850, Accuracy: 9418/9900 (95.1313%)
___Train Local_ResNet_18,  epoch  81, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3974/4364 (91.0632%)
___Train Local_ResNet_18,  epoch  81, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4017/4364 (92.0486%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1038, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4344/4894 (88.7617%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4381/4894 (89.5178%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9345, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4693/5068 (92.6006%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4600/5068 (90.7656%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1121, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  81, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3953/4313 (91.6531%)
___Train Local_ResNet_18,  epoch  81, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3976/4313 (92.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8036, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch  81, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5490/6068 (90.4746%)
___Train Local_ResNet_18,  epoch  81, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5436/6068 (89.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2769, Accuracy: 5060/10000 (50.6000%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4968/5645 (88.0071%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4886/5645 (86.5545%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.4822, Accuracy: 4816/10000 (48.1600%)
___Train Local_ResNet_18,  epoch  81, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5059/5615 (90.0980%)
___Train Local_ResNet_18,  epoch  81, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5057/5615 (90.0623%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1509, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch  81, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4136/4397 (94.0641%)
___Train Local_ResNet_18,  epoch  81, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4172/4397 (94.8829%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7795, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch  81, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5339/5907 (90.3843%)
___Train Local_ResNet_18,  epoch  81, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5333/5907 (90.2827%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2829, Accuracy: 4960/10000 (49.6000%)
___Train Local_ResNet_18,  epoch  81, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4656/5193 (89.6592%)
___Train Local_ResNet_18,  epoch  81, local model 72, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4462/5193 (85.9234%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2890, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4665/5209 (89.5565%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4689/5209 (90.0173%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0782, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  81, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6261/6812 (91.9113%)
___Train Local_ResNet_18,  epoch  81, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6226/6812 (91.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1204, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4208/4605 (91.3789%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4261/4605 (92.5299%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9638, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  81, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3565/3959 (90.0480%)
___Train Local_ResNet_18,  epoch  81, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3639/3959 (91.9172%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0153, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4362/4732 (92.1809%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4434/4732 (93.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8402, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4636/5075 (91.3498%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4609/5075 (90.8177%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1304, Accuracy: 5263/10000 (52.6300%)
time spent on training: 297.16925740242004
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1309, Accuracy: 6967/10000 (69.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 1.8796, Accuracy: 5762/9900 (58.2020%)
Done in 323.9505343437195 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 14, 54, 3, 34, 68, 73, 15, 91, 7, 26, 79, 11, 61, 56, 16, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5014/5308 (94.4612%), train_poison_data_count: 415
Global model norm: 42.67332962780661.
Norm before scaling: 42.66486720423125. Distance: 1.6791590369392766
Total norm for 4 adversaries is: 42.66486720423125. distance: 1.6791590369392766
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2419, Accuracy: 9326/9900 (94.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5517/5777 (95.4994%), train_poison_data_count: 455
Global model norm: 42.67332962780661.
Norm before scaling: 42.65358422302061. Distance: 1.5950997564756006
Total norm for 4 adversaries is: 42.65358422302061. distance: 1.5950997564756006
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1501, Accuracy: 9526/9900 (96.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4804/5123 (93.7732%), train_poison_data_count: 403
Global model norm: 42.67332962780661.
Norm before scaling: 42.66341514913568. Distance: 1.6725223749599947
Total norm for 4 adversaries is: 42.66341514913568. distance: 1.6725223749599947
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.4131, Accuracy: 8918/9900 (90.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5151/5503 (93.6035%), train_poison_data_count: 430
Global model norm: 42.67332962780661.
Norm before scaling: 42.66579849631464. Distance: 1.7620847199257823
Total norm for 4 adversaries is: 42.66579849631464. distance: 1.7620847199257823
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3348, Accuracy: 9030/9900 (91.2121%)
___Train Local_ResNet_18,  epoch  82, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3923/4196 (93.4938%)
___Train Local_ResNet_18,  epoch  82, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3974/4196 (94.7092%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8521, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch  82, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4998/5645 (88.5385%)
___Train Local_ResNet_18,  epoch  82, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4875/5645 (86.3596%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2182, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4941/5346 (92.4242%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4942/5346 (92.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0800, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  82, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4461/4911 (90.8369%)
___Train Local_ResNet_18,  epoch  82, local model 34, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4433/4911 (90.2667%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1340, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  82, local model 68, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3299/3589 (91.9198%)
___Train Local_ResNet_18,  epoch  82, local model 68, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3167/3589 (88.2419%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0650, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4255/4605 (92.3996%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4313/4605 (93.6591%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9152, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  82, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5528/6068 (91.1009%)
___Train Local_ResNet_18,  epoch  82, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5559/6068 (91.6117%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1404, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch  82, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4044/4527 (89.3307%)
___Train Local_ResNet_18,  epoch  82, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3991/4527 (88.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9951, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4369/4869 (89.7310%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4232/4869 (86.9172%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.4142, Accuracy: 4989/10000 (49.8900%)
___Train Local_ResNet_18,  epoch  82, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3754/4086 (91.8747%)
___Train Local_ResNet_18,  epoch  82, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3822/4086 (93.5389%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8922, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  82, local model 79, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3727/4111 (90.6592%)
___Train Local_ResNet_18,  epoch  82, local model 79, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3762/4111 (91.5106%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1941, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  82, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4860/5702 (85.2333%)
___Train Local_ResNet_18,  epoch  82, local model 11, internal_epoch   2,  Average loss: 0.0117, Accuracy: 4407/5702 (77.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2074, Accuracy: 4976/10000 (49.7600%)
___Train Local_ResNet_18,  epoch  82, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4098/4485 (91.3712%)
___Train Local_ResNet_18,  epoch  82, local model 61, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4092/4485 (91.2375%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0216, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  82, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4865/5427 (89.6444%)
___Train Local_ResNet_18,  epoch  82, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4888/5427 (90.0682%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9311, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  82, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4825/5353 (90.1364%)
___Train Local_ResNet_18,  epoch  82, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4806/5353 (89.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0385, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  82, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4856/5489 (88.4678%)
___Train Local_ResNet_18,  epoch  82, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5007/5489 (91.2188%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9700, Accuracy: 5448/10000 (54.4800%)
time spent on training: 293.56366181373596
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1324, Accuracy: 6976/10000 (69.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 1.7037, Accuracy: 6093/9900 (61.5455%)
Done in 319.84930086135864 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 46, 78, 3, 7, 8, 74, 87, 47, 38, 94, 25, 49, 44, 70, 40, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5037/5308 (94.8945%), train_poison_data_count: 415
Global model norm: 42.69603656179268.
Norm before scaling: 42.68290004269494. Distance: 1.6201546396223026
Total norm for 4 adversaries is: 42.68290004269494. distance: 1.6201546396223026
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1046, Accuracy: 9639/9900 (97.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5527/5777 (95.6725%), train_poison_data_count: 455
Global model norm: 42.69603656179268.
Norm before scaling: 42.67766747118743. Distance: 1.6025844383905739
Total norm for 4 adversaries is: 42.67766747118743. distance: 1.6025844383905739
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1307, Accuracy: 9569/9900 (96.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4803/5123 (93.7537%), train_poison_data_count: 403
Global model norm: 42.69603656179268.
Norm before scaling: 42.68622172774987. Distance: 1.6820329480975449
Total norm for 4 adversaries is: 42.68622172774987. distance: 1.6820329480975449
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.4530, Accuracy: 8784/9900 (88.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5180/5503 (94.1305%), train_poison_data_count: 430
Global model norm: 42.69603656179268.
Norm before scaling: 42.68688231617531. Distance: 1.7350058568146542
Total norm for 4 adversaries is: 42.68688231617531. distance: 1.7350058568146542
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0537, Accuracy: 9763/9900 (98.6162%)
___Train Local_ResNet_18,  epoch  83, local model 46, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4757/5399 (88.1089%)
___Train Local_ResNet_18,  epoch  83, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4723/5399 (87.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.4014, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch  83, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4019/4368 (92.0101%)
___Train Local_ResNet_18,  epoch  83, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3976/4368 (91.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8636, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  83, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4934/5346 (92.2933%)
___Train Local_ResNet_18,  epoch  83, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4987/5346 (93.2847%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0439, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  83, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4391/4869 (90.1828%)
___Train Local_ResNet_18,  epoch  83, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4151/4869 (85.2536%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2123, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch  83, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4409/4889 (90.1820%)
___Train Local_ResNet_18,  epoch  83, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4447/4889 (90.9593%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9993, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  83, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4282/4797 (89.2641%)
___Train Local_ResNet_18,  epoch  83, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4282/4797 (89.2641%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0150, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  83, local model 87, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3535/3995 (88.4856%)
___Train Local_ResNet_18,  epoch  83, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3597/3995 (90.0375%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9612, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  83, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4566/5123 (89.1275%)
___Train Local_ResNet_18,  epoch  83, local model 47, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4545/5123 (88.7175%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2031, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  83, local model 38, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5528/6235 (88.6608%)
___Train Local_ResNet_18,  epoch  83, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5518/6235 (88.5004%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1652, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  83, local model 94, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4621/5224 (88.4571%)
___Train Local_ResNet_18,  epoch  83, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4656/5224 (89.1271%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9848, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  83, local model 25, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5681/6419 (88.5029%)
___Train Local_ResNet_18,  epoch  83, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5556/6419 (86.5555%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2494, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5004/5652 (88.5350%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5033/5652 (89.0481%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0904, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  83, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4672/5075 (92.0591%)
___Train Local_ResNet_18,  epoch  83, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4644/5075 (91.5074%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8955, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  83, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5412/5871 (92.1819%)
___Train Local_ResNet_18,  epoch  83, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5419/5871 (92.3011%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0321, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5454/5939 (91.8336%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5416/5939 (91.1938%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0435, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  83, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4874/5454 (89.3656%)
___Train Local_ResNet_18,  epoch  83, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4863/5454 (89.1639%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0815, Accuracy: 5338/10000 (53.3800%)
time spent on training: 299.83536100387573
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1389, Accuracy: 6948/10000 (69.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 1.5005, Accuracy: 6469/9900 (65.3434%)
Done in 326.33236718177795 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 80, 3, 45, 6, 57, 22, 68, 38, 76, 26, 41, 98, 61, 0, 1, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5036/5308 (94.8757%), train_poison_data_count: 415
Global model norm: 42.72036876276424.
Norm before scaling: 42.707868550570545. Distance: 1.6294758850401463
Total norm for 4 adversaries is: 42.707868550570545. distance: 1.6294758850401463
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1559, Accuracy: 9512/9900 (96.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5517/5777 (95.4994%), train_poison_data_count: 455
Global model norm: 42.72036876276424.
Norm before scaling: 42.70077232359211. Distance: 1.6209942522882486
Total norm for 4 adversaries is: 42.70077232359211. distance: 1.6209942522882486
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1253, Accuracy: 9593/9900 (96.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4800/5123 (93.6951%), train_poison_data_count: 403
Global model norm: 42.72036876276424.
Norm before scaling: 42.71033944729455. Distance: 1.6675601074503548
Total norm for 4 adversaries is: 42.71033944729455. distance: 1.6675601074503548
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3405, Accuracy: 9060/9900 (91.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5157/5503 (93.7125%), train_poison_data_count: 430
Global model norm: 42.72036876276424.
Norm before scaling: 42.712960242252585. Distance: 1.7563866830222357
Total norm for 4 adversaries is: 42.712960242252585. distance: 1.7563866830222357
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1571, Accuracy: 9503/9900 (95.9899%)
___Train Local_ResNet_18,  epoch  84, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4933/5461 (90.3314%)
___Train Local_ResNet_18,  epoch  84, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4913/5461 (89.9652%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1790, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  84, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4938/5346 (92.3681%)
___Train Local_ResNet_18,  epoch  84, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4944/5346 (92.4804%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0020, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  84, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4914/5489 (89.5245%)
___Train Local_ResNet_18,  epoch  84, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4926/5489 (89.7431%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1550, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4518/4929 (91.6616%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4478/4929 (90.8501%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0082, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  84, local model 57, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4526/4956 (91.3236%)
___Train Local_ResNet_18,  epoch  84, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4547/4956 (91.7474%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0271, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  84, local model 22, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5176/5696 (90.8708%)
___Train Local_ResNet_18,  epoch  84, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5166/5696 (90.6952%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0202, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  84, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3268/3589 (91.0560%)
___Train Local_ResNet_18,  epoch  84, local model 68, internal_epoch   2,  Average loss: 0.0091, Accuracy: 2991/3589 (83.3380%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2862, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch  84, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5530/6235 (88.6929%)
___Train Local_ResNet_18,  epoch  84, local model 38, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5539/6235 (88.8372%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2549, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch  84, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3527/3959 (89.0882%)
___Train Local_ResNet_18,  epoch  84, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3621/3959 (91.4625%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9120, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3736/4086 (91.4342%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3855/4086 (94.3465%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9569, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  84, local model 41, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4349/4714 (92.2571%)
___Train Local_ResNet_18,  epoch  84, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4336/4714 (91.9813%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0573, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  84, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3822/4161 (91.8529%)
___Train Local_ResNet_18,  epoch  84, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3813/4161 (91.6366%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3282, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch  84, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4089/4485 (91.1706%)
___Train Local_ResNet_18,  epoch  84, local model 61, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4026/4485 (89.7659%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0330, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  84, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4952/5454 (90.7957%)
___Train Local_ResNet_18,  epoch  84, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4975/5454 (91.2175%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9849, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  84, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5055/5422 (93.2313%)
___Train Local_ResNet_18,  epoch  84, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5042/5422 (92.9915%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9349, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  84, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4594/5122 (89.6915%)
___Train Local_ResNet_18,  epoch  84, local model 28, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4210/5122 (82.1945%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3195, Accuracy: 4966/10000 (49.6600%)
time spent on training: 295.9170205593109
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1424, Accuracy: 6941/10000 (69.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 1.3121, Accuracy: 6851/9900 (69.2020%)
Done in 322.77075386047363 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 47, 12, 88, 79, 31, 29, 65, 32, 92, 8, 20, 41, 52, 61, 39, 64].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5050/5308 (95.1394%), train_poison_data_count: 415
Global model norm: 42.74304642369476.
Norm before scaling: 42.72989007544221. Distance: 1.6071908444097778
Total norm for 4 adversaries is: 42.72989007544221. distance: 1.6071908444097778
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1293, Accuracy: 9561/9900 (96.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5529/5777 (95.7071%), train_poison_data_count: 455
Global model norm: 42.74304642369476.
Norm before scaling: 42.72278321990139. Distance: 1.5828348261773364
Total norm for 4 adversaries is: 42.72278321990139. distance: 1.5828348261773364
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2227, Accuracy: 9356/9900 (94.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4794/5123 (93.5780%), train_poison_data_count: 403
Global model norm: 42.74304642369476.
Norm before scaling: 42.73043571880294. Distance: 1.6549872136846606
Total norm for 4 adversaries is: 42.73043571880294. distance: 1.6549872136846606
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3269, Accuracy: 9156/9900 (92.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5191/5503 (94.3304%), train_poison_data_count: 430
Global model norm: 42.74304642369476.
Norm before scaling: 42.730668543561166. Distance: 1.6981293792724301
Total norm for 4 adversaries is: 42.730668543561166. distance: 1.6981293792724301
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1522, Accuracy: 9501/9900 (95.9697%)
___Train Local_ResNet_18,  epoch  85, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4591/5123 (89.6155%)
___Train Local_ResNet_18,  epoch  85, local model 47, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4499/5123 (87.8196%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1294, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  85, local model 12, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4921/5526 (89.0518%)
___Train Local_ResNet_18,  epoch  85, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4880/5526 (88.3098%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1744, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  85, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4928/5362 (91.9060%)
___Train Local_ResNet_18,  epoch  85, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4885/5362 (91.1041%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0972, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  85, local model 79, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3779/4111 (91.9241%)
___Train Local_ResNet_18,  epoch  85, local model 79, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3803/4111 (92.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9179, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  85, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4166/4537 (91.8228%)
___Train Local_ResNet_18,  epoch  85, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4206/4537 (92.7044%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9261, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  85, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4415/4732 (93.3009%)
___Train Local_ResNet_18,  epoch  85, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4473/4732 (94.5266%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8080, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch  85, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4962/5497 (90.2674%)
___Train Local_ResNet_18,  epoch  85, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4931/5497 (89.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1163, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5349/6080 (87.9770%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5300/6080 (87.1711%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1012, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  85, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 6264/6812 (91.9554%)
___Train Local_ResNet_18,  epoch  85, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6210/6812 (91.1627%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0308, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  85, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4448/4889 (90.9798%)
___Train Local_ResNet_18,  epoch  85, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4434/4889 (90.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9158, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  85, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4318/4714 (91.5995%)
___Train Local_ResNet_18,  epoch  85, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4396/4714 (93.2541%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8525, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  85, local model 41, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4315/4714 (91.5359%)
___Train Local_ResNet_18,  epoch  85, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4355/4714 (92.3844%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0992, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  85, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3791/4130 (91.7918%)
___Train Local_ResNet_18,  epoch  85, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3822/4130 (92.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8890, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch  85, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4062/4485 (90.5686%)
___Train Local_ResNet_18,  epoch  85, local model 61, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3952/4485 (88.1159%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1868, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  85, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3730/4175 (89.3413%)
___Train Local_ResNet_18,  epoch  85, local model 39, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3755/4175 (89.9401%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9845, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  85, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4365/4894 (89.1908%)
___Train Local_ResNet_18,  epoch  85, local model 64, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4337/4894 (88.6187%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0331, Accuracy: 5419/10000 (54.1900%)
time spent on training: 287.89578771591187
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1486, Accuracy: 6933/10000 (69.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.1496, Accuracy: 7188/9900 (72.6061%)
Done in 314.9281210899353 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 88, 39, 63, 20, 24, 15, 83, 29, 97, 50, 96, 1, 57, 30, 10, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5034/5308 (94.8380%), train_poison_data_count: 415
Global model norm: 42.76517542922264.
Norm before scaling: 42.75112217551283. Distance: 1.615096431132612
Total norm for 4 adversaries is: 42.75112217551283. distance: 1.615096431132612
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1493, Accuracy: 9531/9900 (96.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5544/5777 (95.9668%), train_poison_data_count: 455
Global model norm: 42.76517542922264.
Norm before scaling: 42.74254949238961. Distance: 1.541259359561813
Total norm for 4 adversaries is: 42.74254949238961. distance: 1.541259359561813
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1762, Accuracy: 9452/9900 (95.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4820/5123 (94.0855%), train_poison_data_count: 403
Global model norm: 42.76517542922264.
Norm before scaling: 42.75390892673587. Distance: 1.6589256842111626
Total norm for 4 adversaries is: 42.75390892673587. distance: 1.6589256842111626
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.2309, Accuracy: 9330/9900 (94.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5218/5503 (94.8210%), train_poison_data_count: 430
Global model norm: 42.76517542922264.
Norm before scaling: 42.75342497016686. Distance: 1.6789548473682498
Total norm for 4 adversaries is: 42.75342497016686. distance: 1.6789548473682498
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0978, Accuracy: 9638/9900 (97.3535%)
___Train Local_ResNet_18,  epoch  86, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4930/5362 (91.9433%)
___Train Local_ResNet_18,  epoch  86, local model 88, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4881/5362 (91.0295%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9090, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  86, local model 39, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3753/4175 (89.8922%)
___Train Local_ResNet_18,  epoch  86, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3803/4175 (91.0898%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1976, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3610/3910 (92.3274%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3574/3910 (91.4066%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0535, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  86, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4332/4714 (91.8965%)
___Train Local_ResNet_18,  epoch  86, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4415/4714 (93.6572%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7812, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch  86, local model 24, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3916/4313 (90.7953%)
___Train Local_ResNet_18,  epoch  86, local model 24, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3974/4313 (92.1400%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8200, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch  86, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5531/6068 (91.1503%)
___Train Local_ResNet_18,  epoch  86, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5522/6068 (91.0020%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9637, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  86, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3222/3552 (90.7095%)
___Train Local_ResNet_18,  epoch  86, local model 83, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3272/3552 (92.1171%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9299, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  86, local model 29, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4381/4732 (92.5824%)
___Train Local_ResNet_18,  epoch  86, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4456/4732 (94.1674%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8050, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch  86, local model 97, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4196/4736 (88.5980%)
___Train Local_ResNet_18,  epoch  86, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4254/4736 (89.8226%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9629, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  86, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4353/4757 (91.5073%)
___Train Local_ResNet_18,  epoch  86, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4371/4757 (91.8856%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9756, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  86, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4588/5086 (90.2084%)
___Train Local_ResNet_18,  epoch  86, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4593/5086 (90.3067%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0298, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  86, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5030/5422 (92.7702%)
___Train Local_ResNet_18,  epoch  86, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5025/5422 (92.6780%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0299, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  86, local model 57, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4572/4956 (92.2518%)
___Train Local_ResNet_18,  epoch  86, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4518/4956 (91.1622%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1685, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3490/3774 (92.4748%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3554/3774 (94.1706%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8473, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch  86, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4683/5068 (92.4033%)
___Train Local_ResNet_18,  epoch  86, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4683/5068 (92.4033%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0073, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  86, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4930/5346 (92.2185%)
___Train Local_ResNet_18,  epoch  86, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4930/5346 (92.2185%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0400, Accuracy: 5300/10000 (53.0000%)
time spent on training: 276.35018134117126
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1612, Accuracy: 6913/10000 (69.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.9706, Accuracy: 7606/9900 (76.8283%)
Done in 302.7957971096039 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 47, 33, 81, 59, 32, 96, 60, 88, 7, 69, 95, 21, 51, 35, 93, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5028/5308 (94.7249%), train_poison_data_count: 415
Global model norm: 42.785254503504916.
Norm before scaling: 42.7721225539888. Distance: 1.5997628125576182
Total norm for 4 adversaries is: 42.7721225539888. distance: 1.5997628125576182
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2048, Accuracy: 9386/9900 (94.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5545/5777 (95.9841%), train_poison_data_count: 455
Global model norm: 42.785254503504916.
Norm before scaling: 42.76204257465083. Distance: 1.522370341249907
Total norm for 4 adversaries is: 42.76204257465083. distance: 1.522370341249907
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1008, Accuracy: 9645/9900 (97.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4813/5123 (93.9489%), train_poison_data_count: 403
Global model norm: 42.785254503504916.
Norm before scaling: 42.7706570157918. Distance: 1.5945261393067518
Total norm for 4 adversaries is: 42.7706570157918. distance: 1.5945261393067518
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0995, Accuracy: 9630/9900 (97.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5230/5503 (95.0391%), train_poison_data_count: 430
Global model norm: 42.785254503504916.
Norm before scaling: 42.76986072374009. Distance: 1.6116493968307914
Total norm for 4 adversaries is: 42.76986072374009. distance: 1.6116493968307914
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.3239, Accuracy: 9097/9900 (91.8889%)
___Train Local_ResNet_18,  epoch  87, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4624/5123 (90.2596%)
___Train Local_ResNet_18,  epoch  87, local model 47, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4426/5123 (86.3947%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1101, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  87, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4330/4818 (89.8713%)
___Train Local_ResNet_18,  epoch  87, local model 33, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4276/4818 (88.7505%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1979, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch  87, local model 81, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4596/5035 (91.2810%)
___Train Local_ResNet_18,  epoch  87, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4635/5035 (92.0556%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0880, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  87, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4170/4397 (94.8374%)
___Train Local_ResNet_18,  epoch  87, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4187/4397 (95.2240%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8284, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch  87, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5268/6080 (86.6447%)
___Train Local_ResNet_18,  epoch  87, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5268/6080 (86.6447%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2312, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch  87, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4617/5086 (90.7786%)
___Train Local_ResNet_18,  epoch  87, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4639/5086 (91.2112%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0727, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3798/4145 (91.6285%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3804/4145 (91.7732%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0942, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  87, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4855/5362 (90.5446%)
___Train Local_ResNet_18,  epoch  87, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4858/5362 (90.6005%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0750, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  87, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4354/4869 (89.4229%)
___Train Local_ResNet_18,  epoch  87, local model 7, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4027/4869 (82.7069%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1651, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch  87, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3957/4364 (90.6737%)
___Train Local_ResNet_18,  epoch  87, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3993/4364 (91.4986%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8780, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  87, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4435/5018 (88.3818%)
___Train Local_ResNet_18,  epoch  87, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4496/5018 (89.5974%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0837, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  87, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4580/5038 (90.9091%)
___Train Local_ResNet_18,  epoch  87, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4647/5038 (92.2390%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9287, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  87, local model 51, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3792/4108 (92.3077%)
___Train Local_ResNet_18,  epoch  87, local model 51, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3770/4108 (91.7722%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0116, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  87, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5051/5615 (89.9555%)
___Train Local_ResNet_18,  epoch  87, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5088/5615 (90.6144%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1601, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  87, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4543/5055 (89.8714%)
___Train Local_ResNet_18,  epoch  87, local model 93, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4511/5055 (89.2384%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1993, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch  87, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4281/4797 (89.2433%)
___Train Local_ResNet_18,  epoch  87, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4331/4797 (90.2856%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9793, Accuracy: 5484/10000 (54.8400%)
time spent on training: 298.2161877155304
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1661, Accuracy: 6907/10000 (69.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.8543, Accuracy: 7871/9900 (79.5051%)
Done in 324.866614818573 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 91, 26, 17, 2, 35, 90, 19, 77, 49, 55, 42, 94, 76, 73, 74, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5088/5308 (95.8553%), train_poison_data_count: 415
Global model norm: 42.80721483116558.
Norm before scaling: 42.792562077312276. Distance: 1.5580896312801722
Total norm for 4 adversaries is: 42.792562077312276. distance: 1.5580896312801722
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1129, Accuracy: 9577/9900 (96.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5515/5777 (95.4648%), train_poison_data_count: 455
Global model norm: 42.80721483116558.
Norm before scaling: 42.78814173625898. Distance: 1.6193221741646888
Total norm for 4 adversaries is: 42.78814173625898. distance: 1.6193221741646888
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0911, Accuracy: 9662/9900 (97.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4823/5123 (94.1441%), train_poison_data_count: 403
Global model norm: 42.80721483116558.
Norm before scaling: 42.79358615055532. Distance: 1.62324517205838
Total norm for 4 adversaries is: 42.79358615055532. distance: 1.62324517205838
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1630, Accuracy: 9454/9900 (95.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5212/5503 (94.7120%), train_poison_data_count: 430
Global model norm: 42.80721483116558.
Norm before scaling: 42.79396553637119. Distance: 1.665948649554992
Total norm for 4 adversaries is: 42.79396553637119. distance: 1.665948649554992
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0615, Accuracy: 9728/9900 (98.2626%)
___Train Local_ResNet_18,  epoch  88, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4070/4527 (89.9050%)
___Train Local_ResNet_18,  epoch  88, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4043/4527 (89.3086%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0862, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  88, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3802/4086 (93.0494%)
___Train Local_ResNet_18,  epoch  88, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3802/4086 (93.0494%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9586, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  88, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4356/4903 (88.8436%)
___Train Local_ResNet_18,  epoch  88, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4425/4903 (90.2509%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1019, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  88, local model 2, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3619/3968 (91.2046%)
___Train Local_ResNet_18,  epoch  88, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3695/3968 (93.1200%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.7193, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18,  epoch  88, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5109/5615 (90.9884%)
___Train Local_ResNet_18,  epoch  88, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5112/5615 (91.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0593, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4419/4748 (93.0708%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4379/4748 (92.2283%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9500, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  88, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4852/5361 (90.5055%)
___Train Local_ResNet_18,  epoch  88, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4850/5361 (90.4682%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1758, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4465/5050 (88.4158%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4537/5050 (89.8416%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0978, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  88, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5042/5652 (89.2074%)
___Train Local_ResNet_18,  epoch  88, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4999/5652 (88.4466%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1097, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4355/4731 (92.0524%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4366/4731 (92.2849%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9651, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5325/5907 (90.1473%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5303/5907 (89.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.6325, Accuracy: 4663/10000 (46.6300%)
___Train Local_ResNet_18,  epoch  88, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4654/5224 (89.0888%)
___Train Local_ResNet_18,  epoch  88, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4694/5224 (89.8545%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0504, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  88, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3586/3959 (90.5784%)
___Train Local_ResNet_18,  epoch  88, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3642/3959 (91.9929%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.7942, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch  88, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4284/4605 (93.0293%)
___Train Local_ResNet_18,  epoch  88, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4300/4605 (93.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9763, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4330/4797 (90.2647%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4277/4797 (89.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0093, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  88, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5222/5696 (91.6784%)
___Train Local_ResNet_18,  epoch  88, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5161/5696 (90.6074%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0358, Accuracy: 5429/10000 (54.2900%)
time spent on training: 295.79932379722595
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1633, Accuracy: 6899/10000 (68.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.8240, Accuracy: 7920/9900 (80.0000%)
Done in 322.2716701030731 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 59, 78, 62, 30, 12, 24, 43, 89, 46, 60, 90, 77, 95, 53, 69, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5038/5308 (94.9133%), train_poison_data_count: 415
Global model norm: 42.82885465449228.
Norm before scaling: 42.81503898721292. Distance: 1.5948409292368602
Total norm for 4 adversaries is: 42.81503898721292. distance: 1.5948409292368602
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.0668, Accuracy: 9717/9900 (98.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5547/5777 (96.0187%), train_poison_data_count: 455
Global model norm: 42.82885465449228.
Norm before scaling: 42.806869782617106. Distance: 1.5687348140878217
Total norm for 4 adversaries is: 42.806869782617106. distance: 1.5687348140878217
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1685, Accuracy: 9459/9900 (95.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4814/5123 (93.9684%), train_poison_data_count: 403
Global model norm: 42.82885465449228.
Norm before scaling: 42.81314580945393. Distance: 1.5641465476030498
Total norm for 4 adversaries is: 42.81314580945393. distance: 1.5641465476030498
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2602, Accuracy: 9267/9900 (93.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5207/5503 (94.6211%), train_poison_data_count: 430
Global model norm: 42.82885465449228.
Norm before scaling: 42.81213646059155. Distance: 1.612448415005034
Total norm for 4 adversaries is: 42.81213646059155. distance: 1.612448415005034
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1371, Accuracy: 9565/9900 (96.6162%)
___Train Local_ResNet_18,  epoch  89, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4178/4397 (95.0193%)
___Train Local_ResNet_18,  epoch  89, local model 59, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4181/4397 (95.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8025, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch  89, local model 78, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4037/4368 (92.4222%)
___Train Local_ResNet_18,  epoch  89, local model 78, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4004/4368 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0002, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  89, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4801/5504 (87.2275%)
___Train Local_ResNet_18,  epoch  89, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4823/5504 (87.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1455, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  89, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3445/3774 (91.2825%)
___Train Local_ResNet_18,  epoch  89, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3500/3774 (92.7398%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0065, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  89, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4971/5526 (89.9566%)
___Train Local_ResNet_18,  epoch  89, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4839/5526 (87.5679%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2818, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3970/4313 (92.0473%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3987/4313 (92.4415%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8698, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch  89, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4491/4979 (90.1988%)
___Train Local_ResNet_18,  epoch  89, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4547/4979 (91.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0667, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  89, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4311/4737 (91.0070%)
___Train Local_ResNet_18,  epoch  89, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4325/4737 (91.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1891, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  89, local model 46, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4775/5399 (88.4423%)
___Train Local_ResNet_18,  epoch  89, local model 46, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4664/5399 (86.3864%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1646, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3774/4145 (91.0495%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3805/4145 (91.7973%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9881, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4427/4748 (93.2393%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4369/4748 (92.0177%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1322, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  89, local model 77, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4495/5050 (89.0099%)
___Train Local_ResNet_18,  epoch  89, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4510/5050 (89.3069%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0661, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  89, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4424/5018 (88.1626%)
___Train Local_ResNet_18,  epoch  89, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4448/5018 (88.6409%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1371, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  89, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5888/6664 (88.3553%)
___Train Local_ResNet_18,  epoch  89, local model 53, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5685/6664 (85.3091%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0188, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3991/4364 (91.4528%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4080/4364 (93.4922%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7842, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch  89, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3926/4196 (93.5653%)
___Train Local_ResNet_18,  epoch  89, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3957/4196 (94.3041%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7919, Accuracy: 5887/10000 (58.8700%)
time spent on training: 291.08798909187317
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1626, Accuracy: 6909/10000 (69.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.7577, Accuracy: 8066/9900 (81.4747%)
Done in 317.6000909805298 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 6, 84, 86, 33, 22, 12, 42, 56, 72, 93, 82, 28, 78, 39, 99, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5052/5308 (95.1771%), train_poison_data_count: 415
Global model norm: 42.8487514745726.
Norm before scaling: 42.83342896288774. Distance: 1.579746055838371
Total norm for 4 adversaries is: 42.83342896288774. distance: 1.579746055838371
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0460, Accuracy: 9766/9900 (98.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5528/5777 (95.6898%), train_poison_data_count: 455
Global model norm: 42.8487514745726.
Norm before scaling: 42.82805374401223. Distance: 1.566054763742562
Total norm for 4 adversaries is: 42.82805374401223. distance: 1.566054763742562
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0751, Accuracy: 9716/9900 (98.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4858/5123 (94.8272%), train_poison_data_count: 403
Global model norm: 42.8487514745726.
Norm before scaling: 42.83507758917115. Distance: 1.5679961623611978
Total norm for 4 adversaries is: 42.83507758917115. distance: 1.5679961623611978
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2624, Accuracy: 9224/9900 (93.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5225/5503 (94.9482%), train_poison_data_count: 430
Global model norm: 42.8487514745726.
Norm before scaling: 42.833068451019095. Distance: 1.6189488204161462
Total norm for 4 adversaries is: 42.833068451019095. distance: 1.6189488204161462
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1033, Accuracy: 9610/9900 (97.0707%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4524/4929 (91.7833%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4475/4929 (90.7892%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1846, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4668/5209 (89.6141%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4641/5209 (89.0958%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0977, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  90, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3534/3929 (89.9466%)
___Train Local_ResNet_18,  epoch  90, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3563/3929 (90.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9266, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  90, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4372/4818 (90.7430%)
___Train Local_ResNet_18,  epoch  90, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4316/4818 (89.5807%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1030, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  90, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5244/5696 (92.0646%)
___Train Local_ResNet_18,  epoch  90, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5191/5696 (91.1341%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9580, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4965/5526 (89.8480%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4850/5526 (87.7669%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0876, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  90, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5367/5907 (90.8583%)
___Train Local_ResNet_18,  epoch  90, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5417/5907 (91.7048%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1866, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  90, local model 56, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4872/5427 (89.7734%)
___Train Local_ResNet_18,  epoch  90, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4838/5427 (89.1469%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9882, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  90, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4722/5193 (90.9301%)
___Train Local_ResNet_18,  epoch  90, local model 72, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4609/5193 (88.7541%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1101, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  90, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4538/5055 (89.7725%)
___Train Local_ResNet_18,  epoch  90, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4601/5055 (91.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0696, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  90, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4905/5298 (92.5821%)
___Train Local_ResNet_18,  epoch  90, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4913/5298 (92.7331%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9956, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  90, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4566/5122 (89.1449%)
___Train Local_ResNet_18,  epoch  90, local model 28, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4258/5122 (83.1316%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.4251, Accuracy: 4805/10000 (48.0500%)
___Train Local_ResNet_18,  epoch  90, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4062/4368 (92.9945%)
___Train Local_ResNet_18,  epoch  90, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4070/4368 (93.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9140, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  90, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3763/4175 (90.1317%)
___Train Local_ResNet_18,  epoch  90, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3814/4175 (91.3533%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0344, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  90, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4373/4851 (90.1464%)
___Train Local_ResNet_18,  epoch  90, local model 99, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4397/4851 (90.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9943, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  90, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4867/5353 (90.9210%)
___Train Local_ResNet_18,  epoch  90, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4792/5353 (89.5199%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9640, Accuracy: 5435/10000 (54.3500%)
time spent on training: 298.0339665412903
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1689, Accuracy: 6897/10000 (68.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.6665, Accuracy: 8241/9900 (83.2424%)
Done in 324.813111782074 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 56, 54, 18, 92, 50, 11, 82, 27, 16, 4, 75, 29, 52, 67, 62, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5067/5308 (95.4597%), train_poison_data_count: 415
Global model norm: 42.872041739234035.
Norm before scaling: 42.85645126511366. Distance: 1.5586611319678345
Total norm for 4 adversaries is: 42.85645126511366. distance: 1.5586611319678345
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0831, Accuracy: 9675/9900 (97.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5551/5777 (96.0879%), train_poison_data_count: 455
Global model norm: 42.872041739234035.
Norm before scaling: 42.84698371731521. Distance: 1.5262496424619114
Total norm for 4 adversaries is: 42.84698371731521. distance: 1.5262496424619114
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0598, Accuracy: 9749/9900 (98.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4856/5123 (94.7882%), train_poison_data_count: 403
Global model norm: 42.872041739234035.
Norm before scaling: 42.852534600414096. Distance: 1.517098172953479
Total norm for 4 adversaries is: 42.852534600414096. distance: 1.517098172953479
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1502, Accuracy: 9524/9900 (96.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5249/5503 (95.3843%), train_poison_data_count: 430
Global model norm: 42.872041739234035.
Norm before scaling: 42.855272030641835. Distance: 1.5882511644567794
Total norm for 4 adversaries is: 42.855272030641835. distance: 1.5882511644567794
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0628, Accuracy: 9722/9900 (98.2020%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4873/5427 (89.7918%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4908/5427 (90.4367%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0095, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  91, local model 54, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4994/5645 (88.4677%)
___Train Local_ResNet_18,  epoch  91, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4945/5645 (87.5996%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0786, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  91, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3881/4249 (91.3391%)
___Train Local_ResNet_18,  epoch  91, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3893/4249 (91.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9878, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6222/6812 (91.3388%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6181/6812 (90.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0445, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  91, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4354/4757 (91.5283%)
___Train Local_ResNet_18,  epoch  91, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4306/4757 (90.5192%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0077, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4919/5702 (86.2680%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4851/5702 (85.0754%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1676, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  91, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4911/5298 (92.6954%)
___Train Local_ResNet_18,  epoch  91, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4935/5298 (93.1484%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0033, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  91, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4142/4587 (90.2987%)
___Train Local_ResNet_18,  epoch  91, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4173/4587 (90.9745%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0343, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  91, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4811/5353 (89.8748%)
___Train Local_ResNet_18,  epoch  91, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4780/5353 (89.2957%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0774, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  91, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3711/4028 (92.1301%)
___Train Local_ResNet_18,  epoch  91, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3697/4028 (91.7825%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8325, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4272/4672 (91.4384%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4309/4672 (92.2303%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8586, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch  91, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4392/4732 (92.8149%)
___Train Local_ResNet_18,  epoch  91, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4427/4732 (93.5545%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9393, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  91, local model 52, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3794/4130 (91.8644%)
___Train Local_ResNet_18,  epoch  91, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3817/4130 (92.4213%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9161, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  91, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4932/5559 (88.7210%)
___Train Local_ResNet_18,  epoch  91, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4880/5559 (87.7856%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2170, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch  91, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4810/5504 (87.3910%)
___Train Local_ResNet_18,  epoch  91, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4849/5504 (88.0996%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0653, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4569/5123 (89.1860%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4243/5123 (82.8226%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1560, Accuracy: 5183/10000 (51.8300%)
time spent on training: 296.59304642677307
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1709, Accuracy: 6885/10000 (68.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.6131, Accuracy: 8376/9900 (84.6061%)
Done in 322.9851350784302 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 74, 10, 82, 34, 43, 23, 33, 1, 44, 19, 63, 0, 28, 54, 70, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5082/5308 (95.7423%), train_poison_data_count: 415
Global model norm: 42.89512299957231.
Norm before scaling: 42.87542279538258. Distance: 1.5043129111054099
Total norm for 4 adversaries is: 42.87542279538258. distance: 1.5043129111054099
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0356, Accuracy: 9801/9900 (99.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5563/5777 (96.2957%), train_poison_data_count: 455
Global model norm: 42.89512299957231.
Norm before scaling: 42.870109790815356. Distance: 1.4723529047915682
Total norm for 4 adversaries is: 42.870109790815356. distance: 1.4723529047915682
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2484, Accuracy: 9333/9900 (94.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4857/5123 (94.8077%), train_poison_data_count: 403
Global model norm: 42.89512299957231.
Norm before scaling: 42.879869723904974. Distance: 1.56268149275522
Total norm for 4 adversaries is: 42.879869723904974. distance: 1.56268149275522
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1421, Accuracy: 9520/9900 (96.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5235/5503 (95.1299%), train_poison_data_count: 430
Global model norm: 42.89512299957231.
Norm before scaling: 42.87771891433679. Distance: 1.5946429126149377
Total norm for 4 adversaries is: 42.87771891433679. distance: 1.5946429126149377
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2170, Accuracy: 9359/9900 (94.5354%)
___Train Local_ResNet_18,  epoch  92, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4278/4797 (89.1807%)
___Train Local_ResNet_18,  epoch  92, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4281/4797 (89.2433%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9720, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  92, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4674/5068 (92.2257%)
___Train Local_ResNet_18,  epoch  92, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4679/5068 (92.3244%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0103, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  92, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4932/5298 (93.0917%)
___Train Local_ResNet_18,  epoch  92, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4926/5298 (92.9785%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9904, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4478/4911 (91.1831%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4550/4911 (92.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0618, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  92, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4485/4979 (90.0783%)
___Train Local_ResNet_18,  epoch  92, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4537/4979 (91.1227%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9830, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  92, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4258/4549 (93.6030%)
___Train Local_ResNet_18,  epoch  92, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4087/4549 (89.8439%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9289, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  92, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4397/4818 (91.2619%)
___Train Local_ResNet_18,  epoch  92, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4345/4818 (90.1826%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0877, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  92, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5066/5422 (93.4342%)
___Train Local_ResNet_18,  epoch  92, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5058/5422 (93.2866%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8674, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  92, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4655/5075 (91.7241%)
___Train Local_ResNet_18,  epoch  92, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4649/5075 (91.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0401, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  92, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4816/5361 (89.8340%)
___Train Local_ResNet_18,  epoch  92, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4820/5361 (89.9086%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0723, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  92, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3561/3910 (91.0742%)
___Train Local_ResNet_18,  epoch  92, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3531/3910 (90.3069%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1669, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  92, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4927/5454 (90.3374%)
___Train Local_ResNet_18,  epoch  92, local model 0, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4829/5454 (88.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0168, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  92, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4556/5122 (88.9496%)
___Train Local_ResNet_18,  epoch  92, local model 28, internal_epoch   2,  Average loss: 0.0086, Accuracy: 4283/5122 (83.6197%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.3046, Accuracy: 4998/10000 (49.9800%)
___Train Local_ResNet_18,  epoch  92, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4991/5645 (88.4145%)
___Train Local_ResNet_18,  epoch  92, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4945/5645 (87.5996%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2759, Accuracy: 4953/10000 (49.5300%)
___Train Local_ResNet_18,  epoch  92, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5407/5871 (92.0967%)
___Train Local_ResNet_18,  epoch  92, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5379/5871 (91.6198%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1415, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  92, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6295/6812 (92.4105%)
___Train Local_ResNet_18,  epoch  92, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6238/6812 (91.5737%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0998, Accuracy: 5411/10000 (54.1100%)
time spent on training: 298.28895568847656
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1665, Accuracy: 6902/10000 (69.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.5978, Accuracy: 8424/9900 (85.0909%)
Done in 324.9508717060089 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 92, 14, 45, 16, 59, 87, 19, 95, 47, 66, 6, 7, 82, 69, 79, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5074/5308 (95.5916%), train_poison_data_count: 415
Global model norm: 42.918470583042684.
Norm before scaling: 42.901282259755945. Distance: 1.5339098036756849
Total norm for 4 adversaries is: 42.901282259755945. distance: 1.5339098036756849
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0717, Accuracy: 9713/9900 (98.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5539/5777 (95.8802%), train_poison_data_count: 455
Global model norm: 42.918470583042684.
Norm before scaling: 42.8939988996312. Distance: 1.5261361501909578
Total norm for 4 adversaries is: 42.8939988996312. distance: 1.5261361501909578
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1147, Accuracy: 9592/9900 (96.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4866/5123 (94.9834%), train_poison_data_count: 403
Global model norm: 42.918470583042684.
Norm before scaling: 42.90118551683624. Distance: 1.553307999512095
Total norm for 4 adversaries is: 42.90118551683624. distance: 1.553307999512095
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1415, Accuracy: 9536/9900 (96.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5243/5503 (95.2753%), train_poison_data_count: 430
Global model norm: 42.918470583042684.
Norm before scaling: 42.901386115882815. Distance: 1.54731620892723
Total norm for 4 adversaries is: 42.901386115882815. distance: 1.54731620892723
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0834, Accuracy: 9674/9900 (97.7172%)
___Train Local_ResNet_18,  epoch  93, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6309/6812 (92.6160%)
___Train Local_ResNet_18,  epoch  93, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6261/6812 (91.9113%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1496, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  93, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3965/4196 (94.4948%)
___Train Local_ResNet_18,  epoch  93, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3972/4196 (94.6616%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8640, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch  93, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4860/5489 (88.5407%)
___Train Local_ResNet_18,  epoch  93, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4954/5489 (90.2532%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9923, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  93, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4866/5353 (90.9023%)
___Train Local_ResNet_18,  epoch  93, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4745/5353 (88.6419%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0139, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  93, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4133/4397 (93.9959%)
___Train Local_ResNet_18,  epoch  93, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4204/4397 (95.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8111, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch  93, local model 87, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3556/3995 (89.0113%)
___Train Local_ResNet_18,  epoch  93, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3568/3995 (89.3116%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9845, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  93, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4866/5361 (90.7666%)
___Train Local_ResNet_18,  epoch  93, local model 19, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4712/5361 (87.8940%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1840, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  93, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4520/5018 (90.0757%)
___Train Local_ResNet_18,  epoch  93, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4463/5018 (88.9398%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9711, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  93, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4583/5123 (89.4593%)
___Train Local_ResNet_18,  epoch  93, local model 47, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4352/5123 (84.9502%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2840, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch  93, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4399/4843 (90.8321%)
___Train Local_ResNet_18,  epoch  93, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4444/4843 (91.7613%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9533, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  93, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4547/4929 (92.2499%)
___Train Local_ResNet_18,  epoch  93, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4458/4929 (90.4443%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1798, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4405/4869 (90.4703%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3949/4869 (81.1049%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.5945, Accuracy: 4601/10000 (46.0100%)
___Train Local_ResNet_18,  epoch  93, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4887/5298 (92.2424%)
___Train Local_ResNet_18,  epoch  93, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4881/5298 (92.1291%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9854, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  93, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4002/4364 (91.7049%)
___Train Local_ResNet_18,  epoch  93, local model 69, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3892/4364 (89.1842%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9803, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  93, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3768/4111 (91.6565%)
___Train Local_ResNet_18,  epoch  93, local model 79, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3742/4111 (91.0241%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0555, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  93, local model 4, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3656/4028 (90.7646%)
___Train Local_ResNet_18,  epoch  93, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3722/4028 (92.4032%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8664, Accuracy: 5797/10000 (57.9700%)
time spent on training: 292.89974665641785
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1697, Accuracy: 6897/10000 (68.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.5270, Accuracy: 8606/9900 (86.9293%)
Done in 319.6575548648834 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 14, 82, 18, 47, 52, 43, 16, 75, 27, 28, 33, 5, 17, 67, 48, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5099/5308 (96.0625%), train_poison_data_count: 415
Global model norm: 42.940820468407445.
Norm before scaling: 42.92104454056454. Distance: 1.495730841622193
Total norm for 4 adversaries is: 42.92104454056454. distance: 1.495730841622193
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0758, Accuracy: 9703/9900 (98.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5571/5777 (96.4341%), train_poison_data_count: 455
Global model norm: 42.940820468407445.
Norm before scaling: 42.912347925651744. Distance: 1.4426598202183905
Total norm for 4 adversaries is: 42.912347925651744. distance: 1.4426598202183905
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1663, Accuracy: 9484/9900 (95.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4860/5123 (94.8663%), train_poison_data_count: 403
Global model norm: 42.940820468407445.
Norm before scaling: 42.922462284387734. Distance: 1.5455393563933093
Total norm for 4 adversaries is: 42.922462284387734. distance: 1.5455393563933093
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1420, Accuracy: 9549/9900 (96.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5259/5503 (95.5661%), train_poison_data_count: 430
Global model norm: 42.940820468407445.
Norm before scaling: 42.9231860693466. Distance: 1.57072003138925
Total norm for 4 adversaries is: 42.9231860693466. distance: 1.57072003138925
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0864, Accuracy: 9662/9900 (97.5960%)
___Train Local_ResNet_18,  epoch  94, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3958/4196 (94.3279%)
___Train Local_ResNet_18,  epoch  94, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3976/4196 (94.7569%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7952, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4898/5298 (92.4500%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4946/5298 (93.3560%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9867, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  94, local model 18, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3855/4249 (90.7272%)
___Train Local_ResNet_18,  epoch  94, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3872/4249 (91.1273%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9508, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  94, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4636/5123 (90.4939%)
___Train Local_ResNet_18,  epoch  94, local model 47, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4591/5123 (89.6155%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0463, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  94, local model 52, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3815/4130 (92.3729%)
___Train Local_ResNet_18,  epoch  94, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3837/4130 (92.9056%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9425, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  94, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4520/4979 (90.7813%)
___Train Local_ResNet_18,  epoch  94, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4517/4979 (90.7210%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9232, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  94, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4876/5353 (91.0891%)
___Train Local_ResNet_18,  epoch  94, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4773/5353 (89.1650%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9807, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4297/4672 (91.9735%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4355/4672 (93.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9334, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4133/4587 (90.1025%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4184/4587 (91.2143%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1079, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  94, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4573/5122 (89.2815%)
___Train Local_ResNet_18,  epoch  94, local model 28, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4335/5122 (84.6349%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3902, Accuracy: 4931/10000 (49.3100%)
___Train Local_ResNet_18,  epoch  94, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4364/4818 (90.5770%)
___Train Local_ResNet_18,  epoch  94, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4395/4818 (91.2204%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0676, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  94, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4679/4993 (93.7112%)
___Train Local_ResNet_18,  epoch  94, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4621/4993 (92.5496%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0386, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  94, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4428/4903 (90.3121%)
___Train Local_ResNet_18,  epoch  94, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4397/4903 (89.6798%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1172, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  94, local model 67, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4942/5559 (88.9009%)
___Train Local_ResNet_18,  epoch  94, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4930/5559 (88.6850%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3090, Accuracy: 4891/10000 (48.9100%)
___Train Local_ResNet_18,  epoch  94, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4501/4830 (93.1884%)
___Train Local_ResNet_18,  epoch  94, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4532/4830 (93.8302%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0128, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  94, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5209/5696 (91.4501%)
___Train Local_ResNet_18,  epoch  94, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5142/5696 (90.2739%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1075, Accuracy: 5211/10000 (52.1100%)
time spent on training: 291.8477292060852
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1671, Accuracy: 6904/10000 (69.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.5073, Accuracy: 8639/9900 (87.2626%)
Done in 318.33767199516296 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 14, 47, 73, 97, 20, 45, 34, 76, 40, 35, 85, 62, 90, 54, 32, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5066/5308 (95.4408%), train_poison_data_count: 415
Global model norm: 42.962069082887666.
Norm before scaling: 42.94226030062417. Distance: 1.5208256168256808
Total norm for 4 adversaries is: 42.94226030062417. distance: 1.5208256168256808
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0284, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5561/5777 (96.2610%), train_poison_data_count: 455
Global model norm: 42.962069082887666.
Norm before scaling: 42.93449771163045. Distance: 1.4864518744424824
Total norm for 4 adversaries is: 42.93449771163045. distance: 1.4864518744424824
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2042, Accuracy: 9435/9900 (95.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4831/5123 (94.3002%), train_poison_data_count: 403
Global model norm: 42.962069082887666.
Norm before scaling: 42.94906082991658. Distance: 1.610933826638445
Total norm for 4 adversaries is: 42.94906082991658. distance: 1.610933826638445
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2002, Accuracy: 9384/9900 (94.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5282/5503 (95.9840%), train_poison_data_count: 430
Global model norm: 42.962069082887666.
Norm before scaling: 42.94102656778611. Distance: 1.470735547036382
Total norm for 4 adversaries is: 42.94102656778611. distance: 1.470735547036382
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1502, Accuracy: 9501/9900 (95.9697%)
___Train Local_ResNet_18,  epoch  95, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3971/4196 (94.6378%)
___Train Local_ResNet_18,  epoch  95, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3937/4196 (93.8275%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9331, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  95, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4606/5123 (89.9083%)
___Train Local_ResNet_18,  epoch  95, local model 47, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4271/5123 (83.3691%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3160, Accuracy: 4975/10000 (49.7500%)
___Train Local_ResNet_18,  epoch  95, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4267/4605 (92.6602%)
___Train Local_ResNet_18,  epoch  95, local model 73, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4244/4605 (92.1607%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8959, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch  95, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4219/4736 (89.0836%)
___Train Local_ResNet_18,  epoch  95, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4250/4736 (89.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0916, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  95, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4347/4714 (92.2147%)
___Train Local_ResNet_18,  epoch  95, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4379/4714 (92.8935%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9876, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  95, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4919/5489 (89.6156%)
___Train Local_ResNet_18,  epoch  95, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4928/5489 (89.7796%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2670, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch  95, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4488/4911 (91.3867%)
___Train Local_ResNet_18,  epoch  95, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4509/4911 (91.8143%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1105, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  95, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3531/3959 (89.1892%)
___Train Local_ResNet_18,  epoch  95, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3628/3959 (91.6393%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9888, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  95, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5430/5939 (91.4295%)
___Train Local_ResNet_18,  epoch  95, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5487/5939 (92.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0982, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  95, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5140/5615 (91.5405%)
___Train Local_ResNet_18,  epoch  95, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5087/5615 (90.5966%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1735, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  95, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6298/6947 (90.6578%)
___Train Local_ResNet_18,  epoch  95, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 6195/6947 (89.1752%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2624, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch  95, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4826/5504 (87.6817%)
___Train Local_ResNet_18,  epoch  95, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4809/5504 (87.3728%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1191, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4411/4748 (92.9023%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4404/4748 (92.7548%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9490, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  95, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4968/5645 (88.0071%)
___Train Local_ResNet_18,  epoch  95, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4918/5645 (87.1213%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2594, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch  95, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5395/6080 (88.7336%)
___Train Local_ResNet_18,  epoch  95, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5392/6080 (88.6842%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1991, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  95, local model 68, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3311/3589 (92.2541%)
___Train Local_ResNet_18,  epoch  95, local model 68, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3230/3589 (89.9972%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0761, Accuracy: 5423/10000 (54.2300%)
time spent on training: 289.570698261261
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1684, Accuracy: 6895/10000 (68.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.4858, Accuracy: 8685/9900 (87.7273%)
Done in 315.81435799598694 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 19, 26, 11, 32, 40, 65, 21, 5, 17, 92, 12, 63, 44, 51, 82, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5102/5308 (96.1191%), train_poison_data_count: 415
Global model norm: 42.98366360507283.
Norm before scaling: 42.961039080849176. Distance: 1.4204355016645558
Total norm for 4 adversaries is: 42.961039080849176. distance: 1.4204355016645558
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1168, Accuracy: 9594/9900 (96.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5569/5777 (96.3995%), train_poison_data_count: 455
Global model norm: 42.98366360507283.
Norm before scaling: 42.9581080571708. Distance: 1.5127557554045674
Total norm for 4 adversaries is: 42.9581080571708. distance: 1.5127557554045674
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0416, Accuracy: 9779/9900 (98.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4854/5123 (94.7492%), train_poison_data_count: 403
Global model norm: 42.98366360507283.
Norm before scaling: 42.966120658189084. Distance: 1.5289858992720402
Total norm for 4 adversaries is: 42.966120658189084. distance: 1.5289858992720402
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2911, Accuracy: 9173/9900 (92.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5260/5503 (95.5842%), train_poison_data_count: 430
Global model norm: 42.98366360507283.
Norm before scaling: 42.96496006013214. Distance: 1.5774051044051176
Total norm for 4 adversaries is: 42.96496006013214. distance: 1.5774051044051176
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0902, Accuracy: 9663/9900 (97.6061%)
___Train Local_ResNet_18,  epoch  96, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4831/5361 (90.1138%)
___Train Local_ResNet_18,  epoch  96, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4847/5361 (90.4122%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1448, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  96, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3761/4086 (92.0460%)
___Train Local_ResNet_18,  epoch  96, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3837/4086 (93.9060%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0498, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  96, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4927/5702 (86.4083%)
___Train Local_ResNet_18,  epoch  96, local model 11, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4613/5702 (80.9014%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2452, Accuracy: 4992/10000 (49.9200%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5348/6080 (87.9605%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5341/6080 (87.8454%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0918, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  96, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5434/5939 (91.4969%)
___Train Local_ResNet_18,  epoch  96, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5429/5939 (91.4127%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0142, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  96, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4922/5497 (89.5397%)
___Train Local_ResNet_18,  epoch  96, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4928/5497 (89.6489%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2068, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  96, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4547/5038 (90.2541%)
___Train Local_ResNet_18,  epoch  96, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4585/5038 (91.0083%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8436, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch  96, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4635/4993 (92.8300%)
___Train Local_ResNet_18,  epoch  96, local model 5, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4545/4993 (91.0274%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1983, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4408/4903 (89.9041%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4434/4903 (90.4344%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1708, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  96, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6293/6812 (92.3811%)
___Train Local_ResNet_18,  epoch  96, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6201/6812 (91.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1316, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  96, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4994/5526 (90.3728%)
___Train Local_ResNet_18,  epoch  96, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4873/5526 (88.1831%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1241, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3605/3910 (92.1995%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3523/3910 (90.1023%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0321, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  96, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4724/5075 (93.0837%)
___Train Local_ResNet_18,  epoch  96, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4645/5075 (91.5271%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1316, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  96, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3760/4108 (91.5287%)
___Train Local_ResNet_18,  epoch  96, local model 51, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3774/4108 (91.8695%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8966, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  96, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4977/5298 (93.9411%)
___Train Local_ResNet_18,  epoch  96, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4936/5298 (93.1672%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1411, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  96, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5007/5422 (92.3460%)
___Train Local_ResNet_18,  epoch  96, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4970/5422 (91.6636%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9628, Accuracy: 5501/10000 (55.0100%)
time spent on training: 311.3727869987488
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1679, Accuracy: 6886/10000 (68.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.4673, Accuracy: 8720/9900 (88.0808%)
Done in 337.67022681236267 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 40, 64, 16, 91, 86, 42, 49, 66, 2, 8, 83, 26, 43, 81, 28, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5107/5308 (96.2133%), train_poison_data_count: 415
Global model norm: 43.00683681341041.
Norm before scaling: 42.98480949889449. Distance: 1.4353012186176404
Total norm for 4 adversaries is: 42.98480949889449. distance: 1.4353012186176404
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0509, Accuracy: 9756/9900 (98.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5570/5777 (96.4168%), train_poison_data_count: 455
Global model norm: 43.00683681341041.
Norm before scaling: 42.97978267453199. Distance: 1.4666146522026227
Total norm for 4 adversaries is: 42.97978267453199. distance: 1.4666146522026227
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0903, Accuracy: 9653/9900 (97.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4864/5123 (94.9444%), train_poison_data_count: 403
Global model norm: 43.00683681341041.
Norm before scaling: 42.98592980421399. Distance: 1.4941450131420448
Total norm for 4 adversaries is: 42.98592980421399. distance: 1.4941450131420448
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2330, Accuracy: 9332/9900 (94.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5254/5503 (95.4752%), train_poison_data_count: 430
Global model norm: 43.00683681341041.
Norm before scaling: 42.98635718802973. Distance: 1.5350132844082935
Total norm for 4 adversaries is: 42.98635718802973. distance: 1.5350132844082935
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1056, Accuracy: 9606/9900 (97.0303%)
___Train Local_ResNet_18,  epoch  97, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5431/5939 (91.4464%)
___Train Local_ResNet_18,  epoch  97, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5447/5939 (91.7158%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2261, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  97, local model 64, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4318/4894 (88.2305%)
___Train Local_ResNet_18,  epoch  97, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4303/4894 (87.9240%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1669, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  97, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4829/5353 (90.2111%)
___Train Local_ResNet_18,  epoch  97, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4867/5353 (90.9210%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9264, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  97, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4076/4527 (90.0376%)
___Train Local_ResNet_18,  epoch  97, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4008/4527 (88.5355%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1019, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch  97, local model 86, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3594/3929 (91.4737%)
___Train Local_ResNet_18,  epoch  97, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3639/3929 (92.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8171, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch  97, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5386/5907 (91.1800%)
___Train Local_ResNet_18,  epoch  97, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5321/5907 (90.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2193, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  97, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5097/5652 (90.1805%)
___Train Local_ResNet_18,  epoch  97, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5040/5652 (89.1720%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1895, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch  97, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4430/4843 (91.4722%)
___Train Local_ResNet_18,  epoch  97, local model 66, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4419/4843 (91.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0792, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  97, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3614/3968 (91.0786%)
___Train Local_ResNet_18,  epoch  97, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3675/3968 (92.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8916, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch  97, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4473/4889 (91.4911%)
___Train Local_ResNet_18,  epoch  97, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4468/4889 (91.3888%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2503, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  97, local model 83, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3218/3552 (90.5968%)
___Train Local_ResNet_18,  epoch  97, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3293/3552 (92.7083%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8648, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch  97, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3823/4086 (93.5634%)
___Train Local_ResNet_18,  epoch  97, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3858/4086 (94.4200%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8622, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch  97, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4560/4979 (91.5847%)
___Train Local_ResNet_18,  epoch  97, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4583/4979 (92.0466%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9827, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  97, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4642/5035 (92.1946%)
___Train Local_ResNet_18,  epoch  97, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4646/5035 (92.2741%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0195, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  97, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4616/5122 (90.1210%)
___Train Local_ResNet_18,  epoch  97, local model 28, internal_epoch   2,  Average loss: 0.0122, Accuracy: 3976/5122 (77.6259%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.6466, Accuracy: 4396/10000 (43.9600%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5135/5615 (91.4515%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5199/5615 (92.5913%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1935, Accuracy: 5246/10000 (52.4600%)
time spent on training: 302.91689133644104
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1765, Accuracy: 6880/10000 (68.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.4174, Accuracy: 8842/9900 (89.3131%)
Done in 329.0215573310852 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 48, 89, 35, 76, 39, 12, 31, 24, 1, 54, 37, 22, 21, 17, 10, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5099/5308 (96.0625%), train_poison_data_count: 415
Global model norm: 43.027718060389574.
Norm before scaling: 43.0064862704235. Distance: 1.4909895637039505
Total norm for 4 adversaries is: 43.0064862704235. distance: 1.4909895637039505
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0696, Accuracy: 9717/9900 (98.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5585/5777 (96.6765%), train_poison_data_count: 455
Global model norm: 43.027718060389574.
Norm before scaling: 42.9984513824517. Distance: 1.4479876530579268
Total norm for 4 adversaries is: 42.9984513824517. distance: 1.4479876530579268
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0499, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4867/5123 (95.0029%), train_poison_data_count: 403
Global model norm: 43.027718060389574.
Norm before scaling: 43.00964531176408. Distance: 1.515109810327444
Total norm for 4 adversaries is: 43.00964531176408. distance: 1.515109810327444
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1495, Accuracy: 9528/9900 (96.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5266/5503 (95.6933%), train_poison_data_count: 430
Global model norm: 43.027718060389574.
Norm before scaling: 43.00827301638096. Distance: 1.535990170636118
Total norm for 4 adversaries is: 43.00827301638096. distance: 1.535990170636118
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0455, Accuracy: 9774/9900 (98.7273%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4499/4830 (93.1470%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4499/4830 (93.1470%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9806, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  98, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4316/4737 (91.1125%)
___Train Local_ResNet_18,  epoch  98, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4307/4737 (90.9225%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2334, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5107/5615 (90.9528%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5098/5615 (90.7925%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1127, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  98, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3567/3959 (90.0985%)
___Train Local_ResNet_18,  epoch  98, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3607/3959 (91.1089%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0482, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  98, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3811/4175 (91.2814%)
___Train Local_ResNet_18,  epoch  98, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3791/4175 (90.8024%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8806, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch  98, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5092/5526 (92.1462%)
___Train Local_ResNet_18,  epoch  98, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4881/5526 (88.3279%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0600, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  98, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4186/4537 (92.2636%)
___Train Local_ResNet_18,  epoch  98, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4189/4537 (92.3297%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8832, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch  98, local model 24, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3923/4313 (90.9576%)
___Train Local_ResNet_18,  epoch  98, local model 24, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3952/4313 (91.6300%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0220, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  98, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5059/5422 (93.3051%)
___Train Local_ResNet_18,  epoch  98, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5053/5422 (93.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9385, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  98, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4951/5645 (87.7059%)
___Train Local_ResNet_18,  epoch  98, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4824/5645 (85.4562%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0060, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  98, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4358/4741 (91.9215%)
___Train Local_ResNet_18,  epoch  98, local model 37, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3887/4741 (81.9869%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.4546, Accuracy: 4714/10000 (47.1400%)
___Train Local_ResNet_18,  epoch  98, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5232/5696 (91.8539%)
___Train Local_ResNet_18,  epoch  98, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5155/5696 (90.5021%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0115, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4558/5038 (90.4724%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4578/5038 (90.8694%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9793, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  98, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4409/4903 (89.9245%)
___Train Local_ResNet_18,  epoch  98, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4465/4903 (91.0667%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9843, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  98, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4682/5068 (92.3836%)
___Train Local_ResNet_18,  epoch  98, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4629/5068 (91.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3147, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch  98, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4418/4748 (93.0497%)
___Train Local_ResNet_18,  epoch  98, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4421/4748 (93.1129%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0434, Accuracy: 5435/10000 (54.3500%)
time spent on training: 301.062863111496
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1800, Accuracy: 6881/10000 (68.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.3846, Accuracy: 8903/9900 (89.9293%)
Done in 327.86800241470337 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 83, 63, 46, 35, 25, 8, 56, 22, 31, 87, 5, 7, 10, 30, 82, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5102/5308 (96.1191%), train_poison_data_count: 415
Global model norm: 43.04921301500107.
Norm before scaling: 43.026458406971805. Distance: 1.4718109862060487
Total norm for 4 adversaries is: 43.026458406971805. distance: 1.4718109862060487
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0212, Accuracy: 9832/9900 (99.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5556/5777 (96.1745%), train_poison_data_count: 455
Global model norm: 43.04921301500107.
Norm before scaling: 43.022482029294146. Distance: 1.5017457975198907
Total norm for 4 adversaries is: 43.022482029294146. distance: 1.5017457975198907
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0838, Accuracy: 9677/9900 (97.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4876/5123 (95.1786%), train_poison_data_count: 403
Global model norm: 43.04921301500107.
Norm before scaling: 43.03064150577397. Distance: 1.5491507387838697
Total norm for 4 adversaries is: 43.03064150577397. distance: 1.5491507387838697
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1209, Accuracy: 9591/9900 (96.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5234/5503 (95.1118%), train_poison_data_count: 430
Global model norm: 43.04921301500107.
Norm before scaling: 43.0310797926917. Distance: 1.5525661545324982
Total norm for 4 adversaries is: 43.0310797926917. distance: 1.5525661545324982
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1444, Accuracy: 9532/9900 (96.2828%)
___Train Local_ResNet_18,  epoch  99, local model 83, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3221/3552 (90.6813%)
___Train Local_ResNet_18,  epoch  99, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3315/3552 (93.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7919, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch  99, local model 63, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3661/3910 (93.6317%)
___Train Local_ResNet_18,  epoch  99, local model 63, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3325/3910 (85.0384%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.3749, Accuracy: 4983/10000 (49.8300%)
___Train Local_ResNet_18,  epoch  99, local model 46, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4793/5399 (88.7757%)
___Train Local_ResNet_18,  epoch  99, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4775/5399 (88.4423%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0963, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  99, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5141/5615 (91.5583%)
___Train Local_ResNet_18,  epoch  99, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5190/5615 (92.4310%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1086, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  99, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5693/6419 (88.6898%)
___Train Local_ResNet_18,  epoch  99, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5541/6419 (86.3219%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2126, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch  99, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4448/4889 (90.9798%)
___Train Local_ResNet_18,  epoch  99, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4423/4889 (90.4684%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1020, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  99, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4884/5427 (89.9945%)
___Train Local_ResNet_18,  epoch  99, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4887/5427 (90.0498%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0263, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  99, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5262/5696 (92.3806%)
___Train Local_ResNet_18,  epoch  99, local model 22, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5267/5696 (92.4684%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9654, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  99, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4152/4537 (91.5142%)
___Train Local_ResNet_18,  epoch  99, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4143/4537 (91.3158%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8647, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  99, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3589/3995 (89.8373%)
___Train Local_ResNet_18,  epoch  99, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3555/3995 (88.9862%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9359, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  99, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4691/4993 (93.9515%)
___Train Local_ResNet_18,  epoch  99, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4649/4993 (93.1104%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0176, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  99, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4391/4869 (90.1828%)
___Train Local_ResNet_18,  epoch  99, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4267/4869 (87.6361%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1338, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  99, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4711/5068 (92.9558%)
___Train Local_ResNet_18,  epoch  99, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4618/5068 (91.1208%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1549, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3491/3774 (92.5013%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3554/3774 (94.1706%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0776, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  99, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4946/5298 (93.3560%)
___Train Local_ResNet_18,  epoch  99, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4926/5298 (92.9785%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1017, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  99, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4991/5461 (91.3935%)
___Train Local_ResNet_18,  epoch  99, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4993/5461 (91.4301%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1368, Accuracy: 5305/10000 (53.0500%)
time spent on training: 299.90013217926025
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1822, Accuracy: 6879/10000 (68.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.3532, Accuracy: 8962/9900 (90.5253%)
Done in 326.85087060928345 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 87, 99, 81, 52, 95, 3, 6, 0, 51, 78, 18, 89, 92, 40, 42, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5121/5308 (96.4770%), train_poison_data_count: 415
Global model norm: 43.07042232549937.
Norm before scaling: 43.04780228130119. Distance: 1.4191859881970539
Total norm for 4 adversaries is: 43.04780228130119. distance: 1.4191859881970539
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0832, Accuracy: 9687/9900 (97.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5593/5777 (96.8150%), train_poison_data_count: 455
Global model norm: 43.07042232549937.
Norm before scaling: 43.04084860266465. Distance: 1.4264792210148245
Total norm for 4 adversaries is: 43.04084860266465. distance: 1.4264792210148245
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0627, Accuracy: 9731/9900 (98.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4854/5123 (94.7492%), train_poison_data_count: 403
Global model norm: 43.07042232549937.
Norm before scaling: 43.049144960567304. Distance: 1.5092082308615806
Total norm for 4 adversaries is: 43.049144960567304. distance: 1.5092082308615806
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1142, Accuracy: 9601/9900 (96.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5299/5503 (96.2929%), train_poison_data_count: 430
Global model norm: 43.07042232549937.
Norm before scaling: 43.04675731608233. Distance: 1.4806263218266331
Total norm for 4 adversaries is: 43.04675731608233. distance: 1.4806263218266331
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0552, Accuracy: 9734/9900 (98.3232%)
___Train Local_ResNet_18,  epoch 100, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3579/3995 (89.5870%)
___Train Local_ResNet_18,  epoch 100, local model 87, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3531/3995 (88.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0588, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 100, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4389/4851 (90.4762%)
___Train Local_ResNet_18,  epoch 100, local model 99, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4409/4851 (90.8885%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0697, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 100, local model 81, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4654/5035 (92.4330%)
___Train Local_ResNet_18,  epoch 100, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4650/5035 (92.3535%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0581, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 100, local model 52, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3816/4130 (92.3971%)
___Train Local_ResNet_18,  epoch 100, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3856/4130 (93.3656%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9204, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 100, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4477/5018 (89.2188%)
___Train Local_ResNet_18,  epoch 100, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4469/5018 (89.0594%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1358, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 100, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4994/5346 (93.4156%)
___Train Local_ResNet_18,  epoch 100, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4968/5346 (92.9293%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0476, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 100, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4563/4929 (92.5746%)
___Train Local_ResNet_18,  epoch 100, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4473/4929 (90.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1276, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 100, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4958/5454 (90.9058%)
___Train Local_ResNet_18,  epoch 100, local model 0, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4901/5454 (89.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1363, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3794/4108 (92.3564%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3781/4108 (92.0399%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8790, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4065/4368 (93.0632%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3970/4368 (90.8883%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0134, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 100, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3911/4249 (92.0452%)
___Train Local_ResNet_18,  epoch 100, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3888/4249 (91.5039%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9260, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 100, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4314/4737 (91.0703%)
___Train Local_ResNet_18,  epoch 100, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4359/4737 (92.0203%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0154, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 100, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6293/6812 (92.3811%)
___Train Local_ResNet_18,  epoch 100, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6233/6812 (91.5003%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.3084, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch 100, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5471/5939 (92.1199%)
___Train Local_ResNet_18,  epoch 100, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5477/5939 (92.2209%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9543, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5355/5907 (90.6552%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5366/5907 (90.8414%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.3884, Accuracy: 4950/10000 (49.5000%)
___Train Local_ResNet_18,  epoch 100, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4439/4843 (91.6581%)
___Train Local_ResNet_18,  epoch 100, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4462/4843 (92.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0354, Accuracy: 5400/10000 (54.0000%)
time spent on training: 310.3955342769623
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1875, Accuracy: 6867/10000 (68.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.3092, Accuracy: 9066/9900 (91.5758%)
Done in 336.48704957962036 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 92, 3, 12, 50, 95, 31, 5, 38, 72, 61, 32, 94, 7, 57, 22, 8].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5116/5308 (96.3828%), train_poison_data_count: 415
Global model norm: 43.09135207931445.
Norm before scaling: 43.068572968454184. Distance: 1.4327553108475009
Total norm for 4 adversaries is: 43.068572968454184. distance: 1.4327553108475009
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0405, Accuracy: 9788/9900 (98.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5577/5777 (96.5380%), train_poison_data_count: 455
Global model norm: 43.09135207931445.
Norm before scaling: 43.06143271309824. Distance: 1.4491646234733009
Total norm for 4 adversaries is: 43.06143271309824. distance: 1.4491646234733009
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0504, Accuracy: 9749/9900 (98.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4880/5123 (95.2567%), train_poison_data_count: 403
Global model norm: 43.09135207931445.
Norm before scaling: 43.07028770065493. Distance: 1.4863656599440918
Total norm for 4 adversaries is: 43.07028770065493. distance: 1.4863656599440918
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0914, Accuracy: 9664/9900 (97.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5270/5503 (95.7659%), train_poison_data_count: 430
Global model norm: 43.09135207931445.
Norm before scaling: 43.070881463909295. Distance: 1.5179604695516884
Total norm for 4 adversaries is: 43.070881463909295. distance: 1.5179604695516884
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0265, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 101, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6320/6812 (92.7775%)
___Train Local_ResNet_18,  epoch 101, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6201/6812 (91.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0957, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4987/5346 (93.2847%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4856/5346 (90.8343%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0390, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 101, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5045/5526 (91.2957%)
___Train Local_ResNet_18,  epoch 101, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4892/5526 (88.5270%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1150, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 101, local model 50, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4407/4757 (92.6424%)
___Train Local_ResNet_18,  epoch 101, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4316/4757 (90.7295%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0942, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 101, local model 95, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4575/5018 (91.1718%)
___Train Local_ResNet_18,  epoch 101, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4457/5018 (88.8202%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0892, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 101, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4211/4537 (92.8146%)
___Train Local_ResNet_18,  epoch 101, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4223/4537 (93.0791%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9110, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 101, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4682/4993 (93.7713%)
___Train Local_ResNet_18,  epoch 101, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4647/4993 (93.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8907, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 101, local model 38, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5564/6235 (89.2382%)
___Train Local_ResNet_18,  epoch 101, local model 38, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5521/6235 (88.5485%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3572, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18,  epoch 101, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4757/5193 (91.6041%)
___Train Local_ResNet_18,  epoch 101, local model 72, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4518/5193 (87.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.5290, Accuracy: 4751/10000 (47.5100%)
___Train Local_ResNet_18,  epoch 101, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4085/4485 (91.0814%)
___Train Local_ResNet_18,  epoch 101, local model 61, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3761/4485 (83.8573%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2988, Accuracy: 4925/10000 (49.2500%)
___Train Local_ResNet_18,  epoch 101, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5369/6080 (88.3059%)
___Train Local_ResNet_18,  epoch 101, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5347/6080 (87.9441%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3283, Accuracy: 5041/10000 (50.4100%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4647/5224 (88.9548%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4680/5224 (89.5865%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0124, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 101, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4414/4869 (90.6552%)
___Train Local_ResNet_18,  epoch 101, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4207/4869 (86.4038%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3238, Accuracy: 4957/10000 (49.5700%)
___Train Local_ResNet_18,  epoch 101, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4539/4956 (91.5860%)
___Train Local_ResNet_18,  epoch 101, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4435/4956 (89.4875%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1192, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5188/5696 (91.0815%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5172/5696 (90.8006%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0192, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 101, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4484/4889 (91.7161%)
___Train Local_ResNet_18,  epoch 101, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4456/4889 (91.1434%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0519, Accuracy: 5403/10000 (54.0300%)
time spent on training: 305.52332496643066
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1890, Accuracy: 6866/10000 (68.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2871, Accuracy: 9126/9900 (92.1818%)
Done in 332.1450753211975 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 1, 65, 25, 70, 59, 5, 76, 49, 11, 2, 40, 47, 23, 83, 28, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5139/5308 (96.8161%), train_poison_data_count: 415
Global model norm: 43.116140677408296.
Norm before scaling: 43.0886112327695. Distance: 1.3336283039606651
Total norm for 4 adversaries is: 43.0886112327695. distance: 1.3336283039606651
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1413, Accuracy: 9530/9900 (96.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5566/5777 (96.3476%), train_poison_data_count: 455
Global model norm: 43.116140677408296.
Norm before scaling: 43.08780665143272. Distance: 1.4755881187680353
Total norm for 4 adversaries is: 43.08780665143272. distance: 1.4755881187680353
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0593, Accuracy: 9753/9900 (98.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4886/5123 (95.3738%), train_poison_data_count: 403
Global model norm: 43.116140677408296.
Norm before scaling: 43.09562660208763. Distance: 1.515880917051665
Total norm for 4 adversaries is: 43.09562660208763. distance: 1.515880917051665
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1352, Accuracy: 9567/9900 (96.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5275/5503 (95.8568%), train_poison_data_count: 430
Global model norm: 43.116140677408296.
Norm before scaling: 43.092966760014185. Distance: 1.5128700938507311
Total norm for 4 adversaries is: 43.092966760014185. distance: 1.5128700938507311
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0431, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 102, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5055/5422 (93.2313%)
___Train Local_ResNet_18,  epoch 102, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5043/5422 (93.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0200, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 102, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4990/5497 (90.7768%)
___Train Local_ResNet_18,  epoch 102, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4925/5497 (89.5943%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0926, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5680/6419 (88.4873%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5575/6419 (86.8515%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3478, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 102, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5413/5871 (92.1989%)
___Train Local_ResNet_18,  epoch 102, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5343/5871 (91.0066%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0749, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 102, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4149/4397 (94.3598%)
___Train Local_ResNet_18,  epoch 102, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4187/4397 (95.2240%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7774, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 102, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4700/4993 (94.1318%)
___Train Local_ResNet_18,  epoch 102, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4666/4993 (93.4508%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8928, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 102, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3585/3959 (90.5532%)
___Train Local_ResNet_18,  epoch 102, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3584/3959 (90.5279%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9918, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 102, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5044/5652 (89.2427%)
___Train Local_ResNet_18,  epoch 102, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5004/5652 (88.5350%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1028, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 102, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4929/5702 (86.4434%)
___Train Local_ResNet_18,  epoch 102, local model 11, internal_epoch   2,  Average loss: 0.0101, Accuracy: 4565/5702 (80.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3829, Accuracy: 4941/10000 (49.4100%)
___Train Local_ResNet_18,  epoch 102, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3629/3968 (91.4567%)
___Train Local_ResNet_18,  epoch 102, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3686/3968 (92.8931%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8785, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 102, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5517/5939 (92.8944%)
___Train Local_ResNet_18,  epoch 102, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5449/5939 (91.7495%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1229, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 102, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4622/5123 (90.2206%)
___Train Local_ResNet_18,  epoch 102, local model 47, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4478/5123 (87.4097%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2692, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 102, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4272/4549 (93.9107%)
___Train Local_ResNet_18,  epoch 102, local model 23, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3976/4549 (87.4038%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0241, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 102, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3213/3552 (90.4561%)
___Train Local_ResNet_18,  epoch 102, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3284/3552 (92.4550%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8998, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 102, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4580/5122 (89.4182%)
___Train Local_ResNet_18,  epoch 102, local model 28, internal_epoch   2,  Average loss: 0.0103, Accuracy: 4168/5122 (81.3745%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.5400, Accuracy: 4668/10000 (46.6800%)
___Train Local_ResNet_18,  epoch 102, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6307/6812 (92.5866%)
___Train Local_ResNet_18,  epoch 102, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 6250/6812 (91.7499%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2011, Accuracy: 5254/10000 (52.5400%)
time spent on training: 300.24870800971985
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1846, Accuracy: 6891/10000 (68.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2749, Accuracy: 9143/9900 (92.3535%)
Done in 326.871022939682 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 55, 74, 81, 88, 47, 3, 20, 49, 91, 24, 85, 5, 96, 21, 80, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5127/5308 (96.5901%), train_poison_data_count: 415
Global model norm: 43.13811508001074.
Norm before scaling: 43.112820970463645. Distance: 1.3899514356540907
Total norm for 4 adversaries is: 43.112820970463645. distance: 1.3899514356540907
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1222, Accuracy: 9574/9900 (96.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5559/5777 (96.2264%), train_poison_data_count: 455
Global model norm: 43.13811508001074.
Norm before scaling: 43.1089870633143. Distance: 1.4770022751591128
Total norm for 4 adversaries is: 43.1089870633143. distance: 1.4770022751591128
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0783, Accuracy: 9696/9900 (97.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4868/5123 (95.0224%), train_poison_data_count: 403
Global model norm: 43.13811508001074.
Norm before scaling: 43.1167394715353. Distance: 1.5082030902221328
Total norm for 4 adversaries is: 43.1167394715353. distance: 1.5082030902221328
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1368, Accuracy: 9557/9900 (96.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5269/5503 (95.7478%), train_poison_data_count: 430
Global model norm: 43.13811508001074.
Norm before scaling: 43.1142437333106. Distance: 1.4959876119947315
Total norm for 4 adversaries is: 43.1142437333106. distance: 1.4959876119947315
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0352, Accuracy: 9806/9900 (99.0505%)
___Train Local_ResNet_18,  epoch 103, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4352/4731 (91.9890%)
___Train Local_ResNet_18,  epoch 103, local model 55, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4412/4731 (93.2572%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9402, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 103, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4358/4797 (90.8484%)
___Train Local_ResNet_18,  epoch 103, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4345/4797 (90.5774%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9371, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 103, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4657/5035 (92.4926%)
___Train Local_ResNet_18,  epoch 103, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4655/5035 (92.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9828, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 103, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4865/5362 (90.7311%)
___Train Local_ResNet_18,  epoch 103, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4851/5362 (90.4700%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2810, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 103, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4663/5123 (91.0209%)
___Train Local_ResNet_18,  epoch 103, local model 47, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4514/5123 (88.1124%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1821, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 103, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4949/5346 (92.5739%)
___Train Local_ResNet_18,  epoch 103, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4945/5346 (92.4991%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0247, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 103, local model 20, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4396/4714 (93.2541%)
___Train Local_ResNet_18,  epoch 103, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4390/4714 (93.1269%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9568, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 103, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5093/5652 (90.1097%)
___Train Local_ResNet_18,  epoch 103, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5020/5652 (88.8181%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0998, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 103, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4067/4527 (89.8387%)
___Train Local_ResNet_18,  epoch 103, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3993/4527 (88.2041%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0539, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 103, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3987/4313 (92.4415%)
___Train Local_ResNet_18,  epoch 103, local model 24, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4007/4313 (92.9052%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8355, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6251/6947 (89.9813%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 6108/6947 (87.9228%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2365, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 103, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4684/4993 (93.8113%)
___Train Local_ResNet_18,  epoch 103, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4618/4993 (92.4895%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0018, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 103, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4662/5086 (91.6634%)
___Train Local_ResNet_18,  epoch 103, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4690/5086 (92.2139%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0451, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 103, local model 21, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4623/5038 (91.7626%)
___Train Local_ResNet_18,  epoch 103, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4619/5038 (91.6832%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8946, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 103, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4990/5461 (91.3752%)
___Train Local_ResNet_18,  epoch 103, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4908/5461 (89.8736%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1029, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 103, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5140/5727 (89.7503%)
___Train Local_ResNet_18,  epoch 103, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5077/5727 (88.6503%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0665, Accuracy: 5406/10000 (54.0600%)
time spent on training: 302.30746150016785
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1840, Accuracy: 6880/10000 (68.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2606, Accuracy: 9184/9900 (92.7677%)
Done in 329.3630840778351 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 24, 64, 59, 90, 22, 56, 73, 1, 70, 49, 88, 11, 44, 15, 92, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5098/5308 (96.0437%), train_poison_data_count: 415
Global model norm: 43.15971344040427.
Norm before scaling: 43.13802452774408. Distance: 1.4702718439268112
Total norm for 4 adversaries is: 43.13802452774408. distance: 1.4702718439268112
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0764, Accuracy: 9702/9900 (98.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5594/5777 (96.8323%), train_poison_data_count: 455
Global model norm: 43.15971344040427.
Norm before scaling: 43.12890607310253. Distance: 1.4178339786428673
Total norm for 4 adversaries is: 43.12890607310253. distance: 1.4178339786428673
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0687, Accuracy: 9717/9900 (98.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4878/5123 (95.2176%), train_poison_data_count: 403
Global model norm: 43.15971344040427.
Norm before scaling: 43.13915217288481. Distance: 1.4686583632431998
Total norm for 4 adversaries is: 43.13915217288481. distance: 1.4686583632431998
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2429, Accuracy: 9231/9900 (93.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5291/5503 (96.1476%), train_poison_data_count: 430
Global model norm: 43.15971344040427.
Norm before scaling: 43.13511543503448. Distance: 1.4634588994235964
Total norm for 4 adversaries is: 43.13511543503448. distance: 1.4634588994235964
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0578, Accuracy: 9735/9900 (98.3333%)
___Train Local_ResNet_18,  epoch 104, local model 24, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3950/4313 (91.5836%)
___Train Local_ResNet_18,  epoch 104, local model 24, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3945/4313 (91.4677%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0359, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 104, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4424/4894 (90.3964%)
___Train Local_ResNet_18,  epoch 104, local model 64, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4340/4894 (88.6800%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9904, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 104, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4192/4397 (95.3377%)
___Train Local_ResNet_18,  epoch 104, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4217/4397 (95.9063%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.7742, Accuracy: 5889/10000 (58.8900%)
___Train Local_ResNet_18,  epoch 104, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4430/4748 (93.3024%)
___Train Local_ResNet_18,  epoch 104, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4445/4748 (93.6184%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0106, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 104, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5270/5696 (92.5211%)
___Train Local_ResNet_18,  epoch 104, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5176/5696 (90.8708%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9286, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 104, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4907/5427 (90.4183%)
___Train Local_ResNet_18,  epoch 104, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4854/5427 (89.4417%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0699, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 104, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4288/4605 (93.1162%)
___Train Local_ResNet_18,  epoch 104, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4278/4605 (92.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2240, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 104, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5078/5422 (93.6555%)
___Train Local_ResNet_18,  epoch 104, local model 1, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5077/5422 (93.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0074, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5470/5871 (93.1698%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5356/5871 (91.2281%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0178, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5069/5652 (89.6851%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5054/5652 (89.4197%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1826, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 104, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4922/5362 (91.7941%)
___Train Local_ResNet_18,  epoch 104, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4808/5362 (89.6680%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1628, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 104, local model 11, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4948/5702 (86.7766%)
___Train Local_ResNet_18,  epoch 104, local model 11, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4817/5702 (84.4791%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.4073, Accuracy: 4891/10000 (48.9100%)
___Train Local_ResNet_18,  epoch 104, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4694/5075 (92.4926%)
___Train Local_ResNet_18,  epoch 104, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4626/5075 (91.1527%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0679, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 104, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5558/6068 (91.5953%)
___Train Local_ResNet_18,  epoch 104, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5556/6068 (91.5623%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2056, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 104, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 6316/6812 (92.7187%)
___Train Local_ResNet_18,  epoch 104, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6259/6812 (91.8820%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0105, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 104, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4409/4732 (93.1741%)
___Train Local_ResNet_18,  epoch 104, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4422/4732 (93.4489%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8966, Accuracy: 5679/10000 (56.7900%)
time spent on training: 304.32550406455994
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1864, Accuracy: 6880/10000 (68.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2601, Accuracy: 9188/9900 (92.8081%)
Done in 331.0877251625061 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 38, 1, 27, 46, 63, 42, 19, 95, 85, 68, 67, 92, 3, 17, 59, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5129/5308 (96.6277%), train_poison_data_count: 415
Global model norm: 43.181807014427385.
Norm before scaling: 43.156588012343924. Distance: 1.3828717235232242
Total norm for 4 adversaries is: 43.156588012343924. distance: 1.3828717235232242
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0995, Accuracy: 9637/9900 (97.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5601/5777 (96.9534%), train_poison_data_count: 455
Global model norm: 43.181807014427385.
Norm before scaling: 43.15074101559917. Distance: 1.405784953893599
Total norm for 4 adversaries is: 43.15074101559917. distance: 1.405784953893599
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0723, Accuracy: 9699/9900 (97.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4893/5123 (95.5104%), train_poison_data_count: 403
Global model norm: 43.181807014427385.
Norm before scaling: 43.15881260494489. Distance: 1.447961554986398
Total norm for 4 adversaries is: 43.15881260494489. distance: 1.447961554986398
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1641, Accuracy: 9458/9900 (95.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5298/5503 (96.2748%), train_poison_data_count: 430
Global model norm: 43.181807014427385.
Norm before scaling: 43.15572105486855. Distance: 1.4574993291889302
Total norm for 4 adversaries is: 43.15572105486855. distance: 1.4574993291889302
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0436, Accuracy: 9779/9900 (98.7778%)
___Train Local_ResNet_18,  epoch 105, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5592/6235 (89.6872%)
___Train Local_ResNet_18,  epoch 105, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5643/6235 (90.5052%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3007, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 105, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5082/5422 (93.7293%)
___Train Local_ResNet_18,  epoch 105, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5021/5422 (92.6042%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8791, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 105, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4132/4587 (90.0807%)
___Train Local_ResNet_18,  epoch 105, local model 27, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4107/4587 (89.5356%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0338, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 105, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4845/5399 (89.7388%)
___Train Local_ResNet_18,  epoch 105, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4745/5399 (87.8866%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3325, Accuracy: 5022/10000 (50.2200%)
___Train Local_ResNet_18,  epoch 105, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3627/3910 (92.7621%)
___Train Local_ResNet_18,  epoch 105, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3577/3910 (91.4834%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9938, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 105, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5349/5907 (90.5536%)
___Train Local_ResNet_18,  epoch 105, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5280/5907 (89.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.4514, Accuracy: 4936/10000 (49.3600%)
___Train Local_ResNet_18,  epoch 105, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4867/5361 (90.7853%)
___Train Local_ResNet_18,  epoch 105, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4777/5361 (89.1065%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0543, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 105, local model 95, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4545/5018 (90.5739%)
___Train Local_ResNet_18,  epoch 105, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4479/5018 (89.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1486, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 105, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6272/6947 (90.2836%)
___Train Local_ResNet_18,  epoch 105, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 6065/6947 (87.3039%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2489, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 105, local model 68, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3292/3589 (91.7247%)
___Train Local_ResNet_18,  epoch 105, local model 68, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3173/3589 (88.4090%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1456, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5031/5559 (90.5019%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4939/5559 (88.8469%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1071, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 105, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 6363/6812 (93.4087%)
___Train Local_ResNet_18,  epoch 105, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6251/6812 (91.7645%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1853, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 105, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4999/5346 (93.5092%)
___Train Local_ResNet_18,  epoch 105, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4958/5346 (92.7422%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0693, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 105, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4393/4903 (89.5982%)
___Train Local_ResNet_18,  epoch 105, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4465/4903 (91.0667%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9540, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 105, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4217/4397 (95.9063%)
___Train Local_ResNet_18,  epoch 105, local model 59, internal_epoch   2,  Average loss: 0.0020, Accuracy: 4247/4397 (96.5886%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.7255, Accuracy: 5965/10000 (59.6500%)
___Train Local_ResNet_18,  epoch 105, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4702/5035 (93.3863%)
___Train Local_ResNet_18,  epoch 105, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4705/5035 (93.4459%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9210, Accuracy: 5652/10000 (56.5200%)
time spent on training: 303.73094606399536
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1824, Accuracy: 6874/10000 (68.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2592, Accuracy: 9183/9900 (92.7576%)
Done in 330.35193252563477 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 70, 72, 67, 66, 75, 44, 99, 84, 22, 28, 37, 74, 14, 79, 7, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5124/5308 (96.5335%), train_poison_data_count: 415
Global model norm: 43.20455750337573.
Norm before scaling: 43.180984380967686. Distance: 1.4194403964136526
Total norm for 4 adversaries is: 43.180984380967686. distance: 1.4194403964136526
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0316, Accuracy: 9819/9900 (99.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5583/5777 (96.6419%), train_poison_data_count: 455
Global model norm: 43.20455750337573.
Norm before scaling: 43.17442254065189. Distance: 1.437436807321534
Total norm for 4 adversaries is: 43.17442254065189. distance: 1.437436807321534
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0673, Accuracy: 9728/9900 (98.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4907/5123 (95.7837%), train_poison_data_count: 403
Global model norm: 43.20455750337573.
Norm before scaling: 43.181354709310014. Distance: 1.4161679942267846
Total norm for 4 adversaries is: 43.181354709310014. distance: 1.4161679942267846
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0826, Accuracy: 9668/9900 (97.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5272/5503 (95.8023%), train_poison_data_count: 430
Global model norm: 43.20455750337573.
Norm before scaling: 43.182099596776645. Distance: 1.5039959769296611
Total norm for 4 adversaries is: 43.182099596776645. distance: 1.5039959769296611
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0314, Accuracy: 9830/9900 (99.2929%)
___Train Local_ResNet_18,  epoch 106, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5396/5871 (91.9094%)
___Train Local_ResNet_18,  epoch 106, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5308/5871 (90.4105%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1359, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 106, local model 72, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4704/5193 (90.5835%)
___Train Local_ResNet_18,  epoch 106, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4532/5193 (87.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2643, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch 106, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5021/5559 (90.3220%)
___Train Local_ResNet_18,  epoch 106, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4893/5559 (88.0194%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0349, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4442/4843 (91.7200%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4423/4843 (91.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0364, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 106, local model 75, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4321/4672 (92.4872%)
___Train Local_ResNet_18,  epoch 106, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4353/4672 (93.1721%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8355, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 106, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4721/5075 (93.0246%)
___Train Local_ResNet_18,  epoch 106, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4664/5075 (91.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2394, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 106, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4428/4851 (91.2801%)
___Train Local_ResNet_18,  epoch 106, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4431/4851 (91.3420%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0260, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 106, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4733/5209 (90.8620%)
___Train Local_ResNet_18,  epoch 106, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4700/5209 (90.2285%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1791, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 106, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5262/5696 (92.3806%)
___Train Local_ResNet_18,  epoch 106, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5190/5696 (91.1166%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3419, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch 106, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4635/5122 (90.4920%)
___Train Local_ResNet_18,  epoch 106, local model 28, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4376/5122 (85.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2745, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch 106, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4320/4741 (91.1200%)
___Train Local_ResNet_18,  epoch 106, local model 37, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4095/4741 (86.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.4128, Accuracy: 4871/10000 (48.7100%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4306/4797 (89.7644%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4251/4797 (88.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0916, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 106, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3975/4196 (94.7331%)
___Train Local_ResNet_18,  epoch 106, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3956/4196 (94.2803%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.7608, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 106, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3757/4111 (91.3890%)
___Train Local_ResNet_18,  epoch 106, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3783/4111 (92.0214%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1429, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 106, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4455/4869 (91.4972%)
___Train Local_ResNet_18,  epoch 106, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4159/4869 (85.4180%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3413, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch 106, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5042/5645 (89.3180%)
___Train Local_ResNet_18,  epoch 106, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4970/5645 (88.0425%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0254, Accuracy: 5389/10000 (53.8900%)
time spent on training: 299.5968716144562
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1804, Accuracy: 6885/10000 (68.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2293, Accuracy: 9256/9900 (93.4949%)
Done in 326.36057233810425 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 16, 83, 76, 93, 11, 51, 92, 61, 72, 59, 60, 3, 30, 80, 49, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5132/5308 (96.6843%), train_poison_data_count: 415
Global model norm: 43.22775631484504.
Norm before scaling: 43.20302893298542. Distance: 1.4302168736361436
Total norm for 4 adversaries is: 43.20302893298542. distance: 1.4302168736361436
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0569, Accuracy: 9744/9900 (98.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5601/5777 (96.9534%), train_poison_data_count: 455
Global model norm: 43.22775631484504.
Norm before scaling: 43.19356245889687. Distance: 1.3757795378258972
Total norm for 4 adversaries is: 43.19356245889687. distance: 1.3757795378258972
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0348, Accuracy: 9804/9900 (99.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4922/5123 (96.0765%), train_poison_data_count: 403
Global model norm: 43.22775631484504.
Norm before scaling: 43.20380452675363. Distance: 1.435620364429528
Total norm for 4 adversaries is: 43.20380452675363. distance: 1.435620364429528
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1127, Accuracy: 9611/9900 (97.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5315/5503 (96.5837%), train_poison_data_count: 430
Global model norm: 43.22775631484504.
Norm before scaling: 43.201336423194135. Distance: 1.4123378373630118
Total norm for 4 adversaries is: 43.201336423194135. distance: 1.4123378373630118
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1089, Accuracy: 9604/9900 (97.0101%)
___Train Local_ResNet_18,  epoch 107, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4878/5353 (91.1265%)
___Train Local_ResNet_18,  epoch 107, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4813/5353 (89.9122%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0389, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 107, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3217/3552 (90.5687%)
___Train Local_ResNet_18,  epoch 107, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3299/3552 (92.8773%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8061, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 107, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3596/3959 (90.8310%)
___Train Local_ResNet_18,  epoch 107, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3624/3959 (91.5383%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9355, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 107, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4576/5055 (90.5242%)
___Train Local_ResNet_18,  epoch 107, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4573/5055 (90.4649%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1515, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 107, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4931/5702 (86.4784%)
___Train Local_ResNet_18,  epoch 107, local model 11, internal_epoch   2,  Average loss: 0.0104, Accuracy: 4567/5702 (80.0947%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.4160, Accuracy: 4739/10000 (47.3900%)
___Train Local_ResNet_18,  epoch 107, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3807/4108 (92.6728%)
___Train Local_ResNet_18,  epoch 107, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3796/4108 (92.4051%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8613, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 107, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6311/6812 (92.6453%)
___Train Local_ResNet_18,  epoch 107, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6242/6812 (91.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0830, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 107, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4139/4485 (92.2854%)
___Train Local_ResNet_18,  epoch 107, local model 61, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3976/4485 (88.6511%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0563, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 107, local model 72, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4720/5193 (90.8916%)
___Train Local_ResNet_18,  epoch 107, local model 72, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4485/5193 (86.3663%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3012, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 107, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4154/4397 (94.4735%)
___Train Local_ResNet_18,  epoch 107, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4201/4397 (95.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.6796, Accuracy: 5998/10000 (59.9800%)
___Train Local_ResNet_18,  epoch 107, local model 60, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3797/4145 (91.6043%)
___Train Local_ResNet_18,  epoch 107, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3794/4145 (91.5320%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0759, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 107, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4991/5346 (93.3595%)
___Train Local_ResNet_18,  epoch 107, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4946/5346 (92.5178%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9819, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 107, local model 30, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3474/3774 (92.0509%)
___Train Local_ResNet_18,  epoch 107, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3528/3774 (93.4817%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9222, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 107, local model 80, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5038/5461 (92.2542%)
___Train Local_ResNet_18,  epoch 107, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5073/5461 (92.8951%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2260, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 107, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5062/5652 (89.5612%)
___Train Local_ResNet_18,  epoch 107, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4991/5652 (88.3050%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1712, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 107, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5552/5939 (93.4838%)
___Train Local_ResNet_18,  epoch 107, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5511/5939 (92.7934%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2163, Accuracy: 5141/10000 (51.4100%)
time spent on training: 289.70786452293396
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1890, Accuracy: 6878/10000 (68.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2073, Accuracy: 9313/9900 (94.0707%)
Done in 316.50149369239807 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 61, 73, 22, 98, 14, 33, 5, 2, 32, 21, 53, 79, 12, 10, 76, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5139/5308 (96.8161%), train_poison_data_count: 415
Global model norm: 43.24790287997356.
Norm before scaling: 43.22158991708817. Distance: 1.377757601735521
Total norm for 4 adversaries is: 43.22158991708817. distance: 1.377757601735521
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0429, Accuracy: 9782/9900 (98.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5586/5777 (96.6938%), train_poison_data_count: 455
Global model norm: 43.24790287997356.
Norm before scaling: 43.21497068616673. Distance: 1.384199793559107
Total norm for 4 adversaries is: 43.21497068616673. distance: 1.384199793559107
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0870, Accuracy: 9673/9900 (97.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4919/5123 (96.0180%), train_poison_data_count: 403
Global model norm: 43.24790287997356.
Norm before scaling: 43.223359298676684. Distance: 1.4210267942990966
Total norm for 4 adversaries is: 43.223359298676684. distance: 1.4210267942990966
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0847, Accuracy: 9697/9900 (97.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5320/5503 (96.6745%), train_poison_data_count: 430
Global model norm: 43.24790287997356.
Norm before scaling: 43.221479769630314. Distance: 1.428974244683148
Total norm for 4 adversaries is: 43.221479769630314. distance: 1.428974244683148
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1209, Accuracy: 9585/9900 (96.8182%)
___Train Local_ResNet_18,  epoch 108, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4125/4485 (91.9732%)
___Train Local_ResNet_18,  epoch 108, local model 61, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3937/4485 (87.7815%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9959, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 108, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4310/4605 (93.5939%)
___Train Local_ResNet_18,  epoch 108, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4306/4605 (93.5071%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8870, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 108, local model 22, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5299/5696 (93.0302%)
___Train Local_ResNet_18,  epoch 108, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5250/5696 (92.1699%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0201, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 108, local model 98, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3853/4161 (92.5979%)
___Train Local_ResNet_18,  epoch 108, local model 98, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3800/4161 (91.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1517, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 108, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3970/4196 (94.6139%)
___Train Local_ResNet_18,  epoch 108, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3992/4196 (95.1382%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.7616, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 108, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4404/4818 (91.4072%)
___Train Local_ResNet_18,  epoch 108, local model 33, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4241/4818 (88.0241%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0530, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 108, local model 5, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4656/4993 (93.2506%)
___Train Local_ResNet_18,  epoch 108, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4626/4993 (92.6497%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1095, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 108, local model 2, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3660/3968 (92.2379%)
___Train Local_ResNet_18,  epoch 108, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3662/3968 (92.2883%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8638, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 108, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5385/6080 (88.5691%)
___Train Local_ResNet_18,  epoch 108, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5416/6080 (89.0789%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2080, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 108, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4599/5038 (91.2862%)
___Train Local_ResNet_18,  epoch 108, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4612/5038 (91.5443%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9084, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 108, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5849/6664 (87.7701%)
___Train Local_ResNet_18,  epoch 108, local model 53, internal_epoch   2,  Average loss: 0.0085, Accuracy: 5551/6664 (83.2983%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.4662, Accuracy: 4791/10000 (47.9100%)
___Train Local_ResNet_18,  epoch 108, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3791/4111 (92.2160%)
___Train Local_ResNet_18,  epoch 108, local model 79, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3768/4111 (91.6565%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1488, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 108, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5025/5526 (90.9338%)
___Train Local_ResNet_18,  epoch 108, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4796/5526 (86.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2471, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 108, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4761/5068 (93.9424%)
___Train Local_ResNet_18,  epoch 108, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4640/5068 (91.5549%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2142, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 108, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3604/3959 (91.0331%)
___Train Local_ResNet_18,  epoch 108, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3681/3959 (92.9780%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8525, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 108, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4089/4368 (93.6126%)
___Train Local_ResNet_18,  epoch 108, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4058/4368 (92.9029%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9686, Accuracy: 5524/10000 (55.2400%)
time spent on training: 288.38067078590393
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1895, Accuracy: 6864/10000 (68.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1934, Accuracy: 9346/9900 (94.4040%)
Done in 315.14673113822937 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 73, 72, 84, 40, 22, 51, 8, 54, 34, 27, 68, 82, 65, 7, 14, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5132/5308 (96.6843%), train_poison_data_count: 415
Global model norm: 43.267590071391055.
Norm before scaling: 43.24128626545035. Distance: 1.3934119083905887
Total norm for 4 adversaries is: 43.24128626545035. distance: 1.3934119083905887
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1168, Accuracy: 9601/9900 (96.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5609/5777 (97.0919%), train_poison_data_count: 455
Global model norm: 43.267590071391055.
Norm before scaling: 43.23466157973325. Distance: 1.3788919421093957
Total norm for 4 adversaries is: 43.23466157973325. distance: 1.3788919421093957
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0953, Accuracy: 9653/9900 (97.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4903/5123 (95.7056%), train_poison_data_count: 403
Global model norm: 43.267590071391055.
Norm before scaling: 43.24321574545321. Distance: 1.4305651529642438
Total norm for 4 adversaries is: 43.24321574545321. distance: 1.4305651529642438
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0880, Accuracy: 9657/9900 (97.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5312/5503 (96.5292%), train_poison_data_count: 430
Global model norm: 43.267590071391055.
Norm before scaling: 43.24193555143404. Distance: 1.458995323701807
Total norm for 4 adversaries is: 43.24193555143404. distance: 1.458995323701807
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1259, Accuracy: 9548/9900 (96.4444%)
___Train Local_ResNet_18,  epoch 109, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4297/4605 (93.3116%)
___Train Local_ResNet_18,  epoch 109, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4283/4605 (93.0076%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9266, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 109, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4764/5193 (91.7389%)
___Train Local_ResNet_18,  epoch 109, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4608/5193 (88.7348%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3571, Accuracy: 4899/10000 (48.9900%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4776/5209 (91.6875%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4696/5209 (90.1517%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1797, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 109, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5504/5939 (92.6755%)
___Train Local_ResNet_18,  epoch 109, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5472/5939 (92.1367%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0701, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 109, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5311/5696 (93.2409%)
___Train Local_ResNet_18,  epoch 109, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5205/5696 (91.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0819, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 109, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3815/4108 (92.8676%)
___Train Local_ResNet_18,  epoch 109, local model 51, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3675/4108 (89.4596%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1156, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 109, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4458/4889 (91.1843%)
___Train Local_ResNet_18,  epoch 109, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4454/4889 (91.1025%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0448, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 109, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5050/5645 (89.4597%)
___Train Local_ResNet_18,  epoch 109, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4880/5645 (86.4482%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2103, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4542/4911 (92.4863%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4516/4911 (91.9568%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0004, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 109, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4140/4587 (90.2551%)
___Train Local_ResNet_18,  epoch 109, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4189/4587 (91.3233%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1212, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 109, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3339/3589 (93.0343%)
___Train Local_ResNet_18,  epoch 109, local model 68, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3140/3589 (87.4896%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2418, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 109, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4965/5298 (93.7146%)
___Train Local_ResNet_18,  epoch 109, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4912/5298 (92.7142%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9588, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 109, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5039/5497 (91.6682%)
___Train Local_ResNet_18,  epoch 109, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4942/5497 (89.9036%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1265, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 109, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4424/4869 (90.8605%)
___Train Local_ResNet_18,  epoch 109, local model 7, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4095/4869 (84.1035%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3931, Accuracy: 4885/10000 (48.8500%)
___Train Local_ResNet_18,  epoch 109, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3978/4196 (94.8046%)
___Train Local_ResNet_18,  epoch 109, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3969/4196 (94.5901%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7480, Accuracy: 5913/10000 (59.1300%)
___Train Local_ResNet_18,  epoch 109, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3665/3968 (92.3639%)
___Train Local_ResNet_18,  epoch 109, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3679/3968 (92.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7551, Accuracy: 5834/10000 (58.3400%)
time spent on training: 286.9411141872406
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1909, Accuracy: 6866/10000 (68.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1983, Accuracy: 9343/9900 (94.3737%)
Done in 313.6459324359894 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 98, 90, 19, 60, 20, 39, 86, 78, 25, 23, 28, 34, 4, 9, 5, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5130/5308 (96.6466%), train_poison_data_count: 415
Global model norm: 43.28875583608216.
Norm before scaling: 43.26301511178457. Distance: 1.4001096393024248
Total norm for 4 adversaries is: 43.26301511178457. distance: 1.4001096393024248
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0315, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5618/5777 (97.2477%), train_poison_data_count: 455
Global model norm: 43.28875583608216.
Norm before scaling: 43.256279461953554. Distance: 1.3655969141116862
Total norm for 4 adversaries is: 43.256279461953554. distance: 1.3655969141116862
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0411, Accuracy: 9788/9900 (98.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4889/5123 (95.4324%), train_poison_data_count: 403
Global model norm: 43.28875583608216.
Norm before scaling: 43.26471226240199. Distance: 1.4435063804747077
Total norm for 4 adversaries is: 43.26471226240199. distance: 1.4435063804747077
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2191, Accuracy: 9345/9900 (94.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5324/5503 (96.7472%), train_poison_data_count: 430
Global model norm: 43.28875583608216.
Norm before scaling: 43.260763427657515. Distance: 1.4021611001760328
Total norm for 4 adversaries is: 43.260763427657515. distance: 1.4021611001760328
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0295, Accuracy: 9821/9900 (99.2020%)
___Train Local_ResNet_18,  epoch 110, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3873/4161 (93.0786%)
___Train Local_ResNet_18,  epoch 110, local model 98, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3769/4161 (90.5792%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0028, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4426/4748 (93.2182%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4430/4748 (93.3024%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9197, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 110, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4912/5361 (91.6247%)
___Train Local_ResNet_18,  epoch 110, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4849/5361 (90.4495%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0231, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3798/4145 (91.6285%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3822/4145 (92.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8804, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 110, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4425/4714 (93.8693%)
___Train Local_ResNet_18,  epoch 110, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4398/4714 (93.2966%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0840, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 110, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3827/4175 (91.6647%)
___Train Local_ResNet_18,  epoch 110, local model 39, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3783/4175 (90.6108%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1012, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 110, local model 86, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3572/3929 (90.9137%)
___Train Local_ResNet_18,  epoch 110, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3539/3929 (90.0738%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8953, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 110, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4075/4368 (93.2921%)
___Train Local_ResNet_18,  epoch 110, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4075/4368 (93.2921%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9787, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5765/6419 (89.8115%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5557/6419 (86.5711%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2002, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4293/4549 (94.3724%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4003/4549 (87.9974%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2897, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch 110, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4586/5122 (89.5353%)
___Train Local_ResNet_18,  epoch 110, local model 28, internal_epoch   2,  Average loss: 0.0152, Accuracy: 3756/5122 (73.3307%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.4665, Accuracy: 4629/10000 (46.2900%)
___Train Local_ResNet_18,  epoch 110, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4557/4911 (92.7917%)
___Train Local_ResNet_18,  epoch 110, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4545/4911 (92.5473%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0950, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3707/4028 (92.0308%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3707/4028 (92.0308%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8540, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5158/5727 (90.0646%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5111/5727 (89.2439%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1987, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 110, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4703/4993 (94.1919%)
___Train Local_ResNet_18,  epoch 110, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4624/4993 (92.6097%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1400, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 110, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4422/4714 (93.8057%)
___Train Local_ResNet_18,  epoch 110, local model 41, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4422/4714 (93.8057%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0217, Accuracy: 5592/10000 (55.9200%)
time spent on training: 301.04211616516113
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.1871, Accuracy: 6871/10000 (68.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1941, Accuracy: 9362/9900 (94.5657%)
Done in 327.88933515548706 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 80, 69, 20, 50, 3, 73, 15, 77, 35, 56, 55, 18, 47, 21, 5, 43].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5152/5308 (97.0610%), train_poison_data_count: 415
Global model norm: 43.30768456050482.
Norm before scaling: 43.27852259005759. Distance: 1.3091918489465257
Total norm for 4 adversaries is: 43.27852259005759. distance: 1.3091918489465257
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0336, Accuracy: 9812/9900 (99.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5605/5777 (97.0227%), train_poison_data_count: 455
Global model norm: 43.30768456050482.
Norm before scaling: 43.274515777999326. Distance: 1.3739796667440751
Total norm for 4 adversaries is: 43.274515777999326. distance: 1.3739796667440751
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0778, Accuracy: 9708/9900 (98.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4921/5123 (96.0570%), train_poison_data_count: 403
Global model norm: 43.30768456050482.
Norm before scaling: 43.281649084351415. Distance: 1.375422889528216
Total norm for 4 adversaries is: 43.281649084351415. distance: 1.375422889528216
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1114, Accuracy: 9609/9900 (97.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5302/5503 (96.3474%), train_poison_data_count: 430
Global model norm: 43.30768456050482.
Norm before scaling: 43.28323410389048. Distance: 1.4777038038632453
Total norm for 4 adversaries is: 43.28323410389048. distance: 1.4777038038632453
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1633, Accuracy: 9465/9900 (95.6061%)
___Train Local_ResNet_18,  epoch 111, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4984/5461 (91.2653%)
___Train Local_ResNet_18,  epoch 111, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4987/5461 (91.3203%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1718, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 111, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3998/4364 (91.6132%)
___Train Local_ResNet_18,  epoch 111, local model 69, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3908/4364 (89.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0830, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 111, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4423/4714 (93.8269%)
___Train Local_ResNet_18,  epoch 111, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4475/4714 (94.9300%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8276, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 111, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4348/4757 (91.4021%)
___Train Local_ResNet_18,  epoch 111, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4281/4757 (89.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2980, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 111, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5013/5346 (93.7710%)
___Train Local_ResNet_18,  epoch 111, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4924/5346 (92.1062%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1734, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 111, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4305/4605 (93.4853%)
___Train Local_ResNet_18,  epoch 111, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4318/4605 (93.7676%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8668, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 111, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5550/6068 (91.4634%)
___Train Local_ResNet_18,  epoch 111, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5527/6068 (91.0844%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2165, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch 111, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4536/5050 (89.8218%)
___Train Local_ResNet_18,  epoch 111, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4539/5050 (89.8812%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0566, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5109/5615 (90.9884%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5128/5615 (91.3268%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9837, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4924/5427 (90.7315%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4894/5427 (90.1787%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1668, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 111, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4398/4731 (92.9613%)
___Train Local_ResNet_18,  epoch 111, local model 55, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4346/4731 (91.8622%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9503, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 111, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3928/4249 (92.4453%)
___Train Local_ResNet_18,  epoch 111, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3904/4249 (91.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9236, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 111, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4629/5123 (90.3572%)
___Train Local_ResNet_18,  epoch 111, local model 47, internal_epoch   2,  Average loss: 0.0100, Accuracy: 4121/5123 (80.4411%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.3592, Accuracy: 4893/10000 (48.9300%)
___Train Local_ResNet_18,  epoch 111, local model 21, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4647/5038 (92.2390%)
___Train Local_ResNet_18,  epoch 111, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4623/5038 (91.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9039, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 111, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4738/4993 (94.8928%)
___Train Local_ResNet_18,  epoch 111, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4688/4993 (93.8914%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0071, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 111, local model 43, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4602/4979 (92.4282%)
___Train Local_ResNet_18,  epoch 111, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4615/4979 (92.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0283, Accuracy: 5498/10000 (54.9800%)
time spent on training: 288.1796259880066
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.1822, Accuracy: 6869/10000 (68.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1936, Accuracy: 9366/9900 (94.6061%)
Done in 314.79514479637146 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 56, 14, 4, 30, 82, 85, 39, 70, 91, 59, 1, 88, 49, 34, 53, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5146/5308 (96.9480%), train_poison_data_count: 415
Global model norm: 43.328765941436785.
Norm before scaling: 43.29950117215916. Distance: 1.343860976493646
Total norm for 4 adversaries is: 43.29950117215916. distance: 1.343860976493646
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0316, Accuracy: 9813/9900 (99.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5603/5777 (96.9881%), train_poison_data_count: 455
Global model norm: 43.328765941436785.
Norm before scaling: 43.29403438218639. Distance: 1.3610791453459383
Total norm for 4 adversaries is: 43.29403438218639. distance: 1.3610791453459383
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0595, Accuracy: 9742/9900 (98.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4932/5123 (96.2717%), train_poison_data_count: 403
Global model norm: 43.328765941436785.
Norm before scaling: 43.303050409927096. Distance: 1.3984950815631898
Total norm for 4 adversaries is: 43.303050409927096. distance: 1.3984950815631898
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0642, Accuracy: 9714/9900 (98.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5302/5503 (96.3474%), train_poison_data_count: 430
Global model norm: 43.328765941436785.
Norm before scaling: 43.301147558497945. Distance: 1.426901432148437
Total norm for 4 adversaries is: 43.301147558497945. distance: 1.426901432148437
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0776, Accuracy: 9689/9900 (97.8687%)
___Train Local_ResNet_18,  epoch 112, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4874/5427 (89.8102%)
___Train Local_ResNet_18,  epoch 112, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4878/5427 (89.8839%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0692, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 112, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3962/4196 (94.4233%)
___Train Local_ResNet_18,  epoch 112, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3987/4196 (95.0191%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9198, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 112, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3713/4028 (92.1797%)
___Train Local_ResNet_18,  epoch 112, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3742/4028 (92.8997%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8869, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 112, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3531/3774 (93.5612%)
___Train Local_ResNet_18,  epoch 112, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3577/3774 (94.7801%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8495, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 112, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4929/5298 (93.0351%)
___Train Local_ResNet_18,  epoch 112, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4867/5298 (91.8649%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1243, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 112, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 6305/6947 (90.7586%)
___Train Local_ResNet_18,  epoch 112, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 6047/6947 (87.0448%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1968, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 112, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3813/4175 (91.3293%)
___Train Local_ResNet_18,  epoch 112, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3785/4175 (90.6587%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1181, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 112, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5421/5871 (92.3352%)
___Train Local_ResNet_18,  epoch 112, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5384/5871 (91.7050%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0935, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 112, local model 91, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4116/4527 (90.9211%)
___Train Local_ResNet_18,  epoch 112, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4037/4527 (89.1761%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9388, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 112, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4169/4397 (94.8146%)
___Train Local_ResNet_18,  epoch 112, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4180/4397 (95.0648%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7702, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5084/5422 (93.7661%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5037/5422 (92.8993%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9929, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 112, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4935/5362 (92.0366%)
___Train Local_ResNet_18,  epoch 112, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4832/5362 (90.1156%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1542, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 112, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5083/5652 (89.9328%)
___Train Local_ResNet_18,  epoch 112, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5049/5652 (89.3312%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1542, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 112, local model 34, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4533/4911 (92.3030%)
___Train Local_ResNet_18,  epoch 112, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4536/4911 (92.3641%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0297, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 112, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5828/6664 (87.4550%)
___Train Local_ResNet_18,  epoch 112, local model 53, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5674/6664 (85.1441%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.7139, Accuracy: 4363/10000 (43.6300%)
___Train Local_ResNet_18,  epoch 112, local model 93, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4578/5055 (90.5638%)
___Train Local_ResNet_18,  epoch 112, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4560/5055 (90.2077%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1610, Accuracy: 5270/10000 (52.7000%)
time spent on training: 303.1535098552704
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.1886, Accuracy: 6856/10000 (68.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1785, Accuracy: 9403/9900 (94.9798%)
Done in 330.0200355052948 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 98, 78, 33, 79, 16, 3, 62, 30, 39, 1, 15, 6, 50, 93, 66, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5144/5308 (96.9103%), train_poison_data_count: 415
Global model norm: 43.34895989777321.
Norm before scaling: 43.32117264137061. Distance: 1.3786774356315077
Total norm for 4 adversaries is: 43.32117264137061. distance: 1.3786774356315077
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0367, Accuracy: 9808/9900 (99.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5592/5777 (96.7976%), train_poison_data_count: 455
Global model norm: 43.34895989777321.
Norm before scaling: 43.316952783379165. Distance: 1.4355239554930574
Total norm for 4 adversaries is: 43.316952783379165. distance: 1.4355239554930574
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0547, Accuracy: 9768/9900 (98.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4912/5123 (95.8813%), train_poison_data_count: 403
Global model norm: 43.34895989777321.
Norm before scaling: 43.323688861886666. Distance: 1.4288662912695562
Total norm for 4 adversaries is: 43.323688861886666. distance: 1.4288662912695562
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0735, Accuracy: 9702/9900 (98.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5298/5503 (96.2748%), train_poison_data_count: 430
Global model norm: 43.34895989777321.
Norm before scaling: 43.32260546794537. Distance: 1.4540513070301035
Total norm for 4 adversaries is: 43.32260546794537. distance: 1.4540513070301035
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0427, Accuracy: 9780/9900 (98.7879%)
___Train Local_ResNet_18,  epoch 113, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3885/4161 (93.3670%)
___Train Local_ResNet_18,  epoch 113, local model 98, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3843/4161 (92.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2003, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 113, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4122/4368 (94.3681%)
___Train Local_ResNet_18,  epoch 113, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4081/4368 (93.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9092, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 113, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4341/4818 (90.0996%)
___Train Local_ResNet_18,  epoch 113, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4347/4818 (90.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9969, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 113, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3817/4111 (92.8485%)
___Train Local_ResNet_18,  epoch 113, local model 79, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3816/4111 (92.8241%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1364, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 113, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4898/5353 (91.5001%)
___Train Local_ResNet_18,  epoch 113, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4840/5353 (90.4166%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9704, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 113, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4998/5346 (93.4905%)
___Train Local_ResNet_18,  epoch 113, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4990/5346 (93.3408%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1381, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 113, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4857/5504 (88.2449%)
___Train Local_ResNet_18,  epoch 113, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4794/5504 (87.1003%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2878, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch 113, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3491/3774 (92.5013%)
___Train Local_ResNet_18,  epoch 113, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3541/3774 (93.8262%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8668, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3848/4175 (92.1677%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3817/4175 (91.4251%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9736, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 113, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5088/5422 (93.8399%)
___Train Local_ResNet_18,  epoch 113, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5042/5422 (92.9915%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9272, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 113, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5591/6068 (92.1391%)
___Train Local_ResNet_18,  epoch 113, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5527/6068 (91.0844%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3163, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch 113, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4541/4929 (92.1282%)
___Train Local_ResNet_18,  epoch 113, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4491/4929 (91.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1248, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 113, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4419/4757 (92.8947%)
___Train Local_ResNet_18,  epoch 113, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4293/4757 (90.2460%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1246, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4630/5055 (91.5925%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4546/5055 (89.9308%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9938, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4480/4843 (92.5046%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4445/4843 (91.7820%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9430, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 113, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4711/5035 (93.5650%)
___Train Local_ResNet_18,  epoch 113, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4696/5035 (93.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9331, Accuracy: 5674/10000 (56.7400%)
time spent on training: 295.8394808769226
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.1916, Accuracy: 6855/10000 (68.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1711, Accuracy: 9420/9900 (95.1515%)
Done in 322.3741891384125 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 33, 91, 10, 81, 5, 93, 90, 24, 64, 16, 9, 18, 27, 2, 67, 82].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5149/5308 (97.0045%), train_poison_data_count: 415
Global model norm: 43.36924437227233.
Norm before scaling: 43.340070308387105. Distance: 1.3414868658832557
Total norm for 4 adversaries is: 43.340070308387105. distance: 1.3414868658832557
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0531, Accuracy: 9755/9900 (98.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5602/5777 (96.9707%), train_poison_data_count: 455
Global model norm: 43.36924437227233.
Norm before scaling: 43.33328888719676. Distance: 1.336075892725573
Total norm for 4 adversaries is: 43.33328888719676. distance: 1.336075892725573
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0459, Accuracy: 9780/9900 (98.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4921/5123 (96.0570%), train_poison_data_count: 403
Global model norm: 43.36924437227233.
Norm before scaling: 43.34281074369846. Distance: 1.4179596703609096
Total norm for 4 adversaries is: 43.34281074369846. distance: 1.4179596703609096
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0850, Accuracy: 9684/9900 (97.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5313/5503 (96.5473%), train_poison_data_count: 430
Global model norm: 43.36924437227233.
Norm before scaling: 43.340933578287164. Distance: 1.4288941563782238
Total norm for 4 adversaries is: 43.340933578287164. distance: 1.4288941563782238
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0540, Accuracy: 9760/9900 (98.5859%)
___Train Local_ResNet_18,  epoch 114, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4421/4818 (91.7601%)
___Train Local_ResNet_18,  epoch 114, local model 33, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4283/4818 (88.8958%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0953, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 114, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4059/4527 (89.6620%)
___Train Local_ResNet_18,  epoch 114, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4040/4527 (89.2423%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1061, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 114, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4706/5068 (92.8571%)
___Train Local_ResNet_18,  epoch 114, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4593/5068 (90.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.3442, Accuracy: 4877/10000 (48.7700%)
___Train Local_ResNet_18,  epoch 114, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4693/5035 (93.2075%)
___Train Local_ResNet_18,  epoch 114, local model 81, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4743/5035 (94.2006%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9622, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4758/4993 (95.2934%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4640/4993 (92.9301%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1292, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 114, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4561/5055 (90.2275%)
___Train Local_ResNet_18,  epoch 114, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4572/5055 (90.4451%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0231, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 114, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4427/4748 (93.2393%)
___Train Local_ResNet_18,  epoch 114, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4344/4748 (91.4912%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0375, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 114, local model 24, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3983/4313 (92.3487%)
___Train Local_ResNet_18,  epoch 114, local model 24, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3984/4313 (92.3719%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9070, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 114, local model 64, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4346/4894 (88.8026%)
___Train Local_ResNet_18,  epoch 114, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4286/4894 (87.5766%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0696, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 114, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4939/5353 (92.2660%)
___Train Local_ResNet_18,  epoch 114, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4827/5353 (90.1737%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0231, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 114, local model 9, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5122/5727 (89.4360%)
___Train Local_ResNet_18,  epoch 114, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5044/5727 (88.0740%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0890, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 114, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3915/4249 (92.1393%)
___Train Local_ResNet_18,  epoch 114, local model 18, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3932/4249 (92.5394%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9460, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 114, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4177/4587 (91.0617%)
___Train Local_ResNet_18,  epoch 114, local model 27, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4093/4587 (89.2304%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0424, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 114, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3659/3968 (92.2127%)
___Train Local_ResNet_18,  epoch 114, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3684/3968 (92.8427%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9267, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 114, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5000/5559 (89.9442%)
___Train Local_ResNet_18,  epoch 114, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4940/5559 (88.8649%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1886, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 114, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4935/5298 (93.1484%)
___Train Local_ResNet_18,  epoch 114, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4938/5298 (93.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0662, Accuracy: 5463/10000 (54.6300%)
time spent on training: 305.45045709609985
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.1971, Accuracy: 6849/10000 (68.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1569, Accuracy: 9466/9900 (95.6162%)
Done in 331.7766344547272 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 33, 82, 16, 30, 63, 31, 53, 84, 47, 60, 12, 92, 42, 39, 44, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5147/5308 (96.9668%), train_poison_data_count: 415
Global model norm: 43.39019597150158.
Norm before scaling: 43.360647503849904. Distance: 1.3355337503239648
Total norm for 4 adversaries is: 43.360647503849904. distance: 1.3355337503239648
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0757, Accuracy: 9708/9900 (98.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5611/5777 (97.1265%), train_poison_data_count: 455
Global model norm: 43.39019597150158.
Norm before scaling: 43.35344835621499. Distance: 1.3444136821408124
Total norm for 4 adversaries is: 43.35344835621499. distance: 1.3444136821408124
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0462, Accuracy: 9783/9900 (98.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4930/5123 (96.2327%), train_poison_data_count: 403
Global model norm: 43.39019597150158.
Norm before scaling: 43.36392853342006. Distance: 1.406448138371497
Total norm for 4 adversaries is: 43.36392853342006. distance: 1.406448138371497
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0777, Accuracy: 9698/9900 (97.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5312/5503 (96.5292%), train_poison_data_count: 430
Global model norm: 43.39019597150158.
Norm before scaling: 43.35993524412831. Distance: 1.387656955604988
Total norm for 4 adversaries is: 43.35993524412831. distance: 1.387656955604988
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0462, Accuracy: 9776/9900 (98.7475%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4377/4818 (90.8468%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4311/4818 (89.4770%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9767, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 115, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5012/5298 (94.6017%)
___Train Local_ResNet_18,  epoch 115, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4946/5298 (93.3560%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0701, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 115, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4957/5353 (92.6023%)
___Train Local_ResNet_18,  epoch 115, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4810/5353 (89.8562%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1026, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3533/3774 (93.6142%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3519/3774 (93.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8740, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 115, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3627/3910 (92.7621%)
___Train Local_ResNet_18,  epoch 115, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3565/3910 (91.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1355, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 115, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4178/4537 (92.0873%)
___Train Local_ResNet_18,  epoch 115, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4169/4537 (91.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9128, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 115, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5919/6664 (88.8205%)
___Train Local_ResNet_18,  epoch 115, local model 53, internal_epoch   2,  Average loss: 0.0084, Accuracy: 5588/6664 (83.8535%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2637, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4719/5209 (90.5932%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4665/5209 (89.5565%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1466, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 115, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4616/5123 (90.1035%)
___Train Local_ResNet_18,  epoch 115, local model 47, internal_epoch   2,  Average loss: 0.0112, Accuracy: 4057/5123 (79.1919%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2906, Accuracy: 4940/10000 (49.4000%)
___Train Local_ResNet_18,  epoch 115, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3852/4145 (92.9312%)
___Train Local_ResNet_18,  epoch 115, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3822/4145 (92.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9574, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 115, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5061/5526 (91.5852%)
___Train Local_ResNet_18,  epoch 115, local model 12, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4949/5526 (89.5585%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1496, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 115, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 6355/6812 (93.2913%)
___Train Local_ResNet_18,  epoch 115, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6243/6812 (91.6471%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0719, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 115, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5416/5907 (91.6878%)
___Train Local_ResNet_18,  epoch 115, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5366/5907 (90.8414%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3023, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 115, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3856/4175 (92.3593%)
___Train Local_ResNet_18,  epoch 115, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3834/4175 (91.8323%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1149, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4721/5075 (93.0246%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4656/5075 (91.7438%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2463, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 115, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3812/4111 (92.7268%)
___Train Local_ResNet_18,  epoch 115, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3760/4111 (91.4619%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9298, Accuracy: 5563/10000 (55.6300%)
time spent on training: 303.8428108692169
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.2008, Accuracy: 6854/10000 (68.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1526, Accuracy: 9478/9900 (95.7374%)
Done in 330.5774121284485 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 41, 49, 96, 89, 92, 44, 42, 48, 23, 22, 76, 75, 29, 6, 15, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5138/5308 (96.7973%), train_poison_data_count: 415
Global model norm: 43.41099826665833.
Norm before scaling: 43.381659532445994. Distance: 1.3483487326532841
Total norm for 4 adversaries is: 43.381659532445994. distance: 1.3483487326532841
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0516, Accuracy: 9763/9900 (98.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5611/5777 (97.1265%), train_poison_data_count: 455
Global model norm: 43.41099826665833.
Norm before scaling: 43.37736676269809. Distance: 1.3995609991607025
Total norm for 4 adversaries is: 43.37736676269809. distance: 1.3995609991607025
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0594, Accuracy: 9735/9900 (98.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4933/5123 (96.2912%), train_poison_data_count: 403
Global model norm: 43.41099826665833.
Norm before scaling: 43.38310443018111. Distance: 1.3587701701585906
Total norm for 4 adversaries is: 43.38310443018111. distance: 1.3587701701585906
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0968, Accuracy: 9639/9900 (97.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5292/5503 (96.1657%), train_poison_data_count: 430
Global model norm: 43.41099826665833.
Norm before scaling: 43.385429953229256. Distance: 1.4722112899150448
Total norm for 4 adversaries is: 43.385429953229256. distance: 1.4722112899150448
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0368, Accuracy: 9806/9900 (99.0505%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4389/4714 (93.1056%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4405/4714 (93.4451%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1294, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 116, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5027/5652 (88.9420%)
___Train Local_ResNet_18,  epoch 116, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5013/5652 (88.6943%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1865, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 116, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4680/5086 (92.0173%)
___Train Local_ResNet_18,  epoch 116, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4658/5086 (91.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0043, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4298/4737 (90.7325%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4321/4737 (91.2181%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2005, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6379/6812 (93.6436%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 6272/6812 (92.0728%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1719, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4703/5075 (92.6700%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4715/5075 (92.9064%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9906, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 116, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5416/5907 (91.6878%)
___Train Local_ResNet_18,  epoch 116, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5335/5907 (90.3166%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1813, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 116, local model 48, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4502/4830 (93.2091%)
___Train Local_ResNet_18,  epoch 116, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4543/4830 (94.0580%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0695, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 116, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4301/4549 (94.5483%)
___Train Local_ResNet_18,  epoch 116, local model 23, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3946/4549 (86.7443%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2581, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 116, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5256/5696 (92.2753%)
___Train Local_ResNet_18,  epoch 116, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5199/5696 (91.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1290, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 116, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3613/3959 (91.2604%)
___Train Local_ResNet_18,  epoch 116, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3629/3959 (91.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9690, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4361/4672 (93.3433%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4352/4672 (93.1507%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9448, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 116, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4402/4732 (93.0262%)
___Train Local_ResNet_18,  epoch 116, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4395/4732 (92.8783%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8843, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 116, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4554/4929 (92.3920%)
___Train Local_ResNet_18,  epoch 116, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4469/4929 (90.6675%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1573, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 116, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5631/6068 (92.7983%)
___Train Local_ResNet_18,  epoch 116, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5548/6068 (91.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1766, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3599/3995 (90.0876%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3596/3995 (90.0125%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1740, Accuracy: 5309/10000 (53.0900%)
time spent on training: 309.47116470336914
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.2054, Accuracy: 6856/10000 (68.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1462, Accuracy: 9495/9900 (95.9091%)
Done in 336.0277543067932 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 5, 39, 78, 34, 63, 68, 55, 14, 81, 75, 43, 73, 11, 3, 70, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5108/5308 (96.2321%), train_poison_data_count: 415
Global model norm: 43.432205162903024.
Norm before scaling: 43.405021018418765. Distance: 1.3967331031226555
Total norm for 4 adversaries is: 43.405021018418765. distance: 1.3967331031226555
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0628, Accuracy: 9725/9900 (98.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5586/5777 (96.6938%), train_poison_data_count: 455
Global model norm: 43.432205162903024.
Norm before scaling: 43.39971518708749. Distance: 1.4130082811003588
Total norm for 4 adversaries is: 43.39971518708749. distance: 1.4130082811003588
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0533, Accuracy: 9763/9900 (98.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4907/5123 (95.7837%), train_poison_data_count: 403
Global model norm: 43.432205162903024.
Norm before scaling: 43.407332712378505. Distance: 1.4593645083195288
Total norm for 4 adversaries is: 43.407332712378505. distance: 1.4593645083195288
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0166, Accuracy: 9854/9900 (99.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5335/5503 (96.9471%), train_poison_data_count: 430
Global model norm: 43.432205162903024.
Norm before scaling: 43.40156027806273. Distance: 1.3427982064476909
Total norm for 4 adversaries is: 43.40156027806273. distance: 1.3427982064476909
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0492, Accuracy: 9768/9900 (98.6667%)
___Train Local_ResNet_18,  epoch 117, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4686/4993 (93.8514%)
___Train Local_ResNet_18,  epoch 117, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4624/4993 (92.6097%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1439, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 117, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3820/4175 (91.4970%)
___Train Local_ResNet_18,  epoch 117, local model 39, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3767/4175 (90.2275%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0534, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 117, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4133/4368 (94.6200%)
___Train Local_ResNet_18,  epoch 117, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4063/4368 (93.0174%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1393, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 117, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4517/4911 (91.9772%)
___Train Local_ResNet_18,  epoch 117, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4463/4911 (90.8776%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1393, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 117, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3644/3910 (93.1969%)
___Train Local_ResNet_18,  epoch 117, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3463/3910 (88.5678%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1562, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 117, local model 68, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3316/3589 (92.3934%)
___Train Local_ResNet_18,  epoch 117, local model 68, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3165/3589 (88.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.3823, Accuracy: 4994/10000 (49.9400%)
___Train Local_ResNet_18,  epoch 117, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4392/4731 (92.8345%)
___Train Local_ResNet_18,  epoch 117, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4369/4731 (92.3483%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9915, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 117, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4000/4196 (95.3289%)
___Train Local_ResNet_18,  epoch 117, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3961/4196 (94.3994%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8468, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 117, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4669/5035 (92.7309%)
___Train Local_ResNet_18,  epoch 117, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4632/5035 (91.9960%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0487, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 117, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4330/4672 (92.6798%)
___Train Local_ResNet_18,  epoch 117, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4359/4672 (93.3005%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8428, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 117, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4561/4979 (91.6047%)
___Train Local_ResNet_18,  epoch 117, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4527/4979 (90.9219%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1298, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 117, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4294/4605 (93.2465%)
___Train Local_ResNet_18,  epoch 117, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4326/4605 (93.9414%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9538, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 117, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4972/5702 (87.1975%)
___Train Local_ResNet_18,  epoch 117, local model 11, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4715/5702 (82.6903%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2156, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 117, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5043/5346 (94.3322%)
___Train Local_ResNet_18,  epoch 117, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5002/5346 (93.5653%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0484, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 117, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5423/5871 (92.3693%)
___Train Local_ResNet_18,  epoch 117, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5340/5871 (90.9555%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1671, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 117, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5087/5645 (90.1151%)
___Train Local_ResNet_18,  epoch 117, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4999/5645 (88.5562%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0352, Accuracy: 5373/10000 (53.7300%)
time spent on training: 310.5731134414673
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.2035, Accuracy: 6853/10000 (68.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1407, Accuracy: 9518/9900 (96.1414%)
Done in 337.33731055259705 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 53, 62, 44, 64, 3, 63, 32, 24, 73, 6, 54, 16, 25, 82, 84, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5160/5308 (97.2118%), train_poison_data_count: 415
Global model norm: 43.45225272182747.
Norm before scaling: 43.421437846396074. Distance: 1.2846973376685018
Total norm for 4 adversaries is: 43.421437846396074. distance: 1.2846973376685018
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0466, Accuracy: 9780/9900 (98.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5617/5777 (97.2304%), train_poison_data_count: 455
Global model norm: 43.45225272182747.
Norm before scaling: 43.41693814144573. Distance: 1.3589363267282333
Total norm for 4 adversaries is: 43.41693814144573. distance: 1.3589363267282333
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0760, Accuracy: 9680/9900 (97.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4932/5123 (96.2717%), train_poison_data_count: 403
Global model norm: 43.45225272182747.
Norm before scaling: 43.42435305766296. Distance: 1.3667635014971165
Total norm for 4 adversaries is: 43.42435305766296. distance: 1.3667635014971165
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0715, Accuracy: 9724/9900 (98.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5328/5503 (96.8199%), train_poison_data_count: 430
Global model norm: 43.45225272182747.
Norm before scaling: 43.42186937747355. Distance: 1.3610019813091534
Total norm for 4 adversaries is: 43.42186937747355. distance: 1.3610019813091534
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0984, Accuracy: 9619/9900 (97.1616%)
___Train Local_ResNet_18,  epoch 118, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5921/6664 (88.8505%)
___Train Local_ResNet_18,  epoch 118, local model 53, internal_epoch   2,  Average loss: 0.0085, Accuracy: 5574/6664 (83.6435%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2249, Accuracy: 4968/10000 (49.6800%)
___Train Local_ResNet_18,  epoch 118, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4856/5504 (88.2267%)
___Train Local_ResNet_18,  epoch 118, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4784/5504 (86.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0881, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 118, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4738/5075 (93.3596%)
___Train Local_ResNet_18,  epoch 118, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4686/5075 (92.3350%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0169, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 118, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4388/4894 (89.6608%)
___Train Local_ResNet_18,  epoch 118, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4282/4894 (87.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2461, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 118, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5025/5346 (93.9955%)
___Train Local_ResNet_18,  epoch 118, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4928/5346 (92.1811%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9647, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 118, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3621/3910 (92.6087%)
___Train Local_ResNet_18,  epoch 118, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3529/3910 (90.2558%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1027, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 118, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5388/6080 (88.6184%)
___Train Local_ResNet_18,  epoch 118, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5360/6080 (88.1579%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.4089, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch 118, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4040/4313 (93.6703%)
___Train Local_ResNet_18,  epoch 118, local model 24, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3992/4313 (92.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8848, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 118, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4317/4605 (93.7459%)
___Train Local_ResNet_18,  epoch 118, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4346/4605 (94.3757%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7478, Accuracy: 5961/10000 (59.6100%)
___Train Local_ResNet_18,  epoch 118, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4568/4929 (92.6760%)
___Train Local_ResNet_18,  epoch 118, local model 6, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4491/4929 (91.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0359, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 118, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5074/5645 (89.8849%)
___Train Local_ResNet_18,  epoch 118, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4874/5645 (86.3419%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1667, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 118, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4939/5353 (92.2660%)
___Train Local_ResNet_18,  epoch 118, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4843/5353 (90.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0468, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 118, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5739/6419 (89.4064%)
___Train Local_ResNet_18,  epoch 118, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5493/6419 (85.5741%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2296, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 118, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5028/5298 (94.9037%)
___Train Local_ResNet_18,  epoch 118, local model 82, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4980/5298 (93.9977%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0437, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4750/5209 (91.1883%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4734/5209 (90.8812%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0703, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4360/4714 (92.4905%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4359/4714 (92.4692%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1198, Accuracy: 5364/10000 (53.6400%)
time spent on training: 300.5686357021332
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.2052, Accuracy: 6855/10000 (68.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1357, Accuracy: 9526/9900 (96.2222%)
Done in 327.4836976528168 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 20, 31, 38, 91, 81, 60, 39, 47, 52, 84, 79, 21, 4, 77, 8, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5163/5308 (97.2683%), train_poison_data_count: 415
Global model norm: 43.47394772572851.
Norm before scaling: 43.44103374789713. Distance: 1.2717937321673574
Total norm for 4 adversaries is: 43.44103374789713. distance: 1.2717937321673574
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0762, Accuracy: 9700/9900 (97.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5596/5777 (96.8669%), train_poison_data_count: 455
Global model norm: 43.47394772572851.
Norm before scaling: 43.43843580376859. Distance: 1.3649276803669255
Total norm for 4 adversaries is: 43.43843580376859. distance: 1.3649276803669255
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0641, Accuracy: 9731/9900 (98.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4911/5123 (95.8618%), train_poison_data_count: 403
Global model norm: 43.47394772572851.
Norm before scaling: 43.44896852873423. Distance: 1.457843952718711
Total norm for 4 adversaries is: 43.44896852873423. distance: 1.457843952718711
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0971, Accuracy: 9660/9900 (97.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5311/5503 (96.5110%), train_poison_data_count: 430
Global model norm: 43.47394772572851.
Norm before scaling: 43.44436630757995. Distance: 1.3865393294194641
Total norm for 4 adversaries is: 43.44436630757995. distance: 1.3865393294194641
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0266, Accuracy: 9830/9900 (99.2929%)
___Train Local_ResNet_18,  epoch 119, local model 20, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4383/4714 (92.9784%)
___Train Local_ResNet_18,  epoch 119, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4407/4714 (93.4875%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8919, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 119, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4228/4537 (93.1893%)
___Train Local_ResNet_18,  epoch 119, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4197/4537 (92.5061%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8417, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 119, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5629/6235 (90.2807%)
___Train Local_ResNet_18,  epoch 119, local model 38, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5507/6235 (88.3240%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.3675, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch 119, local model 91, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4074/4527 (89.9934%)
___Train Local_ResNet_18,  epoch 119, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4011/4527 (88.6017%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1277, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 119, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4705/5035 (93.4459%)
___Train Local_ResNet_18,  epoch 119, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4702/5035 (93.3863%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9164, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 119, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3769/4145 (90.9288%)
___Train Local_ResNet_18,  epoch 119, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3796/4145 (91.5802%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9694, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3862/4175 (92.5030%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3799/4175 (90.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0633, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 119, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4626/5123 (90.2987%)
___Train Local_ResNet_18,  epoch 119, local model 47, internal_epoch   2,  Average loss: 0.0149, Accuracy: 3753/5123 (73.2579%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.3216, Accuracy: 4871/10000 (48.7100%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3892/4130 (94.2373%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3840/4130 (92.9782%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9321, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 119, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4780/5209 (91.7643%)
___Train Local_ResNet_18,  epoch 119, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4729/5209 (90.7852%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0157, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3830/4111 (93.1647%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3798/4111 (92.3863%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9604, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 119, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4641/5038 (92.1199%)
___Train Local_ResNet_18,  epoch 119, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4600/5038 (91.3061%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0001, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 119, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3760/4028 (93.3466%)
___Train Local_ResNet_18,  epoch 119, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3782/4028 (93.8928%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8091, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 119, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4545/5050 (90.0000%)
___Train Local_ResNet_18,  epoch 119, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4526/5050 (89.6238%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2947, Accuracy: 4983/10000 (49.8300%)
___Train Local_ResNet_18,  epoch 119, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4482/4889 (91.6752%)
___Train Local_ResNet_18,  epoch 119, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4355/4889 (89.0775%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1732, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 119, local model 69, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4046/4364 (92.7131%)
___Train Local_ResNet_18,  epoch 119, local model 69, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3985/4364 (91.3153%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9148, Accuracy: 5596/10000 (55.9600%)
time spent on training: 300.9563019275665
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.2027, Accuracy: 6873/10000 (68.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1310, Accuracy: 9548/9900 (96.4444%)
Done in 327.6007091999054 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 72, 30, 96, 38, 62, 1, 31, 88, 21, 34, 43, 37, 10, 83, 93, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5163/5308 (97.2683%), train_poison_data_count: 415
Global model norm: 43.49312563542729.
Norm before scaling: 43.46247876671181. Distance: 1.314717191157326
Total norm for 4 adversaries is: 43.46247876671181. distance: 1.314717191157326
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0402, Accuracy: 9782/9900 (98.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5615/5777 (97.1958%), train_poison_data_count: 455
Global model norm: 43.49312563542729.
Norm before scaling: 43.454939731972644. Distance: 1.3163024680321056
Total norm for 4 adversaries is: 43.454939731972644. distance: 1.3163024680321056
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0520, Accuracy: 9759/9900 (98.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4941/5123 (96.4474%), train_poison_data_count: 403
Global model norm: 43.49312563542729.
Norm before scaling: 43.464700341555904. Distance: 1.36351304146853
Total norm for 4 adversaries is: 43.464700341555904. distance: 1.36351304146853
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1585, Accuracy: 9499/9900 (95.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5308/5503 (96.4565%), train_poison_data_count: 430
Global model norm: 43.49312563542729.
Norm before scaling: 43.46629272799355. Distance: 1.4276869488104564
Total norm for 4 adversaries is: 43.46629272799355. distance: 1.4276869488104564
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1081, Accuracy: 9612/9900 (97.0909%)
___Train Local_ResNet_18,  epoch 120, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4769/5193 (91.8352%)
___Train Local_ResNet_18,  epoch 120, local model 72, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4512/5193 (86.8862%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.3818, Accuracy: 5044/10000 (50.4400%)
___Train Local_ResNet_18,  epoch 120, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3509/3774 (92.9783%)
___Train Local_ResNet_18,  epoch 120, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3506/3774 (92.8988%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8805, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 120, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4653/5086 (91.4864%)
___Train Local_ResNet_18,  epoch 120, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4631/5086 (91.0539%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9999, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5603/6235 (89.8637%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5525/6235 (88.6127%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.4999, Accuracy: 4777/10000 (47.7700%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4901/5504 (89.0443%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4844/5504 (88.0087%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.3092, Accuracy: 4869/10000 (48.6900%)
___Train Local_ResNet_18,  epoch 120, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5102/5422 (94.0981%)
___Train Local_ResNet_18,  epoch 120, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5039/5422 (92.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9987, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 120, local model 31, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4237/4537 (93.3877%)
___Train Local_ResNet_18,  epoch 120, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4175/4537 (92.0212%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0385, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 120, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4944/5362 (92.2044%)
___Train Local_ResNet_18,  epoch 120, local model 88, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4916/5362 (91.6822%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0366, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 120, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4607/5038 (91.4450%)
___Train Local_ResNet_18,  epoch 120, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4586/5038 (91.0282%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9744, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 120, local model 34, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4561/4911 (92.8731%)
___Train Local_ResNet_18,  epoch 120, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4586/4911 (93.3822%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0667, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 120, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4609/4979 (92.5688%)
___Train Local_ResNet_18,  epoch 120, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4557/4979 (91.5244%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0994, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 120, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4341/4741 (91.5630%)
___Train Local_ResNet_18,  epoch 120, local model 37, internal_epoch   2,  Average loss: 0.0113, Accuracy: 3780/4741 (79.7300%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.6930, Accuracy: 4357/10000 (43.5700%)
___Train Local_ResNet_18,  epoch 120, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4745/5068 (93.6267%)
___Train Local_ResNet_18,  epoch 120, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4615/5068 (91.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0618, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 120, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3268/3552 (92.0045%)
___Train Local_ResNet_18,  epoch 120, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3276/3552 (92.2297%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7889, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 120, local model 93, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4665/5055 (92.2849%)
___Train Local_ResNet_18,  epoch 120, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4580/5055 (90.6034%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1020, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 120, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3645/3959 (92.0687%)
___Train Local_ResNet_18,  epoch 120, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3631/3959 (91.7151%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0182, Accuracy: 5554/10000 (55.5400%)
time spent on training: 305.01955556869507
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.2046, Accuracy: 6852/10000 (68.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1240, Accuracy: 9570/9900 (96.6667%)
Done in 331.76520681381226 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 86, 74, 94, 24, 51, 84, 63, 26, 28, 88, 55, 2, 33, 98, 34, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5166/5308 (97.3248%), train_poison_data_count: 415
Global model norm: 43.512735541412184.
Norm before scaling: 43.47966984066375. Distance: 1.2686784902630726
Total norm for 4 adversaries is: 43.47966984066375. distance: 1.2686784902630726
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0557, Accuracy: 9758/9900 (98.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5622/5777 (97.3169%), train_poison_data_count: 455
Global model norm: 43.512735541412184.
Norm before scaling: 43.4771949358763. Distance: 1.3409051722423737
Total norm for 4 adversaries is: 43.4771949358763. distance: 1.3409051722423737
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1369, Accuracy: 9567/9900 (96.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4915/5123 (95.9399%), train_poison_data_count: 403
Global model norm: 43.512735541412184.
Norm before scaling: 43.48510206452895. Distance: 1.4041018290883607
Total norm for 4 adversaries is: 43.48510206452895. distance: 1.4041018290883607
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0550, Accuracy: 9744/9900 (98.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5339/5503 (97.0198%), train_poison_data_count: 430
Global model norm: 43.512735541412184.
Norm before scaling: 43.48242674399481. Distance: 1.3546595287845196
Total norm for 4 adversaries is: 43.48242674399481. distance: 1.3546595287845196
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0198, Accuracy: 9861/9900 (99.6061%)
___Train Local_ResNet_18,  epoch 121, local model 86, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3553/3929 (90.4301%)
___Train Local_ResNet_18,  epoch 121, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3534/3929 (89.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9841, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 121, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4378/4797 (91.2654%)
___Train Local_ResNet_18,  epoch 121, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4272/4797 (89.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2590, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 121, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4719/5224 (90.3331%)
___Train Local_ResNet_18,  epoch 121, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4718/5224 (90.3139%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1691, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 121, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4037/4313 (93.6007%)
___Train Local_ResNet_18,  epoch 121, local model 24, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4040/4313 (93.6703%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7920, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 121, local model 51, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3843/4108 (93.5492%)
___Train Local_ResNet_18,  epoch 121, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3848/4108 (93.6709%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8640, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4751/5209 (91.2075%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4698/5209 (90.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2173, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 121, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3655/3910 (93.4783%)
___Train Local_ResNet_18,  epoch 121, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3632/3910 (92.8900%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9244, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3827/4086 (93.6613%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3807/4086 (93.1718%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0660, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 121, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4566/5122 (89.1449%)
___Train Local_ResNet_18,  epoch 121, local model 28, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4386/5122 (85.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.5914, Accuracy: 4586/10000 (45.8600%)
___Train Local_ResNet_18,  epoch 121, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4915/5362 (91.6636%)
___Train Local_ResNet_18,  epoch 121, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4837/5362 (90.2089%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1226, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 121, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4404/4731 (93.0881%)
___Train Local_ResNet_18,  epoch 121, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4391/4731 (92.8134%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0145, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 121, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3649/3968 (91.9607%)
___Train Local_ResNet_18,  epoch 121, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3653/3968 (92.0615%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8306, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 121, local model 33, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4463/4818 (92.6318%)
___Train Local_ResNet_18,  epoch 121, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4346/4818 (90.2034%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0589, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 121, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3865/4161 (92.8863%)
___Train Local_ResNet_18,  epoch 121, local model 98, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3793/4161 (91.1560%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9748, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 121, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4524/4911 (92.1197%)
___Train Local_ResNet_18,  epoch 121, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4539/4911 (92.4252%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9785, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 121, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4747/5068 (93.6661%)
___Train Local_ResNet_18,  epoch 121, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4760/5068 (93.9227%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1180, Accuracy: 5376/10000 (53.7600%)
time spent on training: 301.0007174015045
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.2142, Accuracy: 6845/10000 (68.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1121, Accuracy: 9598/9900 (96.9495%)
Done in 327.83472776412964 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 33, 32, 46, 38, 22, 73, 61, 35, 83, 24, 87, 23, 3, 19, 98, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5170/5308 (97.4002%), train_poison_data_count: 415
Global model norm: 43.5312990734648.
Norm before scaling: 43.49703092417631. Distance: 1.2311637732041156
Total norm for 4 adversaries is: 43.49703092417631. distance: 1.2311637732041156
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0640, Accuracy: 9727/9900 (98.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5619/5777 (97.2650%), train_poison_data_count: 455
Global model norm: 43.5312990734648.
Norm before scaling: 43.49543264680572. Distance: 1.3540773313349683
Total norm for 4 adversaries is: 43.49543264680572. distance: 1.3540773313349683
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0941, Accuracy: 9662/9900 (97.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4927/5123 (96.1741%), train_poison_data_count: 403
Global model norm: 43.5312990734648.
Norm before scaling: 43.50167527754678. Distance: 1.344021969263719
Total norm for 4 adversaries is: 43.50167527754678. distance: 1.344021969263719
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1747, Accuracy: 9456/9900 (95.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5322/5503 (96.7109%), train_poison_data_count: 430
Global model norm: 43.5312990734648.
Norm before scaling: 43.50118420622305. Distance: 1.4132833283653181
Total norm for 4 adversaries is: 43.50118420622305. distance: 1.4132833283653181
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0932, Accuracy: 9655/9900 (97.5253%)
___Train Local_ResNet_18,  epoch 122, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4464/4818 (92.6526%)
___Train Local_ResNet_18,  epoch 122, local model 33, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4240/4818 (88.0033%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0672, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 122, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5472/6080 (90.0000%)
___Train Local_ResNet_18,  epoch 122, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5334/6080 (87.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1506, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 122, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4816/5399 (89.2017%)
___Train Local_ResNet_18,  epoch 122, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4694/5399 (86.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2191, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 122, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5590/6235 (89.6552%)
___Train Local_ResNet_18,  epoch 122, local model 38, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5423/6235 (86.9767%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2234, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 122, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5349/5696 (93.9080%)
___Train Local_ResNet_18,  epoch 122, local model 22, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5253/5696 (92.2226%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0123, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 122, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4342/4605 (94.2888%)
___Train Local_ResNet_18,  epoch 122, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4349/4605 (94.4408%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7921, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18,  epoch 122, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4133/4485 (92.1516%)
___Train Local_ResNet_18,  epoch 122, local model 61, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4076/4485 (90.8807%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0292, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 122, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5143/5615 (91.5939%)
___Train Local_ResNet_18,  epoch 122, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5090/5615 (90.6500%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2548, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 122, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3260/3552 (91.7793%)
___Train Local_ResNet_18,  epoch 122, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3308/3552 (93.1306%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7688, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 122, local model 24, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4014/4313 (93.0675%)
___Train Local_ResNet_18,  epoch 122, local model 24, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4035/4313 (93.5544%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7325, Accuracy: 5942/10000 (59.4200%)
___Train Local_ResNet_18,  epoch 122, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3617/3995 (90.5382%)
___Train Local_ResNet_18,  epoch 122, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3581/3995 (89.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2065, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 122, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4323/4549 (95.0319%)
___Train Local_ResNet_18,  epoch 122, local model 23, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3987/4549 (87.6456%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1770, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 122, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5007/5346 (93.6588%)
___Train Local_ResNet_18,  epoch 122, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4999/5346 (93.5092%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0375, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 122, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4864/5361 (90.7293%)
___Train Local_ResNet_18,  epoch 122, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4810/5361 (89.7221%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1858, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3861/4161 (92.7902%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3814/4161 (91.6607%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1259, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 122, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4379/4714 (92.8935%)
___Train Local_ResNet_18,  epoch 122, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4405/4714 (93.4451%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1413, Accuracy: 5381/10000 (53.8100%)
time spent on training: 306.37890625
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.2201, Accuracy: 6827/10000 (68.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1122, Accuracy: 9597/9900 (96.9394%)
Done in 333.2600908279419 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 9, 53, 69, 0, 77, 5, 33, 81, 92, 66, 83, 47, 17, 1, 84, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5176/5308 (97.5132%), train_poison_data_count: 415
Global model norm: 43.55142154234893.
Norm before scaling: 43.51695324498905. Distance: 1.2481162659363843
Total norm for 4 adversaries is: 43.51695324498905. distance: 1.2481162659363843
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0962, Accuracy: 9646/9900 (97.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5611/5777 (97.1265%), train_poison_data_count: 455
Global model norm: 43.55142154234893.
Norm before scaling: 43.51464737456587. Distance: 1.3865155998037475
Total norm for 4 adversaries is: 43.51464737456587. distance: 1.3865155998037475
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0385, Accuracy: 9794/9900 (98.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4946/5123 (96.5450%), train_poison_data_count: 403
Global model norm: 43.55142154234893.
Norm before scaling: 43.520749810435255. Distance: 1.3430831052726269
Total norm for 4 adversaries is: 43.520749810435255. distance: 1.3430831052726269
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0794, Accuracy: 9694/9900 (97.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5340/5503 (97.0380%), train_poison_data_count: 430
Global model norm: 43.55142154234893.
Norm before scaling: 43.51975547048647. Distance: 1.3646474294193311
Total norm for 4 adversaries is: 43.51975547048647. distance: 1.3646474294193311
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0479, Accuracy: 9772/9900 (98.7071%)
___Train Local_ResNet_18,  epoch 123, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5161/5727 (90.1170%)
___Train Local_ResNet_18,  epoch 123, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5071/5727 (88.5455%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9893, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 123, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5854/6664 (87.8451%)
___Train Local_ResNet_18,  epoch 123, local model 53, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5737/6664 (86.0894%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2368, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch 123, local model 69, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4053/4364 (92.8735%)
___Train Local_ResNet_18,  epoch 123, local model 69, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3944/4364 (90.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9301, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 123, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4989/5454 (91.4741%)
___Train Local_ResNet_18,  epoch 123, local model 0, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4829/5454 (88.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1786, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 123, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4494/5050 (88.9901%)
___Train Local_ResNet_18,  epoch 123, local model 77, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4423/5050 (87.5842%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1295, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 123, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4723/4993 (94.5924%)
___Train Local_ResNet_18,  epoch 123, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4657/4993 (93.2706%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0575, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 123, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4430/4818 (91.9469%)
___Train Local_ResNet_18,  epoch 123, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4306/4818 (89.3732%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9992, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 123, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4692/5035 (93.1877%)
___Train Local_ResNet_18,  epoch 123, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4689/5035 (93.1281%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9569, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 123, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6382/6812 (93.6876%)
___Train Local_ResNet_18,  epoch 123, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 6302/6812 (92.5132%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0634, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 123, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4472/4843 (92.3395%)
___Train Local_ResNet_18,  epoch 123, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4450/4843 (91.8852%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0712, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 123, local model 83, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3330/3552 (93.7500%)
___Train Local_ResNet_18,  epoch 123, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3329/3552 (93.7218%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8117, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 123, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4627/5123 (90.3182%)
___Train Local_ResNet_18,  epoch 123, local model 47, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4406/5123 (86.0043%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2738, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 123, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4488/4903 (91.5358%)
___Train Local_ResNet_18,  epoch 123, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4427/4903 (90.2917%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1742, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5128/5422 (94.5776%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5091/5422 (93.8952%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9488, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 123, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4747/5209 (91.1307%)
___Train Local_ResNet_18,  epoch 123, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4720/5209 (90.6124%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1288, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5298/5696 (93.0126%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5268/5696 (92.4860%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1041, Accuracy: 5405/10000 (54.0500%)
time spent on training: 309.9820110797882
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.2212, Accuracy: 6829/10000 (68.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1135, Accuracy: 9596/9900 (96.9293%)
Done in 336.5633752346039 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 33, 99, 27, 61, 22, 75, 85, 54, 11, 37, 60, 21, 32, 64, 29, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5142/5308 (96.8726%), train_poison_data_count: 415
Global model norm: 43.572859858069194.
Norm before scaling: 43.54110704758995. Distance: 1.3174422627488767
Total norm for 4 adversaries is: 43.54110704758995. distance: 1.3174422627488767
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1042, Accuracy: 9635/9900 (97.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5616/5777 (97.2131%), train_poison_data_count: 455
Global model norm: 43.572859858069194.
Norm before scaling: 43.53632390341929. Distance: 1.3556359707365115
Total norm for 4 adversaries is: 43.53632390341929. distance: 1.3556359707365115
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0959, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4949/5123 (96.6036%), train_poison_data_count: 403
Global model norm: 43.572859858069194.
Norm before scaling: 43.542025205361945. Distance: 1.3390754298472805
Total norm for 4 adversaries is: 43.542025205361945. distance: 1.3390754298472805
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1426, Accuracy: 9518/9900 (96.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5316/5503 (96.6019%), train_poison_data_count: 430
Global model norm: 43.572859858069194.
Norm before scaling: 43.54428196890494. Distance: 1.4378073819787995
Total norm for 4 adversaries is: 43.54428196890494. distance: 1.4378073819787995
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0296, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 124, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4437/4818 (92.0922%)
___Train Local_ResNet_18,  epoch 124, local model 33, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4285/4818 (88.9373%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9645, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 124, local model 99, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4454/4851 (91.8161%)
___Train Local_ResNet_18,  epoch 124, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4415/4851 (91.0122%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0452, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 124, local model 27, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4246/4587 (92.5659%)
___Train Local_ResNet_18,  epoch 124, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4202/4587 (91.6067%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0362, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 124, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4144/4485 (92.3969%)
___Train Local_ResNet_18,  epoch 124, local model 61, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3915/4485 (87.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2045, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 124, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5322/5696 (93.4340%)
___Train Local_ResNet_18,  epoch 124, local model 22, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5240/5696 (91.9944%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0772, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 124, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4350/4672 (93.1079%)
___Train Local_ResNet_18,  epoch 124, local model 75, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4344/4672 (92.9795%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8883, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 124, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6273/6947 (90.2980%)
___Train Local_ResNet_18,  epoch 124, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 6022/6947 (86.6849%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3306, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch 124, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5064/5645 (89.7077%)
___Train Local_ResNet_18,  epoch 124, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4947/5645 (87.6351%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3532, Accuracy: 4908/10000 (49.0800%)
___Train Local_ResNet_18,  epoch 124, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4907/5702 (86.0575%)
___Train Local_ResNet_18,  epoch 124, local model 11, internal_epoch   2,  Average loss: 0.0120, Accuracy: 4391/5702 (77.0081%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2055, Accuracy: 4968/10000 (49.6800%)
___Train Local_ResNet_18,  epoch 124, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4342/4741 (91.5841%)
___Train Local_ResNet_18,  epoch 124, local model 37, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4120/4741 (86.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2092, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 124, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3817/4145 (92.0869%)
___Train Local_ResNet_18,  epoch 124, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3760/4145 (90.7117%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0293, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4670/5038 (92.6955%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4588/5038 (91.0679%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0970, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 124, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5393/6080 (88.7007%)
___Train Local_ResNet_18,  epoch 124, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5290/6080 (87.0066%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1875, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch 124, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4401/4894 (89.9264%)
___Train Local_ResNet_18,  epoch 124, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4319/4894 (88.2509%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1452, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 124, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4444/4732 (93.9138%)
___Train Local_ResNet_18,  epoch 124, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4489/4732 (94.8648%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8687, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 124, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3949/4249 (92.9395%)
___Train Local_ResNet_18,  epoch 124, local model 18, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3918/4249 (92.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9634, Accuracy: 5611/10000 (56.1100%)
time spent on training: 313.0695583820343
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.2250, Accuracy: 6825/10000 (68.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1198, Accuracy: 9578/9900 (96.7475%)
Done in 339.5800371170044 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 53, 50, 93, 1, 7, 79, 52, 24, 16, 28, 10, 62, 86, 47, 98, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5163/5308 (97.2683%), train_poison_data_count: 415
Global model norm: 43.59454384357849.
Norm before scaling: 43.56387445150583. Distance: 1.3148744086568769
Total norm for 4 adversaries is: 43.56387445150583. distance: 1.3148744086568769
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0741, Accuracy: 9695/9900 (97.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5611/5777 (97.1265%), train_poison_data_count: 455
Global model norm: 43.59454384357849.
Norm before scaling: 43.55816900323133. Distance: 1.3990159356857277
Total norm for 4 adversaries is: 43.55816900323133. distance: 1.3990159356857277
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0706, Accuracy: 9722/9900 (98.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4943/5123 (96.4864%), train_poison_data_count: 403
Global model norm: 43.59454384357849.
Norm before scaling: 43.56428635819067. Distance: 1.3297941153936697
Total norm for 4 adversaries is: 43.56428635819067. distance: 1.3297941153936697
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0380, Accuracy: 9790/9900 (98.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5334/5503 (96.9289%), train_poison_data_count: 430
Global model norm: 43.59454384357849.
Norm before scaling: 43.56390107144332. Distance: 1.3678250815231452
Total norm for 4 adversaries is: 43.56390107144332. distance: 1.3678250815231452
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0574, Accuracy: 9750/9900 (98.4848%)
___Train Local_ResNet_18,  epoch 125, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5859/6664 (87.9202%)
___Train Local_ResNet_18,  epoch 125, local model 53, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5715/6664 (85.7593%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2372, Accuracy: 4983/10000 (49.8300%)
___Train Local_ResNet_18,  epoch 125, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4433/4757 (93.1890%)
___Train Local_ResNet_18,  epoch 125, local model 50, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4341/4757 (91.2550%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0705, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 125, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4633/5055 (91.6518%)
___Train Local_ResNet_18,  epoch 125, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4564/5055 (90.2868%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0859, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 125, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5132/5422 (94.6514%)
___Train Local_ResNet_18,  epoch 125, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5055/5422 (93.2313%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9441, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 125, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4397/4869 (90.3060%)
___Train Local_ResNet_18,  epoch 125, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4141/4869 (85.0483%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3086, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch 125, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3819/4111 (92.8971%)
___Train Local_ResNet_18,  epoch 125, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3781/4111 (91.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1624, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 125, local model 52, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3880/4130 (93.9467%)
___Train Local_ResNet_18,  epoch 125, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3793/4130 (91.8402%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0766, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4032/4313 (93.4848%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4042/4313 (93.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.7533, Accuracy: 5942/10000 (59.4200%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4939/5353 (92.2660%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4819/5353 (90.0243%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3809, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 125, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4653/5122 (90.8434%)
___Train Local_ResNet_18,  epoch 125, local model 28, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4246/5122 (82.8973%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.4123, Accuracy: 4821/10000 (48.2100%)
___Train Local_ResNet_18,  epoch 125, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4709/5068 (92.9163%)
___Train Local_ResNet_18,  epoch 125, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4708/5068 (92.8966%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0593, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 125, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4905/5504 (89.1170%)
___Train Local_ResNet_18,  epoch 125, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4819/5504 (87.5545%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3400, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 125, local model 86, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3590/3929 (91.3719%)
___Train Local_ResNet_18,  epoch 125, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3592/3929 (91.4228%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9542, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4687/5123 (91.4894%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4320/5123 (84.3256%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3124, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 125, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3919/4161 (94.1841%)
___Train Local_ResNet_18,  epoch 125, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3815/4161 (91.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9693, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 125, local model 0, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4988/5454 (91.4558%)
___Train Local_ResNet_18,  epoch 125, local model 0, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4867/5454 (89.2373%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1587, Accuracy: 5314/10000 (53.1400%)
time spent on training: 314.47504711151123
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.2302, Accuracy: 6815/10000 (68.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1111, Accuracy: 9608/9900 (97.0505%)
Done in 340.75878834724426 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 2, 78, 57, 41, 70, 21, 35, 39, 46, 53, 29, 48, 56, 65, 45, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5172/5308 (97.4378%), train_poison_data_count: 415
Global model norm: 43.61533403840042.
Norm before scaling: 43.58053955304334. Distance: 1.216853843077924
Total norm for 4 adversaries is: 43.58053955304334. distance: 1.216853843077924
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1185, Accuracy: 9582/9900 (96.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5625/5777 (97.3689%), train_poison_data_count: 455
Global model norm: 43.61533403840042.
Norm before scaling: 43.577837877774094. Distance: 1.3375854144051764
Total norm for 4 adversaries is: 43.577837877774094. distance: 1.3375854144051764
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0755, Accuracy: 9708/9900 (98.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4946/5123 (96.5450%), train_poison_data_count: 403
Global model norm: 43.61533403840042.
Norm before scaling: 43.58576175690506. Distance: 1.3512032091930397
Total norm for 4 adversaries is: 43.58576175690506. distance: 1.3512032091930397
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1843, Accuracy: 9440/9900 (95.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5326/5503 (96.7836%), train_poison_data_count: 430
Global model norm: 43.61533403840042.
Norm before scaling: 43.584098113858424. Distance: 1.3754203760666601
Total norm for 4 adversaries is: 43.584098113858424. distance: 1.3754203760666601
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0866, Accuracy: 9668/9900 (97.6566%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3702/3968 (93.2964%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3690/3968 (92.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9030, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 126, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4111/4368 (94.1163%)
___Train Local_ResNet_18,  epoch 126, local model 78, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3974/4368 (90.9799%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1804, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 126, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4594/4956 (92.6957%)
___Train Local_ResNet_18,  epoch 126, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4522/4956 (91.2429%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1120, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 126, local model 41, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4396/4714 (93.2541%)
___Train Local_ResNet_18,  epoch 126, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4366/4714 (92.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0018, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5463/5871 (93.0506%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5365/5871 (91.3814%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0621, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 126, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4660/5038 (92.4970%)
___Train Local_ResNet_18,  epoch 126, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4643/5038 (92.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9007, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 126, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5127/5615 (91.3090%)
___Train Local_ResNet_18,  epoch 126, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5108/5615 (90.9706%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1230, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 126, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3810/4175 (91.2575%)
___Train Local_ResNet_18,  epoch 126, local model 39, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3749/4175 (89.7964%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0877, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 126, local model 46, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4866/5399 (90.1278%)
___Train Local_ResNet_18,  epoch 126, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4754/5399 (88.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2659, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 126, local model 53, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5879/6664 (88.2203%)
___Train Local_ResNet_18,  epoch 126, local model 53, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5748/6664 (86.2545%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2656, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch 126, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4444/4732 (93.9138%)
___Train Local_ResNet_18,  epoch 126, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4436/4732 (93.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8933, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 126, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4527/4830 (93.7267%)
___Train Local_ResNet_18,  epoch 126, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4478/4830 (92.7122%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0724, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 126, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4917/5427 (90.6025%)
___Train Local_ResNet_18,  epoch 126, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4853/5427 (89.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0386, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 126, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5068/5497 (92.1957%)
___Train Local_ResNet_18,  epoch 126, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5005/5497 (91.0497%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1970, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 126, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5028/5489 (91.6014%)
___Train Local_ResNet_18,  epoch 126, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4987/5489 (90.8544%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0911, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 126, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4633/5055 (91.6518%)
___Train Local_ResNet_18,  epoch 126, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4581/5055 (90.6231%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1406, Accuracy: 5347/10000 (53.4700%)
time spent on training: 310.8217282295227
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.2348, Accuracy: 6816/10000 (68.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1147, Accuracy: 9594/9900 (96.9091%)
Done in 337.13755893707275 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 55, 61, 17, 94, 19, 54, 21, 96, 8, 84, 97, 57, 90, 95, 73, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5170/5308 (97.4002%), train_poison_data_count: 415
Global model norm: 43.635918505161115.
Norm before scaling: 43.60214412911652. Distance: 1.2872601480119192
Total norm for 4 adversaries is: 43.60214412911652. distance: 1.2872601480119192
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0630, Accuracy: 9719/9900 (98.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5619/5777 (97.2650%), train_poison_data_count: 455
Global model norm: 43.635918505161115.
Norm before scaling: 43.59862763931051. Distance: 1.356615488405485
Total norm for 4 adversaries is: 43.59862763931051. distance: 1.356615488405485
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0455, Accuracy: 9788/9900 (98.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4946/5123 (96.5450%), train_poison_data_count: 403
Global model norm: 43.635918505161115.
Norm before scaling: 43.60646795891135. Distance: 1.3695840811236577
Total norm for 4 adversaries is: 43.60646795891135. distance: 1.3695840811236577
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0180, Accuracy: 9841/9900 (99.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5311/5503 (96.5110%), train_poison_data_count: 430
Global model norm: 43.635918505161115.
Norm before scaling: 43.6044187773907. Distance: 1.3956719442792704
Total norm for 4 adversaries is: 43.6044187773907. distance: 1.3956719442792704
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0331, Accuracy: 9820/9900 (99.1919%)
___Train Local_ResNet_18,  epoch 127, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4453/4731 (94.1239%)
___Train Local_ResNet_18,  epoch 127, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4356/4731 (92.0736%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0229, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 127, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4110/4485 (91.6388%)
___Train Local_ResNet_18,  epoch 127, local model 61, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3855/4485 (85.9532%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2514, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 127, local model 17, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4424/4903 (90.2305%)
___Train Local_ResNet_18,  epoch 127, local model 17, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4363/4903 (88.9863%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2030, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch 127, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4755/5224 (91.0222%)
___Train Local_ResNet_18,  epoch 127, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4751/5224 (90.9456%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2219, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4847/5361 (90.4122%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4767/5361 (88.9200%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9555, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 127, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5083/5645 (90.0443%)
___Train Local_ResNet_18,  epoch 127, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4911/5645 (86.9973%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.3990, Accuracy: 4917/10000 (49.1700%)
___Train Local_ResNet_18,  epoch 127, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4674/5038 (92.7749%)
___Train Local_ResNet_18,  epoch 127, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4640/5038 (92.1000%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9598, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 127, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4659/5086 (91.6044%)
___Train Local_ResNet_18,  epoch 127, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4614/5086 (90.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2147, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 127, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4490/4889 (91.8388%)
___Train Local_ResNet_18,  epoch 127, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4484/4889 (91.7161%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0833, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 127, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4804/5209 (92.2250%)
___Train Local_ResNet_18,  epoch 127, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4713/5209 (90.4780%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1699, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 127, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4264/4736 (90.0338%)
___Train Local_ResNet_18,  epoch 127, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4267/4736 (90.0971%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0133, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4587/4956 (92.5545%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4475/4956 (90.2946%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1397, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 127, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4431/4748 (93.3235%)
___Train Local_ResNet_18,  epoch 127, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4403/4748 (92.7338%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9734, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 127, local model 95, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4534/5018 (90.3547%)
___Train Local_ResNet_18,  epoch 127, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4387/5018 (87.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1524, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 127, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4350/4605 (94.4625%)
___Train Local_ResNet_18,  epoch 127, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4336/4605 (94.1585%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9528, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 127, local model 16, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4944/5353 (92.3594%)
___Train Local_ResNet_18,  epoch 127, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4841/5353 (90.4353%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0762, Accuracy: 5412/10000 (54.1200%)
time spent on training: 309.9560239315033
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.2386, Accuracy: 6804/10000 (68.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1016, Accuracy: 9630/9900 (97.2727%)
Done in 336.48570561408997 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 10, 72, 34, 67, 60, 23, 86, 20, 99, 97, 64, 73, 68, 40, 30, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5176/5308 (97.5132%), train_poison_data_count: 415
Global model norm: 43.65703012456155.
Norm before scaling: 43.62367084740949. Distance: 1.2590772537120685
Total norm for 4 adversaries is: 43.62367084740949. distance: 1.2590772537120685
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0945, Accuracy: 9666/9900 (97.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5618/5777 (97.2477%), train_poison_data_count: 455
Global model norm: 43.65703012456155.
Norm before scaling: 43.62024844288201. Distance: 1.393041247472606
Total norm for 4 adversaries is: 43.62024844288201. distance: 1.393041247472606
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0888, Accuracy: 9672/9900 (97.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4944/5123 (96.5060%), train_poison_data_count: 403
Global model norm: 43.65703012456155.
Norm before scaling: 43.62681317865196. Distance: 1.3389589374248654
Total norm for 4 adversaries is: 43.62681317865196. distance: 1.3389589374248654
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0989, Accuracy: 9654/9900 (97.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5344/5503 (97.1107%), train_poison_data_count: 430
Global model norm: 43.65703012456155.
Norm before scaling: 43.623351844761714. Distance: 1.3470089892233998
Total norm for 4 adversaries is: 43.623351844761714. distance: 1.3470089892233998
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0743, Accuracy: 9697/9900 (97.9495%)
___Train Local_ResNet_18,  epoch 128, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4750/5068 (93.7253%)
___Train Local_ResNet_18,  epoch 128, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4589/5068 (90.5485%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2125, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4730/5193 (91.0842%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4600/5193 (88.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2901, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 128, local model 34, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4535/4911 (92.3437%)
___Train Local_ResNet_18,  epoch 128, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4468/4911 (90.9794%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0057, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 128, local model 67, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5046/5559 (90.7717%)
___Train Local_ResNet_18,  epoch 128, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4951/5559 (89.0628%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0860, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 128, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3788/4145 (91.3872%)
___Train Local_ResNet_18,  epoch 128, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3798/4145 (91.6285%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9607, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 128, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4281/4549 (94.1086%)
___Train Local_ResNet_18,  epoch 128, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4082/4549 (89.7340%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1428, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3577/3929 (91.0410%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3556/3929 (90.5065%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0297, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4415/4714 (93.6572%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4411/4714 (93.5723%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0245, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4459/4851 (91.9192%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4467/4851 (92.0841%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9884, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4302/4736 (90.8361%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4255/4736 (89.8438%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9712, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 128, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4453/4894 (90.9890%)
___Train Local_ResNet_18,  epoch 128, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4325/4894 (88.3735%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.5180, Accuracy: 4796/10000 (47.9600%)
___Train Local_ResNet_18,  epoch 128, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4334/4605 (94.1151%)
___Train Local_ResNet_18,  epoch 128, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4317/4605 (93.7459%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1120, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 128, local model 68, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3348/3589 (93.2850%)
___Train Local_ResNet_18,  epoch 128, local model 68, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3023/3589 (84.2296%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.4827, Accuracy: 4948/10000 (49.4800%)
___Train Local_ResNet_18,  epoch 128, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5504/5939 (92.6755%)
___Train Local_ResNet_18,  epoch 128, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5460/5939 (91.9347%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0499, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 128, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3514/3774 (93.1108%)
___Train Local_ResNet_18,  epoch 128, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3525/3774 (93.4022%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0132, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 128, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3272/3552 (92.1171%)
___Train Local_ResNet_18,  epoch 128, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3314/3552 (93.2995%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9219, Accuracy: 5699/10000 (56.9900%)
time spent on training: 296.55710530281067
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.2437, Accuracy: 6795/10000 (67.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0995, Accuracy: 9639/9900 (97.3636%)
Done in 323.290504693985 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 37, 33, 25, 48, 65, 95, 38, 74, 43, 26, 15, 14, 49, 79, 8, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5174/5308 (97.4755%), train_poison_data_count: 415
Global model norm: 43.675904051622815.
Norm before scaling: 43.6416683324979. Distance: 1.2515563336052593
Total norm for 4 adversaries is: 43.6416683324979. distance: 1.2515563336052593
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0870, Accuracy: 9674/9900 (97.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5615/5777 (97.1958%), train_poison_data_count: 455
Global model norm: 43.675904051622815.
Norm before scaling: 43.639963463926186. Distance: 1.375400051527756
Total norm for 4 adversaries is: 43.639963463926186. distance: 1.375400051527756
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0322, Accuracy: 9820/9900 (99.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4928/5123 (96.1936%), train_poison_data_count: 403
Global model norm: 43.675904051622815.
Norm before scaling: 43.6459351070313. Distance: 1.3412225151978856
Total norm for 4 adversaries is: 43.6459351070313. distance: 1.3412225151978856
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1162, Accuracy: 9589/9900 (96.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5345/5503 (97.1288%), train_poison_data_count: 430
Global model norm: 43.675904051622815.
Norm before scaling: 43.6430011325019. Distance: 1.341220470931764
Total norm for 4 adversaries is: 43.6430011325019. distance: 1.341220470931764
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0817, Accuracy: 9687/9900 (97.8485%)
___Train Local_ResNet_18,  epoch 129, local model 37, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4355/4741 (91.8583%)
___Train Local_ResNet_18,  epoch 129, local model 37, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4216/4741 (88.9264%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.3451, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 129, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4463/4818 (92.6318%)
___Train Local_ResNet_18,  epoch 129, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4404/4818 (91.4072%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9907, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 129, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5718/6419 (89.0793%)
___Train Local_ResNet_18,  epoch 129, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5554/6419 (86.5244%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.3295, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch 129, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4522/4830 (93.6232%)
___Train Local_ResNet_18,  epoch 129, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4559/4830 (94.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0832, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 129, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5045/5497 (91.7773%)
___Train Local_ResNet_18,  epoch 129, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4994/5497 (90.8496%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1582, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 129, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4494/5018 (89.5576%)
___Train Local_ResNet_18,  epoch 129, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4438/5018 (88.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2838, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5666/6235 (90.8741%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5492/6235 (88.0834%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.3201, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4350/4797 (90.6817%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4318/4797 (90.0146%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1122, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 129, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4619/4979 (92.7696%)
___Train Local_ResNet_18,  epoch 129, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4629/4979 (92.9705%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9787, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 129, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3811/4086 (93.2697%)
___Train Local_ResNet_18,  epoch 129, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3786/4086 (92.6579%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9916, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 129, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5601/6068 (92.3039%)
___Train Local_ResNet_18,  epoch 129, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5589/6068 (92.1061%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1427, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3969/4196 (94.5901%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3955/4196 (94.2564%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8589, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 129, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5113/5652 (90.4636%)
___Train Local_ResNet_18,  epoch 129, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5017/5652 (88.7650%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0675, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3823/4111 (92.9944%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3744/4111 (91.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0008, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 129, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4518/4889 (92.4115%)
___Train Local_ResNet_18,  epoch 129, local model 8, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4502/4889 (92.0843%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0913, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 129, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4072/4368 (93.2234%)
___Train Local_ResNet_18,  epoch 129, local model 78, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3970/4368 (90.8883%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1392, Accuracy: 5331/10000 (53.3100%)
time spent on training: 304.9090075492859
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.2454, Accuracy: 6795/10000 (67.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0963, Accuracy: 9638/9900 (97.3535%)
Done in 331.51390051841736 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 55, 3, 46, 33, 49, 20, 1, 52, 29, 54, 11, 97, 91, 79, 88, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5181/5308 (97.6074%), train_poison_data_count: 415
Global model norm: 43.696293765801094.
Norm before scaling: 43.66355578186029. Distance: 1.292547520367134
Total norm for 4 adversaries is: 43.66355578186029. distance: 1.292547520367134
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0255, Accuracy: 9828/9900 (99.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5602/5777 (96.9707%), train_poison_data_count: 455
Global model norm: 43.696293765801094.
Norm before scaling: 43.659395578335996. Distance: 1.3588359684844713
Total norm for 4 adversaries is: 43.659395578335996. distance: 1.3588359684844713
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0675, Accuracy: 9731/9900 (98.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4940/5123 (96.4279%), train_poison_data_count: 403
Global model norm: 43.696293765801094.
Norm before scaling: 43.66422394964784. Distance: 1.303471804057448
Total norm for 4 adversaries is: 43.66422394964784. distance: 1.303471804057448
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1044, Accuracy: 9640/9900 (97.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5327/5503 (96.8017%), train_poison_data_count: 430
Global model norm: 43.696293765801094.
Norm before scaling: 43.664518890753136. Distance: 1.3527922575791664
Total norm for 4 adversaries is: 43.664518890753136. distance: 1.3527922575791664
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0410, Accuracy: 9793/9900 (98.9192%)
___Train Local_ResNet_18,  epoch 130, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4425/4731 (93.5320%)
___Train Local_ResNet_18,  epoch 130, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4418/4731 (93.3841%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9861, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 130, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5005/5346 (93.6214%)
___Train Local_ResNet_18,  epoch 130, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4919/5346 (92.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1506, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 130, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4859/5399 (89.9981%)
___Train Local_ResNet_18,  epoch 130, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4713/5399 (87.2939%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2968, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch 130, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4499/4818 (93.3790%)
___Train Local_ResNet_18,  epoch 130, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4368/4818 (90.6600%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2773, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5157/5652 (91.2420%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5012/5652 (88.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1665, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 130, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4447/4714 (94.3360%)
___Train Local_ResNet_18,  epoch 130, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4413/4714 (93.6148%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9295, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 130, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5114/5422 (94.3194%)
___Train Local_ResNet_18,  epoch 130, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5002/5422 (92.2538%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0690, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 130, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3862/4130 (93.5109%)
___Train Local_ResNet_18,  epoch 130, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3831/4130 (92.7603%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0158, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 130, local model 29, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4421/4732 (93.4277%)
___Train Local_ResNet_18,  epoch 130, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4420/4732 (93.4066%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8263, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 130, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5109/5645 (90.5049%)
___Train Local_ResNet_18,  epoch 130, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4854/5645 (85.9876%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2321, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 130, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4991/5702 (87.5307%)
___Train Local_ResNet_18,  epoch 130, local model 11, internal_epoch   2,  Average loss: 0.0129, Accuracy: 4317/5702 (75.7103%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.4236, Accuracy: 4682/10000 (46.8200%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4334/4736 (91.5118%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4322/4736 (91.2584%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0670, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 130, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4088/4527 (90.3026%)
___Train Local_ResNet_18,  epoch 130, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4069/4527 (89.8829%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0417, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 130, local model 79, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3831/4111 (93.1890%)
___Train Local_ResNet_18,  epoch 130, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3724/4111 (90.5862%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0886, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 130, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4936/5362 (92.0552%)
___Train Local_ResNet_18,  epoch 130, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4844/5362 (90.3394%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2492, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 130, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5512/5939 (92.8102%)
___Train Local_ResNet_18,  epoch 130, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5401/5939 (90.9412%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1851, Accuracy: 5190/10000 (51.9000%)
time spent on training: 306.7307164669037
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.2473, Accuracy: 6796/10000 (67.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0933, Accuracy: 9647/9900 (97.4444%)
Done in 333.2982783317566 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 44, 96, 65, 90, 49, 43, 69, 8, 56, 63, 2, 72, 42, 7, 64, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5163/5308 (97.2683%), train_poison_data_count: 415
Global model norm: 43.71705372200662.
Norm before scaling: 43.68366203858786. Distance: 1.2625303699126538
Total norm for 4 adversaries is: 43.68366203858786. distance: 1.2625303699126538
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1138, Accuracy: 9625/9900 (97.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5636/5777 (97.5593%), train_poison_data_count: 455
Global model norm: 43.71705372200662.
Norm before scaling: 43.67602283522534. Distance: 1.289796839692226
Total norm for 4 adversaries is: 43.67602283522534. distance: 1.289796839692226
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0583, Accuracy: 9751/9900 (98.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4973/5123 (97.0720%), train_poison_data_count: 403
Global model norm: 43.71705372200662.
Norm before scaling: 43.684915316066196. Distance: 1.2943169517155015
Total norm for 4 adversaries is: 43.684915316066196. distance: 1.2943169517155015
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0777, Accuracy: 9685/9900 (97.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5366/5503 (97.5104%), train_poison_data_count: 430
Global model norm: 43.71705372200662.
Norm before scaling: 43.68233467094779. Distance: 1.3148722327644131
Total norm for 4 adversaries is: 43.68233467094779. distance: 1.3148722327644131
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0523, Accuracy: 9760/9900 (98.5859%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4741/5075 (93.4187%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4616/5075 (90.9557%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1402, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 131, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4664/5086 (91.7027%)
___Train Local_ResNet_18,  epoch 131, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4641/5086 (91.2505%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1043, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5042/5497 (91.7228%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4969/5497 (90.3948%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9262, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 131, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4425/4748 (93.1971%)
___Train Local_ResNet_18,  epoch 131, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4278/4748 (90.1011%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2143, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch 131, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5094/5652 (90.1274%)
___Train Local_ResNet_18,  epoch 131, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4943/5652 (87.4558%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3145, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch 131, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4615/4979 (92.6893%)
___Train Local_ResNet_18,  epoch 131, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4573/4979 (91.8458%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0203, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 131, local model 69, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4026/4364 (92.2548%)
___Train Local_ResNet_18,  epoch 131, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4017/4364 (92.0486%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1223, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 131, local model 8, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4509/4889 (92.2274%)
___Train Local_ResNet_18,  epoch 131, local model 8, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4509/4889 (92.2274%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9673, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 131, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4948/5427 (91.1738%)
___Train Local_ResNet_18,  epoch 131, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4858/5427 (89.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0166, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 131, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3666/3910 (93.7596%)
___Train Local_ResNet_18,  epoch 131, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3607/3910 (92.2506%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1345, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 131, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3688/3968 (92.9435%)
___Train Local_ResNet_18,  epoch 131, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3694/3968 (93.0948%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9121, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 131, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4803/5193 (92.4899%)
___Train Local_ResNet_18,  epoch 131, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4564/5193 (87.8875%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3617, Accuracy: 4981/10000 (49.8100%)
___Train Local_ResNet_18,  epoch 131, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5398/5907 (91.3831%)
___Train Local_ResNet_18,  epoch 131, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5362/5907 (90.7737%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2356, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4493/4869 (92.2777%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0109, Accuracy: 3880/4869 (79.6878%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3960, Accuracy: 4980/10000 (49.8000%)
___Train Local_ResNet_18,  epoch 131, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4446/4894 (90.8459%)
___Train Local_ResNet_18,  epoch 131, local model 64, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4304/4894 (87.9444%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1187, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5172/5727 (90.3091%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5023/5727 (87.7074%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1587, Accuracy: 5243/10000 (52.4300%)
time spent on training: 298.0741391181946
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.2501, Accuracy: 6787/10000 (67.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0940, Accuracy: 9646/9900 (97.4343%)
Done in 325.11297249794006 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 66, 50, 48, 43, 31, 92, 4, 61, 56, 47, 18, 87, 89, 21, 97, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5165/5308 (97.3060%), train_poison_data_count: 415
Global model norm: 43.73837596695335.
Norm before scaling: 43.70486790410909. Distance: 1.273588019526505
Total norm for 4 adversaries is: 43.70486790410909. distance: 1.273588019526505
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0419, Accuracy: 9787/9900 (98.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5625/5777 (97.3689%), train_poison_data_count: 455
Global model norm: 43.73837596695335.
Norm before scaling: 43.69815287232545. Distance: 1.293162766389553
Total norm for 4 adversaries is: 43.69815287232545. distance: 1.293162766389553
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0887, Accuracy: 9677/9900 (97.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4955/5123 (96.7207%), train_poison_data_count: 403
Global model norm: 43.73837596695335.
Norm before scaling: 43.705398582261836. Distance: 1.2934026537503291
Total norm for 4 adversaries is: 43.705398582261836. distance: 1.2934026537503291
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0450, Accuracy: 9779/9900 (98.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5363/5503 (97.4559%), train_poison_data_count: 430
Global model norm: 43.73837596695335.
Norm before scaling: 43.704633286450594. Distance: 1.3157286668831432
Total norm for 4 adversaries is: 43.704633286450594. distance: 1.3157286668831432
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0474, Accuracy: 9776/9900 (98.7475%)
___Train Local_ResNet_18,  epoch 132, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4517/4843 (93.2686%)
___Train Local_ResNet_18,  epoch 132, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4407/4843 (90.9973%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0352, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4440/4757 (93.3361%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4364/4757 (91.7385%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9714, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 132, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4515/4830 (93.4783%)
___Train Local_ResNet_18,  epoch 132, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4512/4830 (93.4161%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0190, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 132, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4581/4979 (92.0064%)
___Train Local_ResNet_18,  epoch 132, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4571/4979 (91.8056%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9513, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 132, local model 31, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4204/4537 (92.6603%)
___Train Local_ResNet_18,  epoch 132, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4189/4537 (92.3297%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0345, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 132, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6327/6812 (92.8802%)
___Train Local_ResNet_18,  epoch 132, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6215/6812 (91.2361%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1807, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 132, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3762/4028 (93.3962%)
___Train Local_ResNet_18,  epoch 132, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3730/4028 (92.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9408, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 132, local model 61, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4178/4485 (93.1550%)
___Train Local_ResNet_18,  epoch 132, local model 61, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3985/4485 (88.8517%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1428, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 132, local model 56, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4975/5427 (91.6713%)
___Train Local_ResNet_18,  epoch 132, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4929/5427 (90.8237%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1214, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 132, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4635/5123 (90.4743%)
___Train Local_ResNet_18,  epoch 132, local model 47, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4234/5123 (82.6469%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.4470, Accuracy: 4837/10000 (48.3700%)
___Train Local_ResNet_18,  epoch 132, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3983/4249 (93.7397%)
___Train Local_ResNet_18,  epoch 132, local model 18, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3893/4249 (91.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0665, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 132, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3636/3995 (91.0138%)
___Train Local_ResNet_18,  epoch 132, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3572/3995 (89.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1118, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 132, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4408/4737 (93.0547%)
___Train Local_ResNet_18,  epoch 132, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4300/4737 (90.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1658, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 132, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4695/5038 (93.1917%)
___Train Local_ResNet_18,  epoch 132, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4629/5038 (91.8817%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8309, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 132, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4333/4736 (91.4907%)
___Train Local_ResNet_18,  epoch 132, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4252/4736 (89.7804%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0747, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5491/5871 (93.5275%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5424/5871 (92.3863%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0596, Accuracy: 5508/10000 (55.0800%)
time spent on training: 303.1845648288727
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.2521, Accuracy: 6800/10000 (68.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0866, Accuracy: 9668/9900 (97.6566%)
Done in 329.78734517097473 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 14, 60, 82, 89, 72, 33, 79, 92, 81, 56, 75, 19, 78, 66, 16, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5203/5308 (98.0219%), train_poison_data_count: 415
Global model norm: 43.75839902637621.
Norm before scaling: 43.72123915135169. Distance: 1.1769283440200184
Total norm for 4 adversaries is: 43.72123915135169. distance: 1.1769283440200184
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0733, Accuracy: 9699/9900 (97.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5618/5777 (97.2477%), train_poison_data_count: 455
Global model norm: 43.75839902637621.
Norm before scaling: 43.72120145914622. Distance: 1.3847362262311467
Total norm for 4 adversaries is: 43.72120145914622. distance: 1.3847362262311467
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0513, Accuracy: 9776/9900 (98.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4950/5123 (96.6231%), train_poison_data_count: 403
Global model norm: 43.75839902637621.
Norm before scaling: 43.726766989650486. Distance: 1.315427875021951
Total norm for 4 adversaries is: 43.726766989650486. distance: 1.315427875021951
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0527, Accuracy: 9770/9900 (98.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5353/5503 (97.2742%), train_poison_data_count: 430
Global model norm: 43.75839902637621.
Norm before scaling: 43.72273145737523. Distance: 1.2690028103165287
Total norm for 4 adversaries is: 43.72273145737523. distance: 1.2690028103165287
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0148, Accuracy: 9862/9900 (99.6162%)
___Train Local_ResNet_18,  epoch 133, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3979/4196 (94.8284%)
___Train Local_ResNet_18,  epoch 133, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3985/4196 (94.9714%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9690, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 133, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3827/4145 (92.3281%)
___Train Local_ResNet_18,  epoch 133, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3784/4145 (91.2907%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0382, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 133, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5005/5298 (94.4696%)
___Train Local_ResNet_18,  epoch 133, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4954/5298 (93.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0729, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 133, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4339/4737 (91.5981%)
___Train Local_ResNet_18,  epoch 133, local model 89, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4372/4737 (92.2947%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1339, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 133, local model 72, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4705/5193 (90.6027%)
___Train Local_ResNet_18,  epoch 133, local model 72, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4431/5193 (85.3264%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.3619, Accuracy: 4961/10000 (49.6100%)
___Train Local_ResNet_18,  epoch 133, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4506/4818 (93.5243%)
___Train Local_ResNet_18,  epoch 133, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4299/4818 (89.2279%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0750, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 133, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3859/4111 (93.8701%)
___Train Local_ResNet_18,  epoch 133, local model 79, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3865/4111 (94.0161%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9738, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 133, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 6338/6812 (93.0417%)
___Train Local_ResNet_18,  epoch 133, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6276/6812 (92.1315%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0763, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 133, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4687/5035 (93.0884%)
___Train Local_ResNet_18,  epoch 133, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4636/5035 (92.0755%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0916, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 133, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4979/5427 (91.7450%)
___Train Local_ResNet_18,  epoch 133, local model 56, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4766/5427 (87.8202%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2550, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 133, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4349/4672 (93.0865%)
___Train Local_ResNet_18,  epoch 133, local model 75, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4324/4672 (92.5514%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9857, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 133, local model 19, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4909/5361 (91.5687%)
___Train Local_ResNet_18,  epoch 133, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4814/5361 (89.7967%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0712, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4141/4368 (94.8031%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4098/4368 (93.8187%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9280, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 133, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4487/4843 (92.6492%)
___Train Local_ResNet_18,  epoch 133, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4478/4843 (92.4633%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0027, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 133, local model 16, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4972/5353 (92.8825%)
___Train Local_ResNet_18,  epoch 133, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4791/5353 (89.5012%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0163, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 133, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4432/4714 (94.0178%)
___Train Local_ResNet_18,  epoch 133, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4423/4714 (93.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8016, Accuracy: 5801/10000 (58.0100%)
time spent on training: 313.7002143859863
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.2633, Accuracy: 6782/10000 (67.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0758, Accuracy: 9695/9900 (97.9293%)
Done in 340.14415645599365 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 23, 49, 30, 9, 15, 85, 92, 17, 70, 56, 51, 53, 43, 46, 64, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5185/5308 (97.6827%), train_poison_data_count: 415
Global model norm: 43.77705218321081.
Norm before scaling: 43.73973372850622. Distance: 1.2001082013939828
Total norm for 4 adversaries is: 43.73973372850622. distance: 1.2001082013939828
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0436, Accuracy: 9776/9900 (98.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5635/5777 (97.5420%), train_poison_data_count: 455
Global model norm: 43.77705218321081.
Norm before scaling: 43.73722748825507. Distance: 1.2914248004187927
Total norm for 4 adversaries is: 43.73722748825507. distance: 1.2914248004187927
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0841, Accuracy: 9688/9900 (97.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4971/5123 (97.0330%), train_poison_data_count: 403
Global model norm: 43.77705218321081.
Norm before scaling: 43.74317748142989. Distance: 1.2659324460951606
Total norm for 4 adversaries is: 43.74317748142989. distance: 1.2659324460951606
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1514, Accuracy: 9489/9900 (95.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5346/5503 (97.1470%), train_poison_data_count: 430
Global model norm: 43.77705218321081.
Norm before scaling: 43.741962152259326. Distance: 1.3352005024334765
Total norm for 4 adversaries is: 43.741962152259326. distance: 1.3352005024334765
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0327, Accuracy: 9819/9900 (99.1818%)
___Train Local_ResNet_18,  epoch 134, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4284/4549 (94.1745%)
___Train Local_ResNet_18,  epoch 134, local model 23, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3935/4549 (86.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1480, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 134, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5067/5652 (89.6497%)
___Train Local_ResNet_18,  epoch 134, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4939/5652 (87.3850%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3078, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 134, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3545/3774 (93.9322%)
___Train Local_ResNet_18,  epoch 134, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3570/3774 (94.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.7936, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 134, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5231/5727 (91.3393%)
___Train Local_ResNet_18,  epoch 134, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5112/5727 (89.2614%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3278, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5576/6068 (91.8919%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5493/6068 (90.5241%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1867, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 134, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6279/6947 (90.3843%)
___Train Local_ResNet_18,  epoch 134, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6095/6947 (87.7357%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2137, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 134, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 6333/6812 (92.9683%)
___Train Local_ResNet_18,  epoch 134, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6207/6812 (91.1186%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0992, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 134, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4462/4903 (91.0055%)
___Train Local_ResNet_18,  epoch 134, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4465/4903 (91.0667%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1778, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 134, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5484/5871 (93.4083%)
___Train Local_ResNet_18,  epoch 134, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5394/5871 (91.8753%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1476, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 134, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4934/5427 (90.9158%)
___Train Local_ResNet_18,  epoch 134, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4875/5427 (89.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0541, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 134, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3842/4108 (93.5248%)
___Train Local_ResNet_18,  epoch 134, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3836/4108 (93.3788%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8995, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 134, local model 53, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5923/6664 (88.8806%)
___Train Local_ResNet_18,  epoch 134, local model 53, internal_epoch   2,  Average loss: 0.0082, Accuracy: 5576/6664 (83.6735%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3432, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch 134, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4622/4979 (92.8299%)
___Train Local_ResNet_18,  epoch 134, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4598/4979 (92.3479%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0726, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 134, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4868/5399 (90.1648%)
___Train Local_ResNet_18,  epoch 134, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4744/5399 (87.8681%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3409, Accuracy: 5004/10000 (50.0400%)
___Train Local_ResNet_18,  epoch 134, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4456/4894 (91.0503%)
___Train Local_ResNet_18,  epoch 134, local model 64, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4296/4894 (87.7810%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1236, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 134, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3712/3968 (93.5484%)
___Train Local_ResNet_18,  epoch 134, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3681/3968 (92.7671%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9250, Accuracy: 5623/10000 (56.2300%)
time spent on training: 305.7090976238251
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.2649, Accuracy: 6774/10000 (67.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0823, Accuracy: 9685/9900 (97.8283%)
Done in 332.5073416233063 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 49, 57, 40, 46, 85, 37, 51, 30, 8, 73, 21, 28, 82, 80, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5168/5308 (97.3625%), train_poison_data_count: 415
Global model norm: 43.7996871867397.
Norm before scaling: 43.763566534954336. Distance: 1.2645464881837651
Total norm for 4 adversaries is: 43.763566534954336. distance: 1.2645464881837651
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0408, Accuracy: 9792/9900 (98.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5627/5777 (97.4035%), train_poison_data_count: 455
Global model norm: 43.7996871867397.
Norm before scaling: 43.760846869661925. Distance: 1.3268146109079255
Total norm for 4 adversaries is: 43.760846869661925. distance: 1.3268146109079255
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0392, Accuracy: 9801/9900 (99.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4946/5123 (96.5450%), train_poison_data_count: 403
Global model norm: 43.7996871867397.
Norm before scaling: 43.76772380945732. Distance: 1.3239403716198779
Total norm for 4 adversaries is: 43.76772380945732. distance: 1.3239403716198779
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1949, Accuracy: 9417/9900 (95.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5343/5503 (97.0925%), train_poison_data_count: 430
Global model norm: 43.7996871867397.
Norm before scaling: 43.767207832409326. Distance: 1.3677438094609629
Total norm for 4 adversaries is: 43.767207832409326. distance: 1.3677438094609629
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0125, Accuracy: 9867/9900 (99.6667%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 6349/6812 (93.2032%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6196/6812 (90.9571%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2022, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5137/5652 (90.8882%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5058/5652 (89.4904%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2429, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 135, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4603/4956 (92.8773%)
___Train Local_ResNet_18,  epoch 135, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4527/4956 (91.3438%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0525, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 135, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5523/5939 (92.9955%)
___Train Local_ResNet_18,  epoch 135, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5440/5939 (91.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9863, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4814/5399 (89.1647%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4750/5399 (87.9793%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1671, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 135, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 6266/6947 (90.1972%)
___Train Local_ResNet_18,  epoch 135, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6068/6947 (87.3471%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3894, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch 135, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4388/4741 (92.5543%)
___Train Local_ResNet_18,  epoch 135, local model 37, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4141/4741 (87.3444%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.4056, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 135, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3859/4108 (93.9387%)
___Train Local_ResNet_18,  epoch 135, local model 51, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3795/4108 (92.3807%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0358, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 135, local model 30, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3536/3774 (93.6937%)
___Train Local_ResNet_18,  epoch 135, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3579/3774 (94.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8315, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 135, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4543/4889 (92.9229%)
___Train Local_ResNet_18,  epoch 135, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4468/4889 (91.3888%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1274, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 135, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4365/4605 (94.7883%)
___Train Local_ResNet_18,  epoch 135, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4321/4605 (93.8328%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0426, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 135, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4680/5038 (92.8940%)
___Train Local_ResNet_18,  epoch 135, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4650/5038 (92.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0518, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4647/5122 (90.7263%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4412/5122 (86.1382%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.5965, Accuracy: 4634/10000 (46.3400%)
___Train Local_ResNet_18,  epoch 135, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4962/5298 (93.6580%)
___Train Local_ResNet_18,  epoch 135, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4934/5298 (93.1295%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9837, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 135, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5069/5461 (92.8218%)
___Train Local_ResNet_18,  epoch 135, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4995/5461 (91.4668%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1876, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4506/4830 (93.2919%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4475/4830 (92.6501%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1170, Accuracy: 5424/10000 (54.2400%)
time spent on training: 310.1747167110443
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.2698, Accuracy: 6762/10000 (67.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0770, Accuracy: 9696/9900 (97.9394%)
Done in 336.4930703639984 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 32, 67, 70, 18, 87, 0, 98, 29, 99, 28, 40, 75, 92, 80, 64, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5155/5308 (97.1176%), train_poison_data_count: 415
Global model norm: 43.82003462538925.
Norm before scaling: 43.78668523319546. Distance: 1.31569749899697
Total norm for 4 adversaries is: 43.78668523319546. distance: 1.31569749899697
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0416, Accuracy: 9792/9900 (98.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5630/5777 (97.4554%), train_poison_data_count: 455
Global model norm: 43.82003462538925.
Norm before scaling: 43.78156645808185. Distance: 1.330215424608623
Total norm for 4 adversaries is: 43.78156645808185. distance: 1.330215424608623
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0441, Accuracy: 9788/9900 (98.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4946/5123 (96.5450%), train_poison_data_count: 403
Global model norm: 43.82003462538925.
Norm before scaling: 43.786540265228055. Distance: 1.3011782845001716
Total norm for 4 adversaries is: 43.786540265228055. distance: 1.3011782845001716
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1812, Accuracy: 9475/9900 (95.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5350/5503 (97.2197%), train_poison_data_count: 430
Global model norm: 43.82003462538925.
Norm before scaling: 43.78558123427663. Distance: 1.3187171733079026
Total norm for 4 adversaries is: 43.78558123427663. distance: 1.3187171733079026
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0459, Accuracy: 9777/9900 (98.7576%)
___Train Local_ResNet_18,  epoch 136, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5391/6080 (88.6678%)
___Train Local_ResNet_18,  epoch 136, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5289/6080 (86.9901%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1468, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5009/5559 (90.1061%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4849/5559 (87.2279%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2497, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 136, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5486/5871 (93.4423%)
___Train Local_ResNet_18,  epoch 136, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5390/5871 (91.8072%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1127, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 136, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3989/4249 (93.8809%)
___Train Local_ResNet_18,  epoch 136, local model 18, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3930/4249 (92.4924%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0609, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 136, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3652/3995 (91.4143%)
___Train Local_ResNet_18,  epoch 136, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3596/3995 (90.0125%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2691, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch 136, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5019/5454 (92.0242%)
___Train Local_ResNet_18,  epoch 136, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4842/5454 (88.7789%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1326, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 136, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3891/4161 (93.5112%)
___Train Local_ResNet_18,  epoch 136, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3848/4161 (92.4778%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0467, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 136, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4502/4732 (95.1395%)
___Train Local_ResNet_18,  epoch 136, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4479/4732 (94.6534%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8524, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 136, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4418/4851 (91.0740%)
___Train Local_ResNet_18,  epoch 136, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4408/4851 (90.8679%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0298, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4640/5122 (90.5896%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0110, Accuracy: 4157/5122 (81.1597%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.6231, Accuracy: 4663/10000 (46.6300%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5481/5939 (92.2883%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5418/5939 (91.2275%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1305, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 136, local model 75, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4398/4672 (94.1353%)
___Train Local_ResNet_18,  epoch 136, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4353/4672 (93.1721%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9278, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 6405/6812 (94.0252%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6268/6812 (92.0141%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1535, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 136, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5076/5461 (92.9500%)
___Train Local_ResNet_18,  epoch 136, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5015/5461 (91.8330%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1643, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 136, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4480/4894 (91.5407%)
___Train Local_ResNet_18,  epoch 136, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4338/4894 (88.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1485, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 136, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3835/4175 (91.8563%)
___Train Local_ResNet_18,  epoch 136, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3830/4175 (91.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0227, Accuracy: 5494/10000 (54.9400%)
time spent on training: 298.1229422092438
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.2787, Accuracy: 6753/10000 (67.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0768, Accuracy: 9693/9900 (97.9091%)
Done in 324.57999324798584 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 94, 74, 82, 63, 27, 55, 92, 11, 34, 79, 60, 59, 43, 16, 78, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5191/5308 (97.7958%), train_poison_data_count: 415
Global model norm: 43.84067055293806.
Norm before scaling: 43.802444849627825. Distance: 1.1904063046469164
Total norm for 4 adversaries is: 43.802444849627825. distance: 1.1904063046469164
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0580, Accuracy: 9741/9900 (98.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5639/5777 (97.6112%), train_poison_data_count: 455
Global model norm: 43.84067055293806.
Norm before scaling: 43.80100821114167. Distance: 1.3027949969643327
Total norm for 4 adversaries is: 43.80100821114167. distance: 1.3027949969643327
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0685, Accuracy: 9729/9900 (98.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4961/5123 (96.8378%), train_poison_data_count: 403
Global model norm: 43.84067055293806.
Norm before scaling: 43.808001451914436. Distance: 1.3176242615589402
Total norm for 4 adversaries is: 43.808001451914436. distance: 1.3176242615589402
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0522, Accuracy: 9760/9900 (98.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5350/5503 (97.2197%), train_poison_data_count: 430
Global model norm: 43.84067055293806.
Norm before scaling: 43.80733547708149. Distance: 1.3518034439090454
Total norm for 4 adversaries is: 43.80733547708149. distance: 1.3518034439090454
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0764, Accuracy: 9712/9900 (98.1010%)
___Train Local_ResNet_18,  epoch 137, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4785/5224 (91.5965%)
___Train Local_ResNet_18,  epoch 137, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4709/5224 (90.1417%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1659, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 137, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4367/4797 (91.0361%)
___Train Local_ResNet_18,  epoch 137, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4317/4797 (89.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9736, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 137, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5022/5298 (94.7905%)
___Train Local_ResNet_18,  epoch 137, local model 82, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4977/5298 (93.9411%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9338, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 137, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3678/3910 (94.0665%)
___Train Local_ResNet_18,  epoch 137, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3431/3910 (87.7494%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2262, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4231/4587 (92.2389%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4205/4587 (91.6721%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0402, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 137, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4426/4731 (93.5532%)
___Train Local_ResNet_18,  epoch 137, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4412/4731 (93.2572%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9632, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 137, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6450/6812 (94.6858%)
___Train Local_ResNet_18,  epoch 137, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 6263/6812 (91.9407%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1323, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 137, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5017/5702 (87.9867%)
___Train Local_ResNet_18,  epoch 137, local model 11, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4787/5702 (83.9530%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2688, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 137, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4557/4911 (92.7917%)
___Train Local_ResNet_18,  epoch 137, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4557/4911 (92.7917%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0479, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 137, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3818/4111 (92.8728%)
___Train Local_ResNet_18,  epoch 137, local model 79, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3752/4111 (91.2673%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1687, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 137, local model 60, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3854/4145 (92.9795%)
___Train Local_ResNet_18,  epoch 137, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3885/4145 (93.7274%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0221, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 137, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4209/4397 (95.7244%)
___Train Local_ResNet_18,  epoch 137, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4205/4397 (95.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7813, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 137, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4594/4979 (92.2675%)
___Train Local_ResNet_18,  epoch 137, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4564/4979 (91.6650%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1243, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 137, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5014/5353 (93.6671%)
___Train Local_ResNet_18,  epoch 137, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4798/5353 (89.6320%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1942, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4128/4368 (94.5055%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4098/4368 (93.8187%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0548, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 137, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5050/5346 (94.4632%)
___Train Local_ResNet_18,  epoch 137, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4964/5346 (92.8545%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0317, Accuracy: 5461/10000 (54.6100%)
time spent on training: 314.7301652431488
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.2732, Accuracy: 6757/10000 (67.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0765, Accuracy: 9694/9900 (97.9192%)
Done in 341.45193123817444 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 45, 90, 54, 95, 30, 48, 61, 73, 15, 85, 88, 94, 78, 18, 0, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5196/5308 (97.8900%), train_poison_data_count: 415
Global model norm: 43.85926784587908.
Norm before scaling: 43.821392642464026. Distance: 1.1906685468264433
Total norm for 4 adversaries is: 43.821392642464026. distance: 1.1906685468264433
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1132, Accuracy: 9593/9900 (96.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5634/5777 (97.5247%), train_poison_data_count: 455
Global model norm: 43.85926784587908.
Norm before scaling: 43.81919890165511. Distance: 1.308221747059951
Total norm for 4 adversaries is: 43.81919890165511. distance: 1.308221747059951
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0866, Accuracy: 9658/9900 (97.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4959/5123 (96.7988%), train_poison_data_count: 403
Global model norm: 43.85926784587908.
Norm before scaling: 43.826863283978014. Distance: 1.318346987065641
Total norm for 4 adversaries is: 43.826863283978014. distance: 1.318346987065641
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1521, Accuracy: 9521/9900 (96.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5356/5503 (97.3287%), train_poison_data_count: 430
Global model norm: 43.85926784587908.
Norm before scaling: 43.82558899748596. Distance: 1.3552208049805299
Total norm for 4 adversaries is: 43.82558899748596. distance: 1.3552208049805299
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0638, Accuracy: 9740/9900 (98.3838%)
___Train Local_ResNet_18,  epoch 138, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5013/5489 (91.3281%)
___Train Local_ResNet_18,  epoch 138, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4919/5489 (89.6156%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1871, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 138, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4487/4748 (94.5029%)
___Train Local_ResNet_18,  epoch 138, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4455/4748 (93.8290%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1258, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 138, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5098/5645 (90.3100%)
___Train Local_ResNet_18,  epoch 138, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4946/5645 (87.6174%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.3403, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 138, local model 95, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4590/5018 (91.4707%)
___Train Local_ResNet_18,  epoch 138, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4476/5018 (89.1989%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2496, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3535/3774 (93.6672%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3532/3774 (93.5877%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9963, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 138, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4549/4830 (94.1822%)
___Train Local_ResNet_18,  epoch 138, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4496/4830 (93.0849%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0849, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 138, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4152/4485 (92.5753%)
___Train Local_ResNet_18,  epoch 138, local model 61, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3797/4485 (84.6600%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.3237, Accuracy: 4992/10000 (49.9200%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4315/4605 (93.7025%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4266/4605 (92.6384%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8912, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 138, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5625/6068 (92.6994%)
___Train Local_ResNet_18,  epoch 138, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5474/6068 (90.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2935, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 138, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6327/6947 (91.0753%)
___Train Local_ResNet_18,  epoch 138, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 6094/6947 (87.7213%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.3932, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch 138, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4926/5362 (91.8687%)
___Train Local_ResNet_18,  epoch 138, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4894/5362 (91.2719%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1944, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 138, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4773/5224 (91.3668%)
___Train Local_ResNet_18,  epoch 138, local model 94, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4690/5224 (89.7779%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0604, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4168/4368 (95.4212%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4090/4368 (93.6355%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9891, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 138, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4002/4249 (94.1869%)
___Train Local_ResNet_18,  epoch 138, local model 18, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3925/4249 (92.3747%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9403, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 138, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4992/5454 (91.5292%)
___Train Local_ResNet_18,  epoch 138, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4872/5454 (89.3289%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1320, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 138, local model 40, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5514/5939 (92.8439%)
___Train Local_ResNet_18,  epoch 138, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5434/5939 (91.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0028, Accuracy: 5570/10000 (55.7000%)
time spent on training: 299.26695346832275
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.2776, Accuracy: 6747/10000 (67.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0814, Accuracy: 9679/9900 (97.7677%)
Done in 325.48924493789673 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 59, 30, 64, 19, 12, 82, 16, 74, 70, 85, 50, 67, 57, 72, 18, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5169/5308 (97.3813%), train_poison_data_count: 415
Global model norm: 43.879864458345956.
Norm before scaling: 43.847433358286494. Distance: 1.314974858438904
Total norm for 4 adversaries is: 43.847433358286494. distance: 1.314974858438904
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0525, Accuracy: 9764/9900 (98.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5638/5777 (97.5939%), train_poison_data_count: 455
Global model norm: 43.879864458345956.
Norm before scaling: 43.83939945227281. Distance: 1.3203250500686357
Total norm for 4 adversaries is: 43.83939945227281. distance: 1.3203250500686357
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0215, Accuracy: 9835/9900 (99.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4973/5123 (97.0720%), train_poison_data_count: 403
Global model norm: 43.879864458345956.
Norm before scaling: 43.845080833330094. Distance: 1.2538218722370853
Total norm for 4 adversaries is: 43.845080833330094. distance: 1.2538218722370853
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0902, Accuracy: 9669/9900 (97.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5358/5503 (97.3651%), train_poison_data_count: 430
Global model norm: 43.879864458345956.
Norm before scaling: 43.84654108409308. Distance: 1.3682612970667487
Total norm for 4 adversaries is: 43.84654108409308. distance: 1.3682612970667487
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0474, Accuracy: 9776/9900 (98.7475%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4162/4397 (94.6554%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4203/4397 (95.5879%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8055, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 139, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3575/3774 (94.7271%)
___Train Local_ResNet_18,  epoch 139, local model 30, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3620/3774 (95.9194%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7680, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch 139, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4442/4894 (90.7642%)
___Train Local_ResNet_18,  epoch 139, local model 64, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4281/4894 (87.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3690, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 139, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4836/5361 (90.2071%)
___Train Local_ResNet_18,  epoch 139, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4795/5361 (89.4423%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0496, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 139, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5061/5526 (91.5852%)
___Train Local_ResNet_18,  epoch 139, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4811/5526 (87.0612%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2699, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 139, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5019/5298 (94.7339%)
___Train Local_ResNet_18,  epoch 139, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4937/5298 (93.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2029, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 139, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4928/5353 (92.0605%)
___Train Local_ResNet_18,  epoch 139, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4769/5353 (89.0902%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1313, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 139, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4410/4797 (91.9325%)
___Train Local_ResNet_18,  epoch 139, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4357/4797 (90.8276%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0933, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 139, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5479/5871 (93.3231%)
___Train Local_ResNet_18,  epoch 139, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5315/5871 (90.5297%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2467, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 139, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6356/6947 (91.4927%)
___Train Local_ResNet_18,  epoch 139, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 6149/6947 (88.5130%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1891, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 139, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4422/4757 (92.9577%)
___Train Local_ResNet_18,  epoch 139, local model 50, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4402/4757 (92.5373%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8865, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 139, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5043/5559 (90.7178%)
___Train Local_ResNet_18,  epoch 139, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4934/5559 (88.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0918, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4606/4956 (92.9379%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4536/4956 (91.5254%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2376, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 139, local model 72, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4774/5193 (91.9314%)
___Train Local_ResNet_18,  epoch 139, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4622/5193 (89.0044%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2363, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 139, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3977/4249 (93.5985%)
___Train Local_ResNet_18,  epoch 139, local model 18, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3907/4249 (91.9510%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9799, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 139, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4862/5399 (90.0537%)
___Train Local_ResNet_18,  epoch 139, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4712/5399 (87.2754%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1466, Accuracy: 5232/10000 (52.3200%)
time spent on training: 302.04167461395264
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.2852, Accuracy: 6728/10000 (67.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0780, Accuracy: 9690/9900 (97.8788%)
Done in 328.737909078598 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 18, 76, 66, 22, 96, 54, 1, 88, 32, 97, 26, 2, 77, 68, 42, 5].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5185/5308 (97.6827%), train_poison_data_count: 415
Global model norm: 43.901045065151926.
Norm before scaling: 43.86554635732425. Distance: 1.2880017626880644
Total norm for 4 adversaries is: 43.86554635732425. distance: 1.2880017626880644
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0170, Accuracy: 9848/9900 (99.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5634/5777 (97.5247%), train_poison_data_count: 455
Global model norm: 43.901045065151926.
Norm before scaling: 43.86136078288683. Distance: 1.3328018420599381
Total norm for 4 adversaries is: 43.86136078288683. distance: 1.3328018420599381
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0245, Accuracy: 9832/9900 (99.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4938/5123 (96.3888%), train_poison_data_count: 403
Global model norm: 43.901045065151926.
Norm before scaling: 43.869664750845345. Distance: 1.3515018162858043
Total norm for 4 adversaries is: 43.869664750845345. distance: 1.3515018162858043
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0470, Accuracy: 9778/9900 (98.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5344/5503 (97.1107%), train_poison_data_count: 430
Global model norm: 43.901045065151926.
Norm before scaling: 43.866447984639265. Distance: 1.3514300154652625
Total norm for 4 adversaries is: 43.866447984639265. distance: 1.3514300154652625
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0367, Accuracy: 9811/9900 (99.1010%)
___Train Local_ResNet_18,  epoch 140, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4014/4249 (94.4693%)
___Train Local_ResNet_18,  epoch 140, local model 18, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3956/4249 (93.1043%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9011, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3619/3959 (91.4120%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3639/3959 (91.9172%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9917, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 140, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4534/4843 (93.6197%)
___Train Local_ResNet_18,  epoch 140, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4493/4843 (92.7731%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9940, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 140, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5314/5696 (93.2935%)
___Train Local_ResNet_18,  epoch 140, local model 22, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5273/5696 (92.5737%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0579, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4681/5086 (92.0370%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4661/5086 (91.6437%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9992, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 140, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5096/5645 (90.2746%)
___Train Local_ResNet_18,  epoch 140, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4838/5645 (85.7042%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2570, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch 140, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5134/5422 (94.6883%)
___Train Local_ResNet_18,  epoch 140, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5058/5422 (93.2866%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9054, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 140, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4956/5362 (92.4282%)
___Train Local_ResNet_18,  epoch 140, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4862/5362 (90.6751%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0217, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 140, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5487/6080 (90.2467%)
___Train Local_ResNet_18,  epoch 140, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5314/6080 (87.4013%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2982, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 140, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4328/4736 (91.3851%)
___Train Local_ResNet_18,  epoch 140, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4295/4736 (90.6883%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0795, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 140, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3854/4086 (94.3221%)
___Train Local_ResNet_18,  epoch 140, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3840/4086 (93.9794%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8795, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 140, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3716/3968 (93.6492%)
___Train Local_ResNet_18,  epoch 140, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3681/3968 (92.7671%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8960, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 140, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4549/5050 (90.0792%)
___Train Local_ResNet_18,  epoch 140, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4506/5050 (89.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0841, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 140, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3332/3589 (92.8392%)
___Train Local_ResNet_18,  epoch 140, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3288/3589 (91.6133%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0051, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 140, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5366/5907 (90.8414%)
___Train Local_ResNet_18,  epoch 140, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5412/5907 (91.6201%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1384, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 140, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4698/4993 (94.0917%)
___Train Local_ResNet_18,  epoch 140, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4681/4993 (93.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0135, Accuracy: 5675/10000 (56.7500%)
time spent on training: 306.5571975708008
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.2947, Accuracy: 6707/10000 (67.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0685, Accuracy: 9719/9900 (98.1717%)
Done in 332.9592196941376 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 69, 7, 17, 81, 55, 66, 54, 73, 78, 3, 79, 38, 84, 90, 5, 34].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5196/5308 (97.8900%), train_poison_data_count: 415
Global model norm: 43.92060624946237.
Norm before scaling: 43.88415118907893. Distance: 1.2142166530780998
Total norm for 4 adversaries is: 43.88415118907893. distance: 1.2142166530780998
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0541, Accuracy: 9756/9900 (98.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5652/5777 (97.8362%), train_poison_data_count: 455
Global model norm: 43.92060624946237.
Norm before scaling: 43.87825647859726. Distance: 1.2837962459268637
Total norm for 4 adversaries is: 43.87825647859726. distance: 1.2837962459268637
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0294, Accuracy: 9826/9900 (99.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4964/5123 (96.8963%), train_poison_data_count: 403
Global model norm: 43.92060624946237.
Norm before scaling: 43.88400237059628. Distance: 1.2269391495990531
Total norm for 4 adversaries is: 43.88400237059628. distance: 1.2269391495990531
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1306, Accuracy: 9559/9900 (96.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5357/5503 (97.3469%), train_poison_data_count: 430
Global model norm: 43.92060624946237.
Norm before scaling: 43.88683122621323. Distance: 1.3681539988505014
Total norm for 4 adversaries is: 43.88683122621323. distance: 1.3681539988505014
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0308, Accuracy: 9820/9900 (99.1919%)
___Train Local_ResNet_18,  epoch 141, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4017/4364 (92.0486%)
___Train Local_ResNet_18,  epoch 141, local model 69, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3950/4364 (90.5133%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0063, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 141, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4468/4869 (91.7642%)
___Train Local_ResNet_18,  epoch 141, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4259/4869 (87.4718%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2392, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch 141, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4461/4903 (90.9851%)
___Train Local_ResNet_18,  epoch 141, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4424/4903 (90.2305%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0931, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 141, local model 81, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4739/5035 (94.1212%)
___Train Local_ResNet_18,  epoch 141, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4695/5035 (93.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0098, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 141, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4416/4731 (93.3418%)
___Train Local_ResNet_18,  epoch 141, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4395/4731 (92.8979%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9602, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 141, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4520/4843 (93.3306%)
___Train Local_ResNet_18,  epoch 141, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4498/4843 (92.8763%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0978, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 141, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5118/5645 (90.6643%)
___Train Local_ResNet_18,  epoch 141, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4898/5645 (86.7671%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1510, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 141, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4320/4605 (93.8111%)
___Train Local_ResNet_18,  epoch 141, local model 73, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4364/4605 (94.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9635, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 141, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4138/4368 (94.7344%)
___Train Local_ResNet_18,  epoch 141, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4132/4368 (94.5971%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9839, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 141, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5034/5346 (94.1639%)
___Train Local_ResNet_18,  epoch 141, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4988/5346 (93.3034%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1085, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 141, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3887/4111 (94.5512%)
___Train Local_ResNet_18,  epoch 141, local model 79, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3843/4111 (93.4809%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9924, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 141, local model 38, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5649/6235 (90.6014%)
___Train Local_ResNet_18,  epoch 141, local model 38, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5571/6235 (89.3504%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1789, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 141, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4753/5209 (91.2459%)
___Train Local_ResNet_18,  epoch 141, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4672/5209 (89.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1899, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 141, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4424/4748 (93.1761%)
___Train Local_ResNet_18,  epoch 141, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4309/4748 (90.7540%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1173, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 141, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4733/4993 (94.7927%)
___Train Local_ResNet_18,  epoch 141, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4650/4993 (93.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1688, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 141, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4567/4911 (92.9953%)
___Train Local_ResNet_18,  epoch 141, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4543/4911 (92.5066%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.3399, Accuracy: 5000/10000 (50.0000%)
time spent on training: 300.8769416809082
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.2917, Accuracy: 6726/10000 (67.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0667, Accuracy: 9727/9900 (98.2525%)
Done in 327.556565284729 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 96, 52, 20, 2, 65, 42, 1, 45, 48, 32, 68, 12, 39, 33, 4, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5171/5308 (97.4190%), train_poison_data_count: 415
Global model norm: 43.9391363715552.
Norm before scaling: 43.90256045441. Distance: 1.246727187494703
Total norm for 4 adversaries is: 43.90256045441. distance: 1.246727187494703
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0617, Accuracy: 9736/9900 (98.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5637/5777 (97.5766%), train_poison_data_count: 455
Global model norm: 43.9391363715552.
Norm before scaling: 43.89880664220128. Distance: 1.3345960608161405
Total norm for 4 adversaries is: 43.89880664220128. distance: 1.3345960608161405
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0469, Accuracy: 9788/9900 (98.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4967/5123 (96.9549%), train_poison_data_count: 403
Global model norm: 43.9391363715552.
Norm before scaling: 43.90464854730647. Distance: 1.2808502783282163
Total norm for 4 adversaries is: 43.90464854730647. distance: 1.2808502783282163
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.2334, Accuracy: 9272/9900 (93.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5351/5503 (97.2379%), train_poison_data_count: 430
Global model norm: 43.9391363715552.
Norm before scaling: 43.90409247368063. Distance: 1.3431871255500736
Total norm for 4 adversaries is: 43.90409247368063. distance: 1.3431871255500736
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0488, Accuracy: 9768/9900 (98.6667%)
___Train Local_ResNet_18,  epoch 142, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4673/5086 (91.8797%)
___Train Local_ResNet_18,  epoch 142, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4688/5086 (92.1746%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0485, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 142, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3878/4130 (93.8983%)
___Train Local_ResNet_18,  epoch 142, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3897/4130 (94.3584%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9570, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 142, local model 20, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4407/4714 (93.4875%)
___Train Local_ResNet_18,  epoch 142, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4400/4714 (93.3390%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8970, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 142, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3682/3968 (92.7923%)
___Train Local_ResNet_18,  epoch 142, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3668/3968 (92.4395%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9174, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5037/5497 (91.6318%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4931/5497 (89.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1722, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 142, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5461/5907 (92.4496%)
___Train Local_ResNet_18,  epoch 142, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5341/5907 (90.4181%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2455, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch 142, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5133/5422 (94.6699%)
___Train Local_ResNet_18,  epoch 142, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5065/5422 (93.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8099, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 142, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5039/5489 (91.8018%)
___Train Local_ResNet_18,  epoch 142, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4941/5489 (90.0164%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3888, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch 142, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4526/4830 (93.7060%)
___Train Local_ResNet_18,  epoch 142, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4525/4830 (93.6853%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1788, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 142, local model 32, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5419/6080 (89.1283%)
___Train Local_ResNet_18,  epoch 142, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5367/6080 (88.2730%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1288, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 142, local model 68, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3359/3589 (93.5915%)
___Train Local_ResNet_18,  epoch 142, local model 68, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3077/3589 (85.7342%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1753, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 142, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5070/5526 (91.7481%)
___Train Local_ResNet_18,  epoch 142, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4942/5526 (89.4318%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1646, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3852/4175 (92.2635%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3819/4175 (91.4731%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0211, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 142, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4474/4818 (92.8601%)
___Train Local_ResNet_18,  epoch 142, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4388/4818 (91.0751%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9510, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 142, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3749/4028 (93.0735%)
___Train Local_ResNet_18,  epoch 142, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3734/4028 (92.7011%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8664, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 142, local model 46, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4877/5399 (90.3315%)
___Train Local_ResNet_18,  epoch 142, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4745/5399 (87.8866%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.4056, Accuracy: 4959/10000 (49.5900%)
time spent on training: 295.2366292476654
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.2876, Accuracy: 6723/10000 (67.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0682, Accuracy: 9727/9900 (98.2525%)
Done in 321.8257932662964 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 27, 65, 15, 35, 94, 34, 49, 50, 42, 4, 93, 68, 90, 96, 92, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5198/5308 (97.9277%), train_poison_data_count: 415
Global model norm: 43.958922198119375.
Norm before scaling: 43.92108429339846. Distance: 1.213281982971874
Total norm for 4 adversaries is: 43.92108429339846. distance: 1.213281982971874
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0184, Accuracy: 9852/9900 (99.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5636/5777 (97.5593%), train_poison_data_count: 455
Global model norm: 43.958922198119375.
Norm before scaling: 43.918776015717356. Distance: 1.3151892404768186
Total norm for 4 adversaries is: 43.918776015717356. distance: 1.3151892404768186
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0386, Accuracy: 9792/9900 (98.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4951/5123 (96.6426%), train_poison_data_count: 403
Global model norm: 43.958922198119375.
Norm before scaling: 43.925222491166025. Distance: 1.3110440216617154
Total norm for 4 adversaries is: 43.925222491166025. distance: 1.3110440216617154
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1205, Accuracy: 9599/9900 (96.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5377/5503 (97.7103%), train_poison_data_count: 430
Global model norm: 43.958922198119375.
Norm before scaling: 43.92068546059049. Distance: 1.252338748762457
Total norm for 4 adversaries is: 43.92068546059049. distance: 1.252338748762457
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0296, Accuracy: 9828/9900 (99.2727%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4272/4587 (93.1328%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4228/4587 (92.1735%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0049, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4992/5497 (90.8132%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4973/5497 (90.4675%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1142, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 143, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5570/6068 (91.7930%)
___Train Local_ResNet_18,  epoch 143, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5534/6068 (91.1997%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1992, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch 143, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5226/5615 (93.0721%)
___Train Local_ResNet_18,  epoch 143, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5169/5615 (92.0570%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.4584, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4741/5224 (90.7542%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4731/5224 (90.5628%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1783, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 143, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4562/4911 (92.8935%)
___Train Local_ResNet_18,  epoch 143, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4505/4911 (91.7328%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3322, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 143, local model 49, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5152/5652 (91.1536%)
___Train Local_ResNet_18,  epoch 143, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5028/5652 (88.9597%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3937, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 143, local model 50, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4444/4757 (93.4202%)
___Train Local_ResNet_18,  epoch 143, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4308/4757 (90.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0793, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 143, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5423/5907 (91.8063%)
___Train Local_ResNet_18,  epoch 143, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5335/5907 (90.3166%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.6370, Accuracy: 4547/10000 (45.4700%)
___Train Local_ResNet_18,  epoch 143, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3711/4028 (92.1301%)
___Train Local_ResNet_18,  epoch 143, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3722/4028 (92.4032%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0181, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 143, local model 93, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4658/5055 (92.1464%)
___Train Local_ResNet_18,  epoch 143, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4572/5055 (90.4451%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1537, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 143, local model 68, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3369/3589 (93.8702%)
___Train Local_ResNet_18,  epoch 143, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3363/3589 (93.7030%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9089, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 143, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4482/4748 (94.3976%)
___Train Local_ResNet_18,  epoch 143, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4319/4748 (90.9646%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0313, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 143, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4707/5086 (92.5482%)
___Train Local_ResNet_18,  epoch 143, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4706/5086 (92.5285%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0003, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 6362/6812 (93.3940%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6293/6812 (92.3811%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0144, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 143, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4096/4364 (93.8588%)
___Train Local_ResNet_18,  epoch 143, local model 69, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3983/4364 (91.2695%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0880, Accuracy: 5478/10000 (54.7800%)
time spent on training: 302.8488874435425
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.2825, Accuracy: 6730/10000 (67.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0675, Accuracy: 9726/9900 (98.2424%)
Done in 329.578063249588 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 0, 83, 23, 90, 88, 51, 9, 6, 70, 7, 75, 87, 85, 89, 84, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5191/5308 (97.7958%), train_poison_data_count: 415
Global model norm: 43.978937830014154.
Norm before scaling: 43.94152275325697. Distance: 1.2389678976689278
Total norm for 4 adversaries is: 43.94152275325697. distance: 1.2389678976689278
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0794, Accuracy: 9691/9900 (97.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5623/5777 (97.3343%), train_poison_data_count: 455
Global model norm: 43.978937830014154.
Norm before scaling: 43.939107200779155. Distance: 1.364650879952328
Total norm for 4 adversaries is: 43.939107200779155. distance: 1.364650879952328
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0961, Accuracy: 9659/9900 (97.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4968/5123 (96.9744%), train_poison_data_count: 403
Global model norm: 43.978937830014154.
Norm before scaling: 43.94438818472374. Distance: 1.2832526396280768
Total norm for 4 adversaries is: 43.94438818472374. distance: 1.2832526396280768
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0537, Accuracy: 9752/9900 (98.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5357/5503 (97.3469%), train_poison_data_count: 430
Global model norm: 43.978937830014154.
Norm before scaling: 43.94341454234781. Distance: 1.319973783666191
Total norm for 4 adversaries is: 43.94341454234781. distance: 1.319973783666191
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0419, Accuracy: 9791/9900 (98.8990%)
___Train Local_ResNet_18,  epoch 144, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4966/5454 (91.0524%)
___Train Local_ResNet_18,  epoch 144, local model 0, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4822/5454 (88.4122%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2682, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 144, local model 83, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3278/3552 (92.2860%)
___Train Local_ResNet_18,  epoch 144, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3271/3552 (92.0890%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0507, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 144, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4253/4549 (93.4931%)
___Train Local_ResNet_18,  epoch 144, local model 23, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4043/4549 (88.8767%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0723, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 144, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4512/4748 (95.0295%)
___Train Local_ResNet_18,  epoch 144, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4389/4748 (92.4389%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9880, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4953/5362 (92.3722%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4807/5362 (89.6494%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0460, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 144, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3806/4108 (92.6485%)
___Train Local_ResNet_18,  epoch 144, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3811/4108 (92.7702%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1010, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5253/5727 (91.7234%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5058/5727 (88.3185%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2472, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 144, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4573/4929 (92.7774%)
___Train Local_ResNet_18,  epoch 144, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4468/4929 (90.6472%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2851, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 144, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5490/5871 (93.5105%)
___Train Local_ResNet_18,  epoch 144, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5424/5871 (92.3863%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2045, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 144, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4482/4869 (92.0518%)
___Train Local_ResNet_18,  epoch 144, local model 7, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3993/4869 (82.0086%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.7746, Accuracy: 4414/10000 (44.1400%)
___Train Local_ResNet_18,  epoch 144, local model 75, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4371/4672 (93.5574%)
___Train Local_ResNet_18,  epoch 144, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4367/4672 (93.4717%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0856, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 144, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3596/3995 (90.0125%)
___Train Local_ResNet_18,  epoch 144, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3584/3995 (89.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1424, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 144, local model 85, internal_epoch   1,  Average loss: 0.0047, Accuracy: 6307/6947 (90.7874%)
___Train Local_ResNet_18,  epoch 144, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 6031/6947 (86.8145%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2312, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 144, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4348/4737 (91.7881%)
___Train Local_ResNet_18,  epoch 144, local model 89, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4298/4737 (90.7325%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2285, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4793/5209 (92.0138%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4664/5209 (89.5373%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2363, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 144, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3748/3968 (94.4556%)
___Train Local_ResNet_18,  epoch 144, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3751/3968 (94.5312%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8358, Accuracy: 5737/10000 (57.3700%)
time spent on training: 300.3193402290344
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.2911, Accuracy: 6721/10000 (67.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0691, Accuracy: 9721/9900 (98.1919%)
Done in 326.67986822128296 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 27, 69, 59, 16, 44, 4, 1, 35, 8, 7, 23, 66, 88, 42, 52, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5177/5308 (97.5320%), train_poison_data_count: 415
Global model norm: 43.9987071454236.
Norm before scaling: 43.961188104626025. Distance: 1.2470390058992509
Total norm for 4 adversaries is: 43.961188104626025. distance: 1.2470390058992509
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0283, Accuracy: 9827/9900 (99.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5639/5777 (97.6112%), train_poison_data_count: 455
Global model norm: 43.9987071454236.
Norm before scaling: 43.957515666763406. Distance: 1.318989785256791
Total norm for 4 adversaries is: 43.957515666763406. distance: 1.318989785256791
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0441, Accuracy: 9786/9900 (98.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4976/5123 (97.1306%), train_poison_data_count: 403
Global model norm: 43.9987071454236.
Norm before scaling: 43.96477693936505. Distance: 1.2680832807015234
Total norm for 4 adversaries is: 43.96477693936505. distance: 1.2680832807015234
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1407, Accuracy: 9551/9900 (96.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5353/5503 (97.2742%), train_poison_data_count: 430
Global model norm: 43.9987071454236.
Norm before scaling: 43.96367741261671. Distance: 1.3431169659998676
Total norm for 4 adversaries is: 43.96367741261671. distance: 1.3431169659998676
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0464, Accuracy: 9775/9900 (98.7374%)
___Train Local_ResNet_18,  epoch 145, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4201/4587 (91.5849%)
___Train Local_ResNet_18,  epoch 145, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4165/4587 (90.8001%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1872, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4052/4364 (92.8506%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4014/4364 (91.9798%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0013, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4176/4397 (94.9738%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0021, Accuracy: 4229/4397 (96.1792%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7641, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4952/5353 (92.5089%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4812/5353 (89.8935%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2931, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 145, local model 44, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4754/5075 (93.6749%)
___Train Local_ResNet_18,  epoch 145, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4686/5075 (92.3350%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0708, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 145, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3752/4028 (93.1480%)
___Train Local_ResNet_18,  epoch 145, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3758/4028 (93.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9635, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 145, local model 1, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5144/5422 (94.8727%)
___Train Local_ResNet_18,  epoch 145, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5036/5422 (92.8809%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0286, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 145, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5218/5615 (92.9297%)
___Train Local_ResNet_18,  epoch 145, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5138/5615 (91.5049%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2068, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 145, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4544/4889 (92.9433%)
___Train Local_ResNet_18,  epoch 145, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4476/4889 (91.5525%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0080, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 145, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4452/4869 (91.4356%)
___Train Local_ResNet_18,  epoch 145, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4134/4869 (84.9045%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1872, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 145, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4288/4549 (94.2625%)
___Train Local_ResNet_18,  epoch 145, local model 23, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3898/4549 (85.6892%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.7068, Accuracy: 4693/10000 (46.9300%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4509/4843 (93.1034%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4518/4843 (93.2893%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9973, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 145, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4920/5362 (91.7568%)
___Train Local_ResNet_18,  epoch 145, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4874/5362 (90.8989%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1750, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 145, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5483/5907 (92.8221%)
___Train Local_ResNet_18,  epoch 145, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5321/5907 (90.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.4726, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18,  epoch 145, local model 52, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3877/4130 (93.8741%)
___Train Local_ResNet_18,  epoch 145, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3849/4130 (93.1961%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9493, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 145, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5037/5454 (92.3542%)
___Train Local_ResNet_18,  epoch 145, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4866/5454 (89.2189%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1368, Accuracy: 5401/10000 (54.0100%)
time spent on training: 303.5023989677429
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.2911, Accuracy: 6705/10000 (67.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0676, Accuracy: 9722/9900 (98.2020%)
Done in 330.68718099594116 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 54, 63, 3, 38, 67, 73, 20, 32, 49, 0, 75, 56, 10, 2, 42, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5184/5308 (97.6639%), train_poison_data_count: 415
Global model norm: 44.01836358848217.
Norm before scaling: 43.981953474639035. Distance: 1.2539810205906332
Total norm for 4 adversaries is: 43.981953474639035. distance: 1.2539810205906332
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0158, Accuracy: 9855/9900 (99.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5644/5777 (97.6978%), train_poison_data_count: 455
Global model norm: 44.01836358848217.
Norm before scaling: 43.97600664176148. Distance: 1.2835904121935975
Total norm for 4 adversaries is: 43.97600664176148. distance: 1.2835904121935975
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0437, Accuracy: 9784/9900 (98.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4965/5123 (96.9159%), train_poison_data_count: 403
Global model norm: 44.01836358848217.
Norm before scaling: 43.98503274374989. Distance: 1.3263524961999054
Total norm for 4 adversaries is: 43.98503274374989. distance: 1.3263524961999054
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1351, Accuracy: 9558/9900 (96.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5371/5503 (97.6013%), train_poison_data_count: 430
Global model norm: 44.01836358848217.
Norm before scaling: 43.98180082387416. Distance: 1.2993859032728055
Total norm for 4 adversaries is: 43.98180082387416. distance: 1.2993859032728055
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0608, Accuracy: 9754/9900 (98.5253%)
___Train Local_ResNet_18,  epoch 146, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5103/5645 (90.3986%)
___Train Local_ResNet_18,  epoch 146, local model 54, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4816/5645 (85.3144%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3123, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3685/3910 (94.2455%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3428/3910 (87.6726%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.4771, Accuracy: 5020/10000 (50.2000%)
___Train Local_ResNet_18,  epoch 146, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5091/5346 (95.2301%)
___Train Local_ResNet_18,  epoch 146, local model 3, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5043/5346 (94.3322%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0386, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5611/6235 (89.9920%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5472/6235 (87.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2607, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 146, local model 67, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5059/5559 (91.0056%)
___Train Local_ResNet_18,  epoch 146, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4914/5559 (88.3972%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0875, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4356/4605 (94.5928%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4318/4605 (93.7676%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0505, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 146, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4472/4714 (94.8664%)
___Train Local_ResNet_18,  epoch 146, local model 20, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4497/4714 (95.3967%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8723, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 146, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5468/6080 (89.9342%)
___Train Local_ResNet_18,  epoch 146, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5298/6080 (87.1382%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1944, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 146, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5169/5652 (91.4544%)
___Train Local_ResNet_18,  epoch 146, local model 49, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4967/5652 (87.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2695, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 146, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5030/5454 (92.2259%)
___Train Local_ResNet_18,  epoch 146, local model 0, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4737/5454 (86.8537%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1233, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 146, local model 75, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4397/4672 (94.1139%)
___Train Local_ResNet_18,  epoch 146, local model 75, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4377/4672 (93.6858%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9778, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 146, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4927/5427 (90.7868%)
___Train Local_ResNet_18,  epoch 146, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4833/5427 (89.0547%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1246, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 146, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4750/5068 (93.7253%)
___Train Local_ResNet_18,  epoch 146, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4663/5068 (92.0087%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3340, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 146, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3731/3968 (94.0272%)
___Train Local_ResNet_18,  epoch 146, local model 2, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3715/3968 (93.6240%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8274, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 146, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5419/5907 (91.7386%)
___Train Local_ResNet_18,  epoch 146, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5354/5907 (90.6382%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2887, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 146, local model 99, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4487/4851 (92.4964%)
___Train Local_ResNet_18,  epoch 146, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4471/4851 (92.1666%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0174, Accuracy: 5554/10000 (55.5400%)
time spent on training: 311.9188709259033
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.2943, Accuracy: 6713/10000 (67.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0626, Accuracy: 9737/9900 (98.3535%)
Done in 338.52339720726013 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 92, 39, 50, 63, 32, 3, 4, 22, 47, 68, 64, 51, 16, 62, 87, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5191/5308 (97.7958%), train_poison_data_count: 415
Global model norm: 44.0396535961307.
Norm before scaling: 43.99891938703225. Distance: 1.173986541670906
Total norm for 4 adversaries is: 43.99891938703225. distance: 1.173986541670906
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0668, Accuracy: 9721/9900 (98.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5655/5777 (97.8882%), train_poison_data_count: 455
Global model norm: 44.0396535961307.
Norm before scaling: 43.995825829613516. Distance: 1.2539114788576238
Total norm for 4 adversaries is: 43.995825829613516. distance: 1.2539114788576238
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0384, Accuracy: 9800/9900 (98.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4987/5123 (97.3453%), train_poison_data_count: 403
Global model norm: 44.0396535961307.
Norm before scaling: 44.00314042415041. Distance: 1.21649602167974
Total norm for 4 adversaries is: 44.00314042415041. distance: 1.21649602167974
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0503, Accuracy: 9775/9900 (98.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5360/5503 (97.4014%), train_poison_data_count: 430
Global model norm: 44.0396535961307.
Norm before scaling: 44.00478545088165. Distance: 1.3473962505365982
Total norm for 4 adversaries is: 44.00478545088165. distance: 1.3473962505365982
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1233, Accuracy: 9566/9900 (96.6263%)
___Train Local_ResNet_18,  epoch 147, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6444/6812 (94.5978%)
___Train Local_ResNet_18,  epoch 147, local model 92, internal_epoch   2,  Average loss: 0.0033, Accuracy: 6386/6812 (93.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1319, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 147, local model 39, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3879/4175 (92.9102%)
___Train Local_ResNet_18,  epoch 147, local model 39, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3736/4175 (89.4850%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1460, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 147, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4453/4757 (93.6094%)
___Train Local_ResNet_18,  epoch 147, local model 50, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4368/4757 (91.8226%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0816, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 147, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3691/3910 (94.3990%)
___Train Local_ResNet_18,  epoch 147, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3441/3910 (88.0051%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1535, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 147, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5486/6080 (90.2303%)
___Train Local_ResNet_18,  epoch 147, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5376/6080 (88.4211%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3247, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch 147, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5026/5346 (94.0142%)
___Train Local_ResNet_18,  epoch 147, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4966/5346 (92.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1320, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3774/4028 (93.6941%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3724/4028 (92.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9842, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 147, local model 22, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5340/5696 (93.7500%)
___Train Local_ResNet_18,  epoch 147, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5190/5696 (91.1166%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9929, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 147, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4697/5123 (91.6846%)
___Train Local_ResNet_18,  epoch 147, local model 47, internal_epoch   2,  Average loss: 0.0105, Accuracy: 4084/5123 (79.7189%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2281, Accuracy: 4988/10000 (49.8800%)
___Train Local_ResNet_18,  epoch 147, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3377/3589 (94.0931%)
___Train Local_ResNet_18,  epoch 147, local model 68, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3193/3589 (88.9663%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9831, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 147, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4500/4894 (91.9493%)
___Train Local_ResNet_18,  epoch 147, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4317/4894 (88.2101%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3639, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch 147, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3870/4108 (94.2064%)
___Train Local_ResNet_18,  epoch 147, local model 51, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3777/4108 (91.9426%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0695, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 147, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4998/5353 (93.3682%)
___Train Local_ResNet_18,  epoch 147, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4892/5353 (91.3880%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0890, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 147, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4907/5504 (89.1533%)
___Train Local_ResNet_18,  epoch 147, local model 62, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4888/5504 (88.8081%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3196, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 147, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3639/3995 (91.0889%)
___Train Local_ResNet_18,  epoch 147, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3594/3995 (89.9625%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0389, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 147, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5194/5615 (92.5022%)
___Train Local_ResNet_18,  epoch 147, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5150/5615 (91.7186%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0475, Accuracy: 5464/10000 (54.6400%)
time spent on training: 301.38670539855957
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.3039, Accuracy: 6683/10000 (66.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0635, Accuracy: 9734/9900 (98.3232%)
Done in 327.8347022533417 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 34, 96, 45, 52, 66, 63, 32, 29, 57, 44, 77, 79, 94, 64, 51, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5176/5308 (97.5132%), train_poison_data_count: 415
Global model norm: 44.0600966210676.
Norm before scaling: 44.023403532595594. Distance: 1.2616635242575882
Total norm for 4 adversaries is: 44.023403532595594. distance: 1.2616635242575882
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0501, Accuracy: 9777/9900 (98.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5639/5777 (97.6112%), train_poison_data_count: 455
Global model norm: 44.0600966210676.
Norm before scaling: 44.01778399257722. Distance: 1.3114757174106535
Total norm for 4 adversaries is: 44.01778399257722. distance: 1.3114757174106535
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0880, Accuracy: 9671/9900 (97.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4983/5123 (97.2672%), train_poison_data_count: 403
Global model norm: 44.0600966210676.
Norm before scaling: 44.02344928460357. Distance: 1.2253603541460028
Total norm for 4 adversaries is: 44.02344928460357. distance: 1.2253603541460028
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0826, Accuracy: 9683/9900 (97.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5359/5503 (97.3832%), train_poison_data_count: 430
Global model norm: 44.0600966210676.
Norm before scaling: 44.021949148532. Distance: 1.2981709359296707
Total norm for 4 adversaries is: 44.021949148532. distance: 1.2981709359296707
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0482, Accuracy: 9774/9900 (98.7273%)
___Train Local_ResNet_18,  epoch 148, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4615/4911 (93.9727%)
___Train Local_ResNet_18,  epoch 148, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4537/4911 (92.3844%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0111, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 148, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4753/5086 (93.4526%)
___Train Local_ResNet_18,  epoch 148, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4697/5086 (92.3516%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0771, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 148, local model 45, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5004/5489 (91.1641%)
___Train Local_ResNet_18,  epoch 148, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4961/5489 (90.3808%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2045, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3874/4130 (93.8015%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3859/4130 (93.4383%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0253, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 148, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4513/4843 (93.1860%)
___Train Local_ResNet_18,  epoch 148, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4450/4843 (91.8852%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0908, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 148, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3670/3910 (93.8619%)
___Train Local_ResNet_18,  epoch 148, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3553/3910 (90.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2625, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5498/6080 (90.4276%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5310/6080 (87.3355%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1819, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 148, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4482/4732 (94.7168%)
___Train Local_ResNet_18,  epoch 148, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4472/4732 (94.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8840, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 148, local model 57, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4624/4956 (93.3010%)
___Train Local_ResNet_18,  epoch 148, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4468/4956 (90.1533%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1653, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 148, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4735/5075 (93.3005%)
___Train Local_ResNet_18,  epoch 148, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4585/5075 (90.3448%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0904, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 148, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4579/5050 (90.6733%)
___Train Local_ResNet_18,  epoch 148, local model 77, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4458/5050 (88.2772%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2467, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 148, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3866/4111 (94.0404%)
___Train Local_ResNet_18,  epoch 148, local model 79, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3834/4111 (93.2620%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0769, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 148, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4776/5224 (91.4242%)
___Train Local_ResNet_18,  epoch 148, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4735/5224 (90.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9494, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 148, local model 64, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4549/4894 (92.9506%)
___Train Local_ResNet_18,  epoch 148, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4397/4894 (89.8447%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1148, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 148, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3870/4108 (94.2064%)
___Train Local_ResNet_18,  epoch 148, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3843/4108 (93.5492%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8935, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 148, local model 53, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5944/6664 (89.1957%)
___Train Local_ResNet_18,  epoch 148, local model 53, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5754/6664 (86.3445%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3894, Accuracy: 4894/10000 (48.9400%)
time spent on training: 294.2535343170166
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.3054, Accuracy: 6702/10000 (67.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0631, Accuracy: 9733/9900 (98.3131%)
Done in 320.6441025733948 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 69, 1, 68, 16, 44, 2, 45, 27, 14, 83, 87, 12, 50, 43, 37, 72].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5181/5308 (97.6074%), train_poison_data_count: 415
Global model norm: 44.07914966905413.
Norm before scaling: 44.041934750888984. Distance: 1.26086264462552
Total norm for 4 adversaries is: 44.041934750888984. distance: 1.26086264462552
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0915, Accuracy: 9636/9900 (97.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5634/5777 (97.5247%), train_poison_data_count: 455
Global model norm: 44.07914966905413.
Norm before scaling: 44.03700503553801. Distance: 1.322313676916072
Total norm for 4 adversaries is: 44.03700503553801. distance: 1.322313676916072
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0437, Accuracy: 9788/9900 (98.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4969/5123 (96.9939%), train_poison_data_count: 403
Global model norm: 44.07914966905413.
Norm before scaling: 44.045521163567955. Distance: 1.308567103783629
Total norm for 4 adversaries is: 44.045521163567955. distance: 1.308567103783629
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1569, Accuracy: 9494/9900 (95.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5359/5503 (97.3832%), train_poison_data_count: 430
Global model norm: 44.07914966905413.
Norm before scaling: 44.042318627407944. Distance: 1.3268181598292301
Total norm for 4 adversaries is: 44.042318627407944. distance: 1.3268181598292301
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0221, Accuracy: 9853/9900 (99.5253%)
___Train Local_ResNet_18,  epoch 149, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4088/4364 (93.6755%)
___Train Local_ResNet_18,  epoch 149, local model 69, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3965/4364 (90.8570%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9935, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 149, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5089/5422 (93.8584%)
___Train Local_ResNet_18,  epoch 149, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5038/5422 (92.9177%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9118, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 149, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3354/3589 (93.4522%)
___Train Local_ResNet_18,  epoch 149, local model 68, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3130/3589 (87.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1777, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 149, local model 16, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4940/5353 (92.2847%)
___Train Local_ResNet_18,  epoch 149, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4863/5353 (90.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1086, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 149, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4735/5075 (93.3005%)
___Train Local_ResNet_18,  epoch 149, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4593/5075 (90.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1639, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 149, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3694/3968 (93.0948%)
___Train Local_ResNet_18,  epoch 149, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3685/3968 (92.8679%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9962, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5064/5489 (92.2572%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5030/5489 (91.6378%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1201, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 149, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4251/4587 (92.6750%)
___Train Local_ResNet_18,  epoch 149, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4186/4587 (91.2579%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0576, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 149, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4011/4196 (95.5910%)
___Train Local_ResNet_18,  epoch 149, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4005/4196 (95.4480%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9204, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 149, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3269/3552 (92.0327%)
___Train Local_ResNet_18,  epoch 149, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3289/3552 (92.5957%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8919, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 149, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3631/3995 (90.8886%)
___Train Local_ResNet_18,  epoch 149, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3561/3995 (89.1364%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2820, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 149, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5065/5526 (91.6576%)
___Train Local_ResNet_18,  epoch 149, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4906/5526 (88.7803%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3916, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 149, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4427/4757 (93.0629%)
___Train Local_ResNet_18,  epoch 149, local model 50, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4423/4757 (92.9788%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9603, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 149, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4605/4979 (92.4885%)
___Train Local_ResNet_18,  epoch 149, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4553/4979 (91.4441%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.4195, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 149, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4390/4741 (92.5965%)
___Train Local_ResNet_18,  epoch 149, local model 37, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4298/4741 (90.6560%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1222, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 149, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4747/5193 (91.4115%)
___Train Local_ResNet_18,  epoch 149, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4582/5193 (88.2342%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.4305, Accuracy: 5013/10000 (50.1300%)
time spent on training: 294.5371780395508
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.3035, Accuracy: 6691/10000 (66.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0626, Accuracy: 9737/9900 (98.3535%)
Done in 321.41086649894714 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 63, 26, 6, 29, 91, 4, 39, 1, 80, 62, 89, 20, 33, 74, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5212/5308 (98.1914%), train_poison_data_count: 415
Global model norm: 44.09828860190821.
Norm before scaling: 44.05867392519747. Distance: 1.1889309543424822
Total norm for 4 adversaries is: 44.05867392519747. distance: 1.1889309543424822
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0260, Accuracy: 9834/9900 (99.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5644/5777 (97.6978%), train_poison_data_count: 455
Global model norm: 44.09828860190821.
Norm before scaling: 44.05475885013729. Distance: 1.2852198344446901
Total norm for 4 adversaries is: 44.05475885013729. distance: 1.2852198344446901
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0484, Accuracy: 9769/9900 (98.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4973/5123 (97.0720%), train_poison_data_count: 403
Global model norm: 44.09828860190821.
Norm before scaling: 44.0617672257331. Distance: 1.257673836403948
Total norm for 4 adversaries is: 44.0617672257331. distance: 1.257673836403948
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1731, Accuracy: 9458/9900 (95.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5351/5503 (97.2379%), train_poison_data_count: 430
Global model norm: 44.09828860190821.
Norm before scaling: 44.06170766131574. Distance: 1.3320777415107594
Total norm for 4 adversaries is: 44.06170766131574. distance: 1.3320777415107594
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0544, Accuracy: 9770/9900 (98.6869%)
___Train Local_ResNet_18,  epoch 150, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3682/3910 (94.1688%)
___Train Local_ResNet_18,  epoch 150, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3530/3910 (90.2813%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0669, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 150, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3858/4086 (94.4200%)
___Train Local_ResNet_18,  epoch 150, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3869/4086 (94.6892%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9688, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 150, local model 6, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4639/4929 (94.1165%)
___Train Local_ResNet_18,  epoch 150, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4497/4929 (91.2355%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1285, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 150, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4475/4732 (94.5689%)
___Train Local_ResNet_18,  epoch 150, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4476/4732 (94.5900%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7842, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 150, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4152/4527 (91.7164%)
___Train Local_ResNet_18,  epoch 150, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4027/4527 (88.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0823, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 150, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3779/4028 (93.8183%)
___Train Local_ResNet_18,  epoch 150, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3721/4028 (92.3784%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9528, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 150, local model 39, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3864/4175 (92.5509%)
___Train Local_ResNet_18,  epoch 150, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3784/4175 (90.6347%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9810, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 150, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5167/5422 (95.2969%)
___Train Local_ResNet_18,  epoch 150, local model 1, internal_epoch   2,  Average loss: 0.0030, Accuracy: 5123/5422 (94.4854%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8708, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 150, local model 80, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5052/5461 (92.5105%)
___Train Local_ResNet_18,  epoch 150, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4992/5461 (91.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1390, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4911/5504 (89.2260%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4869/5504 (88.4629%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1847, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 150, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4392/4737 (92.7169%)
___Train Local_ResNet_18,  epoch 150, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4306/4737 (90.9014%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1997, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 150, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4429/4714 (93.9542%)
___Train Local_ResNet_18,  epoch 150, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4417/4714 (93.6996%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9174, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4452/4818 (92.4035%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4337/4818 (90.0166%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9856, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4411/4797 (91.9533%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4318/4797 (90.0146%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1261, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 150, local model 93, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4674/5055 (92.4629%)
___Train Local_ResNet_18,  epoch 150, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4596/5055 (90.9199%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2743, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 150, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5082/5497 (92.4504%)
___Train Local_ResNet_18,  epoch 150, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4989/5497 (90.7586%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1648, Accuracy: 5322/10000 (53.2200%)
time spent on training: 295.6299660205841
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.3029, Accuracy: 6693/10000 (66.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0655, Accuracy: 9732/9900 (98.3030%)
Done in 321.80798172950745 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 4, 98, 5, 17, 65, 46, 15, 48, 68, 94, 2, 93, 43, 10, 26, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5211/5308 (98.1726%), train_poison_data_count: 415
Global model norm: 44.11691564574466.
Norm before scaling: 44.07656856521813. Distance: 1.1595755000140564
Total norm for 4 adversaries is: 44.07656856521813. distance: 1.1595755000140564
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0903, Accuracy: 9663/9900 (97.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5664/5777 (98.0440%), train_poison_data_count: 455
Global model norm: 44.11691564574466.
Norm before scaling: 44.07183384074161. Distance: 1.2150910055355517
Total norm for 4 adversaries is: 44.07183384074161. distance: 1.2150910055355517
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0810, Accuracy: 9697/9900 (97.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4970/5123 (97.0135%), train_poison_data_count: 403
Global model norm: 44.11691564574466.
Norm before scaling: 44.08320241715162. Distance: 1.3114975325240885
Total norm for 4 adversaries is: 44.08320241715162. distance: 1.3114975325240885
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0427, Accuracy: 9776/9900 (98.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5380/5503 (97.7649%), train_poison_data_count: 430
Global model norm: 44.11691564574466.
Norm before scaling: 44.07791590919922. Distance: 1.2205692797715773
Total norm for 4 adversaries is: 44.07791590919922. distance: 1.2205692797715773
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0364, Accuracy: 9808/9900 (99.0707%)
___Train Local_ResNet_18,  epoch 151, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3753/4028 (93.1728%)
___Train Local_ResNet_18,  epoch 151, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3762/4028 (93.3962%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8339, Accuracy: 5865/10000 (58.6500%)
___Train Local_ResNet_18,  epoch 151, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3936/4161 (94.5926%)
___Train Local_ResNet_18,  epoch 151, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3864/4161 (92.8623%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9510, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 151, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4736/4993 (94.8528%)
___Train Local_ResNet_18,  epoch 151, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4616/4993 (92.4494%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2623, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 151, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4449/4903 (90.7404%)
___Train Local_ResNet_18,  epoch 151, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4360/4903 (88.9251%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.4427, Accuracy: 4902/10000 (49.0200%)
___Train Local_ResNet_18,  epoch 151, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5080/5497 (92.4140%)
___Train Local_ResNet_18,  epoch 151, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4930/5497 (89.6853%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1881, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 151, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4896/5399 (90.6835%)
___Train Local_ResNet_18,  epoch 151, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4729/5399 (87.5903%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3754, Accuracy: 5036/10000 (50.3600%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5653/6068 (93.1608%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5529/6068 (91.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1383, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 151, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4591/4830 (95.0518%)
___Train Local_ResNet_18,  epoch 151, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4510/4830 (93.3747%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1662, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 151, local model 68, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3365/3589 (93.7587%)
___Train Local_ResNet_18,  epoch 151, local model 68, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3177/3589 (88.5205%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3225, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4796/5224 (91.8070%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4761/5224 (91.1371%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1101, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 151, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3680/3968 (92.7419%)
___Train Local_ResNet_18,  epoch 151, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3713/3968 (93.5736%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.7306, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4659/5055 (92.1662%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4602/5055 (91.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2145, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 151, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4596/4979 (92.3077%)
___Train Local_ResNet_18,  epoch 151, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4558/4979 (91.5445%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0468, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 151, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4780/5068 (94.3173%)
___Train Local_ResNet_18,  epoch 151, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4634/5068 (91.4365%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3054, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 151, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3857/4086 (94.3955%)
___Train Local_ResNet_18,  epoch 151, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3875/4086 (94.8360%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9432, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4965/5362 (92.5960%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4860/5362 (90.6378%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1704, Accuracy: 5275/10000 (52.7500%)
time spent on training: 300.2270758152008
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.3002, Accuracy: 6703/10000 (67.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0714, Accuracy: 9714/9900 (98.1212%)
Done in 326.9053068161011 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 7, 81, 4, 44, 5, 99, 83, 55, 94, 14, 32, 74, 20, 49, 23, 62].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5210/5308 (98.1537%), train_poison_data_count: 415
Global model norm: 44.1361502156608.
Norm before scaling: 44.09450023723905. Distance: 1.159903039497335
Total norm for 4 adversaries is: 44.09450023723905. distance: 1.159903039497335
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0878, Accuracy: 9675/9900 (97.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5637/5777 (97.5766%), train_poison_data_count: 455
Global model norm: 44.1361502156608.
Norm before scaling: 44.09272982297861. Distance: 1.2819071224359677
Total norm for 4 adversaries is: 44.09272982297861. distance: 1.2819071224359677
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0539, Accuracy: 9763/9900 (98.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4986/5123 (97.3258%), train_poison_data_count: 403
Global model norm: 44.1361502156608.
Norm before scaling: 44.0993847724057. Distance: 1.260980301405915
Total norm for 4 adversaries is: 44.0993847724057. distance: 1.260980301405915
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0532, Accuracy: 9750/9900 (98.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5381/5503 (97.7830%), train_poison_data_count: 430
Global model norm: 44.1361502156608.
Norm before scaling: 44.095166027493164. Distance: 1.2245327622877789
Total norm for 4 adversaries is: 44.095166027493164. distance: 1.2245327622877789
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0914, Accuracy: 9671/9900 (97.6869%)
___Train Local_ResNet_18,  epoch 152, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4463/4869 (91.6615%)
___Train Local_ResNet_18,  epoch 152, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4328/4869 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2656, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 152, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4763/5035 (94.5978%)
___Train Local_ResNet_18,  epoch 152, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4668/5035 (92.7110%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9190, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3796/4028 (94.2403%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3731/4028 (92.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8574, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 152, local model 44, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4777/5075 (94.1281%)
___Train Local_ResNet_18,  epoch 152, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4665/5075 (91.9212%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2132, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 152, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4744/4993 (95.0130%)
___Train Local_ResNet_18,  epoch 152, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4661/4993 (93.3507%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9190, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 152, local model 99, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4476/4851 (92.2696%)
___Train Local_ResNet_18,  epoch 152, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4493/4851 (92.6201%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9389, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 152, local model 83, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3300/3552 (92.9054%)
___Train Local_ResNet_18,  epoch 152, local model 83, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3341/3552 (94.0597%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7820, Accuracy: 5980/10000 (59.8000%)
___Train Local_ResNet_18,  epoch 152, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4427/4731 (93.5743%)
___Train Local_ResNet_18,  epoch 152, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4355/4731 (92.0524%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9342, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 152, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4796/5224 (91.8070%)
___Train Local_ResNet_18,  epoch 152, local model 94, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4753/5224 (90.9839%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1855, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 152, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4012/4196 (95.6149%)
___Train Local_ResNet_18,  epoch 152, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3984/4196 (94.9476%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7799, Accuracy: 5950/10000 (59.5000%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5524/6080 (90.8553%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5361/6080 (88.1743%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2596, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 152, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4423/4797 (92.2035%)
___Train Local_ResNet_18,  epoch 152, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4376/4797 (91.2237%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0708, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 152, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4441/4714 (94.2087%)
___Train Local_ResNet_18,  epoch 152, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4389/4714 (93.1056%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1059, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 152, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5151/5652 (91.1359%)
___Train Local_ResNet_18,  epoch 152, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4992/5652 (88.3227%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3434, Accuracy: 4994/10000 (49.9400%)
___Train Local_ResNet_18,  epoch 152, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4307/4549 (94.6801%)
___Train Local_ResNet_18,  epoch 152, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4160/4549 (91.4487%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0109, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 152, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4946/5504 (89.8619%)
___Train Local_ResNet_18,  epoch 152, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4798/5504 (87.1730%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.4230, Accuracy: 4769/10000 (47.6900%)
time spent on training: 303.35772371292114
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.3128, Accuracy: 6688/10000 (66.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0684, Accuracy: 9718/9900 (98.1616%)
Done in 329.92646288871765 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 0, 97, 90, 3, 15, 93, 69, 88, 79, 65, 44, 84, 6, 78, 24, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5191/5308 (97.7958%), train_poison_data_count: 415
Global model norm: 44.15453458937924.
Norm before scaling: 44.11607171092101. Distance: 1.2527345310611944
Total norm for 4 adversaries is: 44.11607171092101. distance: 1.2527345310611944
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0250, Accuracy: 9835/9900 (99.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5641/5777 (97.6458%), train_poison_data_count: 455
Global model norm: 44.15453458937924.
Norm before scaling: 44.1112083948591. Distance: 1.2820037857452056
Total norm for 4 adversaries is: 44.1112083948591. distance: 1.2820037857452056
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0866, Accuracy: 9682/9900 (97.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4973/5123 (97.0720%), train_poison_data_count: 403
Global model norm: 44.15453458937924.
Norm before scaling: 44.11720894390306. Distance: 1.2642971655609527
Total norm for 4 adversaries is: 44.11720894390306. distance: 1.2642971655609527
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.2722, Accuracy: 9160/9900 (92.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5378/5503 (97.7285%), train_poison_data_count: 430
Global model norm: 44.15453458937924.
Norm before scaling: 44.1137044567608. Distance: 1.2264571417976675
Total norm for 4 adversaries is: 44.1137044567608. distance: 1.2264571417976675
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0786, Accuracy: 9694/9900 (97.9192%)
___Train Local_ResNet_18,  epoch 153, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5038/5454 (92.3726%)
___Train Local_ResNet_18,  epoch 153, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4852/5454 (88.9622%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2095, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 153, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4330/4736 (91.4274%)
___Train Local_ResNet_18,  epoch 153, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4266/4736 (90.0760%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1446, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 153, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4525/4748 (95.3033%)
___Train Local_ResNet_18,  epoch 153, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4445/4748 (93.6184%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0024, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 153, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5054/5346 (94.5380%)
___Train Local_ResNet_18,  epoch 153, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4997/5346 (93.4718%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0926, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 153, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5570/6068 (91.7930%)
___Train Local_ResNet_18,  epoch 153, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5529/6068 (91.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2831, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch 153, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4707/5055 (93.1157%)
___Train Local_ResNet_18,  epoch 153, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4624/5055 (91.4738%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0505, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 153, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4078/4364 (93.4464%)
___Train Local_ResNet_18,  epoch 153, local model 69, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3955/4364 (90.6279%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0841, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 153, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5037/5362 (93.9388%)
___Train Local_ResNet_18,  epoch 153, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4878/5362 (90.9735%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1587, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 153, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3860/4111 (93.8944%)
___Train Local_ResNet_18,  epoch 153, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3806/4111 (92.5809%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1310, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 153, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5028/5497 (91.4681%)
___Train Local_ResNet_18,  epoch 153, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4971/5497 (90.4311%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2576, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 153, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4803/5075 (94.6404%)
___Train Local_ResNet_18,  epoch 153, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4689/5075 (92.3941%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9831, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 153, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4799/5209 (92.1290%)
___Train Local_ResNet_18,  epoch 153, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4721/5209 (90.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0329, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 153, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4585/4929 (93.0209%)
___Train Local_ResNet_18,  epoch 153, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4503/4929 (91.3573%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1119, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 153, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4097/4368 (93.7958%)
___Train Local_ResNet_18,  epoch 153, local model 78, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3941/4368 (90.2244%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.3577, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch 153, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4033/4313 (93.5080%)
___Train Local_ResNet_18,  epoch 153, local model 24, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3996/4313 (92.6501%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8997, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 153, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3792/4028 (94.1410%)
___Train Local_ResNet_18,  epoch 153, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3738/4028 (92.8004%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9894, Accuracy: 5689/10000 (56.8900%)
time spent on training: 297.22437047958374
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.3196, Accuracy: 6677/10000 (66.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0698, Accuracy: 9719/9900 (98.1717%)
Done in 323.91673517227173 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 38, 89, 81, 43, 21, 40, 78, 9, 14, 83, 85, 20, 65, 97, 3, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5209/5308 (98.1349%), train_poison_data_count: 415
Global model norm: 44.173422549827684.
Norm before scaling: 44.133347021678944. Distance: 1.1902092595794846
Total norm for 4 adversaries is: 44.133347021678944. distance: 1.1902092595794846
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0595, Accuracy: 9749/9900 (98.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5639/5777 (97.6112%), train_poison_data_count: 455
Global model norm: 44.173422549827684.
Norm before scaling: 44.128376342584964. Distance: 1.2546774610828004
Total norm for 4 adversaries is: 44.128376342584964. distance: 1.2546774610828004
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0356, Accuracy: 9805/9900 (99.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5012/5123 (97.8333%), train_poison_data_count: 403
Global model norm: 44.173422549827684.
Norm before scaling: 44.13538409152287. Distance: 1.1966066522788577
Total norm for 4 adversaries is: 44.13538409152287. distance: 1.1966066522788577
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1141, Accuracy: 9614/9900 (97.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5361/5503 (97.4196%), train_poison_data_count: 430
Global model norm: 44.173422549827684.
Norm before scaling: 44.137649235976816. Distance: 1.338756375836346
Total norm for 4 adversaries is: 44.137649235976816. distance: 1.338756375836346
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0553, Accuracy: 9747/9900 (98.4545%)
___Train Local_ResNet_18,  epoch 154, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5618/6235 (90.1043%)
___Train Local_ResNet_18,  epoch 154, local model 38, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5522/6235 (88.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.4134, Accuracy: 4914/10000 (49.1400%)
___Train Local_ResNet_18,  epoch 154, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4366/4737 (92.1680%)
___Train Local_ResNet_18,  epoch 154, local model 89, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4286/4737 (90.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3042, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch 154, local model 81, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4757/5035 (94.4786%)
___Train Local_ResNet_18,  epoch 154, local model 81, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4736/5035 (94.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8887, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 154, local model 43, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4624/4979 (92.8701%)
___Train Local_ResNet_18,  epoch 154, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4536/4979 (91.1026%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0890, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 154, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4656/5038 (92.4176%)
___Train Local_ResNet_18,  epoch 154, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4626/5038 (91.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0481, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 154, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5514/5939 (92.8439%)
___Train Local_ResNet_18,  epoch 154, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5440/5939 (91.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1257, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 154, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4150/4368 (95.0092%)
___Train Local_ResNet_18,  epoch 154, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4107/4368 (94.0247%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0711, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 154, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5296/5727 (92.4742%)
___Train Local_ResNet_18,  epoch 154, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5091/5727 (88.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1210, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 154, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4025/4196 (95.9247%)
___Train Local_ResNet_18,  epoch 154, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3966/4196 (94.5186%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8613, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 154, local model 83, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3320/3552 (93.4685%)
___Train Local_ResNet_18,  epoch 154, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3324/3552 (93.5811%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9450, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 154, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6375/6947 (91.7662%)
___Train Local_ResNet_18,  epoch 154, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6070/6947 (87.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3966, Accuracy: 4908/10000 (49.0800%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4455/4714 (94.5057%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4405/4714 (93.4451%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7784, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 154, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5043/5497 (91.7409%)
___Train Local_ResNet_18,  epoch 154, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4916/5497 (89.4306%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2309, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4354/4736 (91.9341%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4237/4736 (89.4637%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2023, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 154, local model 3, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5100/5346 (95.3984%)
___Train Local_ResNet_18,  epoch 154, local model 3, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5021/5346 (93.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9783, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 154, local model 57, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4610/4956 (93.0186%)
___Train Local_ResNet_18,  epoch 154, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4532/4956 (91.4447%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0681, Accuracy: 5446/10000 (54.4600%)
time spent on training: 291.68663692474365
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.3147, Accuracy: 6683/10000 (66.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0674, Accuracy: 9727/9900 (98.2525%)
Done in 318.44955229759216 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 79, 41, 44, 27, 24, 6, 29, 62, 19, 17, 51, 10, 22, 55, 2, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5197/5308 (97.9088%), train_poison_data_count: 415
Global model norm: 44.19195439226254.
Norm before scaling: 44.15307346589108. Distance: 1.2276620977708403
Total norm for 4 adversaries is: 44.15307346589108. distance: 1.2276620977708403
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0691, Accuracy: 9713/9900 (98.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5641/5777 (97.6458%), train_poison_data_count: 455
Global model norm: 44.19195439226254.
Norm before scaling: 44.14855293848826. Distance: 1.2711382276072052
Total norm for 4 adversaries is: 44.14855293848826. distance: 1.2711382276072052
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1088, Accuracy: 9606/9900 (97.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4975/5123 (97.1111%), train_poison_data_count: 403
Global model norm: 44.19195439226254.
Norm before scaling: 44.154787550976565. Distance: 1.2659810354279772
Total norm for 4 adversaries is: 44.154787550976565. distance: 1.2659810354279772
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0383, Accuracy: 9798/9900 (98.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5405/5503 (98.2192%), train_poison_data_count: 430
Global model norm: 44.19195439226254.
Norm before scaling: 44.15096947371315. Distance: 1.196183230331425
Total norm for 4 adversaries is: 44.15096947371315. distance: 1.196183230331425
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0664, Accuracy: 9734/9900 (98.3232%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3863/4111 (93.9674%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3821/4111 (92.9458%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0145, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 155, local model 41, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4420/4714 (93.7633%)
___Train Local_ResNet_18,  epoch 155, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4393/4714 (93.1905%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1277, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 155, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4795/5075 (94.4828%)
___Train Local_ResNet_18,  epoch 155, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4732/5075 (93.2414%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0683, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 155, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4266/4587 (93.0020%)
___Train Local_ResNet_18,  epoch 155, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4210/4587 (91.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0514, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 155, local model 24, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4061/4313 (94.1572%)
___Train Local_ResNet_18,  epoch 155, local model 24, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4011/4313 (92.9979%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8738, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 155, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4594/4929 (93.2035%)
___Train Local_ResNet_18,  epoch 155, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4464/4929 (90.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1874, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 155, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4476/4732 (94.5900%)
___Train Local_ResNet_18,  epoch 155, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4444/4732 (93.9138%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8798, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 155, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4948/5504 (89.8983%)
___Train Local_ResNet_18,  epoch 155, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4865/5504 (88.3903%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.4237, Accuracy: 5024/10000 (50.2400%)
___Train Local_ResNet_18,  epoch 155, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4856/5361 (90.5801%)
___Train Local_ResNet_18,  epoch 155, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4825/5361 (90.0019%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2644, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 155, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4429/4903 (90.3324%)
___Train Local_ResNet_18,  epoch 155, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4393/4903 (89.5982%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2027, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 155, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3862/4108 (94.0117%)
___Train Local_ResNet_18,  epoch 155, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3795/4108 (92.3807%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9996, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4774/5068 (94.1989%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4479/5068 (88.3781%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.3237, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 155, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5316/5696 (93.3287%)
___Train Local_ResNet_18,  epoch 155, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5194/5696 (91.1868%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2120, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 155, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4450/4731 (94.0605%)
___Train Local_ResNet_18,  epoch 155, local model 55, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4391/4731 (92.8134%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9714, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 155, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3685/3968 (92.8679%)
___Train Local_ResNet_18,  epoch 155, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3644/3968 (91.8347%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0238, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 155, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4003/4249 (94.2104%)
___Train Local_ResNet_18,  epoch 155, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3889/4249 (91.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0350, Accuracy: 5582/10000 (55.8200%)
time spent on training: 302.82887291908264
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.3151, Accuracy: 6685/10000 (66.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0699, Accuracy: 9718/9900 (98.1616%)
Done in 329.1216971874237 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 11, 83, 23, 59, 10, 86, 19, 48, 50, 12, 38, 98, 74, 21, 63, 62].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.21030589648682.
Norm before scaling: 44.169501063728916. Distance: 1.1928759405761387
Total norm for 4 adversaries is: 44.169501063728916. distance: 1.1928759405761387
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0319, Accuracy: 9818/9900 (99.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5669/5777 (98.1305%), train_poison_data_count: 455
Global model norm: 44.21030589648682.
Norm before scaling: 44.165174312690226. Distance: 1.2479018722616733
Total norm for 4 adversaries is: 44.165174312690226. distance: 1.2479018722616733
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0884, Accuracy: 9681/9900 (97.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4983/5123 (97.2672%), train_poison_data_count: 403
Global model norm: 44.21030589648682.
Norm before scaling: 44.17299836075979. Distance: 1.2394578800777445
Total norm for 4 adversaries is: 44.17299836075979. distance: 1.2394578800777445
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0542, Accuracy: 9757/9900 (98.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5383/5503 (97.8194%), train_poison_data_count: 430
Global model norm: 44.21030589648682.
Norm before scaling: 44.16924818639732. Distance: 1.210452813392832
Total norm for 4 adversaries is: 44.16924818639732. distance: 1.210452813392832
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0615, Accuracy: 9738/9900 (98.3636%)
___Train Local_ResNet_18,  epoch 156, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5001/5702 (87.7061%)
___Train Local_ResNet_18,  epoch 156, local model 11, internal_epoch   2,  Average loss: 0.0110, Accuracy: 4467/5702 (78.3409%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.6188, Accuracy: 4603/10000 (46.0300%)
___Train Local_ResNet_18,  epoch 156, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3305/3552 (93.0462%)
___Train Local_ResNet_18,  epoch 156, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3304/3552 (93.0180%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8826, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 156, local model 23, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4332/4549 (95.2297%)
___Train Local_ResNet_18,  epoch 156, local model 23, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3792/4549 (83.3590%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3083, Accuracy: 5022/10000 (50.2200%)
___Train Local_ResNet_18,  epoch 156, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4227/4397 (96.1337%)
___Train Local_ResNet_18,  epoch 156, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4207/4397 (95.6789%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8375, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 156, local model 10, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4807/5068 (94.8500%)
___Train Local_ResNet_18,  epoch 156, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4638/5068 (91.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1768, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 156, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3597/3929 (91.5500%)
___Train Local_ResNet_18,  epoch 156, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3578/3929 (91.0664%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9630, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 156, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4889/5361 (91.1957%)
___Train Local_ResNet_18,  epoch 156, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4816/5361 (89.8340%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0904, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 156, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4574/4830 (94.6998%)
___Train Local_ResNet_18,  epoch 156, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4559/4830 (94.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0023, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 156, local model 50, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4465/4757 (93.8617%)
___Train Local_ResNet_18,  epoch 156, local model 50, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4359/4757 (91.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0903, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 156, local model 12, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5109/5526 (92.4539%)
___Train Local_ResNet_18,  epoch 156, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4888/5526 (88.4546%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1756, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 156, local model 38, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5653/6235 (90.6656%)
___Train Local_ResNet_18,  epoch 156, local model 38, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5465/6235 (87.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2732, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18,  epoch 156, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3882/4161 (93.2949%)
___Train Local_ResNet_18,  epoch 156, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3829/4161 (92.0211%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0425, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 156, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4436/4797 (92.4745%)
___Train Local_ResNet_18,  epoch 156, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4368/4797 (91.0569%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3183, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 156, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4668/5038 (92.6558%)
___Train Local_ResNet_18,  epoch 156, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4690/5038 (93.0925%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8342, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 156, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3712/3910 (94.9361%)
___Train Local_ResNet_18,  epoch 156, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3519/3910 (90.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2035, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4955/5504 (90.0254%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4834/5504 (87.8270%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.4398, Accuracy: 4797/10000 (47.9700%)
time spent on training: 294.69361901283264
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.3156, Accuracy: 6689/10000 (66.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0647, Accuracy: 9731/9900 (98.2929%)
Done in 321.00549840927124 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 7, 2, 12, 90, 33, 98, 27, 94, 1, 52, 14, 48, 96, 37, 20, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5203/5308 (98.0219%), train_poison_data_count: 415
Global model norm: 44.22852696683725.
Norm before scaling: 44.18734253419609. Distance: 1.1947333734332843
Total norm for 4 adversaries is: 44.18734253419609. distance: 1.1947333734332843
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0193, Accuracy: 9849/9900 (99.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5638/5777 (97.5939%), train_poison_data_count: 455
Global model norm: 44.22852696683725.
Norm before scaling: 44.18289182124117. Distance: 1.2670723915735738
Total norm for 4 adversaries is: 44.18289182124117. distance: 1.2670723915735738
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0642, Accuracy: 9734/9900 (98.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4975/5123 (97.1111%), train_poison_data_count: 403
Global model norm: 44.22852696683725.
Norm before scaling: 44.190727925327415. Distance: 1.2942715445912465
Total norm for 4 adversaries is: 44.190727925327415. distance: 1.2942715445912465
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0867, Accuracy: 9672/9900 (97.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5372/5503 (97.6195%), train_poison_data_count: 430
Global model norm: 44.22852696683725.
Norm before scaling: 44.18669470845056. Distance: 1.2350623715824693
Total norm for 4 adversaries is: 44.18669470845056. distance: 1.2350623715824693
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1088, Accuracy: 9614/9900 (97.1111%)
___Train Local_ResNet_18,  epoch 157, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4462/4869 (91.6410%)
___Train Local_ResNet_18,  epoch 157, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4138/4869 (84.9867%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1882, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 157, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3742/3968 (94.3044%)
___Train Local_ResNet_18,  epoch 157, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3754/3968 (94.6069%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8441, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 157, local model 12, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5122/5526 (92.6891%)
___Train Local_ResNet_18,  epoch 157, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4921/5526 (89.0518%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3196, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4502/4748 (94.8189%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4351/4748 (91.6386%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2836, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 157, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4471/4818 (92.7978%)
___Train Local_ResNet_18,  epoch 157, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4395/4818 (91.2204%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8995, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 157, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3944/4161 (94.7849%)
___Train Local_ResNet_18,  epoch 157, local model 98, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3803/4161 (91.3963%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1933, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 157, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4255/4587 (92.7622%)
___Train Local_ResNet_18,  epoch 157, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4167/4587 (90.8437%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1728, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4773/5224 (91.3668%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4712/5224 (90.1991%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3148, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 157, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5168/5422 (95.3154%)
___Train Local_ResNet_18,  epoch 157, local model 1, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5115/5422 (94.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9554, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 157, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3910/4130 (94.6731%)
___Train Local_ResNet_18,  epoch 157, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3814/4130 (92.3487%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2167, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 157, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3999/4196 (95.3051%)
___Train Local_ResNet_18,  epoch 157, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3970/4196 (94.6139%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8825, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4584/4830 (94.9068%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4538/4830 (93.9545%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1522, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 157, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4704/5086 (92.4892%)
___Train Local_ResNet_18,  epoch 157, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4708/5086 (92.5678%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2130, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 157, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4392/4741 (92.6387%)
___Train Local_ResNet_18,  epoch 157, local model 37, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4109/4741 (86.6695%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.4799, Accuracy: 4949/10000 (49.4900%)
___Train Local_ResNet_18,  epoch 157, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4466/4714 (94.7391%)
___Train Local_ResNet_18,  epoch 157, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4453/4714 (94.4633%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9445, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 157, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4638/5122 (90.5506%)
___Train Local_ResNet_18,  epoch 157, local model 28, internal_epoch   2,  Average loss: 0.0119, Accuracy: 4002/5122 (78.1335%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.5206, Accuracy: 4702/10000 (47.0200%)
time spent on training: 297.4586329460144
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.3221, Accuracy: 6667/10000 (66.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0597, Accuracy: 9743/9900 (98.4141%)
Done in 323.82803201675415 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 76, 60, 40, 20, 6, 79, 62, 50, 11, 68, 14, 94, 19, 35, 31, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5205/5308 (98.0595%), train_poison_data_count: 415
Global model norm: 44.246326703555994.
Norm before scaling: 44.20408739894352. Distance: 1.1649551041592658
Total norm for 4 adversaries is: 44.20408739894352. distance: 1.1649551041592658
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0241, Accuracy: 9831/9900 (99.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5654/5777 (97.8709%), train_poison_data_count: 455
Global model norm: 44.246326703555994.
Norm before scaling: 44.200327434448944. Distance: 1.2420044770152414
Total norm for 4 adversaries is: 44.200327434448944. distance: 1.2420044770152414
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0093, Accuracy: 9873/9900 (99.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4994/5123 (97.4819%), train_poison_data_count: 403
Global model norm: 44.246326703555994.
Norm before scaling: 44.20797958496153. Distance: 1.2294476829030698
Total norm for 4 adversaries is: 44.20797958496153. distance: 1.2294476829030698
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0265, Accuracy: 9828/9900 (99.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5352/5503 (97.2560%), train_poison_data_count: 430
Global model norm: 44.246326703555994.
Norm before scaling: 44.20862986003482. Distance: 1.343255329012883
Total norm for 4 adversaries is: 44.20862986003482. distance: 1.343255329012883
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0595, Accuracy: 9743/9900 (98.4141%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3655/3959 (92.3213%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3617/3959 (91.3615%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9510, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 158, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3856/4145 (93.0277%)
___Train Local_ResNet_18,  epoch 158, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3803/4145 (91.7491%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0516, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 158, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5502/5939 (92.6419%)
___Train Local_ResNet_18,  epoch 158, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5414/5939 (91.1601%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9895, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 158, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4482/4714 (95.0785%)
___Train Local_ResNet_18,  epoch 158, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4426/4714 (93.8905%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9105, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 158, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4595/4929 (93.2238%)
___Train Local_ResNet_18,  epoch 158, local model 6, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4472/4929 (90.7283%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1860, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 158, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3866/4111 (94.0404%)
___Train Local_ResNet_18,  epoch 158, local model 79, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3749/4111 (91.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1421, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 158, local model 62, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4974/5504 (90.3706%)
___Train Local_ResNet_18,  epoch 158, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4848/5504 (88.0814%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2096, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 158, local model 50, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4435/4757 (93.2310%)
___Train Local_ResNet_18,  epoch 158, local model 50, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4325/4757 (90.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1349, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 158, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5019/5702 (88.0217%)
___Train Local_ResNet_18,  epoch 158, local model 11, internal_epoch   2,  Average loss: 0.0114, Accuracy: 4431/5702 (77.7096%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.4256, Accuracy: 4770/10000 (47.7000%)
___Train Local_ResNet_18,  epoch 158, local model 68, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3375/3589 (94.0373%)
___Train Local_ResNet_18,  epoch 158, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3370/3589 (93.8980%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9637, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4043/4196 (96.3537%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4004/4196 (95.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7718, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 158, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4789/5224 (91.6730%)
___Train Local_ResNet_18,  epoch 158, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4739/5224 (90.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2609, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 158, local model 19, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4971/5361 (92.7252%)
___Train Local_ResNet_18,  epoch 158, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4766/5361 (88.9013%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2419, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch 158, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5184/5615 (92.3241%)
___Train Local_ResNet_18,  epoch 158, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5126/5615 (91.2912%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2885, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4209/4537 (92.7706%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4164/4537 (91.7787%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0551, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 158, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4428/4732 (93.5757%)
___Train Local_ResNet_18,  epoch 158, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4462/4732 (94.2942%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8383, Accuracy: 5842/10000 (58.4200%)
time spent on training: 299.46358942985535
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.3389, Accuracy: 6620/10000 (66.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0507, Accuracy: 9767/9900 (98.6566%)
Done in 326.19025588035583 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 97, 47, 16, 70, 11, 17, 62, 21, 9, 1, 10, 20, 30, 84, 83, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5216/5308 (98.2668%), train_poison_data_count: 415
Global model norm: 44.26446124485054.
Norm before scaling: 44.22208329971789. Distance: 1.1280669686140539
Total norm for 4 adversaries is: 44.22208329971789. distance: 1.1280669686140539
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0502, Accuracy: 9765/9900 (98.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5640/5777 (97.6285%), train_poison_data_count: 455
Global model norm: 44.26446124485054.
Norm before scaling: 44.221977024474214. Distance: 1.3312938360599487
Total norm for 4 adversaries is: 44.221977024474214. distance: 1.3312938360599487
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0342, Accuracy: 9814/9900 (99.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4966/5123 (96.9354%), train_poison_data_count: 403
Global model norm: 44.26446124485054.
Norm before scaling: 44.225581958967766. Distance: 1.2443466135769643
Total norm for 4 adversaries is: 44.225581958967766. distance: 1.2443466135769643
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0642, Accuracy: 9726/9900 (98.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5376/5503 (97.6922%), train_poison_data_count: 430
Global model norm: 44.26446124485054.
Norm before scaling: 44.224949874547626. Distance: 1.2636382438983738
Total norm for 4 adversaries is: 44.224949874547626. distance: 1.2636382438983738
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0425, Accuracy: 9795/9900 (98.9394%)
___Train Local_ResNet_18,  epoch 159, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4350/4736 (91.8497%)
___Train Local_ResNet_18,  epoch 159, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4304/4736 (90.8784%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0221, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4735/5123 (92.4263%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0104, Accuracy: 4129/5123 (80.5973%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.4600, Accuracy: 4871/10000 (48.7100%)
___Train Local_ResNet_18,  epoch 159, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5024/5353 (93.8539%)
___Train Local_ResNet_18,  epoch 159, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4902/5353 (91.5748%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1008, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 159, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5494/5871 (93.5786%)
___Train Local_ResNet_18,  epoch 159, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5380/5871 (91.6369%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1441, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 159, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5028/5702 (88.1796%)
___Train Local_ResNet_18,  epoch 159, local model 11, internal_epoch   2,  Average loss: 0.0132, Accuracy: 4283/5702 (75.1140%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.3765, Accuracy: 4754/10000 (47.5400%)
___Train Local_ResNet_18,  epoch 159, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4470/4903 (91.1687%)
___Train Local_ResNet_18,  epoch 159, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4395/4903 (89.6390%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.3690, Accuracy: 4931/10000 (49.3100%)
___Train Local_ResNet_18,  epoch 159, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4949/5504 (89.9164%)
___Train Local_ResNet_18,  epoch 159, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4811/5504 (87.4092%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2422, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 159, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4687/5038 (93.0329%)
___Train Local_ResNet_18,  epoch 159, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4638/5038 (92.0603%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1083, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 159, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5264/5727 (91.9155%)
___Train Local_ResNet_18,  epoch 159, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5099/5727 (89.0344%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1356, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 159, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5155/5422 (95.0756%)
___Train Local_ResNet_18,  epoch 159, local model 1, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5087/5422 (93.8215%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9689, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 159, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4803/5068 (94.7711%)
___Train Local_ResNet_18,  epoch 159, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4751/5068 (93.7451%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1523, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4460/4714 (94.6118%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4434/4714 (94.0602%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9767, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 159, local model 30, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3576/3774 (94.7536%)
___Train Local_ResNet_18,  epoch 159, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3561/3774 (94.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9506, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 159, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4799/5209 (92.1290%)
___Train Local_ResNet_18,  epoch 159, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4735/5209 (90.9004%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2321, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 159, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3278/3552 (92.2860%)
___Train Local_ResNet_18,  epoch 159, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3304/3552 (93.0180%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8133, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 159, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3702/3910 (94.6803%)
___Train Local_ResNet_18,  epoch 159, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3573/3910 (91.3811%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1164, Accuracy: 5432/10000 (54.3200%)
time spent on training: 297.34400057792664
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.3381, Accuracy: 6617/10000 (66.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0478, Accuracy: 9774/9900 (98.7273%)
Done in 323.9142072200775 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 82, 6, 27, 91, 61, 74, 8, 42, 9, 15, 85, 19, 89, 48, 96, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5204/5308 (98.0407%), train_poison_data_count: 415
Global model norm: 44.283124519251125.
Norm before scaling: 44.24339391675821. Distance: 1.2203822332134828
Total norm for 4 adversaries is: 44.24339391675821. distance: 1.2203822332134828
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0274, Accuracy: 9832/9900 (99.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5661/5777 (97.9920%), train_poison_data_count: 455
Global model norm: 44.283124519251125.
Norm before scaling: 44.23711522331955. Distance: 1.2384646788277978
Total norm for 4 adversaries is: 44.23711522331955. distance: 1.2384646788277978
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0890, Accuracy: 9668/9900 (97.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4997/5123 (97.5405%), train_poison_data_count: 403
Global model norm: 44.283124519251125.
Norm before scaling: 44.24474583698823. Distance: 1.2294448225307406
Total norm for 4 adversaries is: 44.24474583698823. distance: 1.2294448225307406
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0543, Accuracy: 9752/9900 (98.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5389/5503 (97.9284%), train_poison_data_count: 430
Global model norm: 44.283124519251125.
Norm before scaling: 44.242192328491704. Distance: 1.23987993597384
Total norm for 4 adversaries is: 44.242192328491704. distance: 1.23987993597384
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0390, Accuracy: 9793/9900 (98.9192%)
___Train Local_ResNet_18,  epoch 160, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4919/5298 (92.8464%)
___Train Local_ResNet_18,  epoch 160, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4876/5298 (92.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0481, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 160, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4609/4929 (93.5078%)
___Train Local_ResNet_18,  epoch 160, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4524/4929 (91.7833%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0567, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 160, local model 27, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4289/4587 (93.5034%)
___Train Local_ResNet_18,  epoch 160, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4236/4587 (92.3479%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9727, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4143/4527 (91.5176%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4075/4527 (90.0155%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9360, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4119/4485 (91.8395%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4121/4485 (91.8841%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0697, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 160, local model 74, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4469/4797 (93.1624%)
___Train Local_ResNet_18,  epoch 160, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4384/4797 (91.3905%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0780, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 160, local model 8, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4524/4889 (92.5343%)
___Train Local_ResNet_18,  epoch 160, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4453/4889 (91.0820%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0333, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 160, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5426/5907 (91.8571%)
___Train Local_ResNet_18,  epoch 160, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5386/5907 (91.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1906, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 160, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5250/5727 (91.6710%)
___Train Local_ResNet_18,  epoch 160, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5118/5727 (89.3662%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0651, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 160, local model 15, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5625/6068 (92.6994%)
___Train Local_ResNet_18,  epoch 160, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5585/6068 (92.0402%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1765, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 160, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6372/6947 (91.7230%)
___Train Local_ResNet_18,  epoch 160, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6099/6947 (87.7933%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1382, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 160, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4873/5361 (90.8972%)
___Train Local_ResNet_18,  epoch 160, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4818/5361 (89.8713%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2552, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4361/4737 (92.0625%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4333/4737 (91.4714%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2363, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 160, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4581/4830 (94.8447%)
___Train Local_ResNet_18,  epoch 160, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4488/4830 (92.9193%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1515, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 160, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4761/5086 (93.6099%)
___Train Local_ResNet_18,  epoch 160, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4700/5086 (92.4105%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0502, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 160, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4975/5362 (92.7825%)
___Train Local_ResNet_18,  epoch 160, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4844/5362 (90.3394%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1036, Accuracy: 5245/10000 (52.4500%)
time spent on training: 295.0089375972748
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.3429, Accuracy: 6605/10000 (66.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0437, Accuracy: 9783/9900 (98.8182%)
Done in 321.3244936466217 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 74, 51, 9, 80, 78, 64, 90, 42, 14, 6, 57, 0, 46, 43, 18, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5210/5308 (98.1537%), train_poison_data_count: 415
Global model norm: 44.303441422478684.
Norm before scaling: 44.26048990687829. Distance: 1.1456302925316428
Total norm for 4 adversaries is: 44.26048990687829. distance: 1.1456302925316428
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0613, Accuracy: 9735/9900 (98.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5655/5777 (97.8882%), train_poison_data_count: 455
Global model norm: 44.303441422478684.
Norm before scaling: 44.25752771863364. Distance: 1.2522037630141312
Total norm for 4 adversaries is: 44.25752771863364. distance: 1.2522037630141312
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0451, Accuracy: 9784/9900 (98.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4976/5123 (97.1306%), train_poison_data_count: 403
Global model norm: 44.303441422478684.
Norm before scaling: 44.266084150901435. Distance: 1.2722275959874971
Total norm for 4 adversaries is: 44.266084150901435. distance: 1.2722275959874971
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0159, Accuracy: 9864/9900 (99.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5376/5503 (97.6922%), train_poison_data_count: 430
Global model norm: 44.303441422478684.
Norm before scaling: 44.263227134577384. Distance: 1.2573626169804135
Total norm for 4 adversaries is: 44.263227134577384. distance: 1.2573626169804135
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0550, Accuracy: 9765/9900 (98.6364%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4468/4797 (93.1415%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4414/4797 (92.0158%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0078, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3853/4108 (93.7926%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3788/4108 (92.2103%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9258, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 161, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5223/5727 (91.1996%)
___Train Local_ResNet_18,  epoch 161, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5137/5727 (89.6979%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1274, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 161, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5047/5461 (92.4190%)
___Train Local_ResNet_18,  epoch 161, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4963/5461 (90.8808%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3741, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 161, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4130/4368 (94.5513%)
___Train Local_ResNet_18,  epoch 161, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4015/4368 (91.9185%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0224, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 161, local model 64, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4511/4894 (92.1741%)
___Train Local_ResNet_18,  epoch 161, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4439/4894 (90.7029%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2059, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 161, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4506/4748 (94.9031%)
___Train Local_ResNet_18,  epoch 161, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4332/4748 (91.2384%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0505, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 161, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5449/5907 (92.2465%)
___Train Local_ResNet_18,  epoch 161, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5350/5907 (90.5705%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.5123, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch 161, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3989/4196 (95.0667%)
___Train Local_ResNet_18,  epoch 161, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3970/4196 (94.6139%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7776, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 161, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4654/4929 (94.4208%)
___Train Local_ResNet_18,  epoch 161, local model 6, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4471/4929 (90.7081%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1906, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 161, local model 57, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4634/4956 (93.5028%)
___Train Local_ResNet_18,  epoch 161, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4544/4956 (91.6868%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2124, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 161, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5050/5454 (92.5926%)
___Train Local_ResNet_18,  epoch 161, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4901/5454 (89.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2224, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 161, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4915/5399 (91.0354%)
___Train Local_ResNet_18,  epoch 161, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4709/5399 (87.2199%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.5249, Accuracy: 4808/10000 (48.0800%)
___Train Local_ResNet_18,  epoch 161, local model 43, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4666/4979 (93.7136%)
___Train Local_ResNet_18,  epoch 161, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4593/4979 (92.2474%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9729, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 161, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4020/4249 (94.6105%)
___Train Local_ResNet_18,  epoch 161, local model 18, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3956/4249 (93.1043%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9910, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 161, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4609/5050 (91.2673%)
___Train Local_ResNet_18,  epoch 161, local model 77, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4451/5050 (88.1386%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2486, Accuracy: 5102/10000 (51.0200%)
time spent on training: 291.50386333465576
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.3557, Accuracy: 6572/10000 (65.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0424, Accuracy: 9783/9900 (98.8182%)
Done in 318.26815700531006 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 27, 87, 60, 89, 4, 98, 25, 54, 90, 2, 44, 35, 74, 78, 92, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5214/5308 (98.2291%), train_poison_data_count: 415
Global model norm: 44.32242704390747.
Norm before scaling: 44.279227911223366. Distance: 1.1260613097748662
Total norm for 4 adversaries is: 44.279227911223366. distance: 1.1260613097748662
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0495, Accuracy: 9771/9900 (98.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5641/5777 (97.6458%), train_poison_data_count: 455
Global model norm: 44.32242704390747.
Norm before scaling: 44.27820235851454. Distance: 1.288109999656792
Total norm for 4 adversaries is: 44.27820235851454. distance: 1.288109999656792
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0219, Accuracy: 9839/9900 (99.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4983/5123 (97.2672%), train_poison_data_count: 403
Global model norm: 44.32242704390747.
Norm before scaling: 44.282108705064935. Distance: 1.2271933421556145
Total norm for 4 adversaries is: 44.282108705064935. distance: 1.2271933421556145
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1095, Accuracy: 9596/9900 (96.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5384/5503 (97.8375%), train_poison_data_count: 430
Global model norm: 44.32242704390747.
Norm before scaling: 44.282206566061895. Distance: 1.2669647566659004
Total norm for 4 adversaries is: 44.282206566061895. distance: 1.2669647566659004
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0167, Accuracy: 9858/9900 (99.5758%)
___Train Local_ResNet_18,  epoch 162, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4284/4587 (93.3944%)
___Train Local_ResNet_18,  epoch 162, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4220/4587 (91.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9875, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 162, local model 87, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3650/3995 (91.3642%)
___Train Local_ResNet_18,  epoch 162, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3607/3995 (90.2879%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0581, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 162, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3848/4145 (92.8347%)
___Train Local_ResNet_18,  epoch 162, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3815/4145 (92.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1367, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 162, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4388/4737 (92.6325%)
___Train Local_ResNet_18,  epoch 162, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4327/4737 (91.3447%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.4273, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 162, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3765/4028 (93.4707%)
___Train Local_ResNet_18,  epoch 162, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3750/4028 (93.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9447, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3974/4161 (95.5059%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3891/4161 (93.5112%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9580, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5785/6419 (90.1231%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5461/6419 (85.0756%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2908, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5109/5645 (90.5049%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4780/5645 (84.6767%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.3137, Accuracy: 4997/10000 (49.9700%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4490/4748 (94.5661%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4354/4748 (91.7018%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0625, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 162, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3727/3968 (93.9264%)
___Train Local_ResNet_18,  epoch 162, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3731/3968 (94.0272%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.7947, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18,  epoch 162, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4801/5075 (94.6010%)
___Train Local_ResNet_18,  epoch 162, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4726/5075 (93.1232%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9811, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 162, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5219/5615 (92.9475%)
___Train Local_ResNet_18,  epoch 162, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5140/5615 (91.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0662, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 162, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4469/4797 (93.1624%)
___Train Local_ResNet_18,  epoch 162, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4347/4797 (90.6191%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0074, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 162, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4152/4368 (95.0549%)
___Train Local_ResNet_18,  epoch 162, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4078/4368 (93.3608%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9852, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 162, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 6429/6812 (94.3776%)
___Train Local_ResNet_18,  epoch 162, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6227/6812 (91.4122%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9908, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 162, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4776/5068 (94.2384%)
___Train Local_ResNet_18,  epoch 162, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4649/5068 (91.7324%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0345, Accuracy: 5421/10000 (54.2100%)
time spent on training: 299.3158977031708
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.3673, Accuracy: 6551/10000 (65.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0413, Accuracy: 9784/9900 (98.8283%)
Done in 325.70182180404663 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 95, 8, 67, 7, 31, 90, 40, 65, 34, 20, 2, 82, 51, 83, 86, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5202/5308 (98.0030%), train_poison_data_count: 415
Global model norm: 44.33998673689614.
Norm before scaling: 44.29858076521752. Distance: 1.185560248360785
Total norm for 4 adversaries is: 44.29858076521752. distance: 1.185560248360785
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0339, Accuracy: 9818/9900 (99.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5662/5777 (98.0093%), train_poison_data_count: 455
Global model norm: 44.33998673689614.
Norm before scaling: 44.291684274798556. Distance: 1.2127516416571207
Total norm for 4 adversaries is: 44.291684274798556. distance: 1.2127516416571207
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0265, Accuracy: 9832/9900 (99.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5000/5123 (97.5991%), train_poison_data_count: 403
Global model norm: 44.33998673689614.
Norm before scaling: 44.30141621343075. Distance: 1.238123790465009
Total norm for 4 adversaries is: 44.30141621343075. distance: 1.238123790465009
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0497, Accuracy: 9781/9900 (98.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5379/5503 (97.7467%), train_poison_data_count: 430
Global model norm: 44.33998673689614.
Norm before scaling: 44.2989004166582. Distance: 1.2209612031876078
Total norm for 4 adversaries is: 44.2989004166582. distance: 1.2209612031876078
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0737, Accuracy: 9697/9900 (97.9495%)
___Train Local_ResNet_18,  epoch 163, local model 95, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4504/5018 (89.7569%)
___Train Local_ResNet_18,  epoch 163, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4449/5018 (88.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1089, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 163, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4556/4889 (93.1888%)
___Train Local_ResNet_18,  epoch 163, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4398/4889 (89.9570%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1549, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5077/5559 (91.3294%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4921/5559 (88.5231%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.4866, Accuracy: 4810/10000 (48.1000%)
___Train Local_ResNet_18,  epoch 163, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4481/4869 (92.0312%)
___Train Local_ResNet_18,  epoch 163, local model 7, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3986/4869 (81.8649%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2261, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 163, local model 31, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4270/4537 (94.1151%)
___Train Local_ResNet_18,  epoch 163, local model 31, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4224/4537 (93.1012%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9511, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4549/4748 (95.8088%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4477/4748 (94.2923%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9690, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 163, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5549/5939 (93.4332%)
___Train Local_ResNet_18,  epoch 163, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5455/5939 (91.8505%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1056, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5078/5497 (92.3777%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4957/5497 (90.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1435, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 163, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4565/4911 (92.9546%)
___Train Local_ResNet_18,  epoch 163, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4564/4911 (92.9342%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0015, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4477/4714 (94.9724%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4424/4714 (93.8481%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8669, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3716/3968 (93.6492%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3704/3968 (93.3468%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9343, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 163, local model 82, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4968/5298 (93.7712%)
___Train Local_ResNet_18,  epoch 163, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4953/5298 (93.4881%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0949, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 163, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3872/4108 (94.2551%)
___Train Local_ResNet_18,  epoch 163, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3878/4108 (94.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9991, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 163, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3285/3552 (92.4831%)
___Train Local_ResNet_18,  epoch 163, local model 83, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3358/3552 (94.5383%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7569, Accuracy: 5954/10000 (59.5400%)
___Train Local_ResNet_18,  epoch 163, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3600/3929 (91.6264%)
___Train Local_ResNet_18,  epoch 163, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3578/3929 (91.0664%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9708, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 163, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 6466/6812 (94.9207%)
___Train Local_ResNet_18,  epoch 163, local model 92, internal_epoch   2,  Average loss: 0.0036, Accuracy: 6338/6812 (93.0417%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1198, Accuracy: 5429/10000 (54.2900%)
time spent on training: 310.0942885875702
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.3676, Accuracy: 6553/10000 (65.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0413, Accuracy: 9784/9900 (98.8283%)
Done in 336.76581597328186 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 93, 42, 22, 44, 28, 6, 70, 27, 35, 41, 8, 24, 26, 60, 31, 12].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5212/5308 (98.1914%), train_poison_data_count: 415
Global model norm: 44.357616533479906.
Norm before scaling: 44.315886848267375. Distance: 1.159768550325625
Total norm for 4 adversaries is: 44.315886848267375. distance: 1.159768550325625
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0538, Accuracy: 9744/9900 (98.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5635/5777 (97.5420%), train_poison_data_count: 455
Global model norm: 44.357616533479906.
Norm before scaling: 44.312975193591015. Distance: 1.3002458449966414
Total norm for 4 adversaries is: 44.312975193591015. distance: 1.3002458449966414
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0717, Accuracy: 9715/9900 (98.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5008/5123 (97.7552%), train_poison_data_count: 403
Global model norm: 44.357616533479906.
Norm before scaling: 44.31857933879847. Distance: 1.2322370629400587
Total norm for 4 adversaries is: 44.31857933879847. distance: 1.2322370629400587
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0678, Accuracy: 9696/9900 (97.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5386/5503 (97.8739%), train_poison_data_count: 430
Global model norm: 44.357616533479906.
Norm before scaling: 44.31585241638284. Distance: 1.2473116098320378
Total norm for 4 adversaries is: 44.31585241638284. distance: 1.2473116098320378
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0780, Accuracy: 9682/9900 (97.7980%)
___Train Local_ResNet_18,  epoch 164, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4670/5055 (92.3838%)
___Train Local_ResNet_18,  epoch 164, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4634/5055 (91.6716%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1798, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 164, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5446/5907 (92.1957%)
___Train Local_ResNet_18,  epoch 164, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5278/5907 (89.3516%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.4732, Accuracy: 4761/10000 (47.6100%)
___Train Local_ResNet_18,  epoch 164, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5284/5696 (92.7669%)
___Train Local_ResNet_18,  epoch 164, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5098/5696 (89.5014%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2965, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch 164, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4781/5075 (94.2069%)
___Train Local_ResNet_18,  epoch 164, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4668/5075 (91.9803%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1791, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 164, local model 28, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4692/5122 (91.6048%)
___Train Local_ResNet_18,  epoch 164, local model 28, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4201/5122 (82.0187%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.5120, Accuracy: 4658/10000 (46.5800%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4657/4929 (94.4816%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4538/4929 (92.0674%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0270, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 164, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5504/5871 (93.7489%)
___Train Local_ResNet_18,  epoch 164, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5375/5871 (91.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2680, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 164, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4280/4587 (93.3072%)
___Train Local_ResNet_18,  epoch 164, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4220/4587 (91.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9990, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 164, local model 35, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5254/5615 (93.5708%)
___Train Local_ResNet_18,  epoch 164, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5077/5615 (90.4185%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2440, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 164, local model 41, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4438/4714 (94.1451%)
___Train Local_ResNet_18,  epoch 164, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4402/4714 (93.3814%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1286, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 164, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4565/4889 (93.3729%)
___Train Local_ResNet_18,  epoch 164, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4455/4889 (91.1229%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0773, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 164, local model 24, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4052/4313 (93.9485%)
___Train Local_ResNet_18,  epoch 164, local model 24, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4034/4313 (93.5312%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8611, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 164, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3857/4086 (94.3955%)
___Train Local_ResNet_18,  epoch 164, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3817/4086 (93.4165%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0048, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 164, local model 60, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3849/4145 (92.8589%)
___Train Local_ResNet_18,  epoch 164, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3847/4145 (92.8106%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0263, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 164, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4251/4537 (93.6963%)
___Train Local_ResNet_18,  epoch 164, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4184/4537 (92.2195%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8932, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 164, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5074/5526 (91.8205%)
___Train Local_ResNet_18,  epoch 164, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4909/5526 (88.8346%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2914, Accuracy: 5067/10000 (50.6700%)
time spent on training: 303.7861068248749
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.3761, Accuracy: 6542/10000 (65.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0398, Accuracy: 9788/9900 (98.8687%)
Done in 330.55902075767517 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 90, 84, 56, 79, 2, 19, 51, 77, 98, 18, 60, 16, 88, 63, 69, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5214/5308 (98.2291%), train_poison_data_count: 415
Global model norm: 44.37642218231574.
Norm before scaling: 44.334759758586294. Distance: 1.1798739254406347
Total norm for 4 adversaries is: 44.334759758586294. distance: 1.1798739254406347
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0585, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5657/5777 (97.9228%), train_poison_data_count: 455
Global model norm: 44.37642218231574.
Norm before scaling: 44.33044225305633. Distance: 1.2706537536730167
Total norm for 4 adversaries is: 44.33044225305633. distance: 1.2706537536730167
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0744, Accuracy: 9713/9900 (98.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4990/5123 (97.4039%), train_poison_data_count: 403
Global model norm: 44.37642218231574.
Norm before scaling: 44.33760115270742. Distance: 1.2296326718352328
Total norm for 4 adversaries is: 44.33760115270742. distance: 1.2296326718352328
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1156, Accuracy: 9592/9900 (96.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5394/5503 (98.0193%), train_poison_data_count: 430
Global model norm: 44.37642218231574.
Norm before scaling: 44.33317653848174. Distance: 1.2161976914169215
Total norm for 4 adversaries is: 44.33317653848174. distance: 1.2161976914169215
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0660, Accuracy: 9730/9900 (98.2828%)
___Train Local_ResNet_18,  epoch 165, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4520/4748 (95.1980%)
___Train Local_ResNet_18,  epoch 165, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4397/4748 (92.6074%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0330, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4834/5209 (92.8009%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4716/5209 (90.5356%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2912, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 165, local model 56, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5013/5427 (92.3715%)
___Train Local_ResNet_18,  epoch 165, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4823/5427 (88.8705%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0826, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 165, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3877/4111 (94.3080%)
___Train Local_ResNet_18,  epoch 165, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3773/4111 (91.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1122, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 165, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3771/3968 (95.0353%)
___Train Local_ResNet_18,  epoch 165, local model 2, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3750/3968 (94.5060%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7563, Accuracy: 5973/10000 (59.7300%)
___Train Local_ResNet_18,  epoch 165, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4936/5361 (92.0724%)
___Train Local_ResNet_18,  epoch 165, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4765/5361 (88.8827%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1807, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 165, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3893/4108 (94.7663%)
___Train Local_ResNet_18,  epoch 165, local model 51, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3699/4108 (90.0438%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2111, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 165, local model 77, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4641/5050 (91.9010%)
___Train Local_ResNet_18,  epoch 165, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4530/5050 (89.7030%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0747, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 165, local model 98, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3917/4161 (94.1360%)
___Train Local_ResNet_18,  epoch 165, local model 98, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3843/4161 (92.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0839, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 165, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3971/4249 (93.4573%)
___Train Local_ResNet_18,  epoch 165, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3872/4249 (91.1273%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1249, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 165, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3884/4145 (93.7033%)
___Train Local_ResNet_18,  epoch 165, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3836/4145 (92.5452%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0803, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 165, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5026/5353 (93.8913%)
___Train Local_ResNet_18,  epoch 165, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4874/5353 (91.0517%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2524, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 165, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4957/5362 (92.4468%)
___Train Local_ResNet_18,  epoch 165, local model 88, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4905/5362 (91.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2502, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 165, local model 63, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3714/3910 (94.9872%)
___Train Local_ResNet_18,  epoch 165, local model 63, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3647/3910 (93.2737%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2113, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 165, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4084/4364 (93.5839%)
___Train Local_ResNet_18,  epoch 165, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3997/4364 (91.5903%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0234, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 165, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5288/5727 (92.3346%)
___Train Local_ResNet_18,  epoch 165, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5106/5727 (89.1566%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0675, Accuracy: 5452/10000 (54.5200%)
time spent on training: 305.48724246025085
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.3924, Accuracy: 6514/10000 (65.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0403, Accuracy: 9787/9900 (98.8586%)
Done in 332.22881388664246 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 37, 97, 49, 32, 82, 55, 2, 63, 31, 12, 87, 60, 93, 0, 66, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5184/5308 (97.6639%), train_poison_data_count: 415
Global model norm: 44.39434272534762.
Norm before scaling: 44.354820455687225. Distance: 1.250488471910372
Total norm for 4 adversaries is: 44.354820455687225. distance: 1.250488471910372
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0556, Accuracy: 9758/9900 (98.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5670/5777 (98.1478%), train_poison_data_count: 455
Global model norm: 44.39434272534762.
Norm before scaling: 44.3469114997912. Distance: 1.1984953546796078
Total norm for 4 adversaries is: 44.3469114997912. distance: 1.1984953546796078
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0560, Accuracy: 9747/9900 (98.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4982/5123 (97.2477%), train_poison_data_count: 403
Global model norm: 44.39434272534762.
Norm before scaling: 44.354944301445975. Distance: 1.2377990842890099
Total norm for 4 adversaries is: 44.354944301445975. distance: 1.2377990842890099
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0540, Accuracy: 9756/9900 (98.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5386/5503 (97.8739%), train_poison_data_count: 430
Global model norm: 44.39434272534762.
Norm before scaling: 44.35233933946227. Distance: 1.2364251217751085
Total norm for 4 adversaries is: 44.35233933946227. distance: 1.2364251217751085
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0299, Accuracy: 9821/9900 (99.2020%)
___Train Local_ResNet_18,  epoch 166, local model 37, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4425/4741 (93.3347%)
___Train Local_ResNet_18,  epoch 166, local model 37, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4200/4741 (88.5889%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.4450, Accuracy: 4979/10000 (49.7900%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4307/4736 (90.9417%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4223/4736 (89.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3162, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 166, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5163/5652 (91.3482%)
___Train Local_ResNet_18,  epoch 166, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5032/5652 (89.0304%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2509, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 166, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5485/6080 (90.2138%)
___Train Local_ResNet_18,  epoch 166, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5343/6080 (87.8783%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3699, Accuracy: 4941/10000 (49.4100%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5017/5298 (94.6961%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4948/5298 (93.3937%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9287, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 166, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4470/4731 (94.4832%)
___Train Local_ResNet_18,  epoch 166, local model 55, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4438/4731 (93.8068%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8703, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 166, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3764/3968 (94.8589%)
___Train Local_ResNet_18,  epoch 166, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3707/3968 (93.4224%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8872, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 166, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3708/3910 (94.8338%)
___Train Local_ResNet_18,  epoch 166, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3538/3910 (90.4859%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1845, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 166, local model 31, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4273/4537 (94.1812%)
___Train Local_ResNet_18,  epoch 166, local model 31, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4190/4537 (92.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9365, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 166, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5062/5526 (91.6033%)
___Train Local_ResNet_18,  epoch 166, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4941/5526 (89.4137%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3145, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch 166, local model 87, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3703/3995 (92.6909%)
___Train Local_ResNet_18,  epoch 166, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3623/3995 (90.6884%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0476, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 166, local model 60, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3884/4145 (93.7033%)
___Train Local_ResNet_18,  epoch 166, local model 60, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3894/4145 (93.9445%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0601, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 166, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4715/5055 (93.2740%)
___Train Local_ResNet_18,  epoch 166, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4595/5055 (90.9001%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0677, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 166, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5033/5454 (92.2809%)
___Train Local_ResNet_18,  epoch 166, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4839/5454 (88.7239%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3150, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch 166, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4488/4843 (92.6698%)
___Train Local_ResNet_18,  epoch 166, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4487/4843 (92.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9327, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 166, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3896/4130 (94.3341%)
___Train Local_ResNet_18,  epoch 166, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3826/4130 (92.6392%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0835, Accuracy: 5514/10000 (55.1400%)
time spent on training: 309.77714467048645
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.3942, Accuracy: 6497/10000 (64.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0392, Accuracy: 9792/9900 (98.9091%)
Done in 336.2556252479553 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 59, 98, 38, 39, 7, 3, 32, 76, 35, 66, 73, 20, 74, 49, 62, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5197/5308 (97.9088%), train_poison_data_count: 415
Global model norm: 44.41248416830565.
Norm before scaling: 44.36920764352303. Distance: 1.1601100103237911
Total norm for 4 adversaries is: 44.36920764352303. distance: 1.1601100103237911
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0319, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5680/5777 (98.3209%), train_poison_data_count: 455
Global model norm: 44.41248416830565.
Norm before scaling: 44.364666490491054. Distance: 1.198622713859177
Total norm for 4 adversaries is: 44.364666490491054. distance: 1.198622713859177
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0433, Accuracy: 9783/9900 (98.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4996/5123 (97.5210%), train_poison_data_count: 403
Global model norm: 44.41248416830565.
Norm before scaling: 44.3727469718534. Distance: 1.2051709106930488
Total norm for 4 adversaries is: 44.3727469718534. distance: 1.2051709106930488
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0643, Accuracy: 9734/9900 (98.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5371/5503 (97.6013%), train_poison_data_count: 430
Global model norm: 44.41248416830565.
Norm before scaling: 44.373815730235975. Distance: 1.3060481577168483
Total norm for 4 adversaries is: 44.373815730235975. distance: 1.3060481577168483
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0479, Accuracy: 9784/9900 (98.8283%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4232/4397 (96.2474%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0019, Accuracy: 4242/4397 (96.4749%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7188, Accuracy: 6091/10000 (60.9100%)
___Train Local_ResNet_18,  epoch 167, local model 98, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3936/4161 (94.5926%)
___Train Local_ResNet_18,  epoch 167, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3832/4161 (92.0932%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3573, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 167, local model 38, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5645/6235 (90.5373%)
___Train Local_ResNet_18,  epoch 167, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5504/6235 (88.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.4983, Accuracy: 4787/10000 (47.8700%)
___Train Local_ResNet_18,  epoch 167, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3898/4175 (93.3653%)
___Train Local_ResNet_18,  epoch 167, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3779/4175 (90.5150%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1296, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 167, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4470/4869 (91.8053%)
___Train Local_ResNet_18,  epoch 167, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4169/4869 (85.6233%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3334, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 167, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5042/5346 (94.3135%)
___Train Local_ResNet_18,  epoch 167, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4908/5346 (91.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3030, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 167, local model 32, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5503/6080 (90.5099%)
___Train Local_ResNet_18,  epoch 167, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5328/6080 (87.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2658, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 167, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3651/3959 (92.2203%)
___Train Local_ResNet_18,  epoch 167, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3564/3959 (90.0227%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0520, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 167, local model 35, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5199/5615 (92.5913%)
___Train Local_ResNet_18,  epoch 167, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5143/5615 (91.5939%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2099, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4514/4843 (93.2067%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4436/4843 (91.5961%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9714, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 167, local model 73, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4387/4605 (95.2660%)
___Train Local_ResNet_18,  epoch 167, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4339/4605 (94.2237%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8658, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 167, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4473/4714 (94.8876%)
___Train Local_ResNet_18,  epoch 167, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4426/4714 (93.8905%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9824, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 167, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4420/4797 (92.1409%)
___Train Local_ResNet_18,  epoch 167, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4336/4797 (90.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1364, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 167, local model 49, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5170/5652 (91.4720%)
___Train Local_ResNet_18,  epoch 167, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5087/5652 (90.0035%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1796, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4923/5504 (89.4440%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4815/5504 (87.4818%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3412, Accuracy: 4990/10000 (49.9000%)
___Train Local_ResNet_18,  epoch 167, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4777/5075 (94.1281%)
___Train Local_ResNet_18,  epoch 167, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4573/5075 (90.1084%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0315, Accuracy: 5515/10000 (55.1500%)
time spent on training: 277.76915407180786
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.3966, Accuracy: 6506/10000 (65.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0402, Accuracy: 9790/9900 (98.8889%)
Done in 303.92819333076477 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 32, 2, 40, 91, 74, 50, 6, 92, 53, 87, 69, 86, 52, 37, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5208/5308 (98.1161%), train_poison_data_count: 415
Global model norm: 44.431273462769866.
Norm before scaling: 44.389020397345305. Distance: 1.1850437561036766
Total norm for 4 adversaries is: 44.389020397345305. distance: 1.1850437561036766
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0130, Accuracy: 9866/9900 (99.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5652/5777 (97.8362%), train_poison_data_count: 455
Global model norm: 44.431273462769866.
Norm before scaling: 44.38419661523331. Distance: 1.2327786517119856
Total norm for 4 adversaries is: 44.38419661523331. distance: 1.2327786517119856
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0506, Accuracy: 9769/9900 (98.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4997/5123 (97.5405%), train_poison_data_count: 403
Global model norm: 44.431273462769866.
Norm before scaling: 44.39278362843729. Distance: 1.2350492446749464
Total norm for 4 adversaries is: 44.39278362843729. distance: 1.2350492446749464
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.2222, Accuracy: 9281/9900 (93.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5369/5503 (97.5650%), train_poison_data_count: 430
Global model norm: 44.431273462769866.
Norm before scaling: 44.39015613752741. Distance: 1.2839073443538687
Total norm for 4 adversaries is: 44.39015613752741. distance: 1.2839073443538687
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0274, Accuracy: 9834/9900 (99.3333%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3919/4175 (93.8683%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3814/4175 (91.3533%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9336, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 168, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5459/6080 (89.7862%)
___Train Local_ResNet_18,  epoch 168, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5262/6080 (86.5461%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.4551, Accuracy: 4823/10000 (48.2300%)
___Train Local_ResNet_18,  epoch 168, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3755/3968 (94.6321%)
___Train Local_ResNet_18,  epoch 168, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3765/3968 (94.8841%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7729, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5529/5939 (93.0965%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5385/5939 (90.6718%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2471, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 168, local model 91, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4117/4527 (90.9432%)
___Train Local_ResNet_18,  epoch 168, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3988/4527 (88.0937%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1381, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 168, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4506/4797 (93.9337%)
___Train Local_ResNet_18,  epoch 168, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4400/4797 (91.7240%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0436, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 168, local model 50, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4461/4757 (93.7776%)
___Train Local_ResNet_18,  epoch 168, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4298/4757 (90.3511%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1307, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 168, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4626/4929 (93.8527%)
___Train Local_ResNet_18,  epoch 168, local model 6, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4507/4929 (91.4384%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1850, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 168, local model 92, internal_epoch   1,  Average loss: 0.0026, Accuracy: 6472/6812 (95.0088%)
___Train Local_ResNet_18,  epoch 168, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 6267/6812 (91.9994%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3050, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 168, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5947/6664 (89.2407%)
___Train Local_ResNet_18,  epoch 168, local model 53, internal_epoch   2,  Average loss: 0.0081, Accuracy: 5599/6664 (84.0186%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3313, Accuracy: 4839/10000 (48.3900%)
___Train Local_ResNet_18,  epoch 168, local model 87, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3690/3995 (92.3655%)
___Train Local_ResNet_18,  epoch 168, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3611/3995 (90.3880%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2343, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 168, local model 69, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4067/4364 (93.1943%)
___Train Local_ResNet_18,  epoch 168, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4038/4364 (92.5298%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1249, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 168, local model 86, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3617/3929 (92.0590%)
___Train Local_ResNet_18,  epoch 168, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3579/3929 (91.0919%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1162, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 168, local model 52, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3887/4130 (94.1162%)
___Train Local_ResNet_18,  epoch 168, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3781/4130 (91.5496%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0678, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 168, local model 37, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4386/4741 (92.5121%)
___Train Local_ResNet_18,  epoch 168, local model 37, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4067/4741 (85.7836%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2951, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 168, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5512/5871 (93.8852%)
___Train Local_ResNet_18,  epoch 168, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5328/5871 (90.7511%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2599, Accuracy: 5229/10000 (52.2900%)
time spent on training: 277.77378249168396
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.3985, Accuracy: 6500/10000 (65.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0424, Accuracy: 9787/9900 (98.8586%)
Done in 304.60242772102356 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 30, 23, 34, 24, 2, 67, 21, 72, 83, 87, 29, 15, 42, 37, 70, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5211/5308 (98.1726%), train_poison_data_count: 415
Global model norm: 44.45047910623054.
Norm before scaling: 44.40676817299715. Distance: 1.1544480071554892
Total norm for 4 adversaries is: 44.40676817299715. distance: 1.1544480071554892
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0329, Accuracy: 9809/9900 (99.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5654/5777 (97.8709%), train_poison_data_count: 455
Global model norm: 44.45047910623054.
Norm before scaling: 44.40481365331846. Distance: 1.2641497361456173
Total norm for 4 adversaries is: 44.40481365331846. distance: 1.2641497361456173
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0235, Accuracy: 9839/9900 (99.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4974/5123 (97.0915%), train_poison_data_count: 403
Global model norm: 44.45047910623054.
Norm before scaling: 44.41175442001884. Distance: 1.251139884013333
Total norm for 4 adversaries is: 44.41175442001884. distance: 1.251139884013333
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0357, Accuracy: 9807/9900 (99.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5387/5503 (97.8921%), train_poison_data_count: 430
Global model norm: 44.45047910623054.
Norm before scaling: 44.407440276975265. Distance: 1.243130404008461
Total norm for 4 adversaries is: 44.407440276975265. distance: 1.243130404008461
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0213, Accuracy: 9851/9900 (99.5051%)
___Train Local_ResNet_18,  epoch 169, local model 30, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3574/3774 (94.7006%)
___Train Local_ResNet_18,  epoch 169, local model 30, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3558/3774 (94.2766%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8983, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 169, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4285/4549 (94.1965%)
___Train Local_ResNet_18,  epoch 169, local model 23, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4231/4549 (93.0095%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9159, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 169, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4602/4911 (93.7080%)
___Train Local_ResNet_18,  epoch 169, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4526/4911 (92.1605%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1072, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 169, local model 24, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4060/4313 (94.1340%)
___Train Local_ResNet_18,  epoch 169, local model 24, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4017/4313 (93.1370%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9308, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3773/3968 (95.0857%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3726/3968 (93.9012%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7275, Accuracy: 5961/10000 (59.6100%)
___Train Local_ResNet_18,  epoch 169, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5121/5559 (92.1209%)
___Train Local_ResNet_18,  epoch 169, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4965/5559 (89.3146%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2352, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 169, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4702/5038 (93.3307%)
___Train Local_ResNet_18,  epoch 169, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4601/5038 (91.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0781, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 169, local model 72, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4765/5193 (91.7581%)
___Train Local_ResNet_18,  epoch 169, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4637/5193 (89.2933%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2842, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 169, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3279/3552 (92.3142%)
___Train Local_ResNet_18,  epoch 169, local model 83, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3266/3552 (91.9482%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8418, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 169, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3698/3995 (92.5657%)
___Train Local_ResNet_18,  epoch 169, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3599/3995 (90.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1366, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 169, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4478/4732 (94.6323%)
___Train Local_ResNet_18,  epoch 169, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4479/4732 (94.6534%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8621, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 169, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5624/6068 (92.6829%)
___Train Local_ResNet_18,  epoch 169, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5464/6068 (90.0461%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2147, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 169, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5370/5907 (90.9091%)
___Train Local_ResNet_18,  epoch 169, local model 42, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5257/5907 (88.9961%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.5771, Accuracy: 4744/10000 (47.4400%)
___Train Local_ResNet_18,  epoch 169, local model 37, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4427/4741 (93.3769%)
___Train Local_ResNet_18,  epoch 169, local model 37, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4105/4741 (86.5851%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.6640, Accuracy: 4679/10000 (46.7900%)
___Train Local_ResNet_18,  epoch 169, local model 70, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5515/5871 (93.9363%)
___Train Local_ResNet_18,  epoch 169, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5400/5871 (91.9775%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0775, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 169, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3876/4111 (94.2836%)
___Train Local_ResNet_18,  epoch 169, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3777/4111 (91.8755%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1237, Accuracy: 5456/10000 (54.5600%)
time spent on training: 273.1728711128235
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.4060, Accuracy: 6481/10000 (64.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0394, Accuracy: 9791/9900 (98.8990%)
Done in 299.7769396305084 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 51, 97, 20, 54, 5, 34, 74, 14, 77, 50, 56, 10, 16, 39, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5210/5308 (98.1537%), train_poison_data_count: 415
Global model norm: 44.46762587519782.
Norm before scaling: 44.42532083012316. Distance: 1.1619911967221463
Total norm for 4 adversaries is: 44.42532083012316. distance: 1.1619911967221463
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0194, Accuracy: 9843/9900 (99.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.46762587519782.
Norm before scaling: 44.42069472798897. Distance: 1.2280540387568186
Total norm for 4 adversaries is: 44.42069472798897. distance: 1.2280540387568186
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0244, Accuracy: 9837/9900 (99.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4984/5123 (97.2867%), train_poison_data_count: 403
Global model norm: 44.46762587519782.
Norm before scaling: 44.42755195874374. Distance: 1.2278501712712429
Total norm for 4 adversaries is: 44.42755195874374. distance: 1.2278501712712429
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0386, Accuracy: 9811/9900 (99.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5380/5503 (97.7649%), train_poison_data_count: 430
Global model norm: 44.46762587519782.
Norm before scaling: 44.425026818365566. Distance: 1.2258494545978431
Total norm for 4 adversaries is: 44.425026818365566. distance: 1.2258494545978431
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0550, Accuracy: 9769/9900 (98.6768%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4384/4672 (93.8356%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4407/4672 (94.3279%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9615, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 170, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3881/4108 (94.4742%)
___Train Local_ResNet_18,  epoch 170, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3832/4108 (93.2814%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0019, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 170, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4361/4736 (92.0819%)
___Train Local_ResNet_18,  epoch 170, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4266/4736 (90.0760%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0153, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 170, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4492/4714 (95.2906%)
___Train Local_ResNet_18,  epoch 170, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4458/4714 (94.5694%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7943, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 170, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5133/5645 (90.9300%)
___Train Local_ResNet_18,  epoch 170, local model 54, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4843/5645 (85.7927%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2731, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 170, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4725/4993 (94.6325%)
___Train Local_ResNet_18,  epoch 170, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4614/4993 (92.4094%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2712, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4627/4911 (94.2171%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4572/4911 (93.0971%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9744, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 170, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4403/4797 (91.7865%)
___Train Local_ResNet_18,  epoch 170, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4397/4797 (91.6615%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0648, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4020/4196 (95.8055%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3984/4196 (94.9476%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7983, Accuracy: 5865/10000 (58.6500%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4606/5050 (91.2079%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4537/5050 (89.8416%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1803, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 170, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4476/4757 (94.0929%)
___Train Local_ResNet_18,  epoch 170, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4340/4757 (91.2340%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1463, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 170, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4970/5427 (91.5791%)
___Train Local_ResNet_18,  epoch 170, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4826/5427 (88.9257%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1503, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 170, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4777/5068 (94.2581%)
___Train Local_ResNet_18,  epoch 170, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4722/5068 (93.1728%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0875, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 170, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5001/5353 (93.4242%)
___Train Local_ResNet_18,  epoch 170, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4788/5353 (89.4452%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1000, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 170, local model 39, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3866/4175 (92.5988%)
___Train Local_ResNet_18,  epoch 170, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3808/4175 (91.2096%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0414, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 170, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3853/4111 (93.7242%)
___Train Local_ResNet_18,  epoch 170, local model 79, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3853/4111 (93.7242%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9663, Accuracy: 5587/10000 (55.8700%)
time spent on training: 270.7763955593109
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.4199, Accuracy: 6450/10000 (64.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0354, Accuracy: 9803/9900 (99.0202%)
Done in 297.53629636764526 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 31, 8, 83, 64, 23, 74, 90, 97, 86, 76, 0, 62, 33, 32, 54, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5213/5308 (98.2102%), train_poison_data_count: 415
Global model norm: 44.48488951888959.
Norm before scaling: 44.44177277058362. Distance: 1.158150528586783
Total norm for 4 adversaries is: 44.44177277058362. distance: 1.158150528586783
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0479, Accuracy: 9777/9900 (98.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5656/5777 (97.9055%), train_poison_data_count: 455
Global model norm: 44.48488951888959.
Norm before scaling: 44.4379917122936. Distance: 1.2295900628579992
Total norm for 4 adversaries is: 44.4379917122936. distance: 1.2295900628579992
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0765, Accuracy: 9706/9900 (98.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4995/5123 (97.5015%), train_poison_data_count: 403
Global model norm: 44.48488951888959.
Norm before scaling: 44.4440703651792. Distance: 1.1999617769193753
Total norm for 4 adversaries is: 44.4440703651792. distance: 1.1999617769193753
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0660, Accuracy: 9731/9900 (98.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5362/5503 (97.4378%), train_poison_data_count: 430
Global model norm: 44.48488951888959.
Norm before scaling: 44.44392479486791. Distance: 1.294893474468793
Total norm for 4 adversaries is: 44.44392479486791. distance: 1.294893474468793
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0248, Accuracy: 9831/9900 (99.3030%)
___Train Local_ResNet_18,  epoch 171, local model 31, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4305/4537 (94.8865%)
___Train Local_ResNet_18,  epoch 171, local model 31, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4209/4537 (92.7706%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8853, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 171, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4552/4889 (93.1070%)
___Train Local_ResNet_18,  epoch 171, local model 8, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4558/4889 (93.2297%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9638, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 171, local model 83, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3311/3552 (93.2151%)
___Train Local_ResNet_18,  epoch 171, local model 83, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3369/3552 (94.8480%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8461, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4518/4894 (92.3171%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4364/4894 (89.1704%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2632, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4340/4549 (95.4056%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3859/4549 (84.8318%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.6797, Accuracy: 4763/10000 (47.6300%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4453/4797 (92.8289%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4370/4797 (91.0986%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1242, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 171, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4542/4748 (95.6613%)
___Train Local_ResNet_18,  epoch 171, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4406/4748 (92.7970%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9625, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 171, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4354/4736 (91.9341%)
___Train Local_ResNet_18,  epoch 171, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4256/4736 (89.8649%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0911, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3653/3929 (92.9753%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3580/3929 (91.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9312, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 171, local model 76, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3652/3959 (92.2455%)
___Train Local_ResNet_18,  epoch 171, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3648/3959 (92.1445%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0876, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 171, local model 0, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5015/5454 (91.9509%)
___Train Local_ResNet_18,  epoch 171, local model 0, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4834/5454 (88.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3706, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch 171, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4961/5504 (90.1344%)
___Train Local_ResNet_18,  epoch 171, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4700/5504 (85.3924%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2027, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 171, local model 33, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4512/4818 (93.6488%)
___Train Local_ResNet_18,  epoch 171, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4402/4818 (91.3657%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0910, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 171, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5453/6080 (89.6875%)
___Train Local_ResNet_18,  epoch 171, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5386/6080 (88.5855%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1473, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 171, local model 54, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5163/5645 (91.4615%)
___Train Local_ResNet_18,  epoch 171, local model 54, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4806/5645 (85.1373%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3351, Accuracy: 4947/10000 (49.4700%)
___Train Local_ResNet_18,  epoch 171, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4471/4869 (91.8258%)
___Train Local_ResNet_18,  epoch 171, local model 7, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4087/4869 (83.9392%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3806, Accuracy: 5032/10000 (50.3200%)
time spent on training: 273.9158184528351
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.4238, Accuracy: 6443/10000 (64.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0341, Accuracy: 9804/9900 (99.0303%)
Done in 300.38639855384827 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 93, 25, 55, 21, 42, 88, 17, 23, 2, 68, 12, 52, 5, 44, 72, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5225/5308 (98.4363%), train_poison_data_count: 415
Global model norm: 44.50391293584826.
Norm before scaling: 44.459470658679685. Distance: 1.116389169422182
Total norm for 4 adversaries is: 44.459470658679685. distance: 1.116389169422182
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0216, Accuracy: 9846/9900 (99.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5654/5777 (97.8709%), train_poison_data_count: 455
Global model norm: 44.50391293584826.
Norm before scaling: 44.45747726936662. Distance: 1.251677912844859
Total norm for 4 adversaries is: 44.45747726936662. distance: 1.251677912844859
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0816, Accuracy: 9677/9900 (97.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5003/5123 (97.6576%), train_poison_data_count: 403
Global model norm: 44.50391293584826.
Norm before scaling: 44.46215582696424. Distance: 1.1943624373433532
Total norm for 4 adversaries is: 44.46215582696424. distance: 1.1943624373433532
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0625, Accuracy: 9738/9900 (98.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5399/5503 (98.1101%), train_poison_data_count: 430
Global model norm: 44.50391293584826.
Norm before scaling: 44.460224334246924. Distance: 1.176804816229305
Total norm for 4 adversaries is: 44.460224334246924. distance: 1.176804816229305
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0557, Accuracy: 9745/9900 (98.4343%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4676/5055 (92.5025%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4639/5055 (91.7705%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1391, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 172, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5860/6419 (91.2915%)
___Train Local_ResNet_18,  epoch 172, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5571/6419 (86.7892%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2084, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4484/4731 (94.7791%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4416/4731 (93.3418%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9794, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 172, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4657/5038 (92.4375%)
___Train Local_ResNet_18,  epoch 172, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4638/5038 (92.0603%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0703, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 172, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5453/5907 (92.3142%)
___Train Local_ResNet_18,  epoch 172, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5382/5907 (91.1122%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2682, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 172, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4974/5362 (92.7639%)
___Train Local_ResNet_18,  epoch 172, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4821/5362 (89.9105%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1526, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 172, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4516/4903 (92.1069%)
___Train Local_ResNet_18,  epoch 172, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4406/4903 (89.8633%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0923, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 172, local model 23, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4313/4549 (94.8120%)
___Train Local_ResNet_18,  epoch 172, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4108/4549 (90.3056%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2113, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 172, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3758/3968 (94.7077%)
___Train Local_ResNet_18,  epoch 172, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3769/3968 (94.9849%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8807, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 172, local model 68, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3409/3589 (94.9847%)
___Train Local_ResNet_18,  epoch 172, local model 68, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3245/3589 (90.4152%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0814, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 172, local model 12, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5154/5526 (93.2682%)
___Train Local_ResNet_18,  epoch 172, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4875/5526 (88.2193%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1848, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 172, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3905/4130 (94.5521%)
___Train Local_ResNet_18,  epoch 172, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3860/4130 (93.4625%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9220, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 172, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4731/4993 (94.7527%)
___Train Local_ResNet_18,  epoch 172, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4618/4993 (92.4895%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1535, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 172, local model 44, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4793/5075 (94.4433%)
___Train Local_ResNet_18,  epoch 172, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4595/5075 (90.5419%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1795, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 172, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4788/5193 (92.2010%)
___Train Local_ResNet_18,  epoch 172, local model 72, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4436/5193 (85.4227%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.5921, Accuracy: 4760/10000 (47.6000%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4724/5035 (93.8232%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4702/5035 (93.3863%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0349, Accuracy: 5494/10000 (54.9400%)
time spent on training: 275.9807085990906
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.4158, Accuracy: 6469/10000 (64.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0351, Accuracy: 9802/9900 (99.0101%)
Done in 302.7359998226166 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 32, 54, 57, 25, 67, 38, 0, 98, 43, 94, 42, 26, 70, 90, 56, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5221/5308 (98.3610%), train_poison_data_count: 415
Global model norm: 44.52313111295703.
Norm before scaling: 44.47902227850296. Distance: 1.1260080060183006
Total norm for 4 adversaries is: 44.47902227850296. distance: 1.1260080060183006
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0406, Accuracy: 9803/9900 (99.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5664/5777 (98.0440%), train_poison_data_count: 455
Global model norm: 44.52313111295703.
Norm before scaling: 44.47522654655272. Distance: 1.2236290617304595
Total norm for 4 adversaries is: 44.47522654655272. distance: 1.2236290617304595
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0452, Accuracy: 9779/9900 (98.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5000/5123 (97.5991%), train_poison_data_count: 403
Global model norm: 44.52313111295703.
Norm before scaling: 44.480778689806705. Distance: 1.217800112556807
Total norm for 4 adversaries is: 44.480778689806705. distance: 1.217800112556807
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0253, Accuracy: 9831/9900 (99.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5379/5503 (97.7467%), train_poison_data_count: 430
Global model norm: 44.52313111295703.
Norm before scaling: 44.48305506032606. Distance: 1.2984628723089353
Total norm for 4 adversaries is: 44.48305506032606. distance: 1.2984628723089353
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0293, Accuracy: 9826/9900 (99.2525%)
___Train Local_ResNet_18,  epoch 173, local model 32, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5562/6080 (91.4803%)
___Train Local_ResNet_18,  epoch 173, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5272/6080 (86.7105%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3251, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch 173, local model 54, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5159/5645 (91.3906%)
___Train Local_ResNet_18,  epoch 173, local model 54, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4866/5645 (86.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2274, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 173, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4668/4956 (94.1889%)
___Train Local_ResNet_18,  epoch 173, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4518/4956 (91.1622%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0465, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 173, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5813/6419 (90.5593%)
___Train Local_ResNet_18,  epoch 173, local model 25, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5450/6419 (84.9042%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.4585, Accuracy: 4932/10000 (49.3200%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5139/5559 (92.4447%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4964/5559 (89.2966%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0360, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5695/6235 (91.3392%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5469/6235 (87.7145%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.4506, Accuracy: 4883/10000 (48.8300%)
___Train Local_ResNet_18,  epoch 173, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5081/5454 (93.1610%)
___Train Local_ResNet_18,  epoch 173, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4901/5454 (89.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1448, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 173, local model 98, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3944/4161 (94.7849%)
___Train Local_ResNet_18,  epoch 173, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3830/4161 (92.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0351, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 173, local model 43, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4615/4979 (92.6893%)
___Train Local_ResNet_18,  epoch 173, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4545/4979 (91.2834%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0323, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 173, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4787/5224 (91.6348%)
___Train Local_ResNet_18,  epoch 173, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4753/5224 (90.9839%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1763, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 173, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5506/5907 (93.2114%)
___Train Local_ResNet_18,  epoch 173, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5418/5907 (91.7217%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2185, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 173, local model 26, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3882/4086 (95.0073%)
___Train Local_ResNet_18,  epoch 173, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3850/4086 (94.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8707, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 173, local model 70, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5529/5871 (94.1748%)
___Train Local_ResNet_18,  epoch 173, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5381/5871 (91.6539%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2389, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4515/4748 (95.0927%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4351/4748 (91.6386%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1525, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 173, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4946/5427 (91.1369%)
___Train Local_ResNet_18,  epoch 173, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4858/5427 (89.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1280, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 173, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4025/4196 (95.9247%)
___Train Local_ResNet_18,  epoch 173, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4003/4196 (95.4004%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9001, Accuracy: 5791/10000 (57.9100%)
time spent on training: 280.3295135498047
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.4216, Accuracy: 6457/10000 (64.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0333, Accuracy: 9805/9900 (99.0404%)
Done in 307.1735632419586 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 12, 96, 75, 78, 54, 4, 5, 33, 35, 83, 57, 40, 6, 38, 18, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.543250850034084.
Norm before scaling: 44.50086682793381. Distance: 1.2122254444230618
Total norm for 4 adversaries is: 44.50086682793381. distance: 1.2122254444230618
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0304, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5669/5777 (98.1305%), train_poison_data_count: 455
Global model norm: 44.543250850034084.
Norm before scaling: 44.49528152652818. Distance: 1.2399904987524946
Total norm for 4 adversaries is: 44.49528152652818. distance: 1.2399904987524946
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0352, Accuracy: 9809/9900 (99.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5017/5123 (97.9309%), train_poison_data_count: 403
Global model norm: 44.543250850034084.
Norm before scaling: 44.501045129054276. Distance: 1.1593112629852942
Total norm for 4 adversaries is: 44.501045129054276. distance: 1.1593112629852942
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0483, Accuracy: 9775/9900 (98.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5406/5503 (98.2373%), train_poison_data_count: 430
Global model norm: 44.543250850034084.
Norm before scaling: 44.49902616999753. Distance: 1.177156221051684
Total norm for 4 adversaries is: 44.49902616999753. distance: 1.177156221051684
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0819, Accuracy: 9663/9900 (97.6061%)
___Train Local_ResNet_18,  epoch 174, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5058/5526 (91.5309%)
___Train Local_ResNet_18,  epoch 174, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4832/5526 (87.4412%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.5172, Accuracy: 4837/10000 (48.3700%)
___Train Local_ResNet_18,  epoch 174, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4777/5086 (93.9245%)
___Train Local_ResNet_18,  epoch 174, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4717/5086 (92.7448%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9175, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 174, local model 75, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4416/4672 (94.5205%)
___Train Local_ResNet_18,  epoch 174, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4367/4672 (93.4717%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9017, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 174, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4123/4368 (94.3910%)
___Train Local_ResNet_18,  epoch 174, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4049/4368 (92.6969%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1192, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 174, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5106/5645 (90.4517%)
___Train Local_ResNet_18,  epoch 174, local model 54, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4834/5645 (85.6333%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3342, Accuracy: 4954/10000 (49.5400%)
___Train Local_ResNet_18,  epoch 174, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3791/4028 (94.1162%)
___Train Local_ResNet_18,  epoch 174, local model 4, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3775/4028 (93.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8572, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch 174, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4735/4993 (94.8328%)
___Train Local_ResNet_18,  epoch 174, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4637/4993 (92.8700%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1112, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4493/4818 (93.2545%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4450/4818 (92.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0573, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 174, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5204/5615 (92.6803%)
___Train Local_ResNet_18,  epoch 174, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5133/5615 (91.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3867, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 174, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3292/3552 (92.6802%)
___Train Local_ResNet_18,  epoch 174, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3311/3552 (93.2151%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9344, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 174, local model 57, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4630/4956 (93.4221%)
___Train Local_ResNet_18,  epoch 174, local model 57, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4574/4956 (92.2922%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0437, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 174, local model 40, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5584/5939 (94.0226%)
___Train Local_ResNet_18,  epoch 174, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5510/5939 (92.7766%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0599, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 174, local model 6, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4637/4929 (94.0759%)
___Train Local_ResNet_18,  epoch 174, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4515/4929 (91.6007%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2164, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 174, local model 38, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5680/6235 (91.0986%)
___Train Local_ResNet_18,  epoch 174, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5514/6235 (88.4362%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2133, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 174, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4008/4249 (94.3281%)
___Train Local_ResNet_18,  epoch 174, local model 18, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3923/4249 (92.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9892, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 174, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4207/4485 (93.8016%)
___Train Local_ResNet_18,  epoch 174, local model 61, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3888/4485 (86.6890%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3489, Accuracy: 4914/10000 (49.1400%)
time spent on training: 275.00178360939026
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.4245, Accuracy: 6473/10000 (64.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0318, Accuracy: 9811/9900 (99.1010%)
Done in 301.4054181575775 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 65, 4, 57, 0, 72, 62, 24, 77, 78, 41, 19, 61, 52, 59, 2, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5232/5308 (98.5682%), train_poison_data_count: 415
Global model norm: 44.561300167928785.
Norm before scaling: 44.51603769771842. Distance: 1.1150976521448557
Total norm for 4 adversaries is: 44.51603769771842. distance: 1.1150976521448557
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0461, Accuracy: 9776/9900 (98.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5667/5777 (98.0959%), train_poison_data_count: 455
Global model norm: 44.561300167928785.
Norm before scaling: 44.51182141963807. Distance: 1.2047232873650147
Total norm for 4 adversaries is: 44.51182141963807. distance: 1.2047232873650147
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0647, Accuracy: 9735/9900 (98.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4988/5123 (97.3648%), train_poison_data_count: 403
Global model norm: 44.561300167928785.
Norm before scaling: 44.52058123295688. Distance: 1.2049234498112693
Total norm for 4 adversaries is: 44.52058123295688. distance: 1.2049234498112693
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0521, Accuracy: 9757/9900 (98.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5399/5503 (98.1101%), train_poison_data_count: 430
Global model norm: 44.561300167928785.
Norm before scaling: 44.51670815196807. Distance: 1.2076569944407305
Total norm for 4 adversaries is: 44.51670815196807. distance: 1.2076569944407305
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0370, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 175, local model 65, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5115/5497 (93.0508%)
___Train Local_ResNet_18,  epoch 175, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4974/5497 (90.4857%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0512, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 175, local model 4, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3816/4028 (94.7368%)
___Train Local_ResNet_18,  epoch 175, local model 4, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3773/4028 (93.6693%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0262, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 175, local model 57, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4678/4956 (94.3906%)
___Train Local_ResNet_18,  epoch 175, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4489/4956 (90.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2092, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 175, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4999/5454 (91.6575%)
___Train Local_ResNet_18,  epoch 175, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4859/5454 (89.0906%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1828, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 175, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4801/5193 (92.4514%)
___Train Local_ResNet_18,  epoch 175, local model 72, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4476/5193 (86.1930%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.6585, Accuracy: 4649/10000 (46.4900%)
___Train Local_ResNet_18,  epoch 175, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4983/5504 (90.5342%)
___Train Local_ResNet_18,  epoch 175, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4878/5504 (88.6265%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2548, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 175, local model 24, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4054/4313 (93.9949%)
___Train Local_ResNet_18,  epoch 175, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4031/4313 (93.4616%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0265, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 175, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4606/5050 (91.2079%)
___Train Local_ResNet_18,  epoch 175, local model 77, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4447/5050 (88.0594%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.3036, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 175, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4135/4368 (94.6658%)
___Train Local_ResNet_18,  epoch 175, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4077/4368 (93.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9898, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 175, local model 41, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4464/4714 (94.6966%)
___Train Local_ResNet_18,  epoch 175, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4376/4714 (92.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1861, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 175, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4897/5361 (91.3449%)
___Train Local_ResNet_18,  epoch 175, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4886/5361 (91.1397%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0548, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 175, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4156/4485 (92.6644%)
___Train Local_ResNet_18,  epoch 175, local model 61, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3742/4485 (83.4337%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.6371, Accuracy: 4696/10000 (46.9600%)
___Train Local_ResNet_18,  epoch 175, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3912/4130 (94.7215%)
___Train Local_ResNet_18,  epoch 175, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3858/4130 (93.4140%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8898, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 175, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4175/4397 (94.9511%)
___Train Local_ResNet_18,  epoch 175, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4200/4397 (95.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9344, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3750/3968 (94.5060%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3764/3968 (94.8589%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8129, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 175, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4383/4605 (95.1792%)
___Train Local_ResNet_18,  epoch 175, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4300/4605 (93.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8773, Accuracy: 5724/10000 (57.2400%)
time spent on training: 272.06796741485596
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.4231, Accuracy: 6461/10000 (64.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0337, Accuracy: 9808/9900 (99.0707%)
Done in 298.4423384666443 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 19, 85, 76, 57, 46, 62, 22, 25, 89, 95, 48, 51, 45, 96, 41, 17].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5195/5308 (97.8711%), train_poison_data_count: 415
Global model norm: 44.57890268336722.
Norm before scaling: 44.53642787879519. Distance: 1.1851046647152967
Total norm for 4 adversaries is: 44.53642787879519. distance: 1.1851046647152967
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0470, Accuracy: 9789/9900 (98.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5669/5777 (98.1305%), train_poison_data_count: 455
Global model norm: 44.57890268336722.
Norm before scaling: 44.52961208610583. Distance: 1.1925488605525971
Total norm for 4 adversaries is: 44.52961208610583. distance: 1.1925488605525971
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0248, Accuracy: 9828/9900 (99.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5013/5123 (97.8528%), train_poison_data_count: 403
Global model norm: 44.57890268336722.
Norm before scaling: 44.535675492817695. Distance: 1.1657420081761078
Total norm for 4 adversaries is: 44.535675492817695. distance: 1.1657420081761078
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0731, Accuracy: 9703/9900 (98.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5393/5503 (98.0011%), train_poison_data_count: 430
Global model norm: 44.57890268336722.
Norm before scaling: 44.53383353251281. Distance: 1.2092537279463917
Total norm for 4 adversaries is: 44.53383353251281. distance: 1.2092537279463917
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0535, Accuracy: 9754/9900 (98.5253%)
___Train Local_ResNet_18,  epoch 176, local model 19, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4901/5361 (91.4195%)
___Train Local_ResNet_18,  epoch 176, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4827/5361 (90.0392%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1538, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 176, local model 85, internal_epoch   1,  Average loss: 0.0047, Accuracy: 6341/6947 (91.2768%)
___Train Local_ResNet_18,  epoch 176, local model 85, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5982/6947 (86.1091%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.5642, Accuracy: 4814/10000 (48.1400%)
___Train Local_ResNet_18,  epoch 176, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3627/3959 (91.6140%)
___Train Local_ResNet_18,  epoch 176, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3661/3959 (92.4728%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9542, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 176, local model 57, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4640/4956 (93.6239%)
___Train Local_ResNet_18,  epoch 176, local model 57, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4585/4956 (92.5141%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0821, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4840/5399 (89.6462%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4702/5399 (87.0902%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3513, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch 176, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4950/5504 (89.9346%)
___Train Local_ResNet_18,  epoch 176, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4793/5504 (87.0821%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.4334, Accuracy: 4898/10000 (48.9800%)
___Train Local_ResNet_18,  epoch 176, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5331/5696 (93.5920%)
___Train Local_ResNet_18,  epoch 176, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5093/5696 (89.4136%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3699, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch 176, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5833/6419 (90.8709%)
___Train Local_ResNet_18,  epoch 176, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5505/6419 (85.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1845, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4426/4737 (93.4347%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4318/4737 (91.1547%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2599, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 176, local model 95, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4607/5018 (91.8095%)
___Train Local_ResNet_18,  epoch 176, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4422/5018 (88.1228%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2280, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 176, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4606/4830 (95.3623%)
___Train Local_ResNet_18,  epoch 176, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4472/4830 (92.5880%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0360, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 176, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3902/4108 (94.9854%)
___Train Local_ResNet_18,  epoch 176, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3822/4108 (93.0380%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9989, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 176, local model 45, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4994/5489 (90.9820%)
___Train Local_ResNet_18,  epoch 176, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4959/5489 (90.3443%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2991, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 176, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4788/5086 (94.1408%)
___Train Local_ResNet_18,  epoch 176, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4737/5086 (93.1380%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0720, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 176, local model 41, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4445/4714 (94.2936%)
___Train Local_ResNet_18,  epoch 176, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4369/4714 (92.6814%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1777, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 176, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4505/4903 (91.8825%)
___Train Local_ResNet_18,  epoch 176, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4453/4903 (90.8219%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3162, Accuracy: 5119/10000 (51.1900%)
time spent on training: 281.3144943714142
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.4301, Accuracy: 6461/10000 (64.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0332, Accuracy: 9808/9900 (99.0707%)
Done in 308.1417193412781 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 2, 27, 99, 74, 8, 3, 67, 72, 7, 24, 17, 10, 20, 59, 16, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5218/5308 (98.3044%), train_poison_data_count: 415
Global model norm: 44.5982883552581.
Norm before scaling: 44.55200996360181. Distance: 1.098827673691251
Total norm for 4 adversaries is: 44.55200996360181. distance: 1.098827673691251
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0328, Accuracy: 9812/9900 (99.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5678/5777 (98.2863%), train_poison_data_count: 455
Global model norm: 44.5982883552581.
Norm before scaling: 44.546809233553695. Distance: 1.1759717919962978
Total norm for 4 adversaries is: 44.546809233553695. distance: 1.1759717919962978
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0362, Accuracy: 9806/9900 (99.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5005/5123 (97.6967%), train_poison_data_count: 403
Global model norm: 44.5982883552581.
Norm before scaling: 44.55591285247321. Distance: 1.1953436155570203
Total norm for 4 adversaries is: 44.55591285247321. distance: 1.1953436155570203
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0792, Accuracy: 9701/9900 (97.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5403/5503 (98.1828%), train_poison_data_count: 430
Global model norm: 44.5982883552581.
Norm before scaling: 44.55388131065295. Distance: 1.2001578664253514
Total norm for 4 adversaries is: 44.55388131065295. distance: 1.2001578664253514
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0397, Accuracy: 9799/9900 (98.9798%)
___Train Local_ResNet_18,  epoch 177, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3759/3968 (94.7329%)
___Train Local_ResNet_18,  epoch 177, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3742/3968 (94.3044%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9193, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 177, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4315/4587 (94.0702%)
___Train Local_ResNet_18,  epoch 177, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4228/4587 (92.1735%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0203, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4417/4851 (91.0534%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4339/4851 (89.4455%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0971, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 177, local model 74, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4514/4797 (94.1005%)
___Train Local_ResNet_18,  epoch 177, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4372/4797 (91.1403%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9594, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 177, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4592/4889 (93.9251%)
___Train Local_ResNet_18,  epoch 177, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4459/4889 (91.2047%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9926, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 177, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5070/5346 (94.8373%)
___Train Local_ResNet_18,  epoch 177, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4988/5346 (93.3034%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1997, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 177, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5140/5559 (92.4627%)
___Train Local_ResNet_18,  epoch 177, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4906/5559 (88.2533%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.6687, Accuracy: 4728/10000 (47.2800%)
___Train Local_ResNet_18,  epoch 177, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4720/5193 (90.8916%)
___Train Local_ResNet_18,  epoch 177, local model 72, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4466/5193 (86.0004%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.4413, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch 177, local model 7, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4513/4869 (92.6884%)
___Train Local_ResNet_18,  epoch 177, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4298/4869 (88.2727%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.3093, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch 177, local model 24, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4054/4313 (93.9949%)
___Train Local_ResNet_18,  epoch 177, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4014/4313 (93.0675%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9987, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4536/4903 (92.5148%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4439/4903 (90.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2014, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4845/5068 (95.5998%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4648/5068 (91.7127%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.3256, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 177, local model 20, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4508/4714 (95.6300%)
___Train Local_ResNet_18,  epoch 177, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4445/4714 (94.2936%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9123, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 177, local model 59, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4218/4397 (95.9290%)
___Train Local_ResNet_18,  epoch 177, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4219/4397 (95.9518%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7017, Accuracy: 6002/10000 (60.0200%)
___Train Local_ResNet_18,  epoch 177, local model 16, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5020/5353 (93.7792%)
___Train Local_ResNet_18,  epoch 177, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4824/5353 (90.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1576, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 177, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4530/4818 (94.0224%)
___Train Local_ResNet_18,  epoch 177, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4347/4818 (90.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1764, Accuracy: 5399/10000 (53.9900%)
time spent on training: 274.49334168434143
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.4325, Accuracy: 6465/10000 (64.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0315, Accuracy: 9814/9900 (99.1313%)
Done in 300.9900851249695 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 44, 6, 40, 60, 96, 93, 0, 47, 5, 94, 78, 63, 23, 45, 26, 72].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5223/5308 (98.3986%), train_poison_data_count: 415
Global model norm: 44.61575042008007.
Norm before scaling: 44.5712416368973. Distance: 1.1274143379302604
Total norm for 4 adversaries is: 44.5712416368973. distance: 1.1274143379302604
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0840, Accuracy: 9669/9900 (97.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.61575042008007.
Norm before scaling: 44.566118475986045. Distance: 1.2019911042549136
Total norm for 4 adversaries is: 44.566118475986045. distance: 1.2019911042549136
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0310, Accuracy: 9819/9900 (99.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5010/5123 (97.7943%), train_poison_data_count: 403
Global model norm: 44.61575042008007.
Norm before scaling: 44.57335043875362. Distance: 1.2026545608070527
Total norm for 4 adversaries is: 44.57335043875362. distance: 1.2026545608070527
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0275, Accuracy: 9825/9900 (99.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5392/5503 (97.9829%), train_poison_data_count: 430
Global model norm: 44.61575042008007.
Norm before scaling: 44.57135529564504. Distance: 1.2028341561060432
Total norm for 4 adversaries is: 44.57135529564504. distance: 1.2028341561060432
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0372, Accuracy: 9808/9900 (99.0707%)
___Train Local_ResNet_18,  epoch 178, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4778/5075 (94.1478%)
___Train Local_ResNet_18,  epoch 178, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4738/5075 (93.3596%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2443, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 178, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4618/4929 (93.6904%)
___Train Local_ResNet_18,  epoch 178, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4490/4929 (91.0935%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1673, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 178, local model 40, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5590/5939 (94.1236%)
___Train Local_ResNet_18,  epoch 178, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5464/5939 (92.0020%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1659, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 178, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3871/4145 (93.3896%)
___Train Local_ResNet_18,  epoch 178, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3876/4145 (93.5103%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9709, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4771/5086 (93.8065%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4706/5086 (92.5285%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0956, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 178, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4715/5055 (93.2740%)
___Train Local_ResNet_18,  epoch 178, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4642/5055 (91.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0569, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 178, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5060/5454 (92.7759%)
___Train Local_ResNet_18,  epoch 178, local model 0, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4755/5454 (87.1837%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2117, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 178, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4759/5123 (92.8948%)
___Train Local_ResNet_18,  epoch 178, local model 47, internal_epoch   2,  Average loss: 0.0115, Accuracy: 4069/5123 (79.4261%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2582, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4715/4993 (94.4322%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4649/4993 (93.1104%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1230, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 178, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4839/5224 (92.6302%)
___Train Local_ResNet_18,  epoch 178, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4737/5224 (90.6776%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1392, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 178, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4155/4368 (95.1236%)
___Train Local_ResNet_18,  epoch 178, local model 78, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4145/4368 (94.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9231, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3730/3910 (95.3964%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3617/3910 (92.5064%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1161, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 178, local model 23, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4363/4549 (95.9112%)
___Train Local_ResNet_18,  epoch 178, local model 23, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4046/4549 (88.9426%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2030, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 178, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4998/5489 (91.0548%)
___Train Local_ResNet_18,  epoch 178, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4967/5489 (90.4901%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2812, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 178, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3865/4086 (94.5913%)
___Train Local_ResNet_18,  epoch 178, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3818/4086 (93.4410%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0694, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 178, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4788/5193 (92.2010%)
___Train Local_ResNet_18,  epoch 178, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4601/5193 (88.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3405, Accuracy: 5097/10000 (50.9700%)
time spent on training: 274.7250587940216
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.4495, Accuracy: 6428/10000 (64.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0290, Accuracy: 9816/9900 (99.1515%)
Done in 301.4389839172363 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 27, 56, 90, 39, 16, 69, 88, 23, 98, 84, 48, 3, 35, 81, 55, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5229/5308 (98.5117%), train_poison_data_count: 415
Global model norm: 44.63425039802674.
Norm before scaling: 44.588190022169826. Distance: 1.0893321596915164
Total norm for 4 adversaries is: 44.588190022169826. distance: 1.0893321596915164
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0561, Accuracy: 9757/9900 (98.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.63425039802674.
Norm before scaling: 44.584157167232625. Distance: 1.1736142285748872
Total norm for 4 adversaries is: 44.584157167232625. distance: 1.1736142285748872
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0280, Accuracy: 9837/9900 (99.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5007/5123 (97.7357%), train_poison_data_count: 403
Global model norm: 44.63425039802674.
Norm before scaling: 44.59145327389684. Distance: 1.1784336930251151
Total norm for 4 adversaries is: 44.59145327389684. distance: 1.1784336930251151
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0820, Accuracy: 9693/9900 (97.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5397/5503 (98.0738%), train_poison_data_count: 430
Global model norm: 44.63425039802674.
Norm before scaling: 44.58945894079466. Distance: 1.2290590961175414
Total norm for 4 adversaries is: 44.58945894079466. distance: 1.2290590961175414
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0323, Accuracy: 9819/9900 (99.1818%)
___Train Local_ResNet_18,  epoch 179, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4321/4587 (94.2010%)
___Train Local_ResNet_18,  epoch 179, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4251/4587 (92.6750%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0944, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 179, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5024/5427 (92.5742%)
___Train Local_ResNet_18,  epoch 179, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4853/5427 (89.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4044, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch 179, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4518/4748 (95.1559%)
___Train Local_ResNet_18,  epoch 179, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4393/4748 (92.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9738, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 179, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3912/4175 (93.7006%)
___Train Local_ResNet_18,  epoch 179, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3828/4175 (91.6886%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1148, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 179, local model 16, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5071/5353 (94.7319%)
___Train Local_ResNet_18,  epoch 179, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4856/5353 (90.7155%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2770, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 179, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4084/4364 (93.5839%)
___Train Local_ResNet_18,  epoch 179, local model 69, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3903/4364 (89.4363%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1057, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 179, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5020/5362 (93.6218%)
___Train Local_ResNet_18,  epoch 179, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4898/5362 (91.3465%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3982, Accuracy: 4942/10000 (49.4200%)
___Train Local_ResNet_18,  epoch 179, local model 23, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4344/4549 (95.4935%)
___Train Local_ResNet_18,  epoch 179, local model 23, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3891/4549 (85.5353%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4515, Accuracy: 4944/10000 (49.4400%)
___Train Local_ResNet_18,  epoch 179, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3945/4161 (94.8089%)
___Train Local_ResNet_18,  epoch 179, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3831/4161 (92.0692%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1001, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 179, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4804/5209 (92.2250%)
___Train Local_ResNet_18,  epoch 179, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4693/5209 (90.0941%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0738, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4578/4830 (94.7826%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4536/4830 (93.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0605, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 179, local model 3, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5090/5346 (95.2114%)
___Train Local_ResNet_18,  epoch 179, local model 3, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5030/5346 (94.0890%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1604, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 179, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5271/5615 (93.8736%)
___Train Local_ResNet_18,  epoch 179, local model 35, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5247/5615 (93.4461%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0655, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 179, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4772/5035 (94.7766%)
___Train Local_ResNet_18,  epoch 179, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4672/5035 (92.7905%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9412, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4533/4731 (95.8148%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4414/4731 (93.2995%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8876, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5106/5702 (89.5475%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0125, Accuracy: 4378/5702 (76.7801%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.5649, Accuracy: 4648/10000 (46.4800%)
time spent on training: 275.69790959358215
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.4536, Accuracy: 6423/10000 (64.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0270, Accuracy: 9821/9900 (99.2020%)
Done in 302.53248476982117 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 97, 21, 14, 37, 95, 9, 28, 17, 73, 23, 0, 68, 19, 50, 55, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5235/5308 (98.6247%), train_poison_data_count: 415
Global model norm: 44.65302018804621.
Norm before scaling: 44.60564235697234. Distance: 1.0515042338447025
Total norm for 4 adversaries is: 44.60564235697234. distance: 1.0515042338447025
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0307, Accuracy: 9818/9900 (99.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5675/5777 (98.2344%), train_poison_data_count: 455
Global model norm: 44.65302018804621.
Norm before scaling: 44.6043684252696. Distance: 1.2095861955311642
Total norm for 4 adversaries is: 44.6043684252696. distance: 1.2095861955311642
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0198, Accuracy: 9851/9900 (99.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4997/5123 (97.5405%), train_poison_data_count: 403
Global model norm: 44.65302018804621.
Norm before scaling: 44.61093610447092. Distance: 1.1786527832653455
Total norm for 4 adversaries is: 44.61093610447092. distance: 1.1786527832653455
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0610, Accuracy: 9733/9900 (98.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5398/5503 (98.0919%), train_poison_data_count: 430
Global model norm: 44.65302018804621.
Norm before scaling: 44.60919986830771. Distance: 1.2125860006763458
Total norm for 4 adversaries is: 44.60919986830771. distance: 1.2125860006763458
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0381, Accuracy: 9802/9900 (99.0101%)
___Train Local_ResNet_18,  epoch 180, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4385/4736 (92.5887%)
___Train Local_ResNet_18,  epoch 180, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4292/4736 (90.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2127, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4684/5038 (92.9734%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4643/5038 (92.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0960, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 180, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4048/4196 (96.4728%)
___Train Local_ResNet_18,  epoch 180, local model 14, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4011/4196 (95.5910%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8935, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 180, local model 37, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4415/4741 (93.1238%)
___Train Local_ResNet_18,  epoch 180, local model 37, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4113/4741 (86.7538%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.7678, Accuracy: 4553/10000 (45.5300%)
___Train Local_ResNet_18,  epoch 180, local model 95, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4567/5018 (91.0124%)
___Train Local_ResNet_18,  epoch 180, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4475/5018 (89.1790%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0409, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 180, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5258/5727 (91.8107%)
___Train Local_ResNet_18,  epoch 180, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5043/5727 (88.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1671, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 180, local model 28, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4651/5122 (90.8044%)
___Train Local_ResNet_18,  epoch 180, local model 28, internal_epoch   2,  Average loss: 0.0113, Accuracy: 4070/5122 (79.4611%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.6173, Accuracy: 4611/10000 (46.1100%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4571/4903 (93.2286%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4412/4903 (89.9857%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1035, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 180, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4372/4605 (94.9403%)
___Train Local_ResNet_18,  epoch 180, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4346/4605 (94.3757%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9981, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 180, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4315/4549 (94.8560%)
___Train Local_ResNet_18,  epoch 180, local model 23, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3870/4549 (85.0736%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.5652, Accuracy: 4844/10000 (48.4400%)
___Train Local_ResNet_18,  epoch 180, local model 0, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5095/5454 (93.4177%)
___Train Local_ResNet_18,  epoch 180, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4882/5454 (89.5123%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3845, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 180, local model 68, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3382/3589 (94.2324%)
___Train Local_ResNet_18,  epoch 180, local model 68, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3259/3589 (90.8052%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9855, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 180, local model 19, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4921/5361 (91.7926%)
___Train Local_ResNet_18,  epoch 180, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4765/5361 (88.8827%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.4915, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch 180, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4474/4757 (94.0509%)
___Train Local_ResNet_18,  epoch 180, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4343/4757 (91.2970%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0121, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 180, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4480/4731 (94.6946%)
___Train Local_ResNet_18,  epoch 180, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4418/4731 (93.3841%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1199, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5715/6235 (91.6600%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5483/6235 (87.9391%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3240, Accuracy: 5093/10000 (50.9300%)
time spent on training: 274.0986359119415
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.4596, Accuracy: 6415/10000 (64.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0249, Accuracy: 9831/9900 (99.3030%)
Done in 300.8620009422302 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 89, 53, 72, 87, 21, 48, 39, 95, 70, 57, 16, 55, 17, 7, 74, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5204/5308 (98.0407%), train_poison_data_count: 415
Global model norm: 44.67280953901797.
Norm before scaling: 44.629609027562914. Distance: 1.186689351102555
Total norm for 4 adversaries is: 44.629609027562914. distance: 1.186689351102555
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0214, Accuracy: 9845/9900 (99.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5677/5777 (98.2690%), train_poison_data_count: 455
Global model norm: 44.67280953901797.
Norm before scaling: 44.622652905713146. Distance: 1.1952060826620439
Total norm for 4 adversaries is: 44.622652905713146. distance: 1.1952060826620439
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0510, Accuracy: 9766/9900 (98.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4980/5123 (97.2087%), train_poison_data_count: 403
Global model norm: 44.67280953901797.
Norm before scaling: 44.63271472398707. Distance: 1.2646152565627806
Total norm for 4 adversaries is: 44.63271472398707. distance: 1.2646152565627806
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0614, Accuracy: 9745/9900 (98.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5391/5503 (97.9647%), train_poison_data_count: 430
Global model norm: 44.67280953901797.
Norm before scaling: 44.62872965637928. Distance: 1.2256621439672843
Total norm for 4 adversaries is: 44.62872965637928. distance: 1.2256621439672843
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0759, Accuracy: 9706/9900 (98.0404%)
___Train Local_ResNet_18,  epoch 181, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4437/4737 (93.6669%)
___Train Local_ResNet_18,  epoch 181, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4356/4737 (91.9569%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2689, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 181, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5966/6664 (89.5258%)
___Train Local_ResNet_18,  epoch 181, local model 53, internal_epoch   2,  Average loss: 0.0079, Accuracy: 5655/6664 (84.8589%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2931, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch 181, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4749/5193 (91.4500%)
___Train Local_ResNet_18,  epoch 181, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4538/5193 (87.3869%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2578, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 181, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3703/3995 (92.6909%)
___Train Local_ResNet_18,  epoch 181, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3581/3995 (89.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4922, Accuracy: 4974/10000 (49.7400%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4709/5038 (93.4696%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4677/5038 (92.8345%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0567, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 181, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4594/4830 (95.1139%)
___Train Local_ResNet_18,  epoch 181, local model 48, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4580/4830 (94.8240%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0641, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 181, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3927/4175 (94.0599%)
___Train Local_ResNet_18,  epoch 181, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3826/4175 (91.6407%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1675, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 181, local model 95, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4620/5018 (92.0686%)
___Train Local_ResNet_18,  epoch 181, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4483/5018 (89.3384%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.3208, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 181, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5529/5871 (94.1748%)
___Train Local_ResNet_18,  epoch 181, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5405/5871 (92.0627%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1783, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 181, local model 57, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4664/4956 (94.1082%)
___Train Local_ResNet_18,  epoch 181, local model 57, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4623/4956 (93.2809%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1866, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5062/5353 (94.5638%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4872/5353 (91.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0292, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 181, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4488/4731 (94.8637%)
___Train Local_ResNet_18,  epoch 181, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4431/4731 (93.6588%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0571, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4508/4903 (91.9437%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4401/4903 (89.7614%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2285, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4511/4869 (92.6474%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0132, Accuracy: 3652/4869 (75.0051%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4746, Accuracy: 4742/10000 (47.4200%)
___Train Local_ResNet_18,  epoch 181, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4489/4797 (93.5793%)
___Train Local_ResNet_18,  epoch 181, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4420/4797 (92.1409%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2121, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 181, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3731/3910 (95.4220%)
___Train Local_ResNet_18,  epoch 181, local model 63, internal_epoch   2,  Average loss: 0.0101, Accuracy: 3222/3910 (82.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4614, Accuracy: 4983/10000 (49.8300%)
time spent on training: 273.4064631462097
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.4665, Accuracy: 6408/10000 (64.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0254, Accuracy: 9829/9900 (99.2828%)
Done in 300.1531047821045 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 77, 41, 51, 7, 32, 44, 67, 5, 85, 49, 55, 64, 35, 95, 4, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5202/5308 (98.0030%), train_poison_data_count: 415
Global model norm: 44.69150714114344.
Norm before scaling: 44.64655849611339. Distance: 1.158418992303489
Total norm for 4 adversaries is: 44.64655849611339. distance: 1.158418992303489
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0426, Accuracy: 9780/9900 (98.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5673/5777 (98.1998%), train_poison_data_count: 455
Global model norm: 44.69150714114344.
Norm before scaling: 44.641665469586115. Distance: 1.190510197108343
Total norm for 4 adversaries is: 44.641665469586115. distance: 1.190510197108343
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0550, Accuracy: 9754/9900 (98.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5003/5123 (97.6576%), train_poison_data_count: 403
Global model norm: 44.69150714114344.
Norm before scaling: 44.64958919665093. Distance: 1.2103168004257743
Total norm for 4 adversaries is: 44.64958919665093. distance: 1.2103168004257743
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0655, Accuracy: 9726/9900 (98.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5392/5503 (97.9829%), train_poison_data_count: 430
Global model norm: 44.69150714114344.
Norm before scaling: 44.64636163700101. Distance: 1.1923994083483693
Total norm for 4 adversaries is: 44.64636163700101. distance: 1.1923994083483693
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0390, Accuracy: 9802/9900 (99.0101%)
___Train Local_ResNet_18,  epoch 182, local model 77, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4636/5050 (91.8020%)
___Train Local_ResNet_18,  epoch 182, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4546/5050 (90.0198%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1727, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 182, local model 41, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4481/4714 (95.0573%)
___Train Local_ResNet_18,  epoch 182, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4354/4714 (92.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2886, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 182, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3903/4108 (95.0097%)
___Train Local_ResNet_18,  epoch 182, local model 51, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3760/4108 (91.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2302, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 182, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4482/4869 (92.0518%)
___Train Local_ResNet_18,  epoch 182, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4119/4869 (84.5964%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3901, Accuracy: 4943/10000 (49.4300%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5390/6080 (88.6513%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5231/6080 (86.0362%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.4546, Accuracy: 4858/10000 (48.5800%)
___Train Local_ResNet_18,  epoch 182, local model 44, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4847/5075 (95.5074%)
___Train Local_ResNet_18,  epoch 182, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4723/5075 (93.0640%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0892, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 182, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5152/5559 (92.6785%)
___Train Local_ResNet_18,  epoch 182, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4902/5559 (88.1813%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2052, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 182, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4733/4993 (94.7927%)
___Train Local_ResNet_18,  epoch 182, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4636/4993 (92.8500%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1195, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 182, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 6307/6947 (90.7874%)
___Train Local_ResNet_18,  epoch 182, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 6098/6947 (87.7789%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.4642, Accuracy: 4954/10000 (49.5400%)
___Train Local_ResNet_18,  epoch 182, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5157/5652 (91.2420%)
___Train Local_ResNet_18,  epoch 182, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4972/5652 (87.9689%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.4508, Accuracy: 4845/10000 (48.4500%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4494/4731 (94.9905%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4462/4731 (94.3141%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9501, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 182, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4512/4894 (92.1945%)
___Train Local_ResNet_18,  epoch 182, local model 64, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4324/4894 (88.3531%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3771, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch 182, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5226/5615 (93.0721%)
___Train Local_ResNet_18,  epoch 182, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5186/5615 (92.3598%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1671, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 182, local model 95, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4661/5018 (92.8856%)
___Train Local_ResNet_18,  epoch 182, local model 95, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4488/5018 (89.4380%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2702, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 182, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3789/4028 (94.0665%)
___Train Local_ResNet_18,  epoch 182, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3758/4028 (93.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0039, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4726/5123 (92.2506%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4423/5123 (86.3361%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3447, Accuracy: 5047/10000 (50.4700%)
time spent on training: 279.51030588150024
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.4666, Accuracy: 6408/10000 (64.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0258, Accuracy: 9827/9900 (99.2626%)
Done in 306.12012672424316 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 17, 70, 42, 31, 21, 82, 84, 28, 86, 67, 5, 85, 95, 74, 38, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5215/5308 (98.2479%), train_poison_data_count: 415
Global model norm: 44.71192377800006.
Norm before scaling: 44.666004992086826. Distance: 1.1223462382228864
Total norm for 4 adversaries is: 44.666004992086826. distance: 1.1223462382228864
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0595, Accuracy: 9755/9900 (98.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5679/5777 (98.3036%), train_poison_data_count: 455
Global model norm: 44.71192377800006.
Norm before scaling: 44.66150768340325. Distance: 1.1931244514348172
Total norm for 4 adversaries is: 44.66150768340325. distance: 1.1931244514348172
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0569, Accuracy: 9753/9900 (98.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5006/5123 (97.7162%), train_poison_data_count: 403
Global model norm: 44.71192377800006.
Norm before scaling: 44.66943335623576. Distance: 1.1646291390534103
Total norm for 4 adversaries is: 44.66943335623576. distance: 1.1646291390534103
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0117, Accuracy: 9872/9900 (99.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5397/5503 (98.0738%), train_poison_data_count: 430
Global model norm: 44.71192377800006.
Norm before scaling: 44.66576859060037. Distance: 1.1635325716915998
Total norm for 4 adversaries is: 44.66576859060037. distance: 1.1635325716915998
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0432, Accuracy: 9775/9900 (98.7374%)
___Train Local_ResNet_18,  epoch 183, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4543/4903 (92.6576%)
___Train Local_ResNet_18,  epoch 183, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4536/4903 (92.5148%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0845, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 183, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5529/5871 (94.1748%)
___Train Local_ResNet_18,  epoch 183, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5319/5871 (90.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1265, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 183, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5423/5907 (91.8063%)
___Train Local_ResNet_18,  epoch 183, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5363/5907 (90.7906%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.5219, Accuracy: 4950/10000 (49.5000%)
___Train Local_ResNet_18,  epoch 183, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4263/4537 (93.9608%)
___Train Local_ResNet_18,  epoch 183, local model 31, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4238/4537 (93.4097%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8929, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 183, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4675/5038 (92.7948%)
___Train Local_ResNet_18,  epoch 183, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4663/5038 (92.5566%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9724, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 183, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4999/5298 (94.3564%)
___Train Local_ResNet_18,  epoch 183, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4917/5298 (92.8086%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0759, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4850/5209 (93.1081%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4759/5209 (91.3611%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1265, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 183, local model 28, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4717/5122 (92.0929%)
___Train Local_ResNet_18,  epoch 183, local model 28, internal_epoch   2,  Average loss: 0.0100, Accuracy: 4194/5122 (81.8821%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.4714, Accuracy: 4790/10000 (47.9000%)
___Train Local_ResNet_18,  epoch 183, local model 86, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3619/3929 (92.1100%)
___Train Local_ResNet_18,  epoch 183, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3606/3929 (91.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0535, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 183, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5128/5559 (92.2468%)
___Train Local_ResNet_18,  epoch 183, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4943/5559 (88.9189%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3365, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18,  epoch 183, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4715/4993 (94.4322%)
___Train Local_ResNet_18,  epoch 183, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4605/4993 (92.2291%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1552, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0042, Accuracy: 6385/6947 (91.9102%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 6080/6947 (87.5198%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1432, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 183, local model 95, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4581/5018 (91.2914%)
___Train Local_ResNet_18,  epoch 183, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4442/5018 (88.5213%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1369, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 183, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4477/4797 (93.3292%)
___Train Local_ResNet_18,  epoch 183, local model 74, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4435/4797 (92.4536%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9035, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 183, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5698/6235 (91.3873%)
___Train Local_ResNet_18,  epoch 183, local model 38, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5424/6235 (86.9928%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3568, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch 183, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5063/5461 (92.7120%)
___Train Local_ResNet_18,  epoch 183, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4939/5461 (90.4413%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2848, Accuracy: 5252/10000 (52.5200%)
time spent on training: 281.59606075286865
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.4722, Accuracy: 6407/10000 (64.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0249, Accuracy: 9834/9900 (99.3333%)
Done in 308.1805226802826 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 87, 92, 52, 89, 22, 93, 78, 49, 39, 82, 35, 94, 38, 61, 32, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5228/5308 (98.4928%), train_poison_data_count: 415
Global model norm: 44.731807143379534.
Norm before scaling: 44.68512067529442. Distance: 1.1181016929589767
Total norm for 4 adversaries is: 44.68512067529442. distance: 1.1181016929589767
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0599, Accuracy: 9755/9900 (98.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5667/5777 (98.0959%), train_poison_data_count: 455
Global model norm: 44.731807143379534.
Norm before scaling: 44.68139845801676. Distance: 1.1960806778007191
Total norm for 4 adversaries is: 44.68139845801676. distance: 1.1960806778007191
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0451, Accuracy: 9788/9900 (98.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5010/5123 (97.7943%), train_poison_data_count: 403
Global model norm: 44.731807143379534.
Norm before scaling: 44.68916627138226. Distance: 1.1704301701100936
Total norm for 4 adversaries is: 44.68916627138226. distance: 1.1704301701100936
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0640, Accuracy: 9731/9900 (98.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5398/5503 (98.0919%), train_poison_data_count: 430
Global model norm: 44.731807143379534.
Norm before scaling: 44.68655620725391. Distance: 1.188844622226605
Total norm for 4 adversaries is: 44.68655620725391. distance: 1.188844622226605
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0580, Accuracy: 9755/9900 (98.5354%)
___Train Local_ResNet_18,  epoch 184, local model 87, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3680/3995 (92.1151%)
___Train Local_ResNet_18,  epoch 184, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3592/3995 (89.9124%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2739, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 184, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 6391/6812 (93.8197%)
___Train Local_ResNet_18,  epoch 184, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 6240/6812 (91.6031%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2873, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 184, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3921/4130 (94.9395%)
___Train Local_ResNet_18,  epoch 184, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3901/4130 (94.4552%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9233, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 184, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4417/4737 (93.2447%)
___Train Local_ResNet_18,  epoch 184, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4341/4737 (91.6403%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4076, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 184, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5316/5696 (93.3287%)
___Train Local_ResNet_18,  epoch 184, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5174/5696 (90.8357%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1646, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 184, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4714/5055 (93.2542%)
___Train Local_ResNet_18,  epoch 184, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4574/5055 (90.4847%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1626, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 184, local model 78, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4189/4368 (95.9020%)
___Train Local_ResNet_18,  epoch 184, local model 78, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4136/4368 (94.6886%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9309, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 184, local model 49, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5252/5652 (92.9229%)
___Train Local_ResNet_18,  epoch 184, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5010/5652 (88.6412%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2439, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 184, local model 39, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3922/4175 (93.9401%)
___Train Local_ResNet_18,  epoch 184, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3849/4175 (92.1916%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0493, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 184, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5017/5298 (94.6961%)
___Train Local_ResNet_18,  epoch 184, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4897/5298 (92.4311%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1181, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 184, local model 35, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5264/5615 (93.7489%)
___Train Local_ResNet_18,  epoch 184, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5140/5615 (91.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3544, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4831/5224 (92.4770%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4804/5224 (91.9602%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2651, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 184, local model 38, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5732/6235 (91.9326%)
___Train Local_ResNet_18,  epoch 184, local model 38, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5446/6235 (87.3456%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4855, Accuracy: 4744/10000 (47.4400%)
___Train Local_ResNet_18,  epoch 184, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4202/4485 (93.6901%)
___Train Local_ResNet_18,  epoch 184, local model 61, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3748/4485 (83.5674%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4529, Accuracy: 4821/10000 (48.2100%)
___Train Local_ResNet_18,  epoch 184, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5473/6080 (90.0164%)
___Train Local_ResNet_18,  epoch 184, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5254/6080 (86.4145%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4433, Accuracy: 4996/10000 (49.9600%)
___Train Local_ResNet_18,  epoch 184, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3893/4108 (94.7663%)
___Train Local_ResNet_18,  epoch 184, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3773/4108 (91.8452%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1134, Accuracy: 5414/10000 (54.1400%)
time spent on training: 279.2804181575775
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.4934, Accuracy: 6377/10000 (63.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0243, Accuracy: 9833/9900 (99.3232%)
Done in 305.98003602027893 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 8, 12, 68, 28, 34, 90, 64, 6, 54, 43, 77, 76, 83, 84, 52, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5207/5308 (98.0972%), train_poison_data_count: 415
Global model norm: 44.75051146486694.
Norm before scaling: 44.7044125011202. Distance: 1.1215919690154803
Total norm for 4 adversaries is: 44.7044125011202. distance: 1.1215919690154803
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0537, Accuracy: 9765/9900 (98.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5659/5777 (97.9574%), train_poison_data_count: 455
Global model norm: 44.75051146486694.
Norm before scaling: 44.70213511443343. Distance: 1.2393860326017183
Total norm for 4 adversaries is: 44.70213511443343. distance: 1.2393860326017183
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0330, Accuracy: 9819/9900 (99.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5001/5123 (97.6186%), train_poison_data_count: 403
Global model norm: 44.75051146486694.
Norm before scaling: 44.70864201581656. Distance: 1.2105975258328476
Total norm for 4 adversaries is: 44.70864201581656. distance: 1.2105975258328476
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0500, Accuracy: 9759/9900 (98.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5365/5503 (97.4923%), train_poison_data_count: 430
Global model norm: 44.75051146486694.
Norm before scaling: 44.70759900933719. Distance: 1.286847008228867
Total norm for 4 adversaries is: 44.70759900933719. distance: 1.286847008228867
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0552, Accuracy: 9753/9900 (98.5152%)
___Train Local_ResNet_18,  epoch 185, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4570/4889 (93.4751%)
___Train Local_ResNet_18,  epoch 185, local model 8, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4493/4889 (91.9002%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1402, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 185, local model 12, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5129/5526 (92.8158%)
___Train Local_ResNet_18,  epoch 185, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4867/5526 (88.0746%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4303, Accuracy: 4944/10000 (49.4400%)
___Train Local_ResNet_18,  epoch 185, local model 68, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3398/3589 (94.6782%)
___Train Local_ResNet_18,  epoch 185, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3333/3589 (92.8671%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9838, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 185, local model 28, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4660/5122 (90.9801%)
___Train Local_ResNet_18,  epoch 185, local model 28, internal_epoch   2,  Average loss: 0.0115, Accuracy: 4061/5122 (79.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.5628, Accuracy: 4732/10000 (47.3200%)
___Train Local_ResNet_18,  epoch 185, local model 34, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4606/4911 (93.7895%)
___Train Local_ResNet_18,  epoch 185, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4582/4911 (93.3008%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3007, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 185, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4527/4748 (95.3454%)
___Train Local_ResNet_18,  epoch 185, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4408/4748 (92.8391%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1057, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 185, local model 64, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4535/4894 (92.6645%)
___Train Local_ResNet_18,  epoch 185, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4434/4894 (90.6007%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0413, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4703/4929 (95.4149%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4536/4929 (92.0268%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9874, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 185, local model 54, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5200/5645 (92.1169%)
___Train Local_ResNet_18,  epoch 185, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5030/5645 (89.1054%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4144, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 185, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4634/4979 (93.0709%)
___Train Local_ResNet_18,  epoch 185, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4606/4979 (92.5085%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1455, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 185, local model 77, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4637/5050 (91.8218%)
___Train Local_ResNet_18,  epoch 185, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4509/5050 (89.2871%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1300, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 185, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3690/3959 (93.2054%)
___Train Local_ResNet_18,  epoch 185, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3644/3959 (92.0434%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9536, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 185, local model 83, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3319/3552 (93.4403%)
___Train Local_ResNet_18,  epoch 185, local model 83, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3322/3552 (93.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9936, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 185, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4845/5209 (93.0121%)
___Train Local_ResNet_18,  epoch 185, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4674/5209 (89.7293%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1178, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 185, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3924/4130 (95.0121%)
___Train Local_ResNet_18,  epoch 185, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3785/4130 (91.6465%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1066, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 185, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3866/4086 (94.6158%)
___Train Local_ResNet_18,  epoch 185, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3820/4086 (93.4900%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1025, Accuracy: 5435/10000 (54.3500%)
time spent on training: 271.81249356269836
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.4964, Accuracy: 6371/10000 (63.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0237, Accuracy: 9835/9900 (99.3434%)
Done in 298.53682112693787 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 90, 6, 39, 89, 88, 7, 3, 94, 74, 66, 25, 96, 31, 98, 78, 34].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5215/5308 (98.2479%), train_poison_data_count: 415
Global model norm: 44.76746969366749.
Norm before scaling: 44.72319924581928. Distance: 1.155971545120007
Total norm for 4 adversaries is: 44.72319924581928. distance: 1.155971545120007
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0221, Accuracy: 9841/9900 (99.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5675/5777 (98.2344%), train_poison_data_count: 455
Global model norm: 44.76746969366749.
Norm before scaling: 44.715785410118315. Distance: 1.1710041116174823
Total norm for 4 adversaries is: 44.715785410118315. distance: 1.1710041116174823
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0171, Accuracy: 9858/9900 (99.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5027/5123 (98.1261%), train_poison_data_count: 403
Global model norm: 44.76746969366749.
Norm before scaling: 44.72159975196549. Distance: 1.118996709121624
Total norm for 4 adversaries is: 44.72159975196549. distance: 1.118996709121624
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1104, Accuracy: 9593/9900 (96.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5400/5503 (98.1283%), train_poison_data_count: 430
Global model norm: 44.76746969366749.
Norm before scaling: 44.72147555678997. Distance: 1.1695872546326056
Total norm for 4 adversaries is: 44.72147555678997. distance: 1.1695872546326056
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0483, Accuracy: 9777/9900 (98.7576%)
___Train Local_ResNet_18,  epoch 186, local model 90, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4540/4748 (95.6192%)
___Train Local_ResNet_18,  epoch 186, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4408/4748 (92.8391%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9776, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 186, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4672/4929 (94.7860%)
___Train Local_ResNet_18,  epoch 186, local model 6, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4538/4929 (92.0674%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1885, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3911/4175 (93.6766%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3866/4175 (92.5988%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9759, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 186, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4440/4737 (93.7302%)
___Train Local_ResNet_18,  epoch 186, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4335/4737 (91.5136%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2984, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 186, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5023/5362 (93.6777%)
___Train Local_ResNet_18,  epoch 186, local model 88, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4922/5362 (91.7941%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1428, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 186, local model 7, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4533/4869 (93.0992%)
___Train Local_ResNet_18,  epoch 186, local model 7, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4065/4869 (83.4874%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.6887, Accuracy: 4736/10000 (47.3600%)
___Train Local_ResNet_18,  epoch 186, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5058/5346 (94.6128%)
___Train Local_ResNet_18,  epoch 186, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4968/5346 (92.9293%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0684, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4797/5224 (91.8262%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4788/5224 (91.6539%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1160, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4456/4797 (92.8914%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4310/4797 (89.8478%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0929, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4545/4843 (93.8468%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4473/4843 (92.3601%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2733, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 186, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5807/6419 (90.4658%)
___Train Local_ResNet_18,  epoch 186, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5525/6419 (86.0726%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.4022, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch 186, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4753/5086 (93.4526%)
___Train Local_ResNet_18,  epoch 186, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4674/5086 (91.8993%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0683, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 186, local model 31, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4280/4537 (94.3355%)
___Train Local_ResNet_18,  epoch 186, local model 31, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4205/4537 (92.6824%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8535, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch 186, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3971/4161 (95.4338%)
___Train Local_ResNet_18,  epoch 186, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3884/4161 (93.3429%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9449, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 186, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4151/4368 (95.0321%)
___Train Local_ResNet_18,  epoch 186, local model 78, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4125/4368 (94.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9902, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 186, local model 34, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4638/4911 (94.4411%)
___Train Local_ResNet_18,  epoch 186, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4558/4911 (92.8121%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2250, Accuracy: 5273/10000 (52.7300%)
time spent on training: 275.5611696243286
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.5091, Accuracy: 6359/10000 (63.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0228, Accuracy: 9839/9900 (99.3838%)
Done in 302.29010701179504 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 44, 82, 1, 10, 89, 11, 87, 28, 22, 78, 31, 79, 27, 46, 35, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5204/5308 (98.0407%), train_poison_data_count: 415
Global model norm: 44.78519423924468.
Norm before scaling: 44.7408881261034. Distance: 1.1770271974304187
Total norm for 4 adversaries is: 44.7408881261034. distance: 1.1770271974304187
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0368, Accuracy: 9803/9900 (99.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5679/5777 (98.3036%), train_poison_data_count: 455
Global model norm: 44.78519423924468.
Norm before scaling: 44.73488937226108. Distance: 1.1980085199495725
Total norm for 4 adversaries is: 44.73488937226108. distance: 1.1980085199495725
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0520, Accuracy: 9778/9900 (98.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4986/5123 (97.3258%), train_poison_data_count: 403
Global model norm: 44.78519423924468.
Norm before scaling: 44.74338998405938. Distance: 1.225897541936191
Total norm for 4 adversaries is: 44.74338998405938. distance: 1.225897541936191
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0357, Accuracy: 9809/9900 (99.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5393/5503 (98.0011%), train_poison_data_count: 430
Global model norm: 44.78519423924468.
Norm before scaling: 44.73984041447287. Distance: 1.1871190714965743
Total norm for 4 adversaries is: 44.73984041447287. distance: 1.1871190714965743
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0616, Accuracy: 9741/9900 (98.3939%)
___Train Local_ResNet_18,  epoch 187, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4813/5075 (94.8374%)
___Train Local_ResNet_18,  epoch 187, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4718/5075 (92.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1585, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 187, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5033/5298 (94.9981%)
___Train Local_ResNet_18,  epoch 187, local model 82, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4963/5298 (93.6769%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2488, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 187, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5176/5422 (95.4629%)
___Train Local_ResNet_18,  epoch 187, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5028/5422 (92.7333%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0821, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 187, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4829/5068 (95.2841%)
___Train Local_ResNet_18,  epoch 187, local model 10, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4572/5068 (90.2131%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2547, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4436/4737 (93.6458%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4335/4737 (91.5136%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0763, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 187, local model 11, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5083/5702 (89.1442%)
___Train Local_ResNet_18,  epoch 187, local model 11, internal_epoch   2,  Average loss: 0.0105, Accuracy: 4539/5702 (79.6036%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.4884, Accuracy: 4814/10000 (48.1400%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3718/3995 (93.0663%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3608/3995 (90.3129%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2649, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4645/5122 (90.6872%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0123, Accuracy: 3957/5122 (77.2550%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.4633, Accuracy: 4708/10000 (47.0800%)
___Train Local_ResNet_18,  epoch 187, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5322/5696 (93.4340%)
___Train Local_ResNet_18,  epoch 187, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5211/5696 (91.4853%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0716, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 187, local model 78, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4186/4368 (95.8333%)
___Train Local_ResNet_18,  epoch 187, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4073/4368 (93.2463%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1938, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 187, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4282/4537 (94.3795%)
___Train Local_ResNet_18,  epoch 187, local model 31, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4277/4537 (94.2693%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9838, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 187, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3870/4111 (94.1377%)
___Train Local_ResNet_18,  epoch 187, local model 79, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3755/4111 (91.3403%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2585, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 187, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4288/4587 (93.4816%)
___Train Local_ResNet_18,  epoch 187, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4270/4587 (93.0892%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0111, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 187, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4866/5399 (90.1278%)
___Train Local_ResNet_18,  epoch 187, local model 46, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4675/5399 (86.5901%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3213, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 187, local model 35, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5273/5615 (93.9092%)
___Train Local_ResNet_18,  epoch 187, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5136/5615 (91.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2806, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 187, local model 41, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4439/4714 (94.1663%)
___Train Local_ResNet_18,  epoch 187, local model 41, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4437/4714 (94.1239%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0437, Accuracy: 5622/10000 (56.2200%)
time spent on training: 275.84387373924255
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.5136, Accuracy: 6348/10000 (63.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0227, Accuracy: 9838/9900 (99.3737%)
Done in 302.2873160839081 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 50, 45, 74, 0, 54, 55, 59, 96, 81, 75, 98, 14, 62, 25, 73, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5219/5308 (98.3233%), train_poison_data_count: 415
Global model norm: 44.80337495352959.
Norm before scaling: 44.756660860773. Distance: 1.1172573894701083
Total norm for 4 adversaries is: 44.756660860773. distance: 1.1172573894701083
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0431, Accuracy: 9784/9900 (98.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5645/5777 (97.7151%), train_poison_data_count: 455
Global model norm: 44.80337495352959.
Norm before scaling: 44.75709588250714. Distance: 1.3220495050195866
Total norm for 4 adversaries is: 44.75709588250714. distance: 1.3220495050195866
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0478, Accuracy: 9767/9900 (98.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5014/5123 (97.8723%), train_poison_data_count: 403
Global model norm: 44.80337495352959.
Norm before scaling: 44.75982728599246. Distance: 1.182425145528131
Total norm for 4 adversaries is: 44.75982728599246. distance: 1.182425145528131
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0549, Accuracy: 9751/9900 (98.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5393/5503 (98.0011%), train_poison_data_count: 430
Global model norm: 44.80337495352959.
Norm before scaling: 44.75783909167477. Distance: 1.2142706988311864
Total norm for 4 adversaries is: 44.75783909167477. distance: 1.2142706988311864
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0152, Accuracy: 9863/9900 (99.6263%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4483/4757 (94.2401%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4368/4757 (91.8226%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2124, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5093/5489 (92.7856%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5017/5489 (91.4010%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2555, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 188, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4515/4797 (94.1213%)
___Train Local_ResNet_18,  epoch 188, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4432/4797 (92.3911%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9722, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 188, local model 0, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5095/5454 (93.4177%)
___Train Local_ResNet_18,  epoch 188, local model 0, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4848/5454 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2169, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 188, local model 54, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5152/5645 (91.2666%)
___Train Local_ResNet_18,  epoch 188, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4936/5645 (87.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2881, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 188, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4504/4731 (95.2019%)
___Train Local_ResNet_18,  epoch 188, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4427/4731 (93.5743%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9748, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 188, local model 59, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4202/4397 (95.5652%)
___Train Local_ResNet_18,  epoch 188, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4210/4397 (95.7471%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8095, Accuracy: 5963/10000 (59.6300%)
___Train Local_ResNet_18,  epoch 188, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4780/5086 (93.9835%)
___Train Local_ResNet_18,  epoch 188, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4723/5086 (92.8628%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9925, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 188, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4736/5035 (94.0616%)
___Train Local_ResNet_18,  epoch 188, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4676/5035 (92.8699%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1145, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 188, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4436/4672 (94.9486%)
___Train Local_ResNet_18,  epoch 188, local model 75, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4413/4672 (94.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8722, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 188, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3962/4161 (95.2175%)
___Train Local_ResNet_18,  epoch 188, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3808/4161 (91.5165%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2128, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4039/4196 (96.2583%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3987/4196 (95.0191%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8852, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4968/5504 (90.2616%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4761/5504 (86.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.5688, Accuracy: 4815/10000 (48.1500%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5826/6419 (90.7618%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5528/6419 (86.1193%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3136, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 188, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4365/4605 (94.7883%)
___Train Local_ResNet_18,  epoch 188, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4334/4605 (94.1151%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0236, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 188, local model 29, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4533/4732 (95.7946%)
___Train Local_ResNet_18,  epoch 188, local model 29, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4495/4732 (94.9915%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8077, Accuracy: 5961/10000 (59.6100%)
time spent on training: 275.46558141708374
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.5063, Accuracy: 6351/10000 (63.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0223, Accuracy: 9841/9900 (99.4040%)
Done in 302.03868675231934 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 1, 41, 43, 84, 99, 94, 23, 2, 40, 82, 59, 28, 14, 56, 63, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5227/5308 (98.4740%), train_poison_data_count: 415
Global model norm: 44.81958734924107.
Norm before scaling: 44.77292834185282. Distance: 1.0992949393627245
Total norm for 4 adversaries is: 44.77292834185282. distance: 1.0992949393627245
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0375, Accuracy: 9791/9900 (98.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5667/5777 (98.0959%), train_poison_data_count: 455
Global model norm: 44.81958734924107.
Norm before scaling: 44.768103661745045. Distance: 1.1697837990110964
Total norm for 4 adversaries is: 44.768103661745045. distance: 1.1697837990110964
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0304, Accuracy: 9834/9900 (99.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4999/5123 (97.5795%), train_poison_data_count: 403
Global model norm: 44.81958734924107.
Norm before scaling: 44.77560561732736. Distance: 1.1929763204138275
Total norm for 4 adversaries is: 44.77560561732736. distance: 1.1929763204138275
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0479, Accuracy: 9770/9900 (98.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5383/5503 (97.8194%), train_poison_data_count: 430
Global model norm: 44.81958734924107.
Norm before scaling: 44.77507808131104. Distance: 1.2375179790385284
Total norm for 4 adversaries is: 44.77507808131104. distance: 1.2375179790385284
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0379, Accuracy: 9806/9900 (99.0505%)
___Train Local_ResNet_18,  epoch 189, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5152/5422 (95.0203%)
___Train Local_ResNet_18,  epoch 189, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5067/5422 (93.4526%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9152, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 189, local model 41, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4471/4714 (94.8451%)
___Train Local_ResNet_18,  epoch 189, local model 41, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4425/4714 (93.8693%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0471, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 189, local model 43, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4701/4979 (94.4165%)
___Train Local_ResNet_18,  epoch 189, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4577/4979 (91.9261%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1927, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 189, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4807/5209 (92.2826%)
___Train Local_ResNet_18,  epoch 189, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4691/5209 (90.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0766, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 189, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4452/4851 (91.7749%)
___Train Local_ResNet_18,  epoch 189, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4406/4851 (90.8266%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0353, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 189, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4868/5224 (93.1853%)
___Train Local_ResNet_18,  epoch 189, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4715/5224 (90.2565%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2399, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 189, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4308/4549 (94.7021%)
___Train Local_ResNet_18,  epoch 189, local model 23, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4004/4549 (88.0193%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.3116, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 189, local model 2, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3819/3968 (96.2450%)
___Train Local_ResNet_18,  epoch 189, local model 2, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3762/3968 (94.8085%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8377, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5534/5939 (93.1807%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5496/5939 (92.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.3433, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 189, local model 82, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4956/5298 (93.5447%)
___Train Local_ResNet_18,  epoch 189, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4924/5298 (92.9407%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0713, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 189, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4183/4397 (95.1330%)
___Train Local_ResNet_18,  epoch 189, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4190/4397 (95.2922%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8667, Accuracy: 5886/10000 (58.8600%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4654/5122 (90.8629%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0110, Accuracy: 4076/5122 (79.5783%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.7480, Accuracy: 4319/10000 (43.1900%)
___Train Local_ResNet_18,  epoch 189, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4048/4196 (96.4728%)
___Train Local_ResNet_18,  epoch 189, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3993/4196 (95.1621%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8539, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 189, local model 56, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4994/5427 (92.0214%)
___Train Local_ResNet_18,  epoch 189, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4875/5427 (89.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1249, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 189, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3730/3910 (95.3964%)
___Train Local_ResNet_18,  epoch 189, local model 63, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3300/3910 (84.3990%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.4910, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch 189, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3910/4086 (95.6926%)
___Train Local_ResNet_18,  epoch 189, local model 26, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3874/4086 (94.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0553, Accuracy: 5652/10000 (56.5200%)
time spent on training: 268.16031861305237
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.5087, Accuracy: 6353/10000 (63.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0228, Accuracy: 9840/9900 (99.3939%)
Done in 294.72831773757935 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 27, 20, 75, 69, 86, 64, 19, 23, 31, 10, 76, 80, 97, 26, 52, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5227/5308 (98.4740%), train_poison_data_count: 415
Global model norm: 44.836734533994274.
Norm before scaling: 44.78869388148504. Distance: 1.0790568208696913
Total norm for 4 adversaries is: 44.78869388148504. distance: 1.0790568208696913
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0155, Accuracy: 9856/9900 (99.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5670/5777 (98.1478%), train_poison_data_count: 455
Global model norm: 44.836734533994274.
Norm before scaling: 44.78655297238712. Distance: 1.1951876307070848
Total norm for 4 adversaries is: 44.78655297238712. distance: 1.1951876307070848
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0224, Accuracy: 9851/9900 (99.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5017/5123 (97.9309%), train_poison_data_count: 403
Global model norm: 44.836734533994274.
Norm before scaling: 44.79394828248984. Distance: 1.2043427583885422
Total norm for 4 adversaries is: 44.79394828248984. distance: 1.2043427583885422
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0226, Accuracy: 9838/9900 (99.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5392/5503 (97.9829%), train_poison_data_count: 430
Global model norm: 44.836734533994274.
Norm before scaling: 44.79210467930216. Distance: 1.2442986643975869
Total norm for 4 adversaries is: 44.79210467930216. distance: 1.2442986643975869
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0297, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 190, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4299/4587 (93.7214%)
___Train Local_ResNet_18,  epoch 190, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4255/4587 (92.7622%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9516, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 190, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4477/4714 (94.9724%)
___Train Local_ResNet_18,  epoch 190, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4453/4714 (94.4633%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8628, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 190, local model 75, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4427/4672 (94.7560%)
___Train Local_ResNet_18,  epoch 190, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4370/4672 (93.5360%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1150, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 190, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4073/4364 (93.3318%)
___Train Local_ResNet_18,  epoch 190, local model 69, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3866/4364 (88.5885%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2649, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 190, local model 86, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3667/3929 (93.3316%)
___Train Local_ResNet_18,  epoch 190, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3600/3929 (91.6264%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0172, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 190, local model 64, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4528/4894 (92.5215%)
___Train Local_ResNet_18,  epoch 190, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4382/4894 (89.5382%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3069, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 190, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4926/5361 (91.8858%)
___Train Local_ResNet_18,  epoch 190, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4786/5361 (89.2744%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2371, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 190, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4329/4549 (95.1638%)
___Train Local_ResNet_18,  epoch 190, local model 23, internal_epoch   2,  Average loss: 0.0094, Accuracy: 3726/4549 (81.9081%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.6095, Accuracy: 4775/10000 (47.7500%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4273/4537 (94.1812%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4218/4537 (92.9689%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9414, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 190, local model 10, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4854/5068 (95.7774%)
___Train Local_ResNet_18,  epoch 190, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4755/5068 (93.8240%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0402, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3645/3959 (92.0687%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3580/3959 (90.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0528, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 190, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5092/5461 (93.2430%)
___Train Local_ResNet_18,  epoch 190, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4936/5461 (90.3864%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3477, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 190, local model 97, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4380/4736 (92.4831%)
___Train Local_ResNet_18,  epoch 190, local model 97, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4357/4736 (91.9975%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1404, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3871/4086 (94.7381%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3835/4086 (93.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0447, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3869/4130 (93.6804%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3856/4130 (93.3656%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9659, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 190, local model 78, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4173/4368 (95.5357%)
___Train Local_ResNet_18,  epoch 190, local model 78, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4166/4368 (95.3755%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8768, Accuracy: 5839/10000 (58.3900%)
time spent on training: 269.02379393577576
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.5233, Accuracy: 6329/10000 (63.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0207, Accuracy: 9848/9900 (99.4747%)
Done in 295.51927733421326 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 46, 98, 55, 51, 80, 4, 97, 11, 35, 61, 86, 6, 83, 73, 84, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5221/5308 (98.3610%), train_poison_data_count: 415
Global model norm: 44.85305598127484.
Norm before scaling: 44.80706932967232. Distance: 1.1398812573480062
Total norm for 4 adversaries is: 44.80706932967232. distance: 1.1398812573480062
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0287, Accuracy: 9832/9900 (99.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5673/5777 (98.1998%), train_poison_data_count: 455
Global model norm: 44.85305598127484.
Norm before scaling: 44.802849106791605. Distance: 1.2082206026743907
Total norm for 4 adversaries is: 44.802849106791605. distance: 1.2082206026743907
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0375, Accuracy: 9808/9900 (99.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5008/5123 (97.7552%), train_poison_data_count: 403
Global model norm: 44.85305598127484.
Norm before scaling: 44.80907985771759. Distance: 1.163748013815327
Total norm for 4 adversaries is: 44.80907985771759. distance: 1.163748013815327
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0617, Accuracy: 9736/9900 (98.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5408/5503 (98.2737%), train_poison_data_count: 430
Global model norm: 44.85305598127484.
Norm before scaling: 44.80515134350137. Distance: 1.1354255792577137
Total norm for 4 adversaries is: 44.80515134350137. distance: 1.1354255792577137
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0625, Accuracy: 9725/9900 (98.2323%)
___Train Local_ResNet_18,  epoch 191, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4919/5399 (91.1095%)
___Train Local_ResNet_18,  epoch 191, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4695/5399 (86.9605%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.3078, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 191, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3957/4161 (95.0973%)
___Train Local_ResNet_18,  epoch 191, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3887/4161 (93.4150%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9495, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 191, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4492/4731 (94.9482%)
___Train Local_ResNet_18,  epoch 191, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4415/4731 (93.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9969, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 191, local model 51, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3903/4108 (95.0097%)
___Train Local_ResNet_18,  epoch 191, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3823/4108 (93.0623%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9387, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 191, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5048/5461 (92.4373%)
___Train Local_ResNet_18,  epoch 191, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4933/5461 (90.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.3039, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 191, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3794/4028 (94.1907%)
___Train Local_ResNet_18,  epoch 191, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3751/4028 (93.1231%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0019, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 191, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4407/4736 (93.0532%)
___Train Local_ResNet_18,  epoch 191, local model 97, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4345/4736 (91.7441%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9173, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 191, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5084/5702 (89.1617%)
___Train Local_ResNet_18,  epoch 191, local model 11, internal_epoch   2,  Average loss: 0.0115, Accuracy: 4443/5702 (77.9200%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2606, Accuracy: 4905/10000 (49.0500%)
___Train Local_ResNet_18,  epoch 191, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5280/5615 (94.0338%)
___Train Local_ResNet_18,  epoch 191, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5122/5615 (91.2199%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2193, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 191, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4183/4485 (93.2664%)
___Train Local_ResNet_18,  epoch 191, local model 61, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3996/4485 (89.0970%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2425, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 191, local model 86, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3624/3929 (92.2372%)
___Train Local_ResNet_18,  epoch 191, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3555/3929 (90.4810%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0242, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 191, local model 6, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4700/4929 (95.3540%)
___Train Local_ResNet_18,  epoch 191, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4596/4929 (93.2441%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2495, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 191, local model 83, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3324/3552 (93.5811%)
___Train Local_ResNet_18,  epoch 191, local model 83, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3337/3552 (93.9471%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8841, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 191, local model 73, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4415/4605 (95.8740%)
___Train Local_ResNet_18,  epoch 191, local model 73, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4362/4605 (94.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9311, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4857/5209 (93.2425%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4697/5209 (90.1709%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1667, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 191, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4464/4869 (91.6821%)
___Train Local_ResNet_18,  epoch 191, local model 7, internal_epoch   2,  Average loss: 0.0107, Accuracy: 3908/4869 (80.2629%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.6598, Accuracy: 4529/10000 (45.2900%)
time spent on training: 272.71010971069336
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.5217, Accuracy: 6312/10000 (63.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0206, Accuracy: 9848/9900 (99.4747%)
Done in 299.4955008029938 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 14, 5, 1, 61, 91, 75, 59, 44, 12, 38, 53, 74, 20, 89, 0, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5228/5308 (98.4928%), train_poison_data_count: 415
Global model norm: 44.86979589862623.
Norm before scaling: 44.82425942944777. Distance: 1.1412928990368365
Total norm for 4 adversaries is: 44.82425942944777. distance: 1.1412928990368365
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0371, Accuracy: 9797/9900 (98.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5682/5777 (98.3555%), train_poison_data_count: 455
Global model norm: 44.86979589862623.
Norm before scaling: 44.817415231222476. Distance: 1.1834043344947922
Total norm for 4 adversaries is: 44.817415231222476. distance: 1.1834043344947922
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0071, Accuracy: 9882/9900 (99.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5013/5123 (97.8528%), train_poison_data_count: 403
Global model norm: 44.86979589862623.
Norm before scaling: 44.82635768997967. Distance: 1.216705465786796
Total norm for 4 adversaries is: 44.82635768997967. distance: 1.216705465786796
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0554, Accuracy: 9761/9900 (98.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5401/5503 (98.1465%), train_poison_data_count: 430
Global model norm: 44.86979589862623.
Norm before scaling: 44.82301894499912. Distance: 1.1807669948895074
Total norm for 4 adversaries is: 44.82301894499912. distance: 1.1807669948895074
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0244, Accuracy: 9845/9900 (99.4444%)
___Train Local_ResNet_18,  epoch 192, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4006/4196 (95.4719%)
___Train Local_ResNet_18,  epoch 192, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3924/4196 (93.5176%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8702, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 192, local model 5, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4742/4993 (94.9730%)
___Train Local_ResNet_18,  epoch 192, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4648/4993 (93.0903%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1441, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 192, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5184/5422 (95.6105%)
___Train Local_ResNet_18,  epoch 192, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5008/5422 (92.3644%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0950, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 192, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4201/4485 (93.6678%)
___Train Local_ResNet_18,  epoch 192, local model 61, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3727/4485 (83.0992%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2847, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 192, local model 91, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4198/4527 (92.7325%)
___Train Local_ResNet_18,  epoch 192, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4061/4527 (89.7062%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2167, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 192, local model 75, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4424/4672 (94.6918%)
___Train Local_ResNet_18,  epoch 192, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4345/4672 (93.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9242, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 192, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4213/4397 (95.8153%)
___Train Local_ResNet_18,  epoch 192, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4196/4397 (95.4287%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.7805, Accuracy: 5992/10000 (59.9200%)
___Train Local_ResNet_18,  epoch 192, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4818/5075 (94.9360%)
___Train Local_ResNet_18,  epoch 192, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4667/5075 (91.9606%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1067, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5139/5526 (92.9967%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4947/5526 (89.5223%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2173, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 192, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5679/6235 (91.0826%)
___Train Local_ResNet_18,  epoch 192, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5451/6235 (87.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.4219, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch 192, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6035/6664 (90.5612%)
___Train Local_ResNet_18,  epoch 192, local model 53, internal_epoch   2,  Average loss: 0.0088, Accuracy: 5521/6664 (82.8481%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3357, Accuracy: 4981/10000 (49.8100%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4487/4797 (93.5376%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4351/4797 (90.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1374, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 192, local model 20, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4526/4714 (96.0119%)
___Train Local_ResNet_18,  epoch 192, local model 20, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4503/4714 (95.5240%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9576, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 192, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4448/4737 (93.8991%)
___Train Local_ResNet_18,  epoch 192, local model 89, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4386/4737 (92.5902%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2612, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 192, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5084/5454 (93.2160%)
___Train Local_ResNet_18,  epoch 192, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4889/5454 (89.6406%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0989, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4528/4869 (92.9965%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4210/4869 (86.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3357, Accuracy: 5201/10000 (52.0100%)
time spent on training: 269.34022665023804
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.5453, Accuracy: 6283/10000 (62.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0189, Accuracy: 9851/9900 (99.5051%)
Done in 296.0086693763733 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 17, 26, 15, 18, 38, 29, 82, 21, 84, 80, 85, 11, 12, 88, 89, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5202/5308 (98.0030%), train_poison_data_count: 415
Global model norm: 44.88788523879174.
Norm before scaling: 44.84151916271696. Distance: 1.1503221786162319
Total norm for 4 adversaries is: 44.84151916271696. distance: 1.1503221786162319
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0622, Accuracy: 9734/9900 (98.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5673/5777 (98.1998%), train_poison_data_count: 455
Global model norm: 44.88788523879174.
Norm before scaling: 44.83689108042408. Distance: 1.2212924846806814
Total norm for 4 adversaries is: 44.83689108042408. distance: 1.2212924846806814
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0359, Accuracy: 9815/9900 (99.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5022/5123 (98.0285%), train_poison_data_count: 403
Global model norm: 44.88788523879174.
Norm before scaling: 44.842478749402616. Distance: 1.1409573005623581
Total norm for 4 adversaries is: 44.842478749402616. distance: 1.1409573005623581
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0338, Accuracy: 9812/9900 (99.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5404/5503 (98.2010%), train_poison_data_count: 430
Global model norm: 44.88788523879174.
Norm before scaling: 44.84132452064306. Distance: 1.197666269199494
Total norm for 4 adversaries is: 44.84132452064306. distance: 1.197666269199494
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0330, Accuracy: 9814/9900 (99.1313%)
___Train Local_ResNet_18,  epoch 193, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4513/4903 (92.0457%)
___Train Local_ResNet_18,  epoch 193, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4466/4903 (91.0871%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0819, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 193, local model 26, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3913/4086 (95.7660%)
___Train Local_ResNet_18,  epoch 193, local model 26, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3906/4086 (95.5947%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8967, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 193, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5673/6068 (93.4904%)
___Train Local_ResNet_18,  epoch 193, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5584/6068 (92.0237%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2574, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 193, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4005/4249 (94.2575%)
___Train Local_ResNet_18,  epoch 193, local model 18, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3986/4249 (93.8103%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9365, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 193, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5696/6235 (91.3553%)
___Train Local_ResNet_18,  epoch 193, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5476/6235 (87.8268%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.5293, Accuracy: 4877/10000 (48.7700%)
___Train Local_ResNet_18,  epoch 193, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4459/4732 (94.2308%)
___Train Local_ResNet_18,  epoch 193, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4466/4732 (94.3787%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8598, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 193, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5038/5298 (95.0925%)
___Train Local_ResNet_18,  epoch 193, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4964/5298 (93.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9840, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 193, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4699/5038 (93.2711%)
___Train Local_ResNet_18,  epoch 193, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4624/5038 (91.7825%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1157, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4856/5209 (93.2233%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4645/5209 (89.1726%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1442, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 193, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5135/5461 (94.0304%)
___Train Local_ResNet_18,  epoch 193, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4998/5461 (91.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3000, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 193, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6353/6947 (91.4495%)
___Train Local_ResNet_18,  epoch 193, local model 85, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5972/6947 (85.9652%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3324, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch 193, local model 11, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5136/5702 (90.0737%)
___Train Local_ResNet_18,  epoch 193, local model 11, internal_epoch   2,  Average loss: 0.0108, Accuracy: 4510/5702 (79.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.4525, Accuracy: 4875/10000 (48.7500%)
___Train Local_ResNet_18,  epoch 193, local model 12, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5104/5526 (92.3634%)
___Train Local_ResNet_18,  epoch 193, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4904/5526 (88.7441%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3337, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 193, local model 88, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4981/5362 (92.8944%)
___Train Local_ResNet_18,  epoch 193, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4859/5362 (90.6192%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2199, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 193, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4375/4737 (92.3580%)
___Train Local_ResNet_18,  epoch 193, local model 89, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4332/4737 (91.4503%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.5717, Accuracy: 4968/10000 (49.6800%)
___Train Local_ResNet_18,  epoch 193, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5254/5727 (91.7409%)
___Train Local_ResNet_18,  epoch 193, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5045/5727 (88.0915%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1787, Accuracy: 5358/10000 (53.5800%)
time spent on training: 282.71679878234863
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.5531, Accuracy: 6266/10000 (62.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0184, Accuracy: 9856/9900 (99.5556%)
Done in 309.1790008544922 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 7, 34, 31, 64, 77, 29, 99, 0, 33, 46, 72, 22, 88, 80, 11, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5235/5308 (98.6247%), train_poison_data_count: 415
Global model norm: 44.9072217948955.
Norm before scaling: 44.85938180294271. Distance: 1.0726938973173656
Total norm for 4 adversaries is: 44.85938180294271. distance: 1.0726938973173656
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0639, Accuracy: 9733/9900 (98.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5683/5777 (98.3729%), train_poison_data_count: 455
Global model norm: 44.9072217948955.
Norm before scaling: 44.855301212621455. Distance: 1.159950006821762
Total norm for 4 adversaries is: 44.855301212621455. distance: 1.159950006821762
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0469, Accuracy: 9773/9900 (98.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4976/5123 (97.1306%), train_poison_data_count: 403
Global model norm: 44.9072217948955.
Norm before scaling: 44.86702493767346. Distance: 1.2782650113073935
Total norm for 4 adversaries is: 44.86702493767346. distance: 1.2782650113073935
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1683, Accuracy: 9426/9900 (95.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5395/5503 (98.0374%), train_poison_data_count: 430
Global model norm: 44.9072217948955.
Norm before scaling: 44.85984167947779. Distance: 1.1927786505125972
Total norm for 4 adversaries is: 44.85984167947779. distance: 1.1927786505125972
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0150, Accuracy: 9863/9900 (99.6263%)
___Train Local_ResNet_18,  epoch 194, local model 7, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4540/4869 (93.2430%)
___Train Local_ResNet_18,  epoch 194, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4261/4869 (87.5128%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2957, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 194, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4613/4911 (93.9320%)
___Train Local_ResNet_18,  epoch 194, local model 34, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4597/4911 (93.6062%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9935, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 194, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4279/4537 (94.3134%)
___Train Local_ResNet_18,  epoch 194, local model 31, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4251/4537 (93.6963%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0335, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 194, local model 64, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4537/4894 (92.7054%)
___Train Local_ResNet_18,  epoch 194, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4369/4894 (89.2726%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.6378, Accuracy: 4776/10000 (47.7600%)
___Train Local_ResNet_18,  epoch 194, local model 77, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4640/5050 (91.8812%)
___Train Local_ResNet_18,  epoch 194, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4535/5050 (89.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0796, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 194, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4505/4732 (95.2029%)
___Train Local_ResNet_18,  epoch 194, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4489/4732 (94.8648%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8563, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 194, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4514/4851 (93.0530%)
___Train Local_ResNet_18,  epoch 194, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4435/4851 (91.4244%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9025, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5124/5454 (93.9494%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4936/5454 (90.5024%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1082, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 194, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4533/4818 (94.0847%)
___Train Local_ResNet_18,  epoch 194, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4359/4818 (90.4732%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1817, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 194, local model 46, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4926/5399 (91.2391%)
___Train Local_ResNet_18,  epoch 194, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4718/5399 (87.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2600, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 194, local model 72, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4818/5193 (92.7787%)
___Train Local_ResNet_18,  epoch 194, local model 72, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4377/5193 (84.2865%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.5052, Accuracy: 4879/10000 (48.7900%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5384/5696 (94.5225%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5232/5696 (91.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0991, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 194, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5018/5362 (93.5845%)
___Train Local_ResNet_18,  epoch 194, local model 88, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4939/5362 (92.1112%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1384, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 194, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5142/5461 (94.1586%)
___Train Local_ResNet_18,  epoch 194, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5026/5461 (92.0344%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2116, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 194, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5045/5702 (88.4777%)
___Train Local_ResNet_18,  epoch 194, local model 11, internal_epoch   2,  Average loss: 0.0086, Accuracy: 4770/5702 (83.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2872, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 194, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4612/4830 (95.4865%)
___Train Local_ResNet_18,  epoch 194, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4500/4830 (93.1677%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1271, Accuracy: 5512/10000 (55.1200%)
time spent on training: 274.8953320980072
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.5779, Accuracy: 6207/10000 (62.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0196, Accuracy: 9847/9900 (99.4646%)
Done in 301.43981075286865 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 31, 7, 49, 8, 57, 89, 19, 42, 51, 98, 15, 35, 76, 48, 75, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5237/5308 (98.6624%), train_poison_data_count: 415
Global model norm: 44.926376133190814.
Norm before scaling: 44.876404976700314. Distance: 1.0571735046705228
Total norm for 4 adversaries is: 44.876404976700314. distance: 1.0571735046705228
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0321, Accuracy: 9821/9900 (99.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5670/5777 (98.1478%), train_poison_data_count: 455
Global model norm: 44.926376133190814.
Norm before scaling: 44.87332566731947. Distance: 1.1876323525807746
Total norm for 4 adversaries is: 44.87332566731947. distance: 1.1876323525807746
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0104, Accuracy: 9871/9900 (99.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4988/5123 (97.3648%), train_poison_data_count: 403
Global model norm: 44.926376133190814.
Norm before scaling: 44.881945569303674. Distance: 1.1769030216262202
Total norm for 4 adversaries is: 44.881945569303674. distance: 1.1769030216262202
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0234, Accuracy: 9834/9900 (99.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5401/5503 (98.1465%), train_poison_data_count: 430
Global model norm: 44.926376133190814.
Norm before scaling: 44.87769702680483. Distance: 1.1697748821047413
Total norm for 4 adversaries is: 44.87769702680483. distance: 1.1697748821047413
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0694, Accuracy: 9721/9900 (98.1919%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4291/4537 (94.5779%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4244/4537 (93.5420%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0253, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 195, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4541/4869 (93.2635%)
___Train Local_ResNet_18,  epoch 195, local model 7, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4006/4869 (82.2756%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.5903, Accuracy: 4722/10000 (47.2200%)
___Train Local_ResNet_18,  epoch 195, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5185/5652 (91.7374%)
___Train Local_ResNet_18,  epoch 195, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5021/5652 (88.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3048, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 195, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4575/4889 (93.5774%)
___Train Local_ResNet_18,  epoch 195, local model 8, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4561/4889 (93.2911%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9976, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 195, local model 57, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4638/4956 (93.5835%)
___Train Local_ResNet_18,  epoch 195, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4502/4956 (90.8394%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1815, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 195, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4390/4737 (92.6747%)
___Train Local_ResNet_18,  epoch 195, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4315/4737 (91.0914%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3070, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 195, local model 19, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4978/5361 (92.8558%)
___Train Local_ResNet_18,  epoch 195, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4807/5361 (89.6661%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1706, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 195, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5441/5907 (92.1111%)
___Train Local_ResNet_18,  epoch 195, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5311/5907 (89.9103%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.5155, Accuracy: 4860/10000 (48.6000%)
___Train Local_ResNet_18,  epoch 195, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3890/4108 (94.6933%)
___Train Local_ResNet_18,  epoch 195, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3834/4108 (93.3301%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0317, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 195, local model 98, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3928/4161 (94.4004%)
___Train Local_ResNet_18,  epoch 195, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3825/4161 (91.9250%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9475, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 195, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5667/6068 (93.3916%)
___Train Local_ResNet_18,  epoch 195, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5515/6068 (90.8866%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3565, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 195, local model 35, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5245/5615 (93.4105%)
___Train Local_ResNet_18,  epoch 195, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5086/5615 (90.5788%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2078, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 195, local model 76, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3634/3959 (91.7909%)
___Train Local_ResNet_18,  epoch 195, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3594/3959 (90.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0021, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4599/4830 (95.2174%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4568/4830 (94.5756%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0632, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 195, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4443/4672 (95.0985%)
___Train Local_ResNet_18,  epoch 195, local model 75, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4397/4672 (94.1139%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0591, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 195, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5142/5559 (92.4987%)
___Train Local_ResNet_18,  epoch 195, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4855/5559 (87.3359%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2292, Accuracy: 5213/10000 (52.1300%)
time spent on training: 276.4775402545929
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.5911, Accuracy: 6199/10000 (61.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0169, Accuracy: 9856/9900 (99.5556%)
Done in 303.597754240036 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 21, 78, 19, 42, 25, 70, 73, 31, 96, 99, 88, 18, 0, 54, 32, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5228/5308 (98.4928%), train_poison_data_count: 415
Global model norm: 44.94444405883571.
Norm before scaling: 44.895337270074606. Distance: 1.0787729721010317
Total norm for 4 adversaries is: 44.895337270074606. distance: 1.0787729721010317
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0324, Accuracy: 9818/9900 (99.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5698/5777 (98.6325%), train_poison_data_count: 455
Global model norm: 44.94444405883571.
Norm before scaling: 44.891236834500894. Distance: 1.140193178139008
Total norm for 4 adversaries is: 44.891236834500894. distance: 1.140193178139008
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0162, Accuracy: 9862/9900 (99.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4990/5123 (97.4039%), train_poison_data_count: 403
Global model norm: 44.94444405883571.
Norm before scaling: 44.90124118508237. Distance: 1.2143169377023177
Total norm for 4 adversaries is: 44.90124118508237. distance: 1.2143169377023177
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1012, Accuracy: 9634/9900 (97.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5410/5503 (98.3100%), train_poison_data_count: 430
Global model norm: 44.94444405883571.
Norm before scaling: 44.89604012544216. Distance: 1.1659584223072164
Total norm for 4 adversaries is: 44.89604012544216. distance: 1.1659584223072164
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0371, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4679/5038 (92.8742%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4650/5038 (92.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8608, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 196, local model 78, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4202/4368 (96.1996%)
___Train Local_ResNet_18,  epoch 196, local model 78, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4169/4368 (95.4441%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9766, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 196, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4895/5361 (91.3076%)
___Train Local_ResNet_18,  epoch 196, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4835/5361 (90.1884%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1451, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 196, local model 42, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5506/5907 (93.2114%)
___Train Local_ResNet_18,  epoch 196, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5384/5907 (91.1461%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4531, Accuracy: 4933/10000 (49.3300%)
___Train Local_ResNet_18,  epoch 196, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5882/6419 (91.6342%)
___Train Local_ResNet_18,  epoch 196, local model 25, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5637/6419 (87.8174%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4640, Accuracy: 4950/10000 (49.5000%)
___Train Local_ResNet_18,  epoch 196, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5505/5871 (93.7660%)
___Train Local_ResNet_18,  epoch 196, local model 70, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5436/5871 (92.5907%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1184, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 196, local model 73, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4427/4605 (96.1346%)
___Train Local_ResNet_18,  epoch 196, local model 73, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4377/4605 (95.0489%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9673, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 196, local model 31, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4294/4537 (94.6440%)
___Train Local_ResNet_18,  epoch 196, local model 31, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4298/4537 (94.7322%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9831, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 196, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4778/5086 (93.9442%)
___Train Local_ResNet_18,  epoch 196, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4648/5086 (91.3881%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0031, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 196, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4544/4851 (93.6714%)
___Train Local_ResNet_18,  epoch 196, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4478/4851 (92.3109%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0546, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 196, local model 88, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5046/5362 (94.1067%)
___Train Local_ResNet_18,  epoch 196, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4876/5362 (90.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.3013, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 196, local model 18, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4030/4249 (94.8458%)
___Train Local_ResNet_18,  epoch 196, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3883/4249 (91.3862%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0764, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5095/5454 (93.4177%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4833/5454 (88.6139%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.6099, Accuracy: 4954/10000 (49.5400%)
___Train Local_ResNet_18,  epoch 196, local model 54, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5184/5645 (91.8335%)
___Train Local_ResNet_18,  epoch 196, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4932/5645 (87.3694%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2925, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 196, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5504/6080 (90.5263%)
___Train Local_ResNet_18,  epoch 196, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5300/6080 (87.1711%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4287, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18,  epoch 196, local model 45, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5101/5489 (92.9313%)
___Train Local_ResNet_18,  epoch 196, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5032/5489 (91.6743%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2332, Accuracy: 5259/10000 (52.5900%)
time spent on training: 282.0377209186554
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.5858, Accuracy: 6217/10000 (62.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0163, Accuracy: 9858/9900 (99.5758%)
Done in 308.7673931121826 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 84, 48, 20, 55, 59, 40, 92, 0, 16, 85, 82, 90, 52, 6, 15, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5223/5308 (98.3986%), train_poison_data_count: 415
Global model norm: 44.96290653268745.
Norm before scaling: 44.91428196697989. Distance: 1.0887061303603933
Total norm for 4 adversaries is: 44.91428196697989. distance: 1.0887061303603933
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0350, Accuracy: 9810/9900 (99.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5672/5777 (98.1824%), train_poison_data_count: 455
Global model norm: 44.96290653268745.
Norm before scaling: 44.91077580273052. Distance: 1.1908739745775414
Total norm for 4 adversaries is: 44.91077580273052. distance: 1.1908739745775414
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0222, Accuracy: 9842/9900 (99.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5014/5123 (97.8723%), train_poison_data_count: 403
Global model norm: 44.96290653268745.
Norm before scaling: 44.91716959051892. Distance: 1.147535008413808
Total norm for 4 adversaries is: 44.91716959051892. distance: 1.147535008413808
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0522, Accuracy: 9757/9900 (98.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5388/5503 (97.9102%), train_poison_data_count: 430
Global model norm: 44.96290653268745.
Norm before scaling: 44.914654310981845. Distance: 1.16961349982939
Total norm for 4 adversaries is: 44.914654310981845. distance: 1.16961349982939
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0540, Accuracy: 9753/9900 (98.5152%)
___Train Local_ResNet_18,  epoch 197, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4846/5209 (93.0313%)
___Train Local_ResNet_18,  epoch 197, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4709/5209 (90.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1602, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 197, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4611/4830 (95.4658%)
___Train Local_ResNet_18,  epoch 197, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4511/4830 (93.3954%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0321, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 197, local model 20, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4518/4714 (95.8422%)
___Train Local_ResNet_18,  epoch 197, local model 20, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4450/4714 (94.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9422, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 197, local model 55, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4527/4731 (95.6880%)
___Train Local_ResNet_18,  epoch 197, local model 55, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4442/4731 (93.8914%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0584, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 197, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4234/4397 (96.2929%)
___Train Local_ResNet_18,  epoch 197, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4208/4397 (95.7016%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8415, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 197, local model 40, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5583/5939 (94.0057%)
___Train Local_ResNet_18,  epoch 197, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5445/5939 (91.6821%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1728, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 197, local model 92, internal_epoch   1,  Average loss: 0.0027, Accuracy: 6447/6812 (94.6418%)
___Train Local_ResNet_18,  epoch 197, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6269/6812 (92.0288%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2934, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 197, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5054/5454 (92.6659%)
___Train Local_ResNet_18,  epoch 197, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4879/5454 (89.4573%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1549, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 197, local model 16, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5008/5353 (93.5550%)
___Train Local_ResNet_18,  epoch 197, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4863/5353 (90.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2243, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6323/6947 (91.0177%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5939/6947 (85.4901%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.5513, Accuracy: 4739/10000 (47.3900%)
___Train Local_ResNet_18,  epoch 197, local model 82, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5051/5298 (95.3379%)
___Train Local_ResNet_18,  epoch 197, local model 82, internal_epoch   2,  Average loss: 0.0028, Accuracy: 5004/5298 (94.4507%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1001, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 197, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4538/4748 (95.5771%)
___Train Local_ResNet_18,  epoch 197, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4386/4748 (92.3757%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0731, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 197, local model 52, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3934/4130 (95.2542%)
___Train Local_ResNet_18,  epoch 197, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3849/4130 (93.1961%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0799, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4683/4929 (95.0091%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4547/4929 (92.2499%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1279, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5662/6068 (93.3092%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5610/6068 (92.4522%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1396, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 197, local model 97, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4420/4736 (93.3277%)
___Train Local_ResNet_18,  epoch 197, local model 97, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4305/4736 (90.8995%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0240, Accuracy: 5551/10000 (55.5100%)
time spent on training: 282.5431549549103
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.6064, Accuracy: 6181/10000 (61.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0160, Accuracy: 9857/9900 (99.5657%)
Done in 309.0176570415497 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 57, 62, 61, 67, 3, 82, 69, 93, 42, 76, 7, 94, 14, 21, 32, 25].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5232/5308 (98.5682%), train_poison_data_count: 415
Global model norm: 44.9802745395829.
Norm before scaling: 44.93080753581347. Distance: 1.0543782663888315
Total norm for 4 adversaries is: 44.93080753581347. distance: 1.0543782663888315
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0529, Accuracy: 9758/9900 (98.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5658/5777 (97.9401%), train_poison_data_count: 455
Global model norm: 44.9802745395829.
Norm before scaling: 44.931386221364654. Distance: 1.3058603006599836
Total norm for 4 adversaries is: 44.931386221364654. distance: 1.3058603006599836
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0076, Accuracy: 9879/9900 (99.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5010/5123 (97.7943%), train_poison_data_count: 403
Global model norm: 44.9802745395829.
Norm before scaling: 44.93606976818219. Distance: 1.187068208192172
Total norm for 4 adversaries is: 44.93606976818219. distance: 1.187068208192172
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0822, Accuracy: 9673/9900 (97.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5422/5503 (98.5281%), train_poison_data_count: 430
Global model norm: 44.9802745395829.
Norm before scaling: 44.93256666244429. Distance: 1.1636417319704981
Total norm for 4 adversaries is: 44.93256666244429. distance: 1.1636417319704981
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0282, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 198, local model 57, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4679/4956 (94.4108%)
___Train Local_ResNet_18,  epoch 198, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4521/4956 (91.2228%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1592, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 198, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5015/5504 (91.1156%)
___Train Local_ResNet_18,  epoch 198, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4820/5504 (87.5727%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2922, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 198, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4160/4485 (92.7536%)
___Train Local_ResNet_18,  epoch 198, local model 61, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3832/4485 (85.4404%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2831, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch 198, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5107/5559 (91.8690%)
___Train Local_ResNet_18,  epoch 198, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4897/5559 (88.0914%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3141, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 198, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5059/5346 (94.6315%)
___Train Local_ResNet_18,  epoch 198, local model 3, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5013/5346 (93.7710%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1791, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 198, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5021/5298 (94.7716%)
___Train Local_ResNet_18,  epoch 198, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4934/5298 (93.1295%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0863, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 198, local model 69, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4123/4364 (94.4775%)
___Train Local_ResNet_18,  epoch 198, local model 69, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3938/4364 (90.2383%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2339, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 198, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4695/5055 (92.8783%)
___Train Local_ResNet_18,  epoch 198, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4573/5055 (90.4649%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2091, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 198, local model 42, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5469/5907 (92.5851%)
___Train Local_ResNet_18,  epoch 198, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5351/5907 (90.5874%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.5413, Accuracy: 4890/10000 (48.9000%)
___Train Local_ResNet_18,  epoch 198, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3651/3959 (92.2203%)
___Train Local_ResNet_18,  epoch 198, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3640/3959 (91.9424%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0153, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 198, local model 7, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4542/4869 (93.2840%)
___Train Local_ResNet_18,  epoch 198, local model 7, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4064/4869 (83.4668%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.5317, Accuracy: 4801/10000 (48.0100%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4881/5224 (93.4342%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4770/5224 (91.3093%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1448, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 198, local model 14, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4056/4196 (96.6635%)
___Train Local_ResNet_18,  epoch 198, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4012/4196 (95.6149%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8087, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 198, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4730/5038 (93.8865%)
___Train Local_ResNet_18,  epoch 198, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4651/5038 (92.3184%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0515, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 198, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5444/6080 (89.5395%)
___Train Local_ResNet_18,  epoch 198, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5327/6080 (87.6151%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3281, Accuracy: 4955/10000 (49.5500%)
___Train Local_ResNet_18,  epoch 198, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5822/6419 (90.6995%)
___Train Local_ResNet_18,  epoch 198, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5561/6419 (86.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3494, Accuracy: 5103/10000 (51.0300%)
time spent on training: 279.5383470058441
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.6181, Accuracy: 6156/10000 (61.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0163, Accuracy: 9856/9900 (99.5556%)
Done in 306.2679145336151 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 19, 16, 82, 89, 45, 31, 91, 9, 44, 66, 11, 76, 92, 37, 54, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5237/5308 (98.6624%), train_poison_data_count: 415
Global model norm: 44.999793836333296.
Norm before scaling: 44.951046234956394. Distance: 1.0660437781843741
Total norm for 4 adversaries is: 44.951046234956394. distance: 1.0660437781843741
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0557, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5695/5777 (98.5806%), train_poison_data_count: 455
Global model norm: 44.999793836333296.
Norm before scaling: 44.94591340529123. Distance: 1.1666327142316326
Total norm for 4 adversaries is: 44.94591340529123. distance: 1.1666327142316326
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0364, Accuracy: 9805/9900 (99.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5018/5123 (97.9504%), train_poison_data_count: 403
Global model norm: 44.999793836333296.
Norm before scaling: 44.9543741136847. Distance: 1.1486284784871899
Total norm for 4 adversaries is: 44.9543741136847. distance: 1.1486284784871899
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0311, Accuracy: 9818/9900 (99.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5408/5503 (98.2737%), train_poison_data_count: 430
Global model norm: 44.999793836333296.
Norm before scaling: 44.950261411659916. Distance: 1.1340955637035177
Total norm for 4 adversaries is: 44.950261411659916. distance: 1.1340955637035177
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0856, Accuracy: 9666/9900 (97.6364%)
___Train Local_ResNet_18,  epoch 199, local model 19, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4983/5361 (92.9491%)
___Train Local_ResNet_18,  epoch 199, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4816/5361 (89.8340%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1437, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 199, local model 16, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5042/5353 (94.1902%)
___Train Local_ResNet_18,  epoch 199, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4791/5353 (89.5012%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1502, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5069/5298 (95.6776%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4983/5298 (94.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0556, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 199, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4434/4737 (93.6035%)
___Train Local_ResNet_18,  epoch 199, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4363/4737 (92.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2271, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 199, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5057/5489 (92.1297%)
___Train Local_ResNet_18,  epoch 199, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4943/5489 (90.0528%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2155, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 199, local model 31, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4319/4537 (95.1951%)
___Train Local_ResNet_18,  epoch 199, local model 31, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4239/4537 (93.4318%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0142, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 199, local model 91, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4160/4527 (91.8931%)
___Train Local_ResNet_18,  epoch 199, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4007/4527 (88.5134%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0822, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5300/5727 (92.5441%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5132/5727 (89.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1274, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4793/5075 (94.4433%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4666/5075 (91.9409%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0204, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 199, local model 66, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4585/4843 (94.6727%)
___Train Local_ResNet_18,  epoch 199, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4441/4843 (91.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2503, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 199, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5057/5702 (88.6882%)
___Train Local_ResNet_18,  epoch 199, local model 11, internal_epoch   2,  Average loss: 0.0102, Accuracy: 4563/5702 (80.0246%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.5665, Accuracy: 4714/10000 (47.1400%)
___Train Local_ResNet_18,  epoch 199, local model 76, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3686/3959 (93.1043%)
___Train Local_ResNet_18,  epoch 199, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3638/3959 (91.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1084, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 199, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6424/6812 (94.3042%)
___Train Local_ResNet_18,  epoch 199, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6184/6812 (90.7810%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2892, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 199, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4371/4741 (92.1957%)
___Train Local_ResNet_18,  epoch 199, local model 37, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3963/4741 (83.5900%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.8037, Accuracy: 4558/10000 (45.5800%)
___Train Local_ResNet_18,  epoch 199, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5112/5645 (90.5580%)
___Train Local_ResNet_18,  epoch 199, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4970/5645 (88.0425%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3168, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch 199, local model 63, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3733/3910 (95.4731%)
___Train Local_ResNet_18,  epoch 199, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3440/3910 (87.9795%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.4389, Accuracy: 5099/10000 (50.9900%)
time spent on training: 278.2679932117462
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.6181, Accuracy: 6153/10000 (61.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0176, Accuracy: 9854/9900 (99.5354%)
Done in 304.9680733680725 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 42, 74, 66, 6, 50, 49, 10, 11, 1, 96, 61, 52, 79, 72, 55, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5227/5308 (98.4740%), train_poison_data_count: 415
Global model norm: 45.0198754393025.
Norm before scaling: 44.97077501521127. Distance: 1.0961351817777574
Total norm for 4 adversaries is: 44.97077501521127. distance: 1.0961351817777574
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0249, Accuracy: 9847/9900 (99.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5675/5777 (98.2344%), train_poison_data_count: 455
Global model norm: 45.0198754393025.
Norm before scaling: 44.9666108768495. Distance: 1.1683909185877412
Total norm for 4 adversaries is: 44.9666108768495. distance: 1.1683909185877412
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1197, Accuracy: 9593/9900 (96.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5029/5123 (98.1651%), train_poison_data_count: 403
Global model norm: 45.0198754393025.
Norm before scaling: 44.9735314409869. Distance: 1.1181403411614546
Total norm for 4 adversaries is: 44.9735314409869. distance: 1.1181403411614546
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.2281, Accuracy: 9285/9900 (93.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5402/5503 (98.1646%), train_poison_data_count: 430
Global model norm: 45.0198754393025.
Norm before scaling: 44.971988351952206. Distance: 1.1661655451051507
Total norm for 4 adversaries is: 44.971988351952206. distance: 1.1661655451051507
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0356, Accuracy: 9812/9900 (99.1111%)
___Train Local_ResNet_18,  epoch 200, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5508/5907 (93.2453%)
___Train Local_ResNet_18,  epoch 200, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5387/5907 (91.1969%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3428, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4480/4797 (93.3917%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4431/4797 (92.3702%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1189, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 200, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4550/4843 (93.9500%)
___Train Local_ResNet_18,  epoch 200, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4529/4843 (93.5164%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1163, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 200, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4691/4929 (95.1714%)
___Train Local_ResNet_18,  epoch 200, local model 6, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4544/4929 (92.1891%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1074, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 200, local model 50, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4485/4757 (94.2821%)
___Train Local_ResNet_18,  epoch 200, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4338/4757 (91.1919%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1184, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 200, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5172/5652 (91.5074%)
___Train Local_ResNet_18,  epoch 200, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5019/5652 (88.8004%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3352, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch 200, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4835/5068 (95.4025%)
___Train Local_ResNet_18,  epoch 200, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4689/5068 (92.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3914, Accuracy: 5007/10000 (50.0700%)
___Train Local_ResNet_18,  epoch 200, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5080/5702 (89.0915%)
___Train Local_ResNet_18,  epoch 200, local model 11, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4650/5702 (81.5503%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3397, Accuracy: 4996/10000 (49.9600%)
___Train Local_ResNet_18,  epoch 200, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5203/5422 (95.9609%)
___Train Local_ResNet_18,  epoch 200, local model 1, internal_epoch   2,  Average loss: 0.0030, Accuracy: 5119/5422 (94.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8810, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 200, local model 96, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4796/5086 (94.2981%)
___Train Local_ResNet_18,  epoch 200, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4679/5086 (91.9976%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0723, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 200, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4203/4485 (93.7124%)
___Train Local_ResNet_18,  epoch 200, local model 61, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3917/4485 (87.3356%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2088, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3944/4130 (95.4964%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3855/4130 (93.3414%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9945, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 200, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3863/4111 (93.9674%)
___Train Local_ResNet_18,  epoch 200, local model 79, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3672/4111 (89.3213%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2690, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 200, local model 72, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4856/5193 (93.5105%)
___Train Local_ResNet_18,  epoch 200, local model 72, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4609/5193 (88.7541%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3391, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 200, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4449/4731 (94.0393%)
___Train Local_ResNet_18,  epoch 200, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4404/4731 (93.0881%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3551, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 200, local model 38, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5755/6235 (92.3015%)
___Train Local_ResNet_18,  epoch 200, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5531/6235 (88.7089%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.5885, Accuracy: 4772/10000 (47.7200%)
time spent on training: 278.1046690940857
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6019, Accuracy: 6176/10000 (61.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0215, Accuracy: 9840/9900 (99.3939%)
Done in 304.86603713035583 sec.
Saving all the graphs.
This run has a label: Aug.19_12.38.36. Visdom environment: cifar100_CerP
