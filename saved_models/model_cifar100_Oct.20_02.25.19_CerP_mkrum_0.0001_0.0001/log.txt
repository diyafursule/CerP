current path: saved_models/model_cifar100_Oct.20_02.25.19_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4306/4885 (88.1474%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.44003122053517. Distance: 2.2940152589179075
Total norm for 4 adversaries is: 42.44003122053517. distance: 2.2940152589179075
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4478, Accuracy: 8816/9900 (89.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.435329645808544. Distance: 2.2501963423786266
Total norm for 4 adversaries is: 42.435329645808544. distance: 2.2501963423786266
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7269, Accuracy: 8309/9900 (83.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4177/4717 (88.5520%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.438788640228644. Distance: 2.179168748824205
Total norm for 4 adversaries is: 42.438788640228644. distance: 2.179168748824205
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4195, Accuracy: 8905/9900 (89.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4456/5066 (87.9589%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.440400823629275. Distance: 2.3048416344777296
Total norm for 4 adversaries is: 42.440400823629275. distance: 2.3048416344777296
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6046, Accuracy: 8499/9900 (85.8485%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3841/4356 (88.1772%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3658/4356 (83.9761%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4780, Accuracy: 4618/10000 (46.1800%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3932/4465 (88.0627%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4093/4465 (91.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9787, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4050/4647 (87.1530%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4176/4647 (89.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8991, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4443/5055 (87.8932%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4515/5055 (89.3175%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1190, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4435/5116 (86.6888%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4472/5116 (87.4120%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0363, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3624/4126 (87.8333%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3755/4126 (91.0082%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9924, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3081/3472 (88.7385%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3220/3472 (92.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0487, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4432/4986 (88.8889%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4440/4986 (89.0493%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0931, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3538/4013 (88.1635%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3689/4013 (91.9262%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8244, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4033/4618 (87.3322%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4068/4618 (88.0901%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0304, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4434/5083 (87.2319%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4444/5083 (87.4287%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0897, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3972/4511 (88.0514%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4046/4511 (89.6919%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1691, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3330/3797 (87.7008%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3385/3797 (89.1493%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9633, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4997/5582 (89.5199%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5046/5582 (90.3977%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1585, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3152/3616 (87.1681%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3223/3616 (89.1316%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0625, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4831/5455 (88.5610%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4879/5455 (89.4409%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9594, Accuracy: 5332/10000 (53.3200%)
time spent on training: 232.19560956954956
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1347, Accuracy: 7003/10000 (70.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.8672, Accuracy: 56/9900 (0.5657%)
Done in 253.3301990032196 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4356/4885 (89.1709%), train_poison_data_count: 385
Global model norm: 42.467380347211055.
Norm before scaling: 42.47097469338619. Distance: 2.217710224495424
Total norm for 4 adversaries is: 42.47097469338619. distance: 2.217710224495424
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1942, Accuracy: 9426/9900 (95.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4764/5305 (89.8021%), train_poison_data_count: 415
Global model norm: 42.467380347211055.
Norm before scaling: 42.47294778968505. Distance: 2.2111610326557414
Total norm for 4 adversaries is: 42.47294778968505. distance: 2.2111610326557414
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.3823, Accuracy: 8989/9900 (90.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4220/4717 (89.4636%), train_poison_data_count: 370
Global model norm: 42.467380347211055.
Norm before scaling: 42.475190943692354. Distance: 2.1413009578700732
Total norm for 4 adversaries is: 42.475190943692354. distance: 2.1413009578700732
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2842, Accuracy: 9234/9900 (93.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4480/5066 (88.4327%), train_poison_data_count: 400
Global model norm: 42.467380347211055.
Norm before scaling: 42.478610771150166. Distance: 2.3109572135698313
Total norm for 4 adversaries is: 42.478610771150166. distance: 2.3109572135698313
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2552, Accuracy: 9256/9900 (93.4949%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3581/4025 (88.9689%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3690/4025 (91.6770%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9248, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3375/3797 (88.8860%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3478/3797 (91.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9845, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3990/4625 (86.2703%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4016/4625 (86.8324%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2423, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3815/4481 (85.1372%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3846/4481 (85.8291%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2534, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3866/4315 (89.5944%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3945/4315 (91.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0266, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3703/4235 (87.4380%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3783/4235 (89.3270%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0674, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3362/3828 (87.8265%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3506/3828 (91.5883%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8236, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3818/4416 (86.4583%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3935/4416 (89.1078%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0446, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3157/3638 (86.7784%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3294/3638 (90.5443%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9797, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4530/5265 (86.0399%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4534/5265 (86.1159%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9531, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3323/3781 (87.8868%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3387/3781 (89.5795%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1492, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3944/4441 (88.8088%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4017/4441 (90.4526%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0200, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3941/4433 (88.9014%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4006/4433 (90.3677%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0086, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4409/5083 (86.7401%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4420/5083 (86.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1292, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4316/4928 (87.5812%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4394/4928 (89.1640%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9167, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4173/4793 (87.0645%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4328/4793 (90.2984%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0500, Accuracy: 5359/10000 (53.5900%)
time spent on training: 227.48060178756714
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1498, Accuracy: 6987/10000 (69.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.4771, Accuracy: 57/9900 (0.5758%)
Done in 248.75144410133362 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 42.497104680789725.
Norm before scaling: 42.49777395365109. Distance: 2.130057319442965
Total norm for 4 adversaries is: 42.49777395365109. distance: 2.130057319442965
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2263, Accuracy: 9361/9900 (94.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 42.497104680789725.
Norm before scaling: 42.49994829960091. Distance: 2.169421120177819
Total norm for 4 adversaries is: 42.49994829960091. distance: 2.169421120177819
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1286, Accuracy: 9575/9900 (96.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4188/4717 (88.7852%), train_poison_data_count: 370
Global model norm: 42.497104680789725.
Norm before scaling: 42.50285778535221. Distance: 2.150169201779934
Total norm for 4 adversaries is: 42.50285778535221. distance: 2.150169201779934
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2169, Accuracy: 9354/9900 (94.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4502/5066 (88.8670%), train_poison_data_count: 400
Global model norm: 42.497104680789725.
Norm before scaling: 42.502574887532546. Distance: 2.2255586201496493
Total norm for 4 adversaries is: 42.502574887532546. distance: 2.2255586201496493
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2806, Accuracy: 9199/9900 (92.9192%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3156/3616 (87.2788%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3280/3616 (90.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8934, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3390/3837 (88.3503%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3555/3837 (92.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0445, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4123/4679 (88.1171%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4040/4679 (86.3432%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1563, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3134/3638 (86.1462%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3293/3638 (90.5168%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9763, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3644/4046 (90.0643%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3692/4046 (91.2506%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8695, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4025/4518 (89.0881%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4083/4518 (90.3718%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9564, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3348/3797 (88.1749%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3417/3797 (89.9921%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0682, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4420/5025 (87.9602%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4518/5025 (89.9104%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9869, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3856/4362 (88.3998%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3916/4362 (89.7753%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9668, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3993/4558 (87.6042%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4023/4558 (88.2624%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1885, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3174/3672 (86.4379%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3355/3672 (91.3671%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0256, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4282/4874 (87.8539%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4326/4874 (88.7567%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1934, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3598/4025 (89.3913%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3675/4025 (91.3043%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9530, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4129/4663 (88.5481%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4248/4663 (91.1002%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0320, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3416/3911 (87.3434%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3424/3911 (87.5479%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2405, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4401/5017 (87.7217%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4484/5017 (89.3761%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9707, Accuracy: 5434/10000 (54.3400%)
time spent on training: 225.06391954421997
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1672, Accuracy: 6944/10000 (69.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.3855, Accuracy: 63/9900 (0.6364%)
Done in 246.21452736854553 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4389/4885 (89.8465%), train_poison_data_count: 385
Global model norm: 42.52630734505701.
Norm before scaling: 42.53338388980105. Distance: 2.175162482495583
Total norm for 4 adversaries is: 42.53338388980105. distance: 2.175162482495583
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1099, Accuracy: 9620/9900 (97.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4765/5305 (89.8209%), train_poison_data_count: 415
Global model norm: 42.52630734505701.
Norm before scaling: 42.528795966123056. Distance: 2.1985183061119984
Total norm for 4 adversaries is: 42.528795966123056. distance: 2.1985183061119984
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0614, Accuracy: 9731/9900 (98.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4198/4717 (88.9972%), train_poison_data_count: 370
Global model norm: 42.52630734505701.
Norm before scaling: 42.53101895372585. Distance: 2.1017881364480853
Total norm for 4 adversaries is: 42.53101895372585. distance: 2.1017881364480853
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3096, Accuracy: 9130/9900 (92.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4463/5066 (88.0971%), train_poison_data_count: 400
Global model norm: 42.52630734505701.
Norm before scaling: 42.53232628597776. Distance: 2.295454455323308
Total norm for 4 adversaries is: 42.53232628597776. distance: 2.295454455323308
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0910, Accuracy: 9657/9900 (97.5455%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5243/6124 (85.6140%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5250/6124 (85.7283%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1454, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3790/4356 (87.0064%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0094, Accuracy: 3591/4356 (82.4380%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2547, Accuracy: 4888/10000 (48.8800%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3574/4158 (85.9548%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3612/4158 (86.8687%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0614, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4807/5455 (88.1210%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4915/5455 (90.1008%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9594, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3923/4511 (86.9652%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4064/4511 (90.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.7943, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4506/5232 (86.1239%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4591/5232 (87.7485%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0469, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4434/5244 (84.5538%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4554/5244 (86.8421%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0569, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4299/4918 (87.4136%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4459/4918 (90.6669%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0586, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3624/4126 (87.8333%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3752/4126 (90.9355%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8753, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4307/4928 (87.3985%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4347/4928 (88.2102%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0797, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3703/4223 (87.6865%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3851/4223 (91.1911%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9583, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4499/5195 (86.6025%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4514/5195 (86.8912%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0808, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4120/4679 (88.0530%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4200/4679 (89.7628%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0120, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3206/3646 (87.9320%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3308/3646 (90.7296%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8961, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3145/3616 (86.9746%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3258/3616 (90.0996%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9591, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4114/4716 (87.2349%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4166/4716 (88.3376%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9688, Accuracy: 5409/10000 (54.0900%)
time spent on training: 233.29978275299072
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.1785, Accuracy: 6914/10000 (69.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.2427, Accuracy: 84/9900 (0.8485%)
Done in 254.62910795211792 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4397/4885 (90.0102%), train_poison_data_count: 385
Global model norm: 42.56611355805813.
Norm before scaling: 42.571359840988606. Distance: 2.1477908739266396
Total norm for 4 adversaries is: 42.571359840988606. distance: 2.1477908739266396
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2611, Accuracy: 9220/9900 (93.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 42.56611355805813.
Norm before scaling: 42.56685774084913. Distance: 2.1365378685078613
Total norm for 4 adversaries is: 42.56685774084913. distance: 2.1365378685078613
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1667, Accuracy: 9472/9900 (95.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4242/4717 (89.9300%), train_poison_data_count: 370
Global model norm: 42.56611355805813.
Norm before scaling: 42.56479149026076. Distance: 2.063153365713592
Total norm for 4 adversaries is: 42.56479149026076. distance: 2.063153365713592
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.0528, Accuracy: 9754/9900 (98.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4494/5066 (88.7090%), train_poison_data_count: 400
Global model norm: 42.56611355805813.
Norm before scaling: 42.57444651541286. Distance: 2.2730219615273075
Total norm for 4 adversaries is: 42.57444651541286. distance: 2.2730219615273075
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1534, Accuracy: 9512/9900 (96.0808%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5273/6124 (86.1039%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5267/6124 (86.0059%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0930, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3943/4433 (88.9465%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4037/4433 (91.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8300, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3321/3781 (87.8339%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3255/3781 (86.0883%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2327, Accuracy: 4969/10000 (49.6900%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3537/3969 (89.1156%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3581/3969 (90.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9410, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4439/5025 (88.3383%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4521/5025 (89.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2457, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4167/4679 (89.0575%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4119/4679 (88.0316%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3465, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4133/4707 (87.8054%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4264/4707 (90.5885%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0059, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4366/4986 (87.5652%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4444/4986 (89.1296%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9862, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3873/4315 (89.7567%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3934/4315 (91.1703%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9892, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3840/4416 (86.9565%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3900/4416 (88.3152%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9685, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4180/4804 (87.0108%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4027/4804 (83.8260%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3598, Accuracy: 4921/10000 (49.2100%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4186/4793 (87.3357%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4292/4793 (89.5473%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9889, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4488/5232 (85.7798%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4534/5232 (86.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0925, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4124/4662 (88.4599%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4214/4662 (90.3904%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9538, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4250/4956 (85.7546%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4409/4956 (88.9629%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1743, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3816/4368 (87.3626%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3852/4368 (88.1868%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0559, Accuracy: 5374/10000 (53.7400%)
time spent on training: 234.6365795135498
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.1880, Accuracy: 6906/10000 (69.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.4303, Accuracy: 81/9900 (0.8182%)
Done in 255.84159564971924 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4373/4885 (89.5189%), train_poison_data_count: 385
Global model norm: 42.60564334365299.
Norm before scaling: 42.6099536997739. Distance: 2.151793033879103
Total norm for 4 adversaries is: 42.6099536997739. distance: 2.151793033879103
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2553, Accuracy: 9273/9900 (93.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4754/5305 (89.6136%), train_poison_data_count: 415
Global model norm: 42.60564334365299.
Norm before scaling: 42.606607445874815. Distance: 2.214188951584275
Total norm for 4 adversaries is: 42.606607445874815. distance: 2.214188951584275
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2221, Accuracy: 9340/9900 (94.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4219/4717 (89.4424%), train_poison_data_count: 370
Global model norm: 42.60564334365299.
Norm before scaling: 42.60666044937619. Distance: 2.0430576750035994
Total norm for 4 adversaries is: 42.60666044937619. distance: 2.0430576750035994
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1486, Accuracy: 9516/9900 (96.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 42.60564334365299.
Norm before scaling: 42.60923605358717. Distance: 2.2474296511289693
Total norm for 4 adversaries is: 42.60923605358717. distance: 2.2474296511289693
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2113, Accuracy: 9341/9900 (94.3535%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5285/6124 (86.2998%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5383/6124 (87.9001%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9457, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0078, Accuracy: 5027/5902 (85.1745%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4970/5902 (84.2087%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1820, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4136/4707 (87.8691%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4271/4707 (90.7372%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8908, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4075/4647 (87.6910%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4194/4647 (90.2518%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0268, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2941/3297 (89.2023%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3020/3297 (91.5984%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8650, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5542/6263 (88.4879%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5673/6263 (90.5796%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1179, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4140/4663 (88.7840%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4259/4663 (91.3360%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0775, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4210/4956 (84.9475%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4378/4956 (88.3374%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3234, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3625/4046 (89.5947%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3600/4046 (88.9768%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1266, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3677/4184 (87.8824%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3767/4184 (90.0335%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8645, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4837/5591 (86.5140%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4879/5591 (87.2652%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1861, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4080/4634 (88.0449%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4144/4634 (89.4260%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9517, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3399/3828 (88.7931%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3489/3828 (91.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9012, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3181/3638 (87.4382%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3313/3638 (91.0665%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9898, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3318/3781 (87.7546%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3269/3781 (86.4586%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1725, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3391/3837 (88.3763%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3517/3837 (91.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9650, Accuracy: 5499/10000 (54.9900%)
time spent on training: 233.52968192100525
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1977, Accuracy: 6927/10000 (69.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.2514, Accuracy: 98/9900 (0.9899%)
Done in 254.7967870235443 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4343/4885 (88.9048%), train_poison_data_count: 385
Global model norm: 42.64359358940977.
Norm before scaling: 42.64769259401674. Distance: 2.1706238580289385
Total norm for 4 adversaries is: 42.64769259401674. distance: 2.1706238580289385
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.3004, Accuracy: 9182/9900 (92.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 42.64359358940977.
Norm before scaling: 42.6435506508238. Distance: 2.2099191861458767
Total norm for 4 adversaries is: 42.6435506508238. distance: 2.2099191861458767
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1265, Accuracy: 9568/9900 (96.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4206/4717 (89.1668%), train_poison_data_count: 370
Global model norm: 42.64359358940977.
Norm before scaling: 42.646205605411865. Distance: 2.0918412119265426
Total norm for 4 adversaries is: 42.646205605411865. distance: 2.0918412119265426
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.0349, Accuracy: 9795/9900 (98.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4495/5066 (88.7288%), train_poison_data_count: 400
Global model norm: 42.64359358940977.
Norm before scaling: 42.65027144458608. Distance: 2.2585431141094063
Total norm for 4 adversaries is: 42.65027144458608. distance: 2.2585431141094063
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1191, Accuracy: 9586/9900 (96.8283%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3884/4501 (86.2919%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3987/4501 (88.5803%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1514, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3571/4175 (85.5329%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3705/4175 (88.7425%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0241, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3144/3616 (86.9469%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3253/3616 (89.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9462, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4126/4634 (89.0375%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4224/4634 (91.1524%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0137, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3980/4558 (87.3190%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3982/4558 (87.3629%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0790, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4510/5167 (87.2847%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4609/5167 (89.2007%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.3933, Accuracy: 4922/10000 (49.2200%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3891/4356 (89.3251%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3954/4356 (90.7713%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2408, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4077/4716 (86.4504%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4125/4716 (87.4682%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1407, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5300/6124 (86.5447%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5348/6124 (87.3285%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0386, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4446/5055 (87.9525%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4517/5055 (89.3571%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9660, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4418/5025 (87.9204%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4568/5025 (90.9055%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9231, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4360/4918 (88.6539%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4421/4918 (89.8943%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1628, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3696/4223 (87.5207%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3841/4223 (90.9543%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9837, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0083, Accuracy: 3837/4481 (85.6282%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3875/4481 (86.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1511, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3174/3638 (87.2457%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3294/3638 (90.5443%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8285, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3573/4013 (89.0356%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3699/4013 (92.1754%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8952, Accuracy: 5560/10000 (55.6000%)
time spent on training: 231.04022455215454
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1817, Accuracy: 6944/10000 (69.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 9.2523, Accuracy: 102/9900 (1.0303%)
Done in 252.30475401878357 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 42.67838682692256.
Norm before scaling: 42.68141857074267. Distance: 2.1666921345118726
Total norm for 4 adversaries is: 42.68141857074267. distance: 2.1666921345118726
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2141, Accuracy: 9360/9900 (94.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 42.67838682692256.
Norm before scaling: 42.67620727047083. Distance: 2.188409997488623
Total norm for 4 adversaries is: 42.67620727047083. distance: 2.188409997488623
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1595, Accuracy: 9478/9900 (95.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 42.67838682692256.
Norm before scaling: 42.677255588091064. Distance: 2.043436554836924
Total norm for 4 adversaries is: 42.677255588091064. distance: 2.043436554836924
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2017, Accuracy: 9386/9900 (94.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4519/5066 (89.2025%), train_poison_data_count: 400
Global model norm: 42.67838682692256.
Norm before scaling: 42.68276848548999. Distance: 2.220140048584131
Total norm for 4 adversaries is: 42.68276848548999. distance: 2.220140048584131
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1515, Accuracy: 9491/9900 (95.8687%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3188/3646 (87.4383%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3297/3646 (90.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8191, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3906/4501 (86.7807%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4041/4501 (89.7800%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0063, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4089/4651 (87.9166%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4163/4651 (89.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0441, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4580/5167 (88.6394%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4606/5167 (89.1426%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1268, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4847/5455 (88.8543%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4870/5455 (89.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9983, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4848/5591 (86.7108%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4845/5591 (86.6571%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1039, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4158/4679 (88.8651%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4163/4679 (88.9720%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1562, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4456/5017 (88.8180%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4469/5017 (89.0771%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0078, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4154/4793 (86.6681%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4288/4793 (89.4638%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9287, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3959/4456 (88.8465%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4021/4456 (90.2379%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0968, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4788/5424 (88.2743%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4868/5424 (89.7493%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2380, Accuracy: 5069/10000 (50.6900%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3659/4175 (87.6407%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3727/4175 (89.2695%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1342, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4494/5116 (87.8421%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4554/5116 (89.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9809, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3292/3704 (88.8769%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3355/3704 (90.5778%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9615, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4652/5232 (88.9144%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4684/5232 (89.5260%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0762, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3096/3472 (89.1705%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3188/3472 (91.8203%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9986, Accuracy: 5521/10000 (55.2100%)
time spent on training: 233.37696623802185
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1794, Accuracy: 6928/10000 (69.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 9.3432, Accuracy: 91/9900 (0.9192%)
Done in 254.66581678390503 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4393/4885 (89.9284%), train_poison_data_count: 385
Global model norm: 42.710309437260726.
Norm before scaling: 42.71267730702883. Distance: 2.1273975310880524
Total norm for 4 adversaries is: 42.71267730702883. distance: 2.1273975310880524
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2207, Accuracy: 9326/9900 (94.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4753/5305 (89.5947%), train_poison_data_count: 415
Global model norm: 42.710309437260726.
Norm before scaling: 42.713759024006976. Distance: 2.2227784242220943
Total norm for 4 adversaries is: 42.713759024006976. distance: 2.2227784242220943
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1129, Accuracy: 9604/9900 (97.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 42.710309437260726.
Norm before scaling: 42.70933052697619. Distance: 2.098012201381001
Total norm for 4 adversaries is: 42.70933052697619. distance: 2.098012201381001
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1129, Accuracy: 9600/9900 (96.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4470/5066 (88.2353%), train_poison_data_count: 400
Global model norm: 42.710309437260726.
Norm before scaling: 42.71840995201161. Distance: 2.318934895426099
Total norm for 4 adversaries is: 42.71840995201161. distance: 2.318934895426099
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.0668, Accuracy: 9719/9900 (98.1717%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3213/3590 (89.4986%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3086/3590 (85.9610%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1547, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3797/4368 (86.9277%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3846/4368 (88.0495%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1992, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3282/3704 (88.6069%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3333/3704 (89.9838%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9327, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4353/4928 (88.3320%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4460/4928 (90.5032%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8825, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3873/4356 (88.9118%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3710/4356 (85.1699%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2420, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3491/3911 (89.2611%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3416/3911 (87.3434%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2501, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4084/4651 (87.8091%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4188/4651 (90.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1276, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3708/4184 (88.6233%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3761/4184 (89.8901%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9919, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3850/4346 (88.5872%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4013/4346 (92.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9545, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4171/4793 (87.0227%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4297/4793 (89.6516%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2912, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3341/3804 (87.8286%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3455/3804 (90.8254%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9949, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4392/4986 (88.0866%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4440/4986 (89.0493%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9433, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5330/6124 (87.0346%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5341/6124 (87.2142%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1737, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4109/4707 (87.2955%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4240/4707 (90.0786%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9580, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3835/4235 (90.5549%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3801/4235 (89.7521%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9676, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3651/4046 (90.2373%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3678/4046 (90.9046%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9971, Accuracy: 5498/10000 (54.9800%)
time spent on training: 228.72693419456482
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1782, Accuracy: 6928/10000 (69.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.0943, Accuracy: 104/9900 (1.0505%)
Done in 249.83143854141235 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4407/4885 (90.2149%), train_poison_data_count: 385
Global model norm: 42.739176489858224.
Norm before scaling: 42.74536250431151. Distance: 2.147172034980601
Total norm for 4 adversaries is: 42.74536250431151. distance: 2.147172034980601
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3056, Accuracy: 9172/9900 (92.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4763/5305 (89.7832%), train_poison_data_count: 415
Global model norm: 42.739176489858224.
Norm before scaling: 42.74232530022568. Distance: 2.2289176397771335
Total norm for 4 adversaries is: 42.74232530022568. distance: 2.2289176397771335
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0474, Accuracy: 9776/9900 (98.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4226/4717 (89.5908%), train_poison_data_count: 370
Global model norm: 42.739176489858224.
Norm before scaling: 42.73852527835688. Distance: 2.0291102950499114
Total norm for 4 adversaries is: 42.73852527835688. distance: 2.0291102950499114
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3752, Accuracy: 8935/9900 (90.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4536/5066 (89.5381%), train_poison_data_count: 400
Global model norm: 42.739176489858224.
Norm before scaling: 42.74557811332287. Distance: 2.230582372974765
Total norm for 4 adversaries is: 42.74557811332287. distance: 2.230582372974765
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2171, Accuracy: 9348/9900 (94.4242%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4433/4986 (88.9089%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4463/4986 (89.5106%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8734, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4075/4634 (87.9370%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4159/4634 (89.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8425, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4224/4716 (89.5674%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4251/4716 (90.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0058, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5293/6124 (86.4304%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5381/6124 (87.8674%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9905, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4370/4918 (88.8573%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4427/4918 (90.0163%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8811, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3376/3797 (88.9123%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3461/3797 (91.1509%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9265, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5132/5582 (91.9384%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5117/5582 (91.6697%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1410, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4372/4956 (88.2163%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4359/4956 (87.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1425, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3975/4433 (89.6684%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4043/4433 (91.2023%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9136, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3843/4354 (88.2637%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0101, Accuracy: 3528/4354 (81.0289%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.4221, Accuracy: 4683/10000 (46.8300%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4347/4928 (88.2102%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4441/4928 (90.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9782, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3470/3911 (88.7241%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3506/3911 (89.6446%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0424, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0082, Accuracy: 3852/4481 (85.9630%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3918/4481 (87.4358%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1382, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4607/5197 (88.6473%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4598/5197 (88.4741%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9979, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4845/5455 (88.8176%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4893/5455 (89.6975%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2223, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3789/4361 (86.8837%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3881/4361 (88.9934%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0639, Accuracy: 5309/10000 (53.0900%)
time spent on training: 236.54649782180786
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1916, Accuracy: 6886/10000 (68.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 9.0447, Accuracy: 107/9900 (1.0808%)
Done in 258.10999512672424 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4399/4885 (90.0512%), train_poison_data_count: 385
Global model norm: 42.77014328068121.
Norm before scaling: 42.775617096293885. Distance: 2.1496808147811692
Total norm for 4 adversaries is: 42.775617096293885. distance: 2.1496808147811692
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1861, Accuracy: 9420/9900 (95.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4763/5305 (89.7832%), train_poison_data_count: 415
Global model norm: 42.77014328068121.
Norm before scaling: 42.77230235365887. Distance: 2.2248431075426267
Total norm for 4 adversaries is: 42.77230235365887. distance: 2.2248431075426267
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1097, Accuracy: 9624/9900 (97.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4210/4717 (89.2516%), train_poison_data_count: 370
Global model norm: 42.77014328068121.
Norm before scaling: 42.775891054059294. Distance: 2.1464056220980168
Total norm for 4 adversaries is: 42.775891054059294. distance: 2.1464056220980168
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0683, Accuracy: 9712/9900 (98.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4543/5066 (89.6763%), train_poison_data_count: 400
Global model norm: 42.77014328068121.
Norm before scaling: 42.77427724632308. Distance: 2.187316123863698
Total norm for 4 adversaries is: 42.77427724632308. distance: 2.187316123863698
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2014, Accuracy: 9401/9900 (94.9596%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4268/4928 (86.6071%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4407/4928 (89.4278%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9997, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3712/4184 (88.7189%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3776/4184 (90.2486%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9627, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4161/4707 (88.4003%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4249/4707 (90.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9952, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3397/3828 (88.7409%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3496/3828 (91.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8078, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3981/4503 (88.4077%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4028/4503 (89.4515%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1353, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4128/4662 (88.5457%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4242/4662 (90.9910%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0601, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3855/4235 (91.0272%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3894/4235 (91.9481%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0244, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4431/5244 (84.4966%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4546/5244 (86.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0370, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4201/4793 (87.6487%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4313/4793 (89.9854%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9523, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3886/4481 (86.7217%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3915/4481 (87.3689%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0120, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3895/4346 (89.6226%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4009/4346 (92.2457%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8565, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3925/4361 (90.0023%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3882/4361 (89.0163%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0040, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4515/5055 (89.3175%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4571/5055 (90.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2789, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4675/5195 (89.9904%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4614/5195 (88.8162%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0606, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3888/4315 (90.1043%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3919/4315 (90.8227%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0208, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4161/4663 (89.2344%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4215/4663 (90.3925%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0215, Accuracy: 5370/10000 (53.7000%)
time spent on training: 232.51750445365906
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1895, Accuracy: 6902/10000 (69.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 9.2694, Accuracy: 92/9900 (0.9293%)
Done in 253.99041509628296 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4383/4885 (89.7236%), train_poison_data_count: 385
Global model norm: 42.8016837386028.
Norm before scaling: 42.80323662329389. Distance: 2.107969140523623
Total norm for 4 adversaries is: 42.80323662329389. distance: 2.107969140523623
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1068, Accuracy: 9639/9900 (97.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 42.8016837386028.
Norm before scaling: 42.8034604964219. Distance: 2.17578355114471
Total norm for 4 adversaries is: 42.8034604964219. distance: 2.17578355114471
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1373, Accuracy: 9564/9900 (96.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4233/4717 (89.7392%), train_poison_data_count: 370
Global model norm: 42.8016837386028.
Norm before scaling: 42.803106861900226. Distance: 2.0796007925024353
Total norm for 4 adversaries is: 42.803106861900226. distance: 2.0796007925024353
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1265, Accuracy: 9562/9900 (96.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4495/5066 (88.7288%), train_poison_data_count: 400
Global model norm: 42.8016837386028.
Norm before scaling: 42.8081002529384. Distance: 2.2909721246802657
Total norm for 4 adversaries is: 42.8081002529384. distance: 2.2909721246802657
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1610, Accuracy: 9486/9900 (95.8182%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3888/4315 (90.1043%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3998/4315 (92.6535%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7810, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3224/3590 (89.8050%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0093, Accuracy: 2988/3590 (83.2312%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.3637, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4173/4679 (89.1857%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4148/4679 (88.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1390, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4636/5167 (89.7232%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4658/5167 (90.1490%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.3855, Accuracy: 4924/10000 (49.2400%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3371/3775 (89.2980%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3502/3775 (92.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7713, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3432/3828 (89.6552%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3514/3828 (91.7973%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8915, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3853/4235 (90.9799%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3851/4235 (90.9327%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9747, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4061/4647 (87.3897%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4181/4647 (89.9720%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8886, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4304/4918 (87.5153%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4445/4918 (90.3823%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0784, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3939/4433 (88.8563%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4033/4433 (90.9768%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1187, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3869/4481 (86.3423%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3857/4481 (86.0745%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2286, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3791/4295 (88.2654%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3820/4295 (88.9406%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0476, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3966/4503 (88.0746%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4048/4503 (89.8956%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1132, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3792/4354 (87.0923%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3728/4354 (85.6224%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1978, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4426/4986 (88.7686%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4493/4986 (90.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8530, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5536/6263 (88.3921%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5601/6263 (89.4300%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1663, Accuracy: 5193/10000 (51.9300%)
time spent on training: 232.81428813934326
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1932, Accuracy: 6893/10000 (68.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 9.4693, Accuracy: 89/9900 (0.8990%)
Done in 254.2228298187256 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4414/4885 (90.3582%), train_poison_data_count: 385
Global model norm: 42.84238663722456.
Norm before scaling: 42.84372578181299. Distance: 2.0907078747937526
Total norm for 4 adversaries is: 42.84372578181299. distance: 2.0907078747937526
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1785, Accuracy: 9481/9900 (95.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 42.84238663722456.
Norm before scaling: 42.8444281036782. Distance: 2.184285335856165
Total norm for 4 adversaries is: 42.8444281036782. distance: 2.184285335856165
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1599, Accuracy: 9484/9900 (95.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 42.84238663722456.
Norm before scaling: 42.843255661353076. Distance: 2.0535936816413667
Total norm for 4 adversaries is: 42.843255661353076. distance: 2.0535936816413667
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.2769, Accuracy: 9181/9900 (92.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4476/5066 (88.3537%), train_poison_data_count: 400
Global model norm: 42.84238663722456.
Norm before scaling: 42.848240100236325. Distance: 2.2701195694609697
Total norm for 4 adversaries is: 42.848240100236325. distance: 2.2701195694609697
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.2283, Accuracy: 9341/9900 (94.3535%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3760/4223 (89.0362%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3835/4223 (90.8122%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0539, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4823/5455 (88.4143%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4860/5455 (89.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1715, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5109/5582 (91.5263%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5076/5582 (90.9351%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0507, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3954/4465 (88.5554%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4082/4465 (91.4222%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0267, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4845/5591 (86.6571%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4918/5591 (87.9628%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1033, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3501/3911 (89.5167%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3462/3911 (88.5196%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0381, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3876/4356 (88.9807%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3624/4356 (83.1956%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1718, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4378/5037 (86.9168%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4517/5037 (89.6764%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0782, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4207/4679 (89.9124%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4291/4679 (91.7076%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9696, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4025/4362 (92.2742%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4060/4362 (93.0766%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8516, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4037/4518 (89.3537%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4132/4518 (91.4564%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8848, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4433/5083 (87.2123%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4425/5083 (87.0549%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1484, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3591/4013 (89.4842%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3717/4013 (92.6240%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9502, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4553/5197 (87.6082%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4621/5197 (88.9167%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1675, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2927/3297 (88.7777%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3053/3297 (92.5993%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7575, Accuracy: 5943/10000 (59.4300%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4021/4441 (90.5427%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4112/4441 (92.5918%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9687, Accuracy: 5578/10000 (55.7800%)
time spent on training: 234.41988825798035
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1901, Accuracy: 6906/10000 (69.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 9.6455, Accuracy: 68/9900 (0.6869%)
Done in 255.73970365524292 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4428/4885 (90.6448%), train_poison_data_count: 385
Global model norm: 42.8714865087362.
Norm before scaling: 42.87359492276759. Distance: 2.085645333734833
Total norm for 4 adversaries is: 42.87359492276759. distance: 2.085645333734833
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3104, Accuracy: 9194/9900 (92.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 42.8714865087362.
Norm before scaling: 42.872826168014775. Distance: 2.174674226764485
Total norm for 4 adversaries is: 42.872826168014775. distance: 2.174674226764485
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2565, Accuracy: 9289/9900 (93.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 42.8714865087362.
Norm before scaling: 42.87181822423167. Distance: 2.0264742535721063
Total norm for 4 adversaries is: 42.87181822423167. distance: 2.0264742535721063
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1271, Accuracy: 9561/9900 (96.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4479/5066 (88.4129%), train_poison_data_count: 400
Global model norm: 42.8714865087362.
Norm before scaling: 42.87833954286389. Distance: 2.2956397439393355
Total norm for 4 adversaries is: 42.87833954286389. distance: 2.2956397439393355
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1392, Accuracy: 9531/9900 (96.2727%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3963/4501 (88.0471%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3966/4501 (88.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1155, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3961/4511 (87.8076%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4083/4511 (90.5121%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9777, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3836/4354 (88.1029%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0162, Accuracy: 3159/4354 (72.5540%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.7935, Accuracy: 4114/10000 (41.1400%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3934/4346 (90.5200%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4022/4346 (92.5449%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9733, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4186/4707 (88.9314%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4238/4707 (90.0361%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9365, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4872/5591 (87.1400%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4972/5591 (88.9286%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0730, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4068/4647 (87.5403%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4170/4647 (89.7353%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9047, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4073/4538 (89.7532%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4170/4538 (91.8907%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9018, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4311/4934 (87.3733%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4094/4934 (82.9753%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0363, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4277/4804 (89.0300%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4275/4804 (88.9883%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0773, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5706/6263 (91.1065%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5771/6263 (92.1443%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0296, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0082, Accuracy: 3847/4481 (85.8514%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3900/4481 (87.0341%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3082, Accuracy: 5044/10000 (50.4400%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4378/5063 (86.4705%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4406/5063 (87.0235%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1413, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3735/4223 (88.4442%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3886/4223 (92.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8992, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4011/4441 (90.3175%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4112/4441 (92.5918%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0178, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3394/3756 (90.3621%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3497/3756 (93.1044%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8950, Accuracy: 5697/10000 (56.9700%)
time spent on training: 234.20696878433228
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.2092, Accuracy: 6853/10000 (68.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 9.4962, Accuracy: 60/9900 (0.6061%)
Done in 255.58625268936157 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4451/4885 (91.1157%), train_poison_data_count: 385
Global model norm: 42.90810777569462.
Norm before scaling: 42.905198742128704. Distance: 2.0688420669951935
Total norm for 4 adversaries is: 42.905198742128704. distance: 2.0688420669951935
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2230, Accuracy: 9356/9900 (94.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 42.90810777569462.
Norm before scaling: 42.90749042271058. Distance: 2.1600689447843844
Total norm for 4 adversaries is: 42.90749042271058. distance: 2.1600689447843844
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3023, Accuracy: 9190/9900 (92.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4225/4717 (89.5696%), train_poison_data_count: 370
Global model norm: 42.90810777569462.
Norm before scaling: 42.908477614241626. Distance: 2.0747436319104766
Total norm for 4 adversaries is: 42.908477614241626. distance: 2.0747436319104766
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1664, Accuracy: 9437/9900 (95.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4509/5066 (89.0051%), train_poison_data_count: 400
Global model norm: 42.90810777569462.
Norm before scaling: 42.91152866063137. Distance: 2.2530346644647494
Total norm for 4 adversaries is: 42.91152866063137. distance: 2.2530346644647494
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1157, Accuracy: 9601/9900 (96.9798%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4513/5244 (86.0603%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4595/5244 (87.6240%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0177, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4375/4928 (88.7784%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4385/4928 (88.9813%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9254, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3365/3804 (88.4595%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3510/3804 (92.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8807, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3618/4013 (90.1570%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3695/4013 (92.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.7421, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3575/4158 (85.9788%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3608/4158 (86.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0696, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5071/5582 (90.8456%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5088/5582 (91.1501%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1386, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4816/5455 (88.2860%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4796/5455 (87.9193%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1254, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3806/4354 (87.4139%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0151, Accuracy: 3163/4354 (72.6458%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.5662, Accuracy: 4420/10000 (44.2000%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3982/4433 (89.8263%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4086/4433 (92.1723%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8968, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3169/3646 (86.9172%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3277/3646 (89.8793%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9584, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4029/4518 (89.1766%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4137/4518 (91.5671%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9070, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3831/4235 (90.4604%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3856/4235 (91.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9125, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4017/4362 (92.0908%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4008/4362 (91.8845%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0206, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4817/5392 (89.3361%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4828/5392 (89.5401%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0443, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4876/5591 (87.2116%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4900/5591 (87.6409%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0337, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3374/3756 (89.8296%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3500/3756 (93.1842%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9464, Accuracy: 5632/10000 (56.3200%)
time spent on training: 232.49194240570068
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.2450, Accuracy: 6798/10000 (67.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 9.5789, Accuracy: 55/9900 (0.5556%)
Done in 253.89962196350098 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4402/4885 (90.1126%), train_poison_data_count: 385
Global model norm: 42.944727659970816.
Norm before scaling: 42.945721101612676. Distance: 2.1277490673114685
Total norm for 4 adversaries is: 42.945721101612676. distance: 2.1277490673114685
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.3577, Accuracy: 8999/9900 (90.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4765/5305 (89.8209%), train_poison_data_count: 415
Global model norm: 42.944727659970816.
Norm before scaling: 42.94424585381754. Distance: 2.204398902912729
Total norm for 4 adversaries is: 42.94424585381754. distance: 2.204398902912729
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.2975, Accuracy: 9180/9900 (92.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4242/4717 (89.9300%), train_poison_data_count: 370
Global model norm: 42.944727659970816.
Norm before scaling: 42.94406535277532. Distance: 2.041862465429117
Total norm for 4 adversaries is: 42.94406535277532. distance: 2.041862465429117
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1764, Accuracy: 9461/9900 (95.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4500/5066 (88.8275%), train_poison_data_count: 400
Global model norm: 42.944727659970816.
Norm before scaling: 42.9485293330866. Distance: 2.2376268105827477
Total norm for 4 adversaries is: 42.9485293330866. distance: 2.2376268105827477
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1212, Accuracy: 9574/9900 (96.7071%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4175/4634 (90.0950%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4237/4634 (91.4329%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9011, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4003/4503 (88.8963%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4105/4503 (91.1614%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0059, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4377/4928 (88.8190%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4454/4928 (90.3815%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9389, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3361/3804 (88.3544%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3438/3804 (90.3785%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9991, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3224/3590 (89.8050%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3070/3590 (85.5153%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2380, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4103/4647 (88.2935%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4229/4647 (91.0049%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8336, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4010/4625 (86.7027%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4050/4625 (87.5676%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0808, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3864/4356 (88.7052%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0094, Accuracy: 3576/4356 (82.0937%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.4012, Accuracy: 4821/10000 (48.2100%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3412/3797 (89.8604%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3479/3797 (91.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9132, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4001/4456 (89.7890%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4068/4456 (91.2926%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9379, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3625/4025 (90.0621%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3747/4025 (93.0932%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9161, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3126/3472 (90.0346%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3183/3472 (91.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9896, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2930/3297 (88.8687%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3039/3297 (92.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7534, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3869/4416 (87.6132%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3923/4416 (88.8361%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8514, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3909/4356 (89.7383%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3826/4356 (87.8329%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1591, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3178/3638 (87.3557%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3302/3638 (90.7642%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8628, Accuracy: 5554/10000 (55.5400%)
time spent on training: 225.77692079544067
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.2505, Accuracy: 6768/10000 (67.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 9.3946, Accuracy: 67/9900 (0.6768%)
Done in 247.01004767417908 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4429/4885 (90.6653%), train_poison_data_count: 385
Global model norm: 42.97710146112695.
Norm before scaling: 42.97769083117063. Distance: 2.093503681326309
Total norm for 4 adversaries is: 42.97769083117063. distance: 2.093503681326309
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1876, Accuracy: 9422/9900 (95.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4760/5305 (89.7267%), train_poison_data_count: 415
Global model norm: 42.97710146112695.
Norm before scaling: 42.978517355785584. Distance: 2.2022338579954477
Total norm for 4 adversaries is: 42.978517355785584. distance: 2.2022338579954477
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2448, Accuracy: 9307/9900 (94.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4258/4717 (90.2692%), train_poison_data_count: 370
Global model norm: 42.97710146112695.
Norm before scaling: 42.98092867182127. Distance: 2.0768300087228697
Total norm for 4 adversaries is: 42.98092867182127. distance: 2.0768300087228697
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2092, Accuracy: 9373/9900 (94.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4525/5066 (89.3210%), train_poison_data_count: 400
Global model norm: 42.97710146112695.
Norm before scaling: 42.97987356019094. Distance: 2.2347710531855944
Total norm for 4 adversaries is: 42.97987356019094. distance: 2.2347710531855944
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1720, Accuracy: 9457/9900 (95.5253%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3617/4175 (86.6347%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3735/4175 (89.4611%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0462, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4441/4956 (89.6086%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4480/4956 (90.3955%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1792, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4412/5037 (87.5918%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4577/5037 (90.8676%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9330, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4259/4793 (88.8588%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4337/4793 (90.4861%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0758, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3412/3804 (89.6951%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3455/3804 (90.8254%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9174, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4909/5392 (91.0423%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4840/5392 (89.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9218, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4017/4465 (89.9664%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4081/4465 (91.3998%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9287, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4059/4596 (88.3159%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4183/4596 (91.0139%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0159, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5280/6124 (86.2182%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5401/6124 (88.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0112, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2874/3271 (87.8630%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0045, Accuracy: 2983/3271 (91.1954%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8657, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3218/3590 (89.6379%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3086/3590 (85.9610%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1067, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3943/4501 (87.6028%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4031/4501 (89.5579%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9325, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4668/5232 (89.2202%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4680/5232 (89.4495%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9830, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3214/3672 (87.5272%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3325/3672 (90.5501%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8007, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3780/4223 (89.5098%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3862/4223 (91.4516%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9400, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3834/4354 (88.0570%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0158, Accuracy: 3140/4354 (72.1176%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.5903, Accuracy: 4402/10000 (44.0200%)
time spent on training: 232.36368322372437
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.2573, Accuracy: 6814/10000 (68.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 9.8707, Accuracy: 35/9900 (0.3535%)
Done in 253.62529635429382 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4388/4885 (89.8260%), train_poison_data_count: 385
Global model norm: 43.01249052101392.
Norm before scaling: 43.01248626398357. Distance: 2.1436695806694757
Total norm for 4 adversaries is: 43.01248626398357. distance: 2.1436695806694757
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1792, Accuracy: 9464/9900 (95.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4715/5305 (88.8784%), train_poison_data_count: 415
Global model norm: 43.01249052101392.
Norm before scaling: 43.014228773199285. Distance: 2.2806527387960727
Total norm for 4 adversaries is: 43.014228773199285. distance: 2.2806527387960727
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1485, Accuracy: 9503/9900 (95.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4222/4717 (89.5060%), train_poison_data_count: 370
Global model norm: 43.01249052101392.
Norm before scaling: 43.01373213688566. Distance: 2.110346478584517
Total norm for 4 adversaries is: 43.01373213688566. distance: 2.110346478584517
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1792, Accuracy: 9432/9900 (95.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4569/5066 (90.1895%), train_poison_data_count: 400
Global model norm: 43.01249052101392.
Norm before scaling: 43.01288500399836. Distance: 2.1530042905149043
Total norm for 4 adversaries is: 43.01288500399836. distance: 2.1530042905149043
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1346, Accuracy: 9561/9900 (96.5758%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5122/5582 (91.7592%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5110/5582 (91.5442%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0371, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4063/4647 (87.4328%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4197/4647 (90.3163%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0610, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3985/4465 (89.2497%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4019/4465 (90.0112%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9835, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4451/5083 (87.5664%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4475/5083 (88.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1291, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3855/4416 (87.2962%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3986/4416 (90.2627%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9251, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4407/4956 (88.9225%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4492/4956 (90.6376%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0847, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4030/4362 (92.3888%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4063/4362 (93.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8844, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3898/4356 (89.4858%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3899/4356 (89.5087%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0278, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3378/3781 (89.3414%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3420/3781 (90.4523%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0280, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3227/3590 (89.8886%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3165/3590 (88.1616%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0517, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4193/4651 (90.1527%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4193/4651 (90.1527%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1385, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4140/4662 (88.8031%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4285/4662 (91.9133%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8766, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3112/3472 (89.6313%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3123/3472 (89.9482%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9311, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4886/5424 (90.0811%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5023/5424 (92.6069%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1405, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2909/3271 (88.9330%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2950/3271 (90.1865%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8365, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4416/5037 (87.6712%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4546/5037 (90.2521%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0895, Accuracy: 5304/10000 (53.0400%)
time spent on training: 231.2549798488617
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.2471, Accuracy: 6821/10000 (68.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 9.8376, Accuracy: 46/9900 (0.4646%)
Done in 252.60382866859436 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4416/4885 (90.3992%), train_poison_data_count: 385
Global model norm: 43.04439931628736.
Norm before scaling: 43.041377541431714. Distance: 2.0991974750401847
Total norm for 4 adversaries is: 43.041377541431714. distance: 2.0991974750401847
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1896, Accuracy: 9447/9900 (95.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4779/5305 (90.0848%), train_poison_data_count: 415
Global model norm: 43.04439931628736.
Norm before scaling: 43.04471551979044. Distance: 2.1893849562174372
Total norm for 4 adversaries is: 43.04471551979044. distance: 2.1893849562174372
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2254, Accuracy: 9331/9900 (94.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 43.04439931628736.
Norm before scaling: 43.0411733406405. Distance: 2.0625942093111616
Total norm for 4 adversaries is: 43.0411733406405. distance: 2.0625942093111616
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1043, Accuracy: 9626/9900 (97.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4545/5066 (89.7158%), train_poison_data_count: 400
Global model norm: 43.04439931628736.
Norm before scaling: 43.04443334726919. Distance: 2.1405898042555953
Total norm for 4 adversaries is: 43.04443334726919. distance: 2.1405898042555953
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2845, Accuracy: 9205/9900 (92.9798%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4392/4989 (88.0337%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4440/4989 (88.9958%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9991, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3636/4013 (90.6055%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3713/4013 (92.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8819, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4640/5195 (89.3167%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4673/5195 (89.9519%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1845, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3570/3969 (89.9471%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3673/3969 (92.5422%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8122, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3924/4356 (90.0826%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3961/4356 (90.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9000, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4013/4441 (90.3625%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4118/4441 (92.7269%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0535, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4019/4518 (88.9553%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4134/4518 (91.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1471, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3456/3911 (88.3661%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3353/3911 (85.7325%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0643, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4013/4362 (91.9991%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4011/4362 (91.9532%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8847, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3379/3804 (88.8275%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3479/3804 (91.4564%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9085, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3785/4223 (89.6282%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3906/4223 (92.4935%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9891, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4087/4634 (88.1959%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4165/4634 (89.8792%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0479, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3821/4354 (87.7584%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3819/4354 (87.7124%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.6008, Accuracy: 4795/10000 (47.9500%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4502/5244 (85.8505%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4564/5244 (87.0328%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1391, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4422/5037 (87.7904%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4583/5037 (90.9867%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0851, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3237/3704 (87.3920%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3366/3704 (90.8747%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8320, Accuracy: 5814/10000 (58.1400%)
time spent on training: 230.5219280719757
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.2459, Accuracy: 6847/10000 (68.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 9.7118, Accuracy: 49/9900 (0.4949%)
Done in 251.68598747253418 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4436/4885 (90.8086%), train_poison_data_count: 385
Global model norm: 43.07639074311037.
Norm before scaling: 43.07848771156695. Distance: 2.109188495444152
Total norm for 4 adversaries is: 43.07848771156695. distance: 2.109188495444152
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2108, Accuracy: 9411/9900 (95.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4769/5305 (89.8963%), train_poison_data_count: 415
Global model norm: 43.07639074311037.
Norm before scaling: 43.07591182653595. Distance: 2.239574864097964
Total norm for 4 adversaries is: 43.07591182653595. distance: 2.239574864097964
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0940, Accuracy: 9665/9900 (97.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4278/4717 (90.6932%), train_poison_data_count: 370
Global model norm: 43.07639074311037.
Norm before scaling: 43.07356817574584. Distance: 2.008024686889571
Total norm for 4 adversaries is: 43.07356817574584. distance: 2.008024686889571
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1903, Accuracy: 9413/9900 (95.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4539/5066 (89.5973%), train_poison_data_count: 400
Global model norm: 43.07639074311037.
Norm before scaling: 43.07909269633081. Distance: 2.1715174318896757
Total norm for 4 adversaries is: 43.07909269633081. distance: 2.1715174318896757
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1760, Accuracy: 9436/9900 (95.3131%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3848/4416 (87.1377%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3965/4416 (89.7871%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0311, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4597/5197 (88.4549%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4601/5197 (88.5318%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0399, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4399/4918 (89.4469%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4489/4918 (91.2769%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0419, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5693/6263 (90.8989%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5668/6263 (90.4998%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0757, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3243/3646 (88.9468%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3342/3646 (91.6621%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8455, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4136/4707 (87.8691%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4252/4707 (90.3335%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9605, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4516/5063 (89.1961%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4493/5063 (88.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2610, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3810/4295 (88.7078%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3761/4295 (87.5669%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0435, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4201/4793 (87.6487%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4393/4793 (91.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0101, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4099/4538 (90.3261%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4184/4538 (92.1992%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9383, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4477/5083 (88.0779%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4485/5083 (88.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2134, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3181/3638 (87.4382%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3328/3638 (91.4788%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.7786, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5311/6124 (86.7244%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5378/6124 (87.8184%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8928, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4125/4618 (89.3244%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4197/4618 (90.8835%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9226, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3552/3969 (89.4936%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3619/3969 (91.1817%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9595, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3574/4158 (85.9548%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3662/4158 (88.0712%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8831, Accuracy: 5578/10000 (55.7800%)
time spent on training: 234.59469151496887
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.2528, Accuracy: 6790/10000 (67.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 9.4767, Accuracy: 67/9900 (0.6768%)
Done in 255.79750108718872 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4416/4885 (90.3992%), train_poison_data_count: 385
Global model norm: 43.10676556301444.
Norm before scaling: 43.10701051416985. Distance: 2.083778435525086
Total norm for 4 adversaries is: 43.10701051416985. distance: 2.083778435525086
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2289, Accuracy: 9335/9900 (94.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4768/5305 (89.8775%), train_poison_data_count: 415
Global model norm: 43.10676556301444.
Norm before scaling: 43.10657299927921. Distance: 2.1748400969207076
Total norm for 4 adversaries is: 43.10657299927921. distance: 2.1748400969207076
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2174, Accuracy: 9365/9900 (94.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4281/4717 (90.7568%), train_poison_data_count: 370
Global model norm: 43.10676556301444.
Norm before scaling: 43.10805968227186. Distance: 2.051680536644187
Total norm for 4 adversaries is: 43.10805968227186. distance: 2.051680536644187
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1263, Accuracy: 9586/9900 (96.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4518/5066 (89.1828%), train_poison_data_count: 400
Global model norm: 43.10676556301444.
Norm before scaling: 43.10885255890387. Distance: 2.2404198673682547
Total norm for 4 adversaries is: 43.10885255890387. distance: 2.2404198673682547
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2207, Accuracy: 9334/9900 (94.2828%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4170/4716 (88.4224%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4179/4716 (88.6132%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1051, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3931/4481 (87.7260%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3896/4481 (86.9449%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1181, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3906/4361 (89.5666%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3944/4361 (90.4380%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0463, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4186/4793 (87.3357%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4354/4793 (90.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8428, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3894/4295 (90.6636%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3954/4295 (92.0605%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9883, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4519/5244 (86.1747%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4545/5244 (86.6705%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1570, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4479/4989 (89.7775%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4569/4989 (91.5815%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1185, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4596/5197 (88.4356%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4621/5197 (88.9167%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1113, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3935/4356 (90.3352%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4042/4356 (92.7916%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9875, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4121/4647 (88.6809%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4164/4647 (89.6062%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0158, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3587/4013 (89.3845%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3697/4013 (92.1256%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9414, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4106/4538 (90.4804%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4223/4538 (93.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8020, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4171/4707 (88.6127%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4234/4707 (89.9511%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9237, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5621/6263 (89.7493%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5685/6263 (90.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0812, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3858/4235 (91.0980%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3922/4235 (92.6092%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9665, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3443/3861 (89.1738%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3553/3861 (92.0228%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8777, Accuracy: 5677/10000 (56.7700%)
time spent on training: 232.85817790031433
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.2472, Accuracy: 6830/10000 (68.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 9.4954, Accuracy: 75/9900 (0.7576%)
Done in 254.09135246276855 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4423/4885 (90.5425%), train_poison_data_count: 385
Global model norm: 43.14555245085016.
Norm before scaling: 43.1449399100723. Distance: 2.0930790751428923
Total norm for 4 adversaries is: 43.1449399100723. distance: 2.0930790751428923
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1338, Accuracy: 9557/9900 (96.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4786/5305 (90.2168%), train_poison_data_count: 415
Global model norm: 43.14555245085016.
Norm before scaling: 43.14156582865807. Distance: 2.1886662235490015
Total norm for 4 adversaries is: 43.14156582865807. distance: 2.1886662235490015
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1952, Accuracy: 9438/9900 (95.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 43.14555245085016.
Norm before scaling: 43.14024300356049. Distance: 1.9934184740482872
Total norm for 4 adversaries is: 43.14024300356049. distance: 1.9934184740482872
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1598, Accuracy: 9477/9900 (95.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4552/5066 (89.8539%), train_poison_data_count: 400
Global model norm: 43.14555245085016.
Norm before scaling: 43.14499791084202. Distance: 2.1980420720149785
Total norm for 4 adversaries is: 43.14499791084202. distance: 2.1980420720149785
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2875, Accuracy: 9248/9900 (93.4141%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4509/5055 (89.1988%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4598/5055 (90.9594%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9598, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3372/3828 (88.0878%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3466/3828 (90.5434%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9881, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3871/4361 (88.7640%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3784/4361 (86.7691%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1146, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3600/4013 (89.7084%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3709/4013 (92.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8017, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4035/4518 (89.3094%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4119/4518 (91.1687%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1586, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4041/4558 (88.6573%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4083/4558 (89.5788%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0845, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3703/4126 (89.7479%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3800/4126 (92.0989%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8394, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4266/4679 (91.1733%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4199/4679 (89.7414%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0439, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3875/4235 (91.4994%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3762/4235 (88.8312%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0621, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4452/5037 (88.3859%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4564/5037 (90.6095%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0291, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3245/3672 (88.3715%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3311/3672 (90.1688%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9098, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4500/4928 (91.3149%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4570/4928 (92.7354%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9963, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3899/4356 (89.5087%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3862/4356 (88.6593%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9534, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3998/4456 (89.7217%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4100/4456 (92.0108%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9948, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4222/4793 (88.0868%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4322/4793 (90.1732%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1406, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4485/5025 (89.2537%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4570/5025 (90.9453%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2672, Accuracy: 5176/10000 (51.7600%)
time spent on training: 231.25386881828308
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.2782, Accuracy: 6802/10000 (68.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 9.6921, Accuracy: 72/9900 (0.7273%)
Done in 252.42723059654236 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 43.174110114508295.
Norm before scaling: 43.17237547212627. Distance: 2.0876509240694006
Total norm for 4 adversaries is: 43.17237547212627. distance: 2.0876509240694006
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1737, Accuracy: 9457/9900 (95.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4792/5305 (90.3299%), train_poison_data_count: 415
Global model norm: 43.174110114508295.
Norm before scaling: 43.17269639328991. Distance: 2.175570520575313
Total norm for 4 adversaries is: 43.17269639328991. distance: 2.175570520575313
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1985, Accuracy: 9442/9900 (95.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4235/4717 (89.7816%), train_poison_data_count: 370
Global model norm: 43.174110114508295.
Norm before scaling: 43.17234154199596. Distance: 2.0756365569498505
Total norm for 4 adversaries is: 43.17234154199596. distance: 2.0756365569498505
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2235, Accuracy: 9331/9900 (94.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4523/5066 (89.2815%), train_poison_data_count: 400
Global model norm: 43.174110114508295.
Norm before scaling: 43.17834393264319. Distance: 2.265430941985492
Total norm for 4 adversaries is: 43.17834393264319. distance: 2.265430941985492
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2776, Accuracy: 9198/9900 (92.9091%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3915/4346 (90.0828%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4056/4346 (93.3272%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8439, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3720/4184 (88.9101%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3810/4184 (91.0612%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9833, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3941/4356 (90.4729%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3676/4356 (84.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.4615, Accuracy: 4782/10000 (47.8200%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3157/3646 (86.5880%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3281/3646 (89.9890%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8677, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4477/5083 (88.0779%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4562/5083 (89.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3422, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3918/4356 (89.9449%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3646/4356 (83.7006%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3933, Accuracy: 4797/10000 (47.9700%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4036/4558 (88.5476%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4009/4558 (87.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1871, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3701/4175 (88.6467%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3745/4175 (89.7006%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9792, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3097/3472 (89.1993%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3205/3472 (92.3099%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9521, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3945/4501 (87.6472%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3980/4501 (88.4248%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9869, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4946/5424 (91.1873%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4941/5424 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0910, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3899/4481 (87.0118%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3866/4481 (86.2754%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2834, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4849/5455 (88.8909%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4914/5455 (90.0825%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1528, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4611/5232 (88.1307%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4689/5232 (89.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0503, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5582/6391 (87.3416%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5520/6391 (86.3715%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2465, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3432/3775 (90.9139%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3561/3775 (94.3311%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8802, Accuracy: 5757/10000 (57.5700%)
time spent on training: 232.6564130783081
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.2849, Accuracy: 6804/10000 (68.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 9.9316, Accuracy: 72/9900 (0.7273%)
Done in 254.18621063232422 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4428/4885 (90.6448%), train_poison_data_count: 385
Global model norm: 43.20682341764724.
Norm before scaling: 43.2048216778051. Distance: 2.082165225300735
Total norm for 4 adversaries is: 43.2048216778051. distance: 2.082165225300735
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1590, Accuracy: 9520/9900 (96.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4766/5305 (89.8398%), train_poison_data_count: 415
Global model norm: 43.20682341764724.
Norm before scaling: 43.20584869352904. Distance: 2.2373731012428477
Total norm for 4 adversaries is: 43.20584869352904. distance: 2.2373731012428477
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.2404, Accuracy: 9308/9900 (94.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4247/4717 (90.0360%), train_poison_data_count: 370
Global model norm: 43.20682341764724.
Norm before scaling: 43.205700364018085. Distance: 2.027660661157438
Total norm for 4 adversaries is: 43.205700364018085. distance: 2.027660661157438
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1778, Accuracy: 9442/9900 (95.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4557/5066 (89.9526%), train_poison_data_count: 400
Global model norm: 43.20682341764724.
Norm before scaling: 43.20450382067389. Distance: 2.1751850619455206
Total norm for 4 adversaries is: 43.20450382067389. distance: 2.1751850619455206
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.2056, Accuracy: 9395/9900 (94.8990%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3606/4025 (89.5901%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3730/4025 (92.6708%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8671, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3775/4223 (89.3914%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3848/4223 (91.1201%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9187, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3171/3638 (87.1633%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3305/3638 (90.8466%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9821, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4502/5063 (88.9196%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4429/5063 (87.4778%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0890, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4328/4874 (88.7977%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4241/4874 (87.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2802, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4313/4804 (89.7794%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4190/4804 (87.2190%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1750, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3618/4158 (87.0130%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3696/4158 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9055, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4058/4518 (89.8185%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4123/4518 (91.2572%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1546, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3937/4235 (92.9634%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3913/4235 (92.3967%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9641, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4357/4934 (88.3056%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4099/4934 (83.0766%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1639, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5495/6391 (85.9803%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5534/6391 (86.5905%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2449, Accuracy: 4988/10000 (49.8800%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3939/4295 (91.7113%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3809/4295 (88.6845%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0110, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3389/3756 (90.2290%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3448/3756 (91.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0948, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3871/4481 (86.3870%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3937/4481 (87.8599%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1899, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3689/4175 (88.3593%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3647/4175 (87.3533%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0521, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3244/3590 (90.3621%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3284/3590 (91.4763%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0294, Accuracy: 5462/10000 (54.6200%)
time spent on training: 231.64384150505066
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.2834, Accuracy: 6803/10000 (68.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 10.0501, Accuracy: 61/9900 (0.6162%)
Done in 252.79542565345764 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 43.241593971762306.
Norm before scaling: 43.24187485772255. Distance: 2.12334669535139
Total norm for 4 adversaries is: 43.24187485772255. distance: 2.12334669535139
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2951, Accuracy: 9185/9900 (92.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4770/5305 (89.9152%), train_poison_data_count: 415
Global model norm: 43.241593971762306.
Norm before scaling: 43.24095879577747. Distance: 2.215784051563979
Total norm for 4 adversaries is: 43.24095879577747. distance: 2.215784051563979
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1024, Accuracy: 9633/9900 (97.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 43.241593971762306.
Norm before scaling: 43.24011752611081. Distance: 2.0727589098327415
Total norm for 4 adversaries is: 43.24011752611081. distance: 2.0727589098327415
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2095, Accuracy: 9353/9900 (94.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4521/5066 (89.2420%), train_poison_data_count: 400
Global model norm: 43.241593971762306.
Norm before scaling: 43.24474712952863. Distance: 2.251161805182829
Total norm for 4 adversaries is: 43.24474712952863. distance: 2.251161805182829
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1882, Accuracy: 9434/9900 (95.2929%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3451/3828 (90.1515%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3526/3828 (92.1108%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8377, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3537/3911 (90.4372%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3536/3911 (90.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9513, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3976/4362 (91.1508%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4091/4362 (93.7873%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8604, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4558/5197 (87.7044%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4669/5197 (89.8403%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0557, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4227/4679 (90.3398%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4272/4679 (91.3016%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9126, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4240/4793 (88.4623%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4326/4793 (90.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0160, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4547/5116 (88.8780%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4535/5116 (88.6435%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0505, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4032/4625 (87.1784%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4019/4625 (86.8973%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1253, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4122/4618 (89.2594%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4203/4618 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1101, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2910/3271 (88.9636%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2918/3271 (89.2082%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0882, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3694/4175 (88.4790%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3710/4175 (88.8623%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1062, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3192/3616 (88.2743%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3321/3616 (91.8418%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8452, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3881/4481 (86.6101%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3895/4481 (86.9226%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1547, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3935/4368 (90.0870%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3996/4368 (91.4835%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0066, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5106/5740 (88.9547%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5175/5740 (90.1568%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1995, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4099/4647 (88.2074%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4175/4647 (89.8429%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1034, Accuracy: 5325/10000 (53.2500%)
time spent on training: 231.11493015289307
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.3139, Accuracy: 6778/10000 (67.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 9.9160, Accuracy: 61/9900 (0.6162%)
Done in 252.40527081489563 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4433/4885 (90.7472%), train_poison_data_count: 385
Global model norm: 43.278412587498515.
Norm before scaling: 43.27340717524664. Distance: 2.1151301110830754
Total norm for 4 adversaries is: 43.27340717524664. distance: 2.1151301110830754
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2557, Accuracy: 9265/9900 (93.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 43.278412587498515.
Norm before scaling: 43.27593322488118. Distance: 2.1473020570276065
Total norm for 4 adversaries is: 43.27593322488118. distance: 2.1473020570276065
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2345, Accuracy: 9366/9900 (94.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4278/4717 (90.6932%), train_poison_data_count: 370
Global model norm: 43.278412587498515.
Norm before scaling: 43.27376119778734. Distance: 2.0328769916974325
Total norm for 4 adversaries is: 43.27376119778734. distance: 2.0328769916974325
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1293, Accuracy: 9546/9900 (96.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4528/5066 (89.3802%), train_poison_data_count: 400
Global model norm: 43.278412587498515.
Norm before scaling: 43.282770167346904. Distance: 2.2523755143089477
Total norm for 4 adversaries is: 43.282770167346904. distance: 2.2523755143089477
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1430, Accuracy: 9543/9900 (96.3939%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4914/5591 (87.8913%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4991/5591 (89.2685%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9867, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4544/4956 (91.6868%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4476/4956 (90.3148%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1226, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4028/4511 (89.2928%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4074/4511 (90.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9022, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3625/4013 (90.3314%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3687/4013 (91.8764%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8037, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3217/3590 (89.6100%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3271/3590 (91.1142%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0571, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4276/4793 (89.2134%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4385/4793 (91.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0024, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3390/3804 (89.1167%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3426/3804 (90.0631%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9265, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3434/3837 (89.4970%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3523/3837 (91.8165%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8339, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3933/4361 (90.1857%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3856/4361 (88.4201%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0602, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4512/5063 (89.1171%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4336/5063 (85.6409%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1868, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3925/4368 (89.8581%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3989/4368 (91.3233%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0974, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4272/4679 (91.3016%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4267/4679 (91.1947%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1836, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4658/5265 (88.4710%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4645/5265 (88.2241%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8999, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4192/4767 (87.9379%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4248/4767 (89.1126%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2518, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5073/5902 (85.9539%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5128/5902 (86.8858%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2205, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3763/4223 (89.1073%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3892/4223 (92.1620%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8654, Accuracy: 5662/10000 (56.6200%)
time spent on training: 232.36631083488464
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.3000, Accuracy: 6764/10000 (67.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 9.8410, Accuracy: 72/9900 (0.7273%)
Done in 253.45322394371033 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4405/4885 (90.1740%), train_poison_data_count: 385
Global model norm: 43.30856115973564.
Norm before scaling: 43.30488411578133. Distance: 2.11205409834674
Total norm for 4 adversaries is: 43.30488411578133. distance: 2.11205409834674
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1508, Accuracy: 9495/9900 (95.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 43.30856115973564.
Norm before scaling: 43.30448101723279. Distance: 2.1622126967253075
Total norm for 4 adversaries is: 43.30448101723279. distance: 2.1622126967253075
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2729, Accuracy: 9232/9900 (93.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 43.30856115973564.
Norm before scaling: 43.30755067320825. Distance: 2.08054388858165
Total norm for 4 adversaries is: 43.30755067320825. distance: 2.08054388858165
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.3026, Accuracy: 9195/9900 (92.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4542/5066 (89.6565%), train_poison_data_count: 400
Global model norm: 43.30856115973564.
Norm before scaling: 43.30404267853854. Distance: 2.195614614095646
Total norm for 4 adversaries is: 43.30404267853854. distance: 2.195614614095646
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1453, Accuracy: 9520/9900 (96.1616%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3400/3797 (89.5444%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3449/3797 (90.8349%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9989, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3358/3861 (86.9723%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3446/3861 (89.2515%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9929, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4170/4707 (88.5915%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4294/4707 (91.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9018, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4048/4518 (89.5972%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4153/4518 (91.9212%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0212, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3643/4013 (90.7800%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3725/4013 (92.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.7914, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4574/5167 (88.5233%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4694/5167 (90.8458%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0918, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3539/3969 (89.1660%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3647/3969 (91.8871%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8884, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4040/4441 (90.9705%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4054/4441 (91.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0255, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4109/4558 (90.1492%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4182/4558 (91.7508%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0988, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4013/4465 (89.8768%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4115/4465 (92.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8908, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3223/3638 (88.5926%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3338/3638 (91.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8238, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4108/4538 (90.5245%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4205/4538 (92.6620%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8203, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5234/5740 (91.1847%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5234/5740 (91.1847%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1354, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3481/3837 (90.7219%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3581/3837 (93.3281%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8333, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4013/4361 (92.0202%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4041/4361 (92.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8709, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4244/4793 (88.5458%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4378/4793 (91.3415%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9978, Accuracy: 5504/10000 (55.0400%)
time spent on training: 229.56996512413025
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.3213, Accuracy: 6733/10000 (67.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 9.5463, Accuracy: 113/9900 (1.1414%)
Done in 250.75260400772095 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 43.33625650572148.
Norm before scaling: 43.333355086883564. Distance: 2.1185297353574026
Total norm for 4 adversaries is: 43.333355086883564. distance: 2.1185297353574026
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1236, Accuracy: 9596/9900 (96.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4756/5305 (89.6513%), train_poison_data_count: 415
Global model norm: 43.33625650572148.
Norm before scaling: 43.335179059750345. Distance: 2.2134181687554233
Total norm for 4 adversaries is: 43.335179059750345. distance: 2.2134181687554233
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1348, Accuracy: 9560/9900 (96.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4226/4717 (89.5908%), train_poison_data_count: 370
Global model norm: 43.33625650572148.
Norm before scaling: 43.335891726359456. Distance: 2.0779908789470323
Total norm for 4 adversaries is: 43.335891726359456. distance: 2.0779908789470323
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1448, Accuracy: 9551/9900 (96.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 43.33625650572148.
Norm before scaling: 43.33418327867375. Distance: 2.1868689580519365
Total norm for 4 adversaries is: 43.33418327867375. distance: 2.1868689580519365
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2021, Accuracy: 9397/9900 (94.9192%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4192/4767 (87.9379%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4247/4767 (89.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0862, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4047/4441 (91.1281%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4098/4441 (92.2765%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1665, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3884/4356 (89.1644%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3896/4356 (89.4399%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1808, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5575/6391 (87.2320%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5550/6391 (86.8409%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1371, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3751/4184 (89.6511%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3823/4184 (91.3719%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8851, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3905/4346 (89.8527%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4013/4346 (92.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8257, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4471/5037 (88.7632%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4600/5037 (91.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0791, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4112/4634 (88.7354%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4271/4634 (92.1666%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9517, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4370/4934 (88.5691%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4290/4934 (86.9477%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1681, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4906/5424 (90.4499%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4963/5424 (91.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1947, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3391/3781 (89.6853%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3460/3781 (91.5102%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9638, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3443/3861 (89.1738%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3515/3861 (91.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9146, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4544/5055 (89.8912%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4585/5055 (90.7023%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9061, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4026/4433 (90.8189%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4039/4433 (91.1121%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8471, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4599/5167 (89.0072%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4704/5167 (91.0393%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1061, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3271/3590 (91.1142%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3158/3590 (87.9666%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1339, Accuracy: 5302/10000 (53.0200%)
time spent on training: 233.6947090625763
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.3074, Accuracy: 6783/10000 (67.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 9.8690, Accuracy: 86/9900 (0.8687%)
Done in 254.97277164459229 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 43.36737679543446.
Norm before scaling: 43.36862513942972. Distance: 2.0920938802773748
Total norm for 4 adversaries is: 43.36862513942972. distance: 2.0920938802773748
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2352, Accuracy: 9281/9900 (93.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 43.36737679543446.
Norm before scaling: 43.366301530087135. Distance: 2.202750316169152
Total norm for 4 adversaries is: 43.366301530087135. distance: 2.202750316169152
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1562, Accuracy: 9518/9900 (96.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4246/4717 (90.0148%), train_poison_data_count: 370
Global model norm: 43.36737679543446.
Norm before scaling: 43.360575715356774. Distance: 2.0319777138832054
Total norm for 4 adversaries is: 43.360575715356774. distance: 2.0319777138832054
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1426, Accuracy: 9539/9900 (96.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4579/5066 (90.3869%), train_poison_data_count: 400
Global model norm: 43.36737679543446.
Norm before scaling: 43.36499541275702. Distance: 2.134741166123892
Total norm for 4 adversaries is: 43.36499541275702. distance: 2.134741166123892
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2896, Accuracy: 9167/9900 (92.5960%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3946/4368 (90.3388%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4014/4368 (91.8956%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9034, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3451/3828 (90.1515%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3530/3828 (92.2153%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8406, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3946/4356 (90.5877%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3828/4356 (87.8788%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0442, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3391/3861 (87.8270%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3414/3861 (88.4227%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9200, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3130/3472 (90.1498%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3202/3472 (92.2235%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9412, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4100/4538 (90.3482%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4198/4538 (92.5077%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8259, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4982/5392 (92.3961%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4862/5392 (90.1706%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9771, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3859/4295 (89.8487%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3909/4295 (91.0128%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1956, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3955/4235 (93.3884%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3939/4235 (93.0106%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9971, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4020/4456 (90.2154%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4091/4456 (91.8088%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9340, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4691/5265 (89.0978%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4728/5265 (89.8006%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9991, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4065/4441 (91.5334%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4127/4441 (92.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9917, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3645/4013 (90.8298%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3739/4013 (93.1722%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7996, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4022/4465 (90.0784%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4154/4465 (93.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7601, Accuracy: 5929/10000 (59.2900%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5757/6263 (91.9208%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5777/6263 (92.2401%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1636, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4469/4986 (89.6310%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4530/4986 (90.8544%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8007, Accuracy: 5799/10000 (57.9900%)
time spent on training: 231.13831329345703
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.3145, Accuracy: 6762/10000 (67.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 9.8576, Accuracy: 89/9900 (0.8990%)
Done in 252.25319600105286 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 43.40211997765417.
Norm before scaling: 43.3994845452001. Distance: 2.1161197912059806
Total norm for 4 adversaries is: 43.3994845452001. distance: 2.1161197912059806
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2105, Accuracy: 9386/9900 (94.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4788/5305 (90.2545%), train_poison_data_count: 415
Global model norm: 43.40211997765417.
Norm before scaling: 43.40065461820896. Distance: 2.1805705807675064
Total norm for 4 adversaries is: 43.40065461820896. distance: 2.1805705807675064
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2267, Accuracy: 9380/9900 (94.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 43.40211997765417.
Norm before scaling: 43.39904716605971. Distance: 2.0865837553369118
Total norm for 4 adversaries is: 43.39904716605971. distance: 2.0865837553369118
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1190, Accuracy: 9599/9900 (96.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4542/5066 (89.6565%), train_poison_data_count: 400
Global model norm: 43.40211997765417.
Norm before scaling: 43.401291675946986. Distance: 2.1912816738139624
Total norm for 4 adversaries is: 43.401291675946986. distance: 2.1912816738139624
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0796, Accuracy: 9711/9900 (98.0909%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3633/4158 (87.3737%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3635/4158 (87.4218%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1796, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4601/5167 (89.0459%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4653/5167 (90.0523%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1353, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3404/3828 (88.9237%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3524/3828 (92.0585%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9153, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4176/4663 (89.5561%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4294/4663 (92.0866%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0926, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4011/4433 (90.4805%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4052/4433 (91.4054%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9060, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3747/4184 (89.5554%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3732/4184 (89.1969%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0561, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4215/4716 (89.3766%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4188/4716 (88.8041%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9691, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3807/4223 (90.1492%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3871/4223 (91.6647%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9550, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4262/4679 (91.0878%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4149/4679 (88.6728%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1034, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3301/3704 (89.1199%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3398/3704 (91.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0190, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3429/3837 (89.3667%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3554/3837 (92.6244%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9991, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3370/3861 (87.2831%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3417/3861 (88.5004%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8649, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4864/5424 (89.6755%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5035/5424 (92.8282%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1237, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4093/4576 (89.4449%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4172/4576 (91.1713%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8945, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3646/4025 (90.5839%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3751/4025 (93.1925%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8556, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3423/3775 (90.6755%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3535/3775 (93.6424%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9147, Accuracy: 5638/10000 (56.3800%)
time spent on training: 229.07073140144348
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.3037, Accuracy: 6791/10000 (67.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 9.6724, Accuracy: 74/9900 (0.7475%)
Done in 250.33444166183472 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4399/4885 (90.0512%), train_poison_data_count: 385
Global model norm: 43.43152920969037.
Norm before scaling: 43.43231056006504. Distance: 2.1822774396506963
Total norm for 4 adversaries is: 43.43231056006504. distance: 2.1822774396506963
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1892, Accuracy: 9443/9900 (95.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 43.43152920969037.
Norm before scaling: 43.4321489509787. Distance: 2.2282993970677305
Total norm for 4 adversaries is: 43.4321489509787. distance: 2.2282993970677305
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0190, Accuracy: 9850/9900 (99.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 43.43152920969037.
Norm before scaling: 43.42959825836307. Distance: 2.064318115670239
Total norm for 4 adversaries is: 43.42959825836307. distance: 2.064318115670239
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1934, Accuracy: 9423/9900 (95.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4561/5066 (90.0316%), train_poison_data_count: 400
Global model norm: 43.43152920969037.
Norm before scaling: 43.430272836269545. Distance: 2.16574086681608
Total norm for 4 adversaries is: 43.430272836269545. distance: 2.16574086681608
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2488, Accuracy: 9282/9900 (93.7576%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4098/4576 (89.5542%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4248/4576 (92.8322%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8500, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3226/3672 (87.8540%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3347/3672 (91.1492%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9929, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4141/4618 (89.6709%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4134/4618 (89.5193%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0611, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4150/4538 (91.4500%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4191/4538 (92.3535%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8548, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4489/5025 (89.3333%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4549/5025 (90.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9960, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3229/3590 (89.9443%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3336/3590 (92.9248%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9458, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4199/4707 (89.2076%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4285/4707 (91.0346%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9226, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4386/4918 (89.1826%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4493/4918 (91.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1796, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3872/4336 (89.2989%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3955/4336 (91.2131%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0368, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5144/5902 (87.1569%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5153/5902 (87.3094%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9620, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4088/4441 (92.0513%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4144/4441 (93.3123%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9390, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4680/5232 (89.4495%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4741/5232 (90.6154%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9771, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4246/4804 (88.3847%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0098, Accuracy: 3950/4804 (82.2231%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3938, Accuracy: 4924/10000 (49.2400%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3590/3969 (90.4510%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3674/3969 (92.5674%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0080, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4998/5392 (92.6929%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4935/5392 (91.5245%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9471, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3415/3828 (89.2111%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3508/3828 (91.6405%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8772, Accuracy: 5608/10000 (56.0800%)
time spent on training: 233.73629021644592
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.3403, Accuracy: 6704/10000 (67.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 9.7510, Accuracy: 61/9900 (0.6162%)
Done in 255.0392246246338 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 43.46349969415788.
Norm before scaling: 43.46086657935073. Distance: 2.1290507136334598
Total norm for 4 adversaries is: 43.46086657935073. distance: 2.1290507136334598
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1133, Accuracy: 9596/9900 (96.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4782/5305 (90.1414%), train_poison_data_count: 415
Global model norm: 43.46349969415788.
Norm before scaling: 43.46222598867464. Distance: 2.2130041808766734
Total norm for 4 adversaries is: 43.46222598867464. distance: 2.2130041808766734
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.3632, Accuracy: 9048/9900 (91.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4280/4717 (90.7356%), train_poison_data_count: 370
Global model norm: 43.46349969415788.
Norm before scaling: 43.45576841564017. Distance: 1.9994952637830246
Total norm for 4 adversaries is: 43.45576841564017. distance: 1.9994952637830246
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1610, Accuracy: 9492/9900 (95.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4541/5066 (89.6368%), train_poison_data_count: 400
Global model norm: 43.46349969415788.
Norm before scaling: 43.46129771893682. Distance: 2.222556274525488
Total norm for 4 adversaries is: 43.46129771893682. distance: 2.222556274525488
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1264, Accuracy: 9569/9900 (96.6566%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4633/5232 (88.5512%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4665/5232 (89.1628%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9774, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4479/4956 (90.3753%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4457/4956 (89.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0746, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4473/5063 (88.3468%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4507/5063 (89.0184%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9647, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3662/4025 (90.9814%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3757/4025 (93.3416%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7761, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4050/4441 (91.1957%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4030/4441 (90.7453%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0977, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4057/4625 (87.7189%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4063/4625 (87.8486%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2427, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4935/5591 (88.2669%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4923/5591 (88.0522%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1360, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5102/5582 (91.4009%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5062/5582 (90.6843%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0864, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5122/5902 (86.7841%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5011/5902 (84.9034%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1569, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4117/4538 (90.7228%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4205/4538 (92.6620%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9240, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4510/5025 (89.7512%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4586/5025 (91.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9874, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3811/4223 (90.2439%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3917/4223 (92.7540%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8250, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4004/4361 (91.8138%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3868/4361 (88.6953%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1997, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3878/4354 (89.0675%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3619/4354 (83.1190%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3747, Accuracy: 4792/10000 (47.9200%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3258/3672 (88.7255%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3350/3672 (91.2309%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9863, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3908/4356 (89.7153%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3795/4356 (87.1212%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2632, Accuracy: 5058/10000 (50.5800%)
time spent on training: 235.79403495788574
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.3257, Accuracy: 6734/10000 (67.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 10.1118, Accuracy: 51/9900 (0.5152%)
Done in 257.2580122947693 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4432/4885 (90.7267%), train_poison_data_count: 385
Global model norm: 43.500897979237166.
Norm before scaling: 43.49870070347648. Distance: 2.1252391904962815
Total norm for 4 adversaries is: 43.49870070347648. distance: 2.1252391904962815
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1717, Accuracy: 9452/9900 (95.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4760/5305 (89.7267%), train_poison_data_count: 415
Global model norm: 43.500897979237166.
Norm before scaling: 43.49764973221614. Distance: 2.2076268295540564
Total norm for 4 adversaries is: 43.49764973221614. distance: 2.2076268295540564
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2698, Accuracy: 9239/9900 (93.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 43.500897979237166.
Norm before scaling: 43.495387742642464. Distance: 2.0144106733410547
Total norm for 4 adversaries is: 43.495387742642464. distance: 2.0144106733410547
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1579, Accuracy: 9531/9900 (96.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4546/5066 (89.7355%), train_poison_data_count: 400
Global model norm: 43.500897979237166.
Norm before scaling: 43.50376998525171. Distance: 2.232174943965806
Total norm for 4 adversaries is: 43.50376998525171. distance: 2.232174943965806
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1770, Accuracy: 9433/9900 (95.2828%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3426/3828 (89.4984%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3535/3828 (92.3459%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9091, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3933/4235 (92.8689%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3933/4235 (92.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8891, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3291/3704 (88.8499%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3349/3704 (90.4158%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8685, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3615/4046 (89.3475%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3641/4046 (89.9901%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9939, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4484/4928 (90.9903%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4556/4928 (92.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.7817, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5162/5740 (89.9303%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5200/5740 (90.5923%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0966, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4434/5083 (87.2319%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4456/5083 (87.6648%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1236, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4133/4576 (90.3191%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4235/4576 (92.5481%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8956, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4179/4647 (89.9290%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4238/4647 (91.1986%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8887, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4945/5424 (91.1689%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4987/5424 (91.9432%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1627, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4045/4503 (89.8290%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4062/4503 (90.2065%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9899, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5586/6391 (87.4042%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5584/6391 (87.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1591, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3970/4511 (88.0071%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4062/4511 (90.0466%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9842, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4049/4456 (90.8662%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4089/4456 (91.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9985, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4292/4804 (89.3422%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4222/4804 (87.8851%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2027, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3343/3804 (87.8812%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3507/3804 (92.1924%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9799, Accuracy: 5583/10000 (55.8300%)
time spent on training: 234.43979692459106
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.3352, Accuracy: 6704/10000 (67.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 9.8625, Accuracy: 74/9900 (0.7475%)
Done in 255.6657907962799 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4416/4885 (90.3992%), train_poison_data_count: 385
Global model norm: 43.53016476123913.
Norm before scaling: 43.5262259865568. Distance: 2.124057897529369
Total norm for 4 adversaries is: 43.5262259865568. distance: 2.124057897529369
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2403, Accuracy: 9327/9900 (94.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 43.53016476123913.
Norm before scaling: 43.53186691953378. Distance: 2.2207609922305998
Total norm for 4 adversaries is: 43.53186691953378. distance: 2.2207609922305998
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2049, Accuracy: 9382/9900 (94.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4261/4717 (90.3328%), train_poison_data_count: 370
Global model norm: 43.53016476123913.
Norm before scaling: 43.52475078233145. Distance: 2.0289907949736112
Total norm for 4 adversaries is: 43.52475078233145. distance: 2.0289907949736112
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1569, Accuracy: 9488/9900 (95.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4576/5066 (90.3277%), train_poison_data_count: 400
Global model norm: 43.53016476123913.
Norm before scaling: 43.5290822997611. Distance: 2.1685203056836038
Total norm for 4 adversaries is: 43.5290822997611. distance: 2.1685203056836038
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0716, Accuracy: 9727/9900 (98.2525%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4436/4928 (90.0162%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4517/4928 (91.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9522, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4431/5037 (87.9690%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4598/5037 (91.2845%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1502, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5063/5392 (93.8984%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4960/5392 (91.9881%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9642, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3974/4501 (88.2915%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4030/4501 (89.5357%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0970, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3377/3804 (88.7750%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3534/3804 (92.9022%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8841, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3450/3837 (89.9140%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3577/3837 (93.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8895, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4471/5063 (88.3073%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4472/5063 (88.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1159, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3944/4481 (88.0161%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3905/4481 (87.1457%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1445, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4075/4518 (90.1948%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4155/4518 (91.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9148, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3171/3638 (87.1633%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3293/3638 (90.5168%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9256, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4174/4663 (89.5132%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4292/4663 (92.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0515, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4035/4625 (87.2432%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4008/4625 (86.6595%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0544, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4619/5197 (88.8782%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4707/5197 (90.5715%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0758, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4530/5083 (89.1206%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4462/5083 (87.7828%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9966, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3401/3828 (88.8454%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3520/3828 (91.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8280, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3303/3704 (89.1739%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3418/3704 (92.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8297, Accuracy: 5810/10000 (58.1000%)
time spent on training: 233.01780533790588
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.3326, Accuracy: 6727/10000 (67.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 10.1088, Accuracy: 38/9900 (0.3838%)
Done in 254.23573637008667 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4416/4885 (90.3992%), train_poison_data_count: 385
Global model norm: 43.56249019234107.
Norm before scaling: 43.56114932446973. Distance: 2.174437294440756
Total norm for 4 adversaries is: 43.56114932446973. distance: 2.174437294440756
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0358, Accuracy: 9797/9900 (98.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 43.56249019234107.
Norm before scaling: 43.560193738270094. Distance: 2.2323414545267015
Total norm for 4 adversaries is: 43.560193738270094. distance: 2.2323414545267015
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1152, Accuracy: 9616/9900 (97.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 43.56249019234107.
Norm before scaling: 43.55583308471008. Distance: 2.05256897525841
Total norm for 4 adversaries is: 43.55583308471008. distance: 2.05256897525841
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0654, Accuracy: 9726/9900 (98.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4570/5066 (90.2092%), train_poison_data_count: 400
Global model norm: 43.56249019234107.
Norm before scaling: 43.56053001732905. Distance: 2.1830788757711286
Total norm for 4 adversaries is: 43.56053001732905. distance: 2.1830788757711286
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2590, Accuracy: 9287/9900 (93.8081%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3471/3861 (89.8990%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3541/3861 (91.7120%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8618, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3776/4184 (90.2486%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3833/4184 (91.6109%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8381, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4416/5037 (87.6712%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4491/5037 (89.1602%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9703, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4770/5197 (91.7837%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4719/5197 (90.8024%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1783, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4485/5025 (89.2537%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4594/5025 (91.4229%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0113, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4514/5116 (88.2330%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4543/5116 (88.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0249, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3888/4481 (86.7663%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3882/4481 (86.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2393, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4126/4576 (90.1661%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4170/4576 (91.1276%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9787, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4651/5232 (88.8953%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4734/5232 (90.4817%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0298, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3848/4354 (88.3785%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3767/4354 (86.5181%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2645, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2903/3271 (88.7496%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0062, Accuracy: 2886/3271 (88.2299%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2396, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4846/5455 (88.8359%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4861/5455 (89.1109%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9985, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3680/4126 (89.1905%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3784/4126 (91.7111%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9591, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3428/3797 (90.2818%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3453/3797 (90.9402%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9053, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3289/3704 (88.7959%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3392/3704 (91.5767%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8886, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4345/4934 (88.0624%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4072/4934 (82.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1639, Accuracy: 5107/10000 (51.0700%)
time spent on training: 229.24709343910217
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.3219, Accuracy: 6756/10000 (67.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 10.3679, Accuracy: 38/9900 (0.3838%)
Done in 250.60398960113525 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4413/4885 (90.3378%), train_poison_data_count: 385
Global model norm: 43.59903501790134.
Norm before scaling: 43.598109661034904. Distance: 2.14214310102689
Total norm for 4 adversaries is: 43.598109661034904. distance: 2.14214310102689
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1995, Accuracy: 9419/9900 (95.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4785/5305 (90.1979%), train_poison_data_count: 415
Global model norm: 43.59903501790134.
Norm before scaling: 43.59507586469414. Distance: 2.2186188994883715
Total norm for 4 adversaries is: 43.59507586469414. distance: 2.2186188994883715
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0780, Accuracy: 9675/9900 (97.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 43.59903501790134.
Norm before scaling: 43.59531807215656. Distance: 2.054505894979049
Total norm for 4 adversaries is: 43.59531807215656. distance: 2.054505894979049
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2718, Accuracy: 9224/9900 (93.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4563/5066 (90.0711%), train_poison_data_count: 400
Global model norm: 43.59903501790134.
Norm before scaling: 43.59861503991196. Distance: 2.1818280391398193
Total norm for 4 adversaries is: 43.59861503991196. distance: 2.1818280391398193
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1029, Accuracy: 9638/9900 (97.3535%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4163/4618 (90.1472%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4174/4618 (90.3854%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1767, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4058/4625 (87.7405%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4070/4625 (88.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0835, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5233/5740 (91.1672%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5253/5740 (91.5157%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0256, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3898/4416 (88.2699%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3922/4416 (88.8134%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9009, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3684/4126 (89.2874%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3811/4126 (92.3655%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9414, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3237/3616 (89.5188%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3317/3616 (91.7312%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8672, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3718/4158 (89.4180%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3756/4158 (90.3319%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9353, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3941/4346 (90.6811%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4063/4346 (93.4883%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8115, Accuracy: 5885/10000 (58.8500%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4435/4874 (90.9930%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4388/4874 (90.0287%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2608, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4686/5265 (89.0028%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4627/5265 (87.8822%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1416, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3661/4025 (90.9565%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3706/4025 (92.0745%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8956, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4158/4651 (89.4001%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4260/4651 (91.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8784, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3406/3837 (88.7673%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3553/3837 (92.5984%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8931, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3259/3638 (89.5822%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3317/3638 (91.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9020, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3125/3472 (90.0058%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3169/3472 (91.2730%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0337, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4088/4456 (91.7415%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4139/4456 (92.8860%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9128, Accuracy: 5730/10000 (57.3000%)
time spent on training: 229.26673769950867
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.3203, Accuracy: 6741/10000 (67.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 10.3863, Accuracy: 34/9900 (0.3434%)
Done in 250.40898036956787 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 43.633000643059006.
Norm before scaling: 43.62863607474095. Distance: 2.105251662009625
Total norm for 4 adversaries is: 43.62863607474095. distance: 2.105251662009625
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.3067, Accuracy: 9139/9900 (92.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4768/5305 (89.8775%), train_poison_data_count: 415
Global model norm: 43.633000643059006.
Norm before scaling: 43.63287195049665. Distance: 2.232827350842024
Total norm for 4 adversaries is: 43.63287195049665. distance: 2.232827350842024
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1818, Accuracy: 9429/9900 (95.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 43.633000643059006.
Norm before scaling: 43.63160458824901. Distance: 2.075571312444063
Total norm for 4 adversaries is: 43.63160458824901. distance: 2.075571312444063
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1298, Accuracy: 9560/9900 (96.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4549/5066 (89.7947%), train_poison_data_count: 400
Global model norm: 43.633000643059006.
Norm before scaling: 43.63513660439686. Distance: 2.229725301271082
Total norm for 4 adversaries is: 43.63513660439686. distance: 2.229725301271082
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1575, Accuracy: 9507/9900 (96.0303%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4932/5424 (90.9292%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5004/5424 (92.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1386, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4503/4986 (90.3129%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4537/4986 (90.9948%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8452, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4550/5167 (88.0588%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4637/5167 (89.7426%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1297, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4213/4716 (89.3342%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4239/4716 (89.8855%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9583, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3876/4368 (88.7363%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3864/4368 (88.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1387, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3950/4356 (90.6795%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3852/4356 (88.4298%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1803, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4238/4804 (88.2182%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4140/4804 (86.1782%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2148, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3913/4481 (87.3243%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3913/4481 (87.3243%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0892, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3638/4025 (90.3851%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3741/4025 (92.9441%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9608, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4480/5017 (89.2964%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4492/5017 (89.5356%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9894, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3186/3616 (88.1084%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3319/3616 (91.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8217, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3682/4184 (88.0019%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3804/4184 (90.9178%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8652, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4632/5195 (89.1627%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4576/5195 (88.0847%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2031, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4005/4361 (91.8367%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3834/4361 (87.9156%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0080, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3404/3756 (90.6283%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3504/3756 (93.2907%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0076, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5066/5591 (90.6099%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5016/5591 (89.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0415, Accuracy: 5474/10000 (54.7400%)
time spent on training: 234.05453753471375
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.3120, Accuracy: 6744/10000 (67.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 10.2734, Accuracy: 44/9900 (0.4444%)
Done in 255.16788458824158 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4399/4885 (90.0512%), train_poison_data_count: 385
Global model norm: 43.66325524280614.
Norm before scaling: 43.66147433172994. Distance: 2.1127767753994355
Total norm for 4 adversaries is: 43.66147433172994. distance: 2.1127767753994355
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1544, Accuracy: 9495/9900 (95.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 43.66325524280614.
Norm before scaling: 43.65948924319388. Distance: 2.2292369106550574
Total norm for 4 adversaries is: 43.65948924319388. distance: 2.2292369106550574
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1011, Accuracy: 9637/9900 (97.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4290/4717 (90.9476%), train_poison_data_count: 370
Global model norm: 43.66325524280614.
Norm before scaling: 43.65514689685441. Distance: 1.970638822294735
Total norm for 4 adversaries is: 43.65514689685441. distance: 1.970638822294735
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1876, Accuracy: 9436/9900 (95.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4553/5066 (89.8737%), train_poison_data_count: 400
Global model norm: 43.66325524280614.
Norm before scaling: 43.66415825159478. Distance: 2.2052186797819346
Total norm for 4 adversaries is: 43.66415825159478. distance: 2.2052186797819346
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1609, Accuracy: 9495/9900 (95.9091%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3708/4175 (88.8144%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3752/4175 (89.8683%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9016, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4843/5455 (88.7809%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4911/5455 (90.0275%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9486, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3282/3704 (88.6069%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3374/3704 (91.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9326, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4468/4989 (89.5570%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4497/4989 (90.1383%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9791, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4477/4928 (90.8482%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4480/4928 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8473, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3366/3804 (88.4858%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3497/3804 (91.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8777, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3862/4336 (89.0683%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3893/4336 (89.7832%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0736, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3645/4046 (90.0890%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3649/4046 (90.1878%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9404, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4262/4793 (88.9213%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4368/4793 (91.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9297, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3415/3756 (90.9212%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3496/3756 (93.0777%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8937, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5596/6391 (87.5606%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5647/6391 (88.3586%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2158, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3269/3672 (89.0251%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3355/3672 (91.3671%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9785, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4170/4558 (91.4875%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4162/4558 (91.3120%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9952, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4101/4576 (89.6198%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4166/4576 (91.0402%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9304, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4056/4456 (91.0233%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4130/4456 (92.6840%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9073, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3922/4356 (90.0367%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3914/4356 (89.8531%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0237, Accuracy: 5481/10000 (54.8100%)
time spent on training: 230.35168480873108
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.3110, Accuracy: 6733/10000 (67.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 10.0039, Accuracy: 67/9900 (0.6768%)
Done in 251.45553588867188 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 43.69100374898419.
Norm before scaling: 43.68556219995987. Distance: 2.0956550016681765
Total norm for 4 adversaries is: 43.68556219995987. distance: 2.0956550016681765
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1851, Accuracy: 9409/9900 (95.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 43.69100374898419.
Norm before scaling: 43.68778360735914. Distance: 2.22600604683191
Total norm for 4 adversaries is: 43.68778360735914. distance: 2.22600604683191
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1225, Accuracy: 9592/9900 (96.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4271/4717 (90.5448%), train_poison_data_count: 370
Global model norm: 43.69100374898419.
Norm before scaling: 43.68988475921443. Distance: 2.052725083233014
Total norm for 4 adversaries is: 43.68988475921443. distance: 2.052725083233014
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1928, Accuracy: 9434/9900 (95.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4554/5066 (89.8934%), train_poison_data_count: 400
Global model norm: 43.69100374898419.
Norm before scaling: 43.68830750773741. Distance: 2.1665948586913437
Total norm for 4 adversaries is: 43.68830750773741. distance: 2.1665948586913437
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1810, Accuracy: 9478/9900 (95.7374%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4698/5116 (91.8296%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4623/5116 (90.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1355, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5063/5582 (90.7023%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5063/5582 (90.7023%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1408, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4378/4928 (88.8393%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4471/4928 (90.7265%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9825, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3676/4126 (89.0936%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3805/4126 (92.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8058, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3738/4158 (89.8990%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3773/4158 (90.7407%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9587, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4500/5063 (88.8801%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4485/5063 (88.5838%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0319, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5393/6124 (88.0634%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5407/6124 (88.2920%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9022, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3799/4354 (87.2531%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0129, Accuracy: 3321/4354 (76.2747%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.6132, Accuracy: 4431/10000 (44.3100%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4501/5025 (89.5721%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4574/5025 (91.0249%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0429, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4283/4679 (91.5367%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4149/4679 (88.6728%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1871, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4220/4793 (88.0451%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4388/4793 (91.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9424, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4089/4518 (90.5046%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4184/4518 (92.6073%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0140, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4630/5167 (89.6071%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4700/5167 (90.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1280, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4016/4433 (90.5933%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4050/4433 (91.3603%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8344, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4111/4503 (91.2947%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4131/4503 (91.7388%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8802, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4179/4707 (88.7827%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4231/4707 (89.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8992, Accuracy: 5617/10000 (56.1700%)
time spent on training: 236.10747647285461
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.3154, Accuracy: 6741/10000 (67.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 10.0704, Accuracy: 53/9900 (0.5354%)
Done in 257.32549238204956 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4442/4885 (90.9314%), train_poison_data_count: 385
Global model norm: 43.72466900603708.
Norm before scaling: 43.717656850611434. Distance: 2.097779566942321
Total norm for 4 adversaries is: 43.717656850611434. distance: 2.097779566942321
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1567, Accuracy: 9498/9900 (95.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 43.72466900603708.
Norm before scaling: 43.72142202788726. Distance: 2.204435459278024
Total norm for 4 adversaries is: 43.72142202788726. distance: 2.204435459278024
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.4263, Accuracy: 8865/9900 (89.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4276/4717 (90.6508%), train_poison_data_count: 370
Global model norm: 43.72466900603708.
Norm before scaling: 43.7172072972095. Distance: 2.0078081064139064
Total norm for 4 adversaries is: 43.7172072972095. distance: 2.0078081064139064
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0906, Accuracy: 9680/9900 (97.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 43.72466900603708.
Norm before scaling: 43.725054272050365. Distance: 2.209059709770328
Total norm for 4 adversaries is: 43.725054272050365. distance: 2.209059709770328
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1603, Accuracy: 9475/9900 (95.7071%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3298/3704 (89.0389%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3387/3704 (91.4417%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8966, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4986/5392 (92.4703%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4907/5392 (91.0052%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0375, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4041/4362 (92.6410%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4059/4362 (93.0536%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8131, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4184/4538 (92.1992%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4227/4538 (93.1468%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9051, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3767/4184 (90.0335%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3835/4184 (91.6587%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8854, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3433/3756 (91.4004%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3505/3756 (93.3174%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9291, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4329/4679 (92.5198%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4197/4679 (89.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.3671, Accuracy: 4928/10000 (49.2800%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3167/3472 (91.2154%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3210/3472 (92.4539%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9315, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5611/6391 (87.7953%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5669/6391 (88.7029%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1206, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4666/5265 (88.6230%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4635/5265 (88.0342%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1087, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5130/5902 (86.9197%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5130/5902 (86.9197%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1509, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5445/6124 (88.9125%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5434/6124 (88.7329%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0537, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4529/5083 (89.1009%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4606/5083 (90.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9469, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4024/4465 (90.1232%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4129/4465 (92.4748%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9437, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3395/3804 (89.2482%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3458/3804 (90.9043%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9225, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4415/4918 (89.7723%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4480/4918 (91.0939%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0435, Accuracy: 5428/10000 (54.2800%)
time spent on training: 236.62107634544373
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.3849, Accuracy: 6578/10000 (65.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 9.5124, Accuracy: 93/9900 (0.9394%)
Done in 257.6218421459198 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4430/4885 (90.6858%), train_poison_data_count: 385
Global model norm: 43.754150193778045.
Norm before scaling: 43.75468864385064. Distance: 2.136348601644358
Total norm for 4 adversaries is: 43.75468864385064. distance: 2.136348601644358
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1869, Accuracy: 9410/9900 (95.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 43.754150193778045.
Norm before scaling: 43.75255572892285. Distance: 2.2264614149203004
Total norm for 4 adversaries is: 43.75255572892285. distance: 2.2264614149203004
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2740, Accuracy: 9226/9900 (93.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 43.754150193778045.
Norm before scaling: 43.748130540415666. Distance: 2.0106919121628772
Total norm for 4 adversaries is: 43.748130540415666. distance: 2.0106919121628772
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1819, Accuracy: 9440/9900 (95.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4563/5066 (90.0711%), train_poison_data_count: 400
Global model norm: 43.754150193778045.
Norm before scaling: 43.75257386402042. Distance: 2.194192077783197
Total norm for 4 adversaries is: 43.75257386402042. distance: 2.194192077783197
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1556, Accuracy: 9508/9900 (96.0404%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4152/4538 (91.4941%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4196/4538 (92.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9063, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4466/4989 (89.5169%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4482/4989 (89.8376%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9107, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4288/4793 (89.4638%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4393/4793 (91.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0158, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3701/4158 (89.0091%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3797/4158 (91.3179%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9210, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3496/3861 (90.5465%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3533/3861 (91.5048%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8935, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4674/5232 (89.3349%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4693/5232 (89.6980%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1088, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4184/4663 (89.7276%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4289/4663 (91.9794%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9310, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4698/5197 (90.3983%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4675/5197 (89.9557%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0905, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4632/5167 (89.6458%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4734/5167 (91.6199%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0303, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3888/4416 (88.0435%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3999/4416 (90.5571%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8884, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3849/4354 (88.4015%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3606/4354 (82.8204%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.4679, Accuracy: 4772/10000 (47.7200%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4890/5455 (89.6425%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4885/5455 (89.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.4231, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4035/4456 (90.5521%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4139/4456 (92.8860%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8648, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2929/3271 (89.5445%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2936/3271 (89.7585%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9257, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2993/3297 (90.7795%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3069/3297 (93.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8194, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5074/5591 (90.7530%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5027/5591 (89.9124%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9535, Accuracy: 5638/10000 (56.3800%)
time spent on training: 232.79269194602966
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.3572, Accuracy: 6661/10000 (66.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 9.8144, Accuracy: 72/9900 (0.7273%)
Done in 253.852530002594 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4453/4885 (91.1566%), train_poison_data_count: 385
Global model norm: 43.787726479395744.
Norm before scaling: 43.78201953285161. Distance: 2.073046106741249
Total norm for 4 adversaries is: 43.78201953285161. distance: 2.073046106741249
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.2208, Accuracy: 9360/9900 (94.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 43.787726479395744.
Norm before scaling: 43.78243356938731. Distance: 2.1984789401814027
Total norm for 4 adversaries is: 43.78243356938731. distance: 2.1984789401814027
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0444, Accuracy: 9781/9900 (98.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4250/4717 (90.0996%), train_poison_data_count: 370
Global model norm: 43.787726479395744.
Norm before scaling: 43.785808448450226. Distance: 2.0047956430072733
Total norm for 4 adversaries is: 43.785808448450226. distance: 2.0047956430072733
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1807, Accuracy: 9462/9900 (95.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4566/5066 (90.1303%), train_poison_data_count: 400
Global model norm: 43.787726479395744.
Norm before scaling: 43.786147176593566. Distance: 2.236613825909605
Total norm for 4 adversaries is: 43.786147176593566. distance: 2.236613825909605
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1720, Accuracy: 9451/9900 (95.4646%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4607/5167 (89.1620%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4681/5167 (90.5942%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1799, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3482/3775 (92.2384%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3550/3775 (94.0397%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7976, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4624/5195 (89.0087%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4629/5195 (89.1049%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2792, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3744/4126 (90.7416%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3793/4126 (91.9292%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9135, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3461/3911 (88.4940%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3513/3911 (89.8236%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1174, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4019/4433 (90.6610%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4106/4433 (92.6235%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7276, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2905/3271 (88.8108%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0045, Accuracy: 2977/3271 (91.0119%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7789, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3265/3590 (90.9471%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3262/3590 (90.8635%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0165, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4435/4918 (90.1789%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4510/4918 (91.7039%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9849, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4496/4986 (90.1725%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4541/4986 (91.0750%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8863, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3246/3616 (89.7677%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3321/3616 (91.8418%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8795, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3887/4295 (90.5006%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3721/4295 (86.6356%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1520, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3904/4356 (89.6235%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3955/4356 (90.7943%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0174, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4291/4793 (89.5264%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4370/4793 (91.1746%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0298, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3955/4315 (91.6570%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3982/4315 (92.2827%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9249, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4306/4804 (89.6336%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4173/4804 (86.8651%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0932, Accuracy: 5422/10000 (54.2200%)
time spent on training: 230.51371383666992
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.3924, Accuracy: 6563/10000 (65.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 9.4635, Accuracy: 96/9900 (0.9697%)
Done in 251.8798143863678 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4432/4885 (90.7267%), train_poison_data_count: 385
Global model norm: 43.814733081018964.
Norm before scaling: 43.81035318162178. Distance: 2.1194096126446755
Total norm for 4 adversaries is: 43.81035318162178. distance: 2.1194096126446755
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0975, Accuracy: 9667/9900 (97.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4753/5305 (89.5947%), train_poison_data_count: 415
Global model norm: 43.814733081018964.
Norm before scaling: 43.813491875363006. Distance: 2.234699785862649
Total norm for 4 adversaries is: 43.813491875363006. distance: 2.234699785862649
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1298, Accuracy: 9552/9900 (96.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4301/4717 (91.1808%), train_poison_data_count: 370
Global model norm: 43.814733081018964.
Norm before scaling: 43.806999699320315. Distance: 1.9779608081333038
Total norm for 4 adversaries is: 43.806999699320315. distance: 1.9779608081333038
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1470, Accuracy: 9562/9900 (96.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4547/5066 (89.7552%), train_poison_data_count: 400
Global model norm: 43.814733081018964.
Norm before scaling: 43.815620430960465. Distance: 2.242455017931528
Total norm for 4 adversaries is: 43.815620430960465. distance: 2.242455017931528
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1437, Accuracy: 9529/9900 (96.2525%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4125/4503 (91.6056%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4111/4503 (91.2947%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1659, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4315/4934 (87.4544%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4068/4934 (82.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2803, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4297/4804 (89.4463%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0107, Accuracy: 3860/4804 (80.3497%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3532, Accuracy: 4942/10000 (49.4200%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4050/4456 (90.8887%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4083/4456 (91.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1291, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4195/4651 (90.1957%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4236/4651 (91.0772%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9217, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3761/4184 (89.8901%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3780/4184 (90.3442%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0362, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4389/4928 (89.0625%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4442/4928 (90.1380%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0348, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3462/3775 (91.7086%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3534/3775 (93.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9176, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4544/5083 (89.3960%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4536/5083 (89.2386%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1627, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4856/5455 (89.0192%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4927/5455 (90.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9468, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3205/3638 (88.0979%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3332/3638 (91.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8093, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3616/3911 (92.4572%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3433/3911 (87.7781%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3946, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3428/3837 (89.3406%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3549/3837 (92.4941%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9435, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4023/4501 (89.3801%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3973/4501 (88.2693%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8988, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4730/5197 (91.0140%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4629/5197 (89.0706%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0821, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3461/3861 (89.6400%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3538/3861 (91.6343%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8212, Accuracy: 5805/10000 (58.0500%)
time spent on training: 231.01988649368286
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Misclassification from 98 to 35 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.4110, Accuracy: 6552/10000 (65.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 9.5175, Accuracy: 95/9900 (0.9596%)
Done in 252.18803358078003 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4461/4885 (91.3204%), train_poison_data_count: 385
Global model norm: 43.84814605099485.
Norm before scaling: 43.845297994767925. Distance: 2.0442651315273457
Total norm for 4 adversaries is: 43.845297994767925. distance: 2.0442651315273457
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2716, Accuracy: 9219/9900 (93.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4789/5305 (90.2733%), train_poison_data_count: 415
Global model norm: 43.84814605099485.
Norm before scaling: 43.84563487128023. Distance: 2.238889921023518
Total norm for 4 adversaries is: 43.84563487128023. distance: 2.238889921023518
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0831, Accuracy: 9694/9900 (97.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 43.84814605099485.
Norm before scaling: 43.84390452351601. Distance: 2.0517843064091448
Total norm for 4 adversaries is: 43.84390452351601. distance: 2.0517843064091448
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2116, Accuracy: 9385/9900 (94.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4574/5066 (90.2882%), train_poison_data_count: 400
Global model norm: 43.84814605099485.
Norm before scaling: 43.84702828754119. Distance: 2.1961244866640173
Total norm for 4 adversaries is: 43.84702828754119. distance: 2.1961244866640173
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1472, Accuracy: 9523/9900 (96.1919%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2912/3271 (89.0248%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3010/3271 (92.0208%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8295, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4026/4511 (89.2485%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4099/4511 (90.8668%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8775, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3245/3638 (89.1974%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3331/3638 (91.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.7945, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5160/5582 (92.4400%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5167/5582 (92.5654%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0461, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4055/4456 (91.0009%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4096/4456 (91.9210%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0243, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5192/5902 (87.9702%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5138/5902 (87.0552%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0552, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3858/4416 (87.3641%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4009/4416 (90.7835%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8851, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4404/4934 (89.2582%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4072/4934 (82.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2206, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4142/4596 (90.1218%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4257/4596 (92.6240%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9639, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3410/3837 (88.8715%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3548/3837 (92.4681%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8139, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5513/6391 (86.2619%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5562/6391 (87.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0569, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3947/4368 (90.3617%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3992/4368 (91.3919%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8924, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3425/3804 (90.0368%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3415/3804 (89.7739%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0017, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5809/6263 (92.7511%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5839/6263 (93.2301%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9317, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4281/4793 (89.3178%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4348/4793 (90.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9802, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4952/5424 (91.2979%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4978/5424 (91.7773%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0822, Accuracy: 5436/10000 (54.3600%)
time spent on training: 234.6576714515686
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.4177, Accuracy: 6552/10000 (65.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 9.3725, Accuracy: 104/9900 (1.0505%)
Done in 255.9931240081787 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4478/4885 (91.6684%), train_poison_data_count: 385
Global model norm: 43.876528808389544.
Norm before scaling: 43.870139176074254. Distance: 2.0138182119778225
Total norm for 4 adversaries is: 43.870139176074254. distance: 2.0138182119778225
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2025, Accuracy: 9390/9900 (94.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 43.876528808389544.
Norm before scaling: 43.87386900919427. Distance: 2.2168647386019273
Total norm for 4 adversaries is: 43.87386900919427. distance: 2.2168647386019273
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0450, Accuracy: 9775/9900 (98.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4308/4717 (91.3292%), train_poison_data_count: 370
Global model norm: 43.876528808389544.
Norm before scaling: 43.871375996610105. Distance: 1.9991839055151177
Total norm for 4 adversaries is: 43.871375996610105. distance: 1.9991839055151177
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1842, Accuracy: 9469/9900 (95.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4560/5066 (90.0118%), train_poison_data_count: 400
Global model norm: 43.876528808389544.
Norm before scaling: 43.873863444591784. Distance: 2.182015874243737
Total norm for 4 adversaries is: 43.873863444591784. distance: 2.182015874243737
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1490, Accuracy: 9546/9900 (96.4242%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4561/5055 (90.2275%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4610/5055 (91.1968%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0084, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3751/4184 (89.6511%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3809/4184 (91.0373%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9155, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3506/3861 (90.8055%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3546/3861 (91.8415%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8580, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4350/4804 (90.5495%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4261/4804 (88.6969%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1197, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3159/3472 (90.9850%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3146/3472 (90.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0531, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3595/3969 (90.5770%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3646/3969 (91.8619%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9738, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4512/4989 (90.4390%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4553/4989 (91.2608%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8839, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5204/5582 (93.2282%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5202/5582 (93.1924%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0158, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4376/4793 (91.2998%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4416/4793 (92.1344%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8902, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4182/4662 (89.7040%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4307/4662 (92.3852%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9006, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4388/4934 (88.9339%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4256/4934 (86.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2323, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4516/4986 (90.5736%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4566/4986 (91.5764%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.7767, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4020/4433 (90.6835%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4078/4433 (91.9919%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9968, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4215/4716 (89.3766%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4258/4716 (90.2884%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0715, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4195/4596 (91.2750%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4254/4596 (92.5587%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0092, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3892/4354 (89.3891%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3779/4354 (86.7938%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3638, Accuracy: 5016/10000 (50.1600%)
time spent on training: 229.90510988235474
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.4226, Accuracy: 6557/10000 (65.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 9.5173, Accuracy: 92/9900 (0.9293%)
Done in 251.35309195518494 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4485/4885 (91.8117%), train_poison_data_count: 385
Global model norm: 43.90547152334775.
Norm before scaling: 43.89764150484055. Distance: 2.02093445305324
Total norm for 4 adversaries is: 43.89764150484055. distance: 2.02093445305324
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1861, Accuracy: 9435/9900 (95.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4749/5305 (89.5193%), train_poison_data_count: 415
Global model norm: 43.90547152334775.
Norm before scaling: 43.89983271608219. Distance: 2.2238643962904705
Total norm for 4 adversaries is: 43.89983271608219. distance: 2.2238643962904705
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0984, Accuracy: 9637/9900 (97.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4294/4717 (91.0324%), train_poison_data_count: 370
Global model norm: 43.90547152334775.
Norm before scaling: 43.8996352890958. Distance: 2.0149933764251817
Total norm for 4 adversaries is: 43.8996352890958. distance: 2.0149933764251817
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1325, Accuracy: 9580/9900 (96.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4578/5066 (90.3672%), train_poison_data_count: 400
Global model norm: 43.90547152334775.
Norm before scaling: 43.90305815800307. Distance: 2.163074474433509
Total norm for 4 adversaries is: 43.90305815800307. distance: 2.163074474433509
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1287, Accuracy: 9566/9900 (96.6263%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4688/5116 (91.6341%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4723/5116 (92.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8038, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4169/4662 (89.4251%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4219/4662 (90.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9955, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5130/5902 (86.9197%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5111/5902 (86.5978%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1666, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4484/5063 (88.5641%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4499/5063 (88.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0374, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3895/4354 (89.4580%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3763/4354 (86.4263%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2906, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4628/5195 (89.0857%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4634/5195 (89.2012%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9955, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3911/4356 (89.7842%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3863/4356 (88.6823%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1872, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3880/4295 (90.3376%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3712/4295 (86.4261%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1189, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5813/6263 (92.8149%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5802/6263 (92.6393%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9856, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4039/4511 (89.5367%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4158/4511 (92.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9283, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4216/4663 (90.4139%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4332/4663 (92.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9688, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3910/4336 (90.1753%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3959/4336 (91.3054%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2292, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4409/4928 (89.4683%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4489/4928 (91.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0317, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3692/4046 (91.2506%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3687/4046 (91.1270%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8972, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3276/3672 (89.2157%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3311/3672 (90.1688%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9309, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3937/4356 (90.3811%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3891/4356 (89.3251%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0535, Accuracy: 5398/10000 (53.9800%)
time spent on training: 234.11037969589233
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.4172, Accuracy: 6592/10000 (65.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 9.9251, Accuracy: 46/9900 (0.4646%)
Done in 255.3584794998169 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 43.93754861972772.
Norm before scaling: 43.93337268354846. Distance: 2.049707680306397
Total norm for 4 adversaries is: 43.93337268354846. distance: 2.049707680306397
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1942, Accuracy: 9434/9900 (95.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4788/5305 (90.2545%), train_poison_data_count: 415
Global model norm: 43.93754861972772.
Norm before scaling: 43.93563435094926. Distance: 2.2051757574641013
Total norm for 4 adversaries is: 43.93563435094926. distance: 2.2051757574641013
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0224, Accuracy: 9840/9900 (99.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4310/4717 (91.3716%), train_poison_data_count: 370
Global model norm: 43.93754861972772.
Norm before scaling: 43.93076773191683. Distance: 1.9865180030773175
Total norm for 4 adversaries is: 43.93076773191683. distance: 1.9865180030773175
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1787, Accuracy: 9453/9900 (95.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4585/5066 (90.5053%), train_poison_data_count: 400
Global model norm: 43.93754861972772.
Norm before scaling: 43.93437433316736. Distance: 2.1756545737080324
Total norm for 4 adversaries is: 43.93437433316736. distance: 2.1756545737080324
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2857, Accuracy: 9140/9900 (92.3232%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4500/5037 (89.3389%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4595/5037 (91.2249%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9157, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4163/4647 (89.5847%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4223/4647 (90.8758%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9181, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4252/4663 (91.1859%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4328/4663 (92.8158%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9898, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3889/4336 (89.6910%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3956/4336 (91.2362%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0749, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3409/3756 (90.7614%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3536/3756 (94.1427%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8562, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4098/4625 (88.6054%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4069/4625 (87.9784%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2416, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4020/4362 (92.1596%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4070/4362 (93.3058%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8508, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4426/4874 (90.8084%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4245/4874 (87.0948%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2105, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4285/4767 (89.8888%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4320/4767 (90.6230%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2492, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3459/3775 (91.6291%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3521/3775 (93.2715%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8235, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4207/4662 (90.2402%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4274/4662 (91.6774%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9093, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5428/6124 (88.6349%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5447/6124 (88.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1297, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4025/4511 (89.2263%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4148/4511 (91.9530%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9061, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3603/3911 (92.1248%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3495/3911 (89.3633%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0594, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4975/5591 (88.9823%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4986/5591 (89.1790%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9845, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3737/4126 (90.5720%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3778/4126 (91.5657%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9672, Accuracy: 5509/10000 (55.0900%)
time spent on training: 232.86819744110107
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.4620, Accuracy: 6533/10000 (65.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 9.7356, Accuracy: 56/9900 (0.5657%)
Done in 254.08057522773743 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4436/4885 (90.8086%), train_poison_data_count: 385
Global model norm: 43.963276189568866.
Norm before scaling: 43.95880834434309. Distance: 2.1187947496397745
Total norm for 4 adversaries is: 43.95880834434309. distance: 2.1187947496397745
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1103, Accuracy: 9625/9900 (97.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4785/5305 (90.1979%), train_poison_data_count: 415
Global model norm: 43.963276189568866.
Norm before scaling: 43.95995242254236. Distance: 2.218570970646293
Total norm for 4 adversaries is: 43.95995242254236. distance: 2.218570970646293
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0451, Accuracy: 9790/9900 (98.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4291/4717 (90.9688%), train_poison_data_count: 370
Global model norm: 43.963276189568866.
Norm before scaling: 43.95662146153296. Distance: 1.9930098687524305
Total norm for 4 adversaries is: 43.95662146153296. distance: 1.9930098687524305
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.3613, Accuracy: 9031/9900 (91.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4595/5066 (90.7027%), train_poison_data_count: 400
Global model norm: 43.963276189568866.
Norm before scaling: 43.95836958800835. Distance: 2.1398913386200418
Total norm for 4 adversaries is: 43.95836958800835. distance: 2.1398913386200418
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.3319, Accuracy: 9070/9900 (91.6162%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4487/5025 (89.2935%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4615/5025 (91.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0561, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4685/5116 (91.5754%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4623/5116 (90.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0794, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4629/5167 (89.5878%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4697/5167 (90.9038%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1585, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4185/4558 (91.8166%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4138/4558 (90.7854%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9613, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4163/4651 (89.5076%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4244/4651 (91.2492%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1435, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3857/4336 (88.9530%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3927/4336 (90.5673%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0541, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4532/5055 (89.6538%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4626/5055 (91.5134%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9388, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3496/3775 (92.6093%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3549/3775 (94.0132%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8431, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4720/5265 (89.6486%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4681/5265 (88.9079%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0275, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3628/4025 (90.1366%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3753/4025 (93.2422%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8296, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4508/4989 (90.3588%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4480/4989 (89.7976%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9569, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4395/4793 (91.6962%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4447/4793 (92.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9690, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3440/3804 (90.4311%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3515/3804 (92.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9712, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3422/3797 (90.1238%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3505/3797 (92.3097%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9080, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4020/4433 (90.6835%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4100/4433 (92.4882%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8797, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4251/4707 (90.3123%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4277/4707 (90.8647%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9656, Accuracy: 5541/10000 (55.4100%)
time spent on training: 234.0406048297882
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.4452, Accuracy: 6535/10000 (65.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 9.8811, Accuracy: 47/9900 (0.4747%)
Done in 255.3904206752777 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4467/4885 (91.4432%), train_poison_data_count: 385
Global model norm: 43.99314410809513.
Norm before scaling: 43.98674782676028. Distance: 2.0710259126067148
Total norm for 4 adversaries is: 43.98674782676028. distance: 2.0710259126067148
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1928, Accuracy: 9481/9900 (95.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4808/5305 (90.6315%), train_poison_data_count: 415
Global model norm: 43.99314410809513.
Norm before scaling: 43.99017085481639. Distance: 2.160531147713561
Total norm for 4 adversaries is: 43.99017085481639. distance: 2.160531147713561
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1878, Accuracy: 9449/9900 (95.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4270/4717 (90.5236%), train_poison_data_count: 370
Global model norm: 43.99314410809513.
Norm before scaling: 43.98635513970852. Distance: 2.062831042916771
Total norm for 4 adversaries is: 43.98635513970852. distance: 2.062831042916771
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0850, Accuracy: 9693/9900 (97.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4539/5066 (89.5973%), train_poison_data_count: 400
Global model norm: 43.99314410809513.
Norm before scaling: 43.99134880327324. Distance: 2.242592485917102
Total norm for 4 adversaries is: 43.99134880327324. distance: 2.242592485917102
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1021, Accuracy: 9630/9900 (97.2727%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5020/5392 (93.1009%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4980/5392 (92.3591%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9413, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4243/4663 (90.9929%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4327/4663 (92.7943%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9162, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3427/3797 (90.2555%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3528/3797 (92.9155%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9628, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5247/5582 (93.9986%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0029, Accuracy: 5269/5582 (94.3927%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9726, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4622/5167 (89.4523%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4674/5167 (90.4587%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1254, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3431/3781 (90.7432%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3468/3781 (91.7218%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1592, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3627/3969 (91.3832%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3647/3969 (91.8871%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9858, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3512/3837 (91.5298%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3593/3837 (93.6409%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8468, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5199/5902 (88.0888%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5123/5902 (86.8011%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0909, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4869/5455 (89.2576%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4842/5455 (88.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9986, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4505/5037 (89.4382%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4607/5037 (91.4632%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0635, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4536/5017 (90.4126%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4588/5017 (91.4491%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8747, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4427/4986 (88.7886%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4525/4986 (90.7541%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8907, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4701/5197 (90.4560%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4653/5197 (89.5324%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0091, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4052/4361 (92.9145%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3982/4361 (91.3093%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9619, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5848/6263 (93.3738%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5858/6263 (93.5335%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9870, Accuracy: 5502/10000 (55.0200%)
time spent on training: 237.57727122306824
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.4020, Accuracy: 6611/10000 (66.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 9.5639, Accuracy: 78/9900 (0.7879%)
Done in 258.8069064617157 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4447/4885 (91.0338%), train_poison_data_count: 385
Global model norm: 44.01550158617771.
Norm before scaling: 44.008709132309114. Distance: 2.1006858159948556
Total norm for 4 adversaries is: 44.008709132309114. distance: 2.1006858159948556
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0866, Accuracy: 9665/9900 (97.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 44.01550158617771.
Norm before scaling: 44.01164230295349. Distance: 2.229960208246997
Total norm for 4 adversaries is: 44.01164230295349. distance: 2.229960208246997
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.3292, Accuracy: 9066/9900 (91.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4283/4717 (90.7992%), train_poison_data_count: 370
Global model norm: 44.01550158617771.
Norm before scaling: 44.00790750366986. Distance: 2.019598541024116
Total norm for 4 adversaries is: 44.00790750366986. distance: 2.019598541024116
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2332, Accuracy: 9362/9900 (94.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4550/5066 (89.8144%), train_poison_data_count: 400
Global model norm: 44.01550158617771.
Norm before scaling: 44.01258115362796. Distance: 2.188671016607843
Total norm for 4 adversaries is: 44.01258115362796. distance: 2.188671016607843
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1099, Accuracy: 9607/9900 (97.0404%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4536/5017 (90.4126%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4567/5017 (91.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8650, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4427/4928 (89.8336%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4423/4928 (89.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0238, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3741/4184 (89.4120%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3810/4184 (91.0612%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0828, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4384/4793 (91.4667%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4455/4793 (92.9480%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9919, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5269/5740 (91.7944%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5288/5740 (92.1254%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0573, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3425/3756 (91.1874%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3487/3756 (92.8381%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8762, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3943/4235 (93.1051%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3912/4235 (92.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8435, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3805/4223 (90.1018%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3869/4223 (91.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9020, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4537/5063 (89.6109%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4517/5063 (89.2159%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1094, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4617/4989 (92.5436%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4649/4989 (93.1850%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8766, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4486/4928 (91.0308%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4512/4928 (91.5584%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9495, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5195/5902 (88.0210%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5172/5902 (87.6313%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0903, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4048/4456 (90.8438%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4144/4456 (92.9982%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8658, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5411/6124 (88.3573%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5388/6124 (87.9817%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0175, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3430/3828 (89.6029%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3554/3828 (92.8422%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8894, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3237/3616 (89.5188%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3312/3616 (91.5929%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9134, Accuracy: 5727/10000 (57.2700%)
time spent on training: 236.09140729904175
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.4235, Accuracy: 6600/10000 (66.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 9.7165, Accuracy: 64/9900 (0.6465%)
Done in 257.17250323295593 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4450/4885 (91.0952%), train_poison_data_count: 385
Global model norm: 44.044174214378934.
Norm before scaling: 44.0401940991302. Distance: 2.0953338098544676
Total norm for 4 adversaries is: 44.0401940991302. distance: 2.0953338098544676
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1009, Accuracy: 9655/9900 (97.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4804/5305 (90.5561%), train_poison_data_count: 415
Global model norm: 44.044174214378934.
Norm before scaling: 44.03624688866051. Distance: 2.1712483112546055
Total norm for 4 adversaries is: 44.03624688866051. distance: 2.1712483112546055
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1438, Accuracy: 9534/9900 (96.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4282/4717 (90.7780%), train_poison_data_count: 370
Global model norm: 44.044174214378934.
Norm before scaling: 44.034682043319556. Distance: 1.9999274002249818
Total norm for 4 adversaries is: 44.034682043319556. distance: 1.9999274002249818
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.3761, Accuracy: 9034/9900 (91.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4562/5066 (90.0513%), train_poison_data_count: 400
Global model norm: 44.044174214378934.
Norm before scaling: 44.042461367642844. Distance: 2.2309097415272787
Total norm for 4 adversaries is: 44.042461367642844. distance: 2.2309097415272787
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2430, Accuracy: 9299/9900 (93.9293%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3811/4223 (90.2439%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3901/4223 (92.3751%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9161, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4050/4362 (92.8473%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4101/4362 (94.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8708, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5542/6391 (86.7157%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5632/6391 (88.1239%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0530, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4364/4793 (91.0494%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4434/4793 (92.5099%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9752, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3409/3756 (90.7614%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3487/3756 (92.8381%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8830, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4184/4618 (90.6020%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4183/4618 (90.5803%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0091, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3677/4025 (91.3540%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3758/4025 (93.3665%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8382, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3225/3638 (88.6476%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3338/3638 (91.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9577, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3939/4315 (91.2862%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4039/4315 (93.6037%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8794, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3983/4295 (92.7357%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3795/4295 (88.3586%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0384, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4503/4928 (91.3758%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4534/4928 (92.0049%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8382, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4459/4986 (89.4304%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4541/4986 (91.0750%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8379, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3735/4126 (90.5235%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3794/4126 (91.9535%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0561, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4421/4918 (89.8943%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4486/4918 (91.2159%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1380, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4681/5195 (90.1059%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4639/5195 (89.2974%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9677, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5276/5740 (91.9164%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5312/5740 (92.5436%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9902, Accuracy: 5518/10000 (55.1800%)
time spent on training: 232.7179729938507
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.4015, Accuracy: 6622/10000 (66.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 9.8391, Accuracy: 56/9900 (0.5657%)
Done in 253.8597388267517 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4491/4885 (91.9345%), train_poison_data_count: 385
Global model norm: 44.074808509138045.
Norm before scaling: 44.06753766636573. Distance: 2.046278655562863
Total norm for 4 adversaries is: 44.06753766636573. distance: 2.046278655562863
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1198, Accuracy: 9617/9900 (97.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4775/5305 (90.0094%), train_poison_data_count: 415
Global model norm: 44.074808509138045.
Norm before scaling: 44.07047661620745. Distance: 2.2221466713884115
Total norm for 4 adversaries is: 44.07047661620745. distance: 2.2221466713884115
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2072, Accuracy: 9379/9900 (94.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4279/4717 (90.7144%), train_poison_data_count: 370
Global model norm: 44.074808509138045.
Norm before scaling: 44.0684656311737. Distance: 2.026436486955079
Total norm for 4 adversaries is: 44.0684656311737. distance: 2.026436486955079
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2958, Accuracy: 9173/9900 (92.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4587/5066 (90.5448%), train_poison_data_count: 400
Global model norm: 44.074808509138045.
Norm before scaling: 44.07131449955572. Distance: 2.1858712808696588
Total norm for 4 adversaries is: 44.07131449955572. distance: 2.1858712808696588
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1053, Accuracy: 9636/9900 (97.3333%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2996/3297 (90.8705%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3051/3297 (92.5387%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8172, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3455/3828 (90.2560%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3528/3828 (92.1630%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9248, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4495/5063 (88.7814%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4234/5063 (83.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0743, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4041/4501 (89.7800%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4093/4501 (90.9353%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0538, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4412/4793 (92.0509%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4403/4793 (91.8631%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9367, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3844/4223 (91.0253%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3909/4223 (92.5645%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8729, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3436/3756 (91.4803%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3513/3756 (93.5304%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8029, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3222/3638 (88.5651%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3308/3638 (90.9291%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9628, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3246/3646 (89.0291%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3389/3646 (92.9512%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8597, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4456/4874 (91.4239%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4276/4874 (87.7308%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1594, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5828/6263 (93.0544%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5750/6263 (91.8090%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0309, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4508/5037 (89.4977%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4573/5037 (90.7882%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0884, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4036/4362 (92.5264%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4078/4362 (93.4892%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9410, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3957/4356 (90.8402%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3678/4356 (84.4353%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1991, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4699/5116 (91.8491%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4642/5116 (90.7349%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9731, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3912/4346 (90.0138%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4045/4346 (93.0741%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8853, Accuracy: 5625/10000 (56.2500%)
time spent on training: 231.41258311271667
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.3877, Accuracy: 6639/10000 (66.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 9.7520, Accuracy: 70/9900 (0.7071%)
Done in 252.60871291160583 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4419/4885 (90.4606%), train_poison_data_count: 385
Global model norm: 44.10628503833453.
Norm before scaling: 44.10413452973754. Distance: 2.1970470811455134
Total norm for 4 adversaries is: 44.10413452973754. distance: 2.1970470811455134
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0691, Accuracy: 9726/9900 (98.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 44.10628503833453.
Norm before scaling: 44.099936999494396. Distance: 2.17328921593118
Total norm for 4 adversaries is: 44.099936999494396. distance: 2.17328921593118
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1503, Accuracy: 9498/9900 (95.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4312/4717 (91.4140%), train_poison_data_count: 370
Global model norm: 44.10628503833453.
Norm before scaling: 44.09715088098451. Distance: 1.9873433177295798
Total norm for 4 adversaries is: 44.09715088098451. distance: 1.9873433177295798
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2767, Accuracy: 9238/9900 (93.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4607/5066 (90.9396%), train_poison_data_count: 400
Global model norm: 44.10628503833453.
Norm before scaling: 44.10046845963629. Distance: 2.1556247412774607
Total norm for 4 adversaries is: 44.10046845963629. distance: 2.1556247412774607
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2515, Accuracy: 9278/9900 (93.7172%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4102/4518 (90.7924%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4162/4518 (92.1204%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9721, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4193/4558 (91.9921%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4175/4558 (91.5972%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0150, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3412/3804 (89.6951%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3450/3804 (90.6940%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9726, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3445/3775 (91.2583%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3544/3775 (93.8808%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7881, Accuracy: 5889/10000 (58.8900%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4578/5083 (90.0649%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4625/5083 (90.9896%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0653, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4451/4928 (90.3206%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4486/4928 (91.0308%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8763, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4579/5244 (87.3188%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4615/5244 (88.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8713, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4554/4989 (91.2808%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4563/4989 (91.4612%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9428, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4620/4986 (92.6594%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4577/4986 (91.7970%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8050, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3752/4175 (89.8683%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3804/4175 (91.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8735, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4783/5232 (91.4182%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4808/5232 (91.8960%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9224, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4447/5063 (87.8333%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4329/5063 (85.5027%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2379, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4075/4441 (91.7586%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4089/4441 (92.0739%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9998, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3250/3646 (89.1388%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3336/3646 (91.4975%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8029, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4608/5167 (89.1813%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4693/5167 (90.8264%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2397, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4174/4538 (91.9788%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4240/4538 (93.4332%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9231, Accuracy: 5645/10000 (56.4500%)
time spent on training: 232.61406803131104
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.3978, Accuracy: 6635/10000 (66.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 9.8121, Accuracy: 64/9900 (0.6465%)
Done in 258.59750175476074 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4485/4885 (91.8117%), train_poison_data_count: 385
Global model norm: 44.135919273503156.
Norm before scaling: 44.125951654043675. Distance: 2.0444159259857257
Total norm for 4 adversaries is: 44.125951654043675. distance: 2.0444159259857257
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.2040, Accuracy: 9398/9900 (94.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4831/5305 (91.0650%), train_poison_data_count: 415
Global model norm: 44.135919273503156.
Norm before scaling: 44.12948697972536. Distance: 2.1431852747956324
Total norm for 4 adversaries is: 44.12948697972536. distance: 2.1431852747956324
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0792, Accuracy: 9706/9900 (98.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4284/4717 (90.8204%), train_poison_data_count: 370
Global model norm: 44.135919273503156.
Norm before scaling: 44.128149509146226. Distance: 1.9946861006755603
Total norm for 4 adversaries is: 44.128149509146226. distance: 1.9946861006755603
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1683, Accuracy: 9485/9900 (95.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4616/5066 (91.1173%), train_poison_data_count: 400
Global model norm: 44.135919273503156.
Norm before scaling: 44.13140390410071. Distance: 2.1153845060121736
Total norm for 4 adversaries is: 44.13140390410071. distance: 2.1153845060121736
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.3038, Accuracy: 9173/9900 (92.6566%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4018/4356 (92.2406%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3733/4356 (85.6979%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2187, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4378/4928 (88.8393%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4455/4928 (90.4018%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9749, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4501/5037 (89.3587%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4614/5037 (91.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9707, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4289/4804 (89.2798%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4157/4804 (86.5321%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2084, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3436/3775 (91.0199%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3587/3775 (95.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8238, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4685/5167 (90.6716%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4736/5167 (91.6586%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1119, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3932/4235 (92.8453%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3908/4235 (92.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8548, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4482/4956 (90.4358%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4459/4956 (89.9718%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1061, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5342/5740 (93.0662%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5314/5740 (92.5784%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9329, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4331/4679 (92.5625%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4351/4679 (92.9900%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9967, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3343/3704 (90.2538%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3417/3704 (92.2516%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8132, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3193/3472 (91.9643%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3218/3472 (92.6843%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0101, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4192/4651 (90.1312%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4245/4651 (91.2707%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9874, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4208/4634 (90.8071%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4235/4634 (91.3897%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8679, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5173/5902 (87.6483%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5101/5902 (86.4283%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2144, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3470/3837 (90.4352%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3565/3837 (92.9111%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8713, Accuracy: 5772/10000 (57.7200%)
time spent on training: 263.07545614242554
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.4392, Accuracy: 6564/10000 (65.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 9.2254, Accuracy: 131/9900 (1.3232%)
Done in 288.0372757911682 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4463/4885 (91.3613%), train_poison_data_count: 385
Global model norm: 44.1616722497964.
Norm before scaling: 44.155128977719706. Distance: 2.0562379738128445
Total norm for 4 adversaries is: 44.155128977719706. distance: 2.0562379738128445
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2531, Accuracy: 9282/9900 (93.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 44.1616722497964.
Norm before scaling: 44.15297946575208. Distance: 2.176879386536009
Total norm for 4 adversaries is: 44.15297946575208. distance: 2.176879386536009
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2371, Accuracy: 9325/9900 (94.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4306/4717 (91.2868%), train_poison_data_count: 370
Global model norm: 44.1616722497964.
Norm before scaling: 44.15004877280007. Distance: 2.006976476792804
Total norm for 4 adversaries is: 44.15004877280007. distance: 2.006976476792804
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2064, Accuracy: 9432/9900 (95.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4572/5066 (90.2487%), train_poison_data_count: 400
Global model norm: 44.1616722497964.
Norm before scaling: 44.157702725129816. Distance: 2.2119542671911785
Total norm for 4 adversaries is: 44.157702725129816. distance: 2.2119542671911785
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1628, Accuracy: 9476/9900 (95.7172%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3577/3969 (90.1235%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3602/3969 (90.7533%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9001, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4269/4707 (90.6947%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4278/4707 (90.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0231, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3512/3861 (90.9609%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3531/3861 (91.4530%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9465, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4141/4596 (90.1001%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4219/4596 (91.7972%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9835, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4089/4503 (90.8061%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4059/4503 (90.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0266, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4577/4928 (92.8774%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4566/4928 (92.6542%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9435, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4535/5025 (90.2488%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4584/5025 (91.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0126, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4148/4576 (90.6469%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4226/4576 (92.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9545, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4465/4918 (90.7889%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4487/4918 (91.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9946, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3936/4315 (91.2167%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4001/4315 (92.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8944, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3258/3590 (90.7521%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3266/3590 (90.9749%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9672, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4089/4456 (91.7639%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4136/4456 (92.8187%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9864, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3866/4354 (88.7919%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3745/4354 (86.0129%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3552, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4039/4501 (89.7356%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4075/4501 (90.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8953, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3662/3911 (93.6333%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3560/3911 (91.0253%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0244, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4136/4558 (90.7416%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4126/4558 (90.5222%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0842, Accuracy: 5413/10000 (54.1300%)
time spent on training: 259.5022873878479
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.4507, Accuracy: 6571/10000 (65.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 9.3267, Accuracy: 107/9900 (1.0808%)
Done in 284.0994727611542 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4447/4885 (91.0338%), train_poison_data_count: 385
Global model norm: 44.185647669361344.
Norm before scaling: 44.17854289520819. Distance: 2.0578983876951673
Total norm for 4 adversaries is: 44.17854289520819. distance: 2.0578983876951673
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1726, Accuracy: 9487/9900 (95.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4806/5305 (90.5938%), train_poison_data_count: 415
Global model norm: 44.185647669361344.
Norm before scaling: 44.18005152922527. Distance: 2.2032922992357555
Total norm for 4 adversaries is: 44.18005152922527. distance: 2.2032922992357555
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1883, Accuracy: 9446/9900 (95.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4287/4717 (90.8840%), train_poison_data_count: 370
Global model norm: 44.185647669361344.
Norm before scaling: 44.17633787589234. Distance: 2.0066482196268343
Total norm for 4 adversaries is: 44.17633787589234. distance: 2.0066482196268343
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2198, Accuracy: 9376/9900 (94.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4604/5066 (90.8804%), train_poison_data_count: 400
Global model norm: 44.185647669361344.
Norm before scaling: 44.180378945738596. Distance: 2.171151898440336
Total norm for 4 adversaries is: 44.180378945738596. distance: 2.171151898440336
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0748, Accuracy: 9707/9900 (98.0505%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4791/5116 (93.6474%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4712/5116 (92.1032%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8809, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5033/5392 (93.3420%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4930/5392 (91.4318%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0582, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4282/4767 (89.8259%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4312/4767 (90.4552%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2927, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4198/4618 (90.9052%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4170/4618 (90.2988%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1323, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3639/4046 (89.9407%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3747/4046 (92.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9185, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4123/4625 (89.1459%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4065/4625 (87.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1005, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3257/3638 (89.5272%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3344/3638 (91.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9051, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3942/4416 (89.2663%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4018/4416 (90.9873%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0076, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4436/4874 (91.0135%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4381/4874 (89.8851%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1402, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3277/3646 (89.8793%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3345/3646 (91.7444%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9369, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4438/5063 (87.6555%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4389/5063 (86.6877%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1060, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3780/4126 (91.6142%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3797/4126 (92.0262%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8005, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4362/4934 (88.4070%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4354/4934 (88.2448%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2346, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4069/4511 (90.2017%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4093/4511 (90.7338%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1077, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4082/4518 (90.3497%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4141/4518 (91.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0113, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2982/3297 (90.4459%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3065/3297 (92.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8327, Accuracy: 5869/10000 (58.6900%)
time spent on training: 260.4155216217041
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.4523, Accuracy: 6556/10000 (65.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 9.4940, Accuracy: 89/9900 (0.8990%)
Done in 284.69077253341675 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4457/4885 (91.2385%), train_poison_data_count: 385
Global model norm: 44.216952812418285.
Norm before scaling: 44.21038734968712. Distance: 2.1084246719940327
Total norm for 4 adversaries is: 44.21038734968712. distance: 2.1084246719940327
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1665, Accuracy: 9484/9900 (95.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4832/5305 (91.0839%), train_poison_data_count: 415
Global model norm: 44.216952812418285.
Norm before scaling: 44.21217376010537. Distance: 2.213411490408596
Total norm for 4 adversaries is: 44.21217376010537. distance: 2.213411490408596
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1952, Accuracy: 9448/9900 (95.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4309/4717 (91.3504%), train_poison_data_count: 370
Global model norm: 44.216952812418285.
Norm before scaling: 44.20454718903362. Distance: 1.958083488543034
Total norm for 4 adversaries is: 44.20454718903362. distance: 1.958083488543034
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.2221, Accuracy: 9338/9900 (94.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4635/5066 (91.4923%), train_poison_data_count: 400
Global model norm: 44.216952812418285.
Norm before scaling: 44.2105171222725. Distance: 2.138823147653797
Total norm for 4 adversaries is: 44.2105171222725. distance: 2.138823147653797
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1317, Accuracy: 9586/9900 (96.8283%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5447/6124 (88.9451%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5368/6124 (87.6551%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1454, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4527/5025 (90.0896%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4560/5025 (90.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0218, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3170/3472 (91.3018%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3194/3472 (91.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8607, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4466/5037 (88.6639%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4480/5037 (88.9418%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1794, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5273/5582 (94.4643%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5227/5582 (93.6403%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0415, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4740/5116 (92.6505%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4722/5116 (92.2987%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8919, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4061/4518 (89.8849%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4165/4518 (92.1868%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0956, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4408/4928 (89.4481%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4455/4928 (90.4018%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0752, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4151/4558 (91.0706%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4142/4558 (90.8732%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1696, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3032/3297 (91.9624%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3074/3297 (93.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.7992, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3404/3756 (90.6283%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3494/3756 (93.0245%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8373, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4202/4651 (90.3462%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4228/4651 (90.9052%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1820, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4049/4441 (91.1732%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4099/4441 (92.2990%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0636, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3217/3638 (88.4277%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3317/3638 (91.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8937, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4156/4596 (90.4265%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4237/4596 (92.1889%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0479, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2948/3271 (90.1253%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2967/3271 (90.7062%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8563, Accuracy: 5784/10000 (57.8400%)
time spent on training: 257.6782958507538
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.4329, Accuracy: 6545/10000 (65.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 9.4541, Accuracy: 86/9900 (0.8687%)
Done in 281.9650909900665 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4465/4885 (91.4023%), train_poison_data_count: 385
Global model norm: 44.24422438693623.
Norm before scaling: 44.237965127181766. Distance: 2.1164114680600816
Total norm for 4 adversaries is: 44.237965127181766. distance: 2.1164114680600816
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0802, Accuracy: 9695/9900 (97.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4820/5305 (90.8577%), train_poison_data_count: 415
Global model norm: 44.24422438693623.
Norm before scaling: 44.236003149124755. Distance: 2.184683594305263
Total norm for 4 adversaries is: 44.236003149124755. distance: 2.184683594305263
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0856, Accuracy: 9679/9900 (97.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4333/4717 (91.8592%), train_poison_data_count: 370
Global model norm: 44.24422438693623.
Norm before scaling: 44.23341877940323. Distance: 1.947494263842537
Total norm for 4 adversaries is: 44.23341877940323. distance: 1.947494263842537
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.3717, Accuracy: 9028/9900 (91.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4613/5066 (91.0580%), train_poison_data_count: 400
Global model norm: 44.24422438693623.
Norm before scaling: 44.2382217507878. Distance: 2.138791712360295
Total norm for 4 adversaries is: 44.2382217507878. distance: 2.138791712360295
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2192, Accuracy: 9363/9900 (94.5758%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4608/4989 (92.3632%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4633/4989 (92.8643%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7844, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4046/4465 (90.6159%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4157/4465 (93.1019%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8713, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3965/4315 (91.8888%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4012/4315 (92.9780%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8767, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4298/4767 (90.1615%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4312/4767 (90.4552%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1054, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5611/6391 (87.7953%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5597/6391 (87.5763%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1630, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3293/3672 (89.6786%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3388/3672 (92.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9195, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3696/3969 (93.1217%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3645/3969 (91.8367%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0171, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3285/3590 (91.5042%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3180/3590 (88.5794%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1940, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5218/5902 (88.4107%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5080/5902 (86.0725%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.4080, Accuracy: 4981/10000 (49.8100%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3688/4013 (91.9013%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3765/4013 (93.8201%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7778, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4303/4804 (89.5712%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4169/4804 (86.7818%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2430, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3796/4175 (90.9222%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3746/4175 (89.7246%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0325, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3236/3616 (89.4912%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3268/3616 (90.3761%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0161, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4036/4361 (92.5476%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3948/4361 (90.5297%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9558, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4957/5424 (91.3901%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5053/5424 (93.1600%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2644, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3472/3837 (90.4874%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3578/3837 (93.2499%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8886, Accuracy: 5671/10000 (56.7100%)
time spent on training: 260.3937327861786
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.4519, Accuracy: 6552/10000 (65.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 9.9989, Accuracy: 42/9900 (0.4242%)
Done in 284.8269259929657 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4457/4885 (91.2385%), train_poison_data_count: 385
Global model norm: 44.27346851838511.
Norm before scaling: 44.268268154849785. Distance: 2.130174059852517
Total norm for 4 adversaries is: 44.268268154849785. distance: 2.130174059852517
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1820, Accuracy: 9490/9900 (95.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4814/5305 (90.7446%), train_poison_data_count: 415
Global model norm: 44.27346851838511.
Norm before scaling: 44.266387491226766. Distance: 2.1488761315377456
Total norm for 4 adversaries is: 44.266387491226766. distance: 2.1488761315377456
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2295, Accuracy: 9349/9900 (94.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4270/4717 (90.5236%), train_poison_data_count: 370
Global model norm: 44.27346851838511.
Norm before scaling: 44.264048959324064. Distance: 2.014283791186527
Total norm for 4 adversaries is: 44.264048959324064. distance: 2.014283791186527
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.3229, Accuracy: 9167/9900 (92.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4625/5066 (91.2949%), train_poison_data_count: 400
Global model norm: 44.27346851838511.
Norm before scaling: 44.26864179624641. Distance: 2.1437820209747516
Total norm for 4 adversaries is: 44.26864179624641. distance: 2.1437820209747516
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2495, Accuracy: 9283/9900 (93.7677%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3940/4416 (89.2210%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3998/4416 (90.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9254, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5243/5740 (91.3415%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5277/5740 (91.9338%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1637, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4510/5037 (89.5374%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4578/5037 (90.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0380, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4730/5116 (92.4550%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4691/5116 (91.6927%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9174, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4403/4918 (89.5283%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4453/4918 (90.5449%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0533, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3483/3837 (90.7740%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3554/3837 (92.6244%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9170, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4215/4651 (90.6257%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4204/4651 (90.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9690, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3430/3861 (88.8371%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3460/3861 (89.6141%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0288, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3839/4223 (90.9069%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3939/4223 (93.2749%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8827, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4237/4662 (90.8837%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4314/4662 (92.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9689, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5839/6263 (93.2301%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5857/6263 (93.5175%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9587, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3444/3781 (91.0870%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3160/3781 (83.5758%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.3183, Accuracy: 5012/10000 (50.1200%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3408/3804 (89.5899%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3532/3804 (92.8496%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8724, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3486/3828 (91.0658%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3563/3828 (93.0773%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9785, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3946/4315 (91.4484%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3995/4315 (92.5840%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8282, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4419/4956 (89.1646%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4476/4956 (90.3148%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0977, Accuracy: 5388/10000 (53.8800%)
time spent on training: 263.02351355552673
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.4235, Accuracy: 6589/10000 (65.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 9.5830, Accuracy: 77/9900 (0.7778%)
Done in 287.65608406066895 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4459/4885 (91.2794%), train_poison_data_count: 385
Global model norm: 44.29939091179754.
Norm before scaling: 44.29113857257101. Distance: 2.0697672575797785
Total norm for 4 adversaries is: 44.29113857257101. distance: 2.0697672575797785
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1146, Accuracy: 9604/9900 (97.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4809/5305 (90.6503%), train_poison_data_count: 415
Global model norm: 44.29939091179754.
Norm before scaling: 44.29392213482497. Distance: 2.2162763749138374
Total norm for 4 adversaries is: 44.29392213482497. distance: 2.2162763749138374
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.2840, Accuracy: 9209/9900 (93.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4291/4717 (90.9688%), train_poison_data_count: 370
Global model norm: 44.29939091179754.
Norm before scaling: 44.29015050370257. Distance: 1.9973777627604148
Total norm for 4 adversaries is: 44.29015050370257. distance: 1.9973777627604148
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.2380, Accuracy: 9343/9900 (94.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4636/5066 (91.5120%), train_poison_data_count: 400
Global model norm: 44.29939091179754.
Norm before scaling: 44.29146103379084. Distance: 2.1166207656489084
Total norm for 4 adversaries is: 44.29146103379084. distance: 2.1166207656489084
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1373, Accuracy: 9528/9900 (96.2424%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4228/4662 (90.6907%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4334/4662 (92.9644%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8614, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3224/3616 (89.1593%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3330/3616 (92.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8785, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3461/3828 (90.4127%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3572/3828 (93.3124%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8453, Accuracy: 5867/10000 (58.6700%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3021/3297 (91.6288%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3080/3297 (93.4183%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7745, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4019/4361 (92.1578%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3938/4361 (90.3004%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9577, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4127/4576 (90.1879%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4192/4576 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9520, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3984/4295 (92.7590%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3897/4295 (90.7334%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8670, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4652/5083 (91.5208%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4644/5083 (91.3634%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0186, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4742/5116 (92.6896%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4728/5116 (92.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8813, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3667/4046 (90.6327%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3715/4046 (91.8191%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8599, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5199/5902 (88.0888%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5035/5902 (85.3101%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0243, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4817/5197 (92.6881%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4701/5197 (90.4560%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9413, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4099/4465 (91.8029%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4205/4465 (94.1769%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8329, Accuracy: 5888/10000 (58.8800%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3309/3704 (89.3359%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3400/3704 (91.7927%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9338, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3556/3861 (92.1005%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3591/3861 (93.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8951, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3753/4126 (90.9598%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3792/4126 (91.9050%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8801, Accuracy: 5678/10000 (56.7800%)
time spent on training: 257.3955843448639
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.4436, Accuracy: 6568/10000 (65.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 9.7680, Accuracy: 74/9900 (0.7475%)
Done in 281.6545524597168 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4484/4885 (91.7912%), train_poison_data_count: 385
Global model norm: 44.328871270595194.
Norm before scaling: 44.32377379948739. Distance: 2.0810297119131276
Total norm for 4 adversaries is: 44.32377379948739. distance: 2.0810297119131276
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.5080, Accuracy: 8718/9900 (88.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4835/5305 (91.1404%), train_poison_data_count: 415
Global model norm: 44.328871270595194.
Norm before scaling: 44.320552809810344. Distance: 2.179514013243168
Total norm for 4 adversaries is: 44.320552809810344. distance: 2.179514013243168
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0786, Accuracy: 9682/9900 (97.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4316/4717 (91.4988%), train_poison_data_count: 370
Global model norm: 44.328871270595194.
Norm before scaling: 44.31465003819631. Distance: 1.9898617800916798
Total norm for 4 adversaries is: 44.31465003819631. distance: 1.9898617800916798
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1460, Accuracy: 9501/9900 (95.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4586/5066 (90.5251%), train_poison_data_count: 400
Global model norm: 44.328871270595194.
Norm before scaling: 44.323638850364034. Distance: 2.1819481287174485
Total norm for 4 adversaries is: 44.323638850364034. distance: 2.1819481287174485
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1802, Accuracy: 9453/9900 (95.4848%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4030/4511 (89.3372%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4099/4511 (90.8668%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9120, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5228/5740 (91.0801%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5306/5740 (92.4390%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0605, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4251/4662 (91.1840%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4320/4662 (92.6641%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9170, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3920/4235 (92.5620%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3912/4235 (92.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0302, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4686/5265 (89.0028%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4701/5265 (89.2877%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0232, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4085/4433 (92.1498%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4042/4433 (91.1798%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9426, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4205/4596 (91.4926%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4255/4596 (92.5805%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0040, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4604/5055 (91.0781%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4622/5055 (91.4342%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9198, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4513/5037 (89.5970%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4549/5037 (90.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1743, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4188/4538 (92.2874%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4253/4538 (93.7197%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8987, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3425/3756 (91.1874%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3502/3756 (93.2375%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9417, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3694/4025 (91.7764%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3799/4025 (94.3851%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8876, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4618/5244 (88.0625%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4598/5244 (87.6812%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9310, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4276/4663 (91.7006%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4378/4663 (93.8881%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9251, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3502/3837 (91.2692%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3537/3837 (92.1814%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0685, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4020/4481 (89.7121%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3937/4481 (87.8599%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1775, Accuracy: 5403/10000 (54.0300%)
time spent on training: 262.61489272117615
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.4398, Accuracy: 6570/10000 (65.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 9.8599, Accuracy: 78/9900 (0.7879%)
Done in 287.0916347503662 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4480/4885 (91.7093%), train_poison_data_count: 385
Global model norm: 44.35669324184978.
Norm before scaling: 44.348737827304625. Distance: 2.0798358041804823
Total norm for 4 adversaries is: 44.348737827304625. distance: 2.0798358041804823
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1988, Accuracy: 9390/9900 (94.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 44.35669324184978.
Norm before scaling: 44.3505448128353. Distance: 2.1931065237854748
Total norm for 4 adversaries is: 44.3505448128353. distance: 2.1931065237854748
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.4225, Accuracy: 8884/9900 (89.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 44.35669324184978.
Norm before scaling: 44.348703420925254. Distance: 2.043164099841076
Total norm for 4 adversaries is: 44.348703420925254. distance: 2.043164099841076
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.3580, Accuracy: 9058/9900 (91.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4582/5066 (90.4461%), train_poison_data_count: 400
Global model norm: 44.35669324184978.
Norm before scaling: 44.35337693906111. Distance: 2.206490293390261
Total norm for 4 adversaries is: 44.35337693906111. distance: 2.206490293390261
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1272, Accuracy: 9563/9900 (96.5960%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4042/4362 (92.6639%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4024/4362 (92.2513%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9748, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5038/5591 (90.1091%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4990/5591 (89.2506%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1495, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3952/4315 (91.5875%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3967/4315 (91.9351%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8517, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3504/3781 (92.6739%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3357/3781 (88.7860%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8527, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3761/4158 (90.4521%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3770/4158 (90.6686%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9075, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4036/4511 (89.4702%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4122/4511 (91.3766%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8708, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4380/4793 (91.3833%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4417/4793 (92.1552%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9182, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4952/5424 (91.2979%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4938/5424 (91.0398%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1050, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4215/4618 (91.2733%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4142/4618 (89.6925%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0970, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3934/4368 (90.0641%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3956/4368 (90.5678%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0588, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4349/4934 (88.1435%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4181/4934 (84.7385%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1272, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4764/5232 (91.0550%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4777/5232 (91.3035%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1339, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5208/5902 (88.2413%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5054/5902 (85.6320%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0972, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5113/5392 (94.8257%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5054/5392 (93.7315%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8664, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4627/5017 (92.2264%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4641/5017 (92.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8898, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4688/5195 (90.2406%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4715/5195 (90.7603%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9711, Accuracy: 5647/10000 (56.4700%)
time spent on training: 266.2942543029785
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.4676, Accuracy: 6553/10000 (65.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 10.3568, Accuracy: 47/9900 (0.4747%)
Done in 290.54141902923584 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4468/4885 (91.4637%), train_poison_data_count: 385
Global model norm: 44.391521462260954.
Norm before scaling: 44.38393258466049. Distance: 2.0786251527475477
Total norm for 4 adversaries is: 44.38393258466049. distance: 2.0786251527475477
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1383, Accuracy: 9553/9900 (96.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4837/5305 (91.1781%), train_poison_data_count: 415
Global model norm: 44.391521462260954.
Norm before scaling: 44.38176802480736. Distance: 2.18322794516722
Total norm for 4 adversaries is: 44.38176802480736. distance: 2.18322794516722
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2217, Accuracy: 9377/9900 (94.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4275/4717 (90.6296%), train_poison_data_count: 370
Global model norm: 44.391521462260954.
Norm before scaling: 44.38335913785002. Distance: 2.028556563862119
Total norm for 4 adversaries is: 44.38335913785002. distance: 2.028556563862119
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2859, Accuracy: 9199/9900 (92.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4554/5066 (89.8934%), train_poison_data_count: 400
Global model norm: 44.391521462260954.
Norm before scaling: 44.387329108108794. Distance: 2.2519199868482778
Total norm for 4 adversaries is: 44.387329108108794. distance: 2.2519199868482778
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1500, Accuracy: 9489/9900 (95.8485%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4727/5265 (89.7816%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4693/5265 (89.1358%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0921, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3716/4126 (90.0630%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3859/4126 (93.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8101, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4056/4501 (90.1133%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4078/4501 (90.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8541, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5411/6124 (88.3573%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5406/6124 (88.2756%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1504, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2966/3271 (90.6756%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3036/3271 (92.8157%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0408, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4237/4663 (90.8643%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4310/4663 (92.4298%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9808, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3673/4025 (91.2547%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3747/4025 (93.0932%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8706, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4161/4651 (89.4646%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4232/4651 (90.9912%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1880, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4345/4804 (90.4455%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0121, Accuracy: 3741/4804 (77.8726%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.3433, Accuracy: 4931/10000 (49.3100%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3260/3616 (90.1549%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3364/3616 (93.0310%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7969, Accuracy: 5885/10000 (58.8500%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3661/3911 (93.6078%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3541/3911 (90.5395%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9626, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4754/5197 (91.4759%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4700/5197 (90.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0893, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4182/4538 (92.1551%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4244/4538 (93.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8476, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5623/6391 (87.9831%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5568/6391 (87.1225%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1370, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3342/3704 (90.2268%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3433/3704 (92.6836%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8137, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3941/4235 (93.0579%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3856/4235 (91.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9789, Accuracy: 5575/10000 (55.7500%)
time spent on training: 261.35917353630066
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.4864, Accuracy: 6558/10000 (65.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 9.9579, Accuracy: 72/9900 (0.7273%)
Done in 285.8435091972351 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4498/4885 (92.0778%), train_poison_data_count: 385
Global model norm: 44.425265874802314.
Norm before scaling: 44.41254188799741. Distance: 2.0078949076443324
Total norm for 4 adversaries is: 44.41254188799741. distance: 2.0078949076443324
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.2425, Accuracy: 9305/9900 (93.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4816/5305 (90.7823%), train_poison_data_count: 415
Global model norm: 44.425265874802314.
Norm before scaling: 44.418145838018724. Distance: 2.1908450028418374
Total norm for 4 adversaries is: 44.418145838018724. distance: 2.1908450028418374
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1807, Accuracy: 9455/9900 (95.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4304/4717 (91.2444%), train_poison_data_count: 370
Global model norm: 44.425265874802314.
Norm before scaling: 44.41512408032102. Distance: 2.0071651142362166
Total norm for 4 adversaries is: 44.41512408032102. distance: 2.0071651142362166
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0841, Accuracy: 9696/9900 (97.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4599/5066 (90.7817%), train_poison_data_count: 400
Global model norm: 44.425265874802314.
Norm before scaling: 44.4181472121228. Distance: 2.1640743985176054
Total norm for 4 adversaries is: 44.4181472121228. distance: 2.1640743985176054
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.2010, Accuracy: 9392/9900 (94.8687%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4720/5116 (92.2596%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4708/5116 (92.0250%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0117, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5271/5582 (94.4285%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0028, Accuracy: 5290/5582 (94.7689%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0646, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3913/4235 (92.3967%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3888/4235 (91.8064%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9515, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4090/4625 (88.4324%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4059/4625 (87.7622%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1932, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4001/4481 (89.2881%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4035/4481 (90.0469%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9849, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4768/5232 (91.1315%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4740/5232 (90.5963%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0085, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4227/4662 (90.6692%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4325/4662 (92.7713%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8475, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4063/4441 (91.4884%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4120/4441 (92.7719%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0848, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4114/4518 (91.0580%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4200/4518 (92.9615%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9500, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4556/4928 (92.4513%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4563/4928 (92.5933%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9021, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4228/4634 (91.2387%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4251/4634 (91.7350%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9433, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4378/4934 (88.7313%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4307/4934 (87.2923%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2133, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3560/3861 (92.2041%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3552/3861 (91.9969%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9816, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3272/3616 (90.4867%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3331/3616 (92.1184%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.7910, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3974/4416 (89.9909%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4044/4416 (91.5761%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8587, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3466/3797 (91.2826%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3481/3797 (91.6776%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0606, Accuracy: 5529/10000 (55.2900%)
time spent on training: 263.6988105773926
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.5245, Accuracy: 6472/10000 (64.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 10.5135, Accuracy: 37/9900 (0.3737%)
Done in 288.23945021629333 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4472/4885 (91.5455%), train_poison_data_count: 385
Global model norm: 44.449804906770964.
Norm before scaling: 44.44053534376724. Distance: 2.102887158031563
Total norm for 4 adversaries is: 44.44053534376724. distance: 2.102887158031563
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.2363, Accuracy: 9293/9900 (93.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4836/5305 (91.1593%), train_poison_data_count: 415
Global model norm: 44.449804906770964.
Norm before scaling: 44.4408622145768. Distance: 2.162180719344303
Total norm for 4 adversaries is: 44.4408622145768. distance: 2.162180719344303
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1281, Accuracy: 9582/9900 (96.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4297/4717 (91.0960%), train_poison_data_count: 370
Global model norm: 44.449804906770964.
Norm before scaling: 44.43880755811861. Distance: 1.9976315183156625
Total norm for 4 adversaries is: 44.43880755811861. distance: 1.9976315183156625
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1882, Accuracy: 9453/9900 (95.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4588/5066 (90.5645%), train_poison_data_count: 400
Global model norm: 44.449804906770964.
Norm before scaling: 44.44267781455259. Distance: 2.1940569019015297
Total norm for 4 adversaries is: 44.44267781455259. distance: 2.1940569019015297
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.2065, Accuracy: 9384/9900 (94.7879%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5850/6263 (93.4057%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5856/6263 (93.5015%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9772, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3970/4295 (92.4331%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3784/4295 (88.1024%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1319, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4593/4989 (92.0625%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4588/4989 (91.9623%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8390, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3854/4223 (91.2621%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3874/4223 (91.7357%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9242, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5382/6124 (87.8837%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5442/6124 (88.8635%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0052, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4018/4481 (89.6675%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3925/4481 (87.5921%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1479, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4248/4618 (91.9879%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4183/4618 (90.5803%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1454, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4072/4441 (91.6911%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4077/4441 (91.8036%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1491, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3671/4013 (91.4777%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3786/4013 (94.3434%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8181, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4068/4511 (90.1796%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4122/4511 (91.3766%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9237, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3919/4416 (88.7455%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4015/4416 (90.9194%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9782, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4470/4956 (90.1937%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4513/4956 (91.0613%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0402, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4222/4538 (93.0366%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4256/4538 (93.7858%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8574, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4835/5265 (91.8329%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4838/5265 (91.8898%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9176, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4781/5197 (91.9954%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4745/5197 (91.3027%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9517, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4262/4716 (90.3732%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4257/4716 (90.2672%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0328, Accuracy: 5443/10000 (54.4300%)
time spent on training: 265.9380910396576
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.4854, Accuracy: 6504/10000 (65.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 10.2327, Accuracy: 54/9900 (0.5455%)
Done in 290.81595826148987 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4489/4885 (91.8936%), train_poison_data_count: 385
Global model norm: 44.47907991184943.
Norm before scaling: 44.468336863418195. Distance: 2.0439255991867675
Total norm for 4 adversaries is: 44.468336863418195. distance: 2.0439255991867675
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1656, Accuracy: 9492/9900 (95.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4814/5305 (90.7446%), train_poison_data_count: 415
Global model norm: 44.47907991184943.
Norm before scaling: 44.47183948113612. Distance: 2.219490787254097
Total norm for 4 adversaries is: 44.47183948113612. distance: 2.219490787254097
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1267, Accuracy: 9579/9900 (96.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4303/4717 (91.2232%), train_poison_data_count: 370
Global model norm: 44.47907991184943.
Norm before scaling: 44.466917620803365. Distance: 1.9617228967887896
Total norm for 4 adversaries is: 44.466917620803365. distance: 1.9617228967887896
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.4240, Accuracy: 8953/9900 (90.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4614/5066 (91.0778%), train_poison_data_count: 400
Global model norm: 44.47907991184943.
Norm before scaling: 44.47294703050524. Distance: 2.1394081833963114
Total norm for 4 adversaries is: 44.47294703050524. distance: 2.1394081833963114
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1865, Accuracy: 9428/9900 (95.2323%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3253/3616 (89.9613%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3337/3616 (92.2843%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9088, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3937/4315 (91.2399%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4010/4315 (92.9316%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8900, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4891/5455 (89.6609%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4908/5455 (89.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0532, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4320/4804 (89.9251%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4187/4804 (87.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.3169, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4051/4362 (92.8702%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4008/4362 (91.8845%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9335, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5846/6263 (93.3418%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5822/6263 (92.9586%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9408, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4181/4538 (92.1331%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4249/4538 (93.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0209, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4225/4634 (91.1739%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4240/4634 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9575, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4765/5116 (93.1392%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4769/5116 (93.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8690, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4265/4716 (90.4368%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4318/4716 (91.5606%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9929, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3655/4046 (90.3361%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3717/4046 (91.8685%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8875, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4136/4518 (91.5449%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4217/4518 (93.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9440, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4525/5063 (89.3739%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4500/5063 (88.8801%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0299, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5331/5740 (92.8746%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5280/5740 (91.9861%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1808, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5225/5582 (93.6044%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5175/5582 (92.7087%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9326, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4032/4433 (90.9542%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4036/4433 (91.0444%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9346, Accuracy: 5711/10000 (57.1100%)
time spent on training: 266.85797119140625
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.4925, Accuracy: 6468/10000 (64.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 10.0168, Accuracy: 53/9900 (0.5354%)
Done in 291.20970153808594 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4495/4885 (92.0164%), train_poison_data_count: 385
Global model norm: 44.50308456874436.
Norm before scaling: 44.4921703522794. Distance: 2.0957876510141267
Total norm for 4 adversaries is: 44.4921703522794. distance: 2.0957876510141267
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1811, Accuracy: 9444/9900 (95.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4842/5305 (91.2724%), train_poison_data_count: 415
Global model norm: 44.50308456874436.
Norm before scaling: 44.494705399561305. Distance: 2.1722382166285295
Total norm for 4 adversaries is: 44.494705399561305. distance: 2.1722382166285295
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1775, Accuracy: 9443/9900 (95.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4276/4717 (90.6508%), train_poison_data_count: 370
Global model norm: 44.50308456874436.
Norm before scaling: 44.49458194281215. Distance: 2.0573781313210358
Total norm for 4 adversaries is: 44.49458194281215. distance: 2.0573781313210358
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1786, Accuracy: 9448/9900 (95.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4594/5066 (90.6830%), train_poison_data_count: 400
Global model norm: 44.50308456874436.
Norm before scaling: 44.493040076335255. Distance: 2.1557033785813395
Total norm for 4 adversaries is: 44.493040076335255. distance: 2.1557033785813395
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.3077, Accuracy: 9134/9900 (92.2626%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4748/5197 (91.3604%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4664/5197 (89.7441%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0925, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3676/4025 (91.3292%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3780/4025 (93.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8316, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3955/4481 (88.2615%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3957/4481 (88.3062%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1791, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4211/4651 (90.5397%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4238/4651 (91.1202%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9324, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5221/5902 (88.4615%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5162/5902 (87.4619%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0288, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3728/4126 (90.3539%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3813/4126 (92.4140%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8160, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3953/4368 (90.4991%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3987/4368 (91.2775%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0471, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5681/6391 (88.8906%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5629/6391 (88.0770%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1416, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3813/4175 (91.3293%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3838/4175 (91.9281%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8807, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4261/4596 (92.7111%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4296/4596 (93.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7503, Accuracy: 5964/10000 (59.6400%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4211/4634 (90.8718%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4276/4634 (92.2745%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9625, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3814/4223 (90.3149%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3886/4223 (92.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8948, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3629/3911 (92.7896%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3576/3911 (91.4344%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9213, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4072/4433 (91.8565%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4074/4433 (91.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9319, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3898/4336 (89.8985%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3952/4336 (91.1439%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0903, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3294/3638 (90.5443%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3331/3638 (91.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9334, Accuracy: 5551/10000 (55.5100%)
time spent on training: 259.80800461769104
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.5860, Accuracy: 6277/10000 (62.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 9.8457, Accuracy: 53/9900 (0.5354%)
Done in 284.2896001338959 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4483/4885 (91.7707%), train_poison_data_count: 385
Global model norm: 44.526218191592605.
Norm before scaling: 44.51974357921859. Distance: 2.075526168478152
Total norm for 4 adversaries is: 44.51974357921859. distance: 2.075526168478152
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2241, Accuracy: 9367/9900 (94.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4822/5305 (90.8954%), train_poison_data_count: 415
Global model norm: 44.526218191592605.
Norm before scaling: 44.5203317207255. Distance: 2.2190239965474503
Total norm for 4 adversaries is: 44.5203317207255. distance: 2.2190239965474503
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2897, Accuracy: 9187/9900 (92.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4300/4717 (91.1596%), train_poison_data_count: 370
Global model norm: 44.526218191592605.
Norm before scaling: 44.516373611641484. Distance: 2.0345092447876625
Total norm for 4 adversaries is: 44.516373611641484. distance: 2.0345092447876625
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1179, Accuracy: 9602/9900 (96.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4606/5066 (90.9199%), train_poison_data_count: 400
Global model norm: 44.526218191592605.
Norm before scaling: 44.51721955506726. Distance: 2.14731138366942
Total norm for 4 adversaries is: 44.51721955506726. distance: 2.14731138366942
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1716, Accuracy: 9484/9900 (95.7980%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3449/3756 (91.8264%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3494/3756 (93.0245%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8958, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4945/5424 (91.1689%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5028/5424 (92.6991%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0586, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4063/4433 (91.6535%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4062/4433 (91.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8285, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4086/4501 (90.7798%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4068/4501 (90.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9906, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3692/4025 (91.7267%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3727/4025 (92.5963%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9311, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3964/4235 (93.6009%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3926/4235 (92.7037%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9628, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5441/6124 (88.8472%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5422/6124 (88.5369%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0303, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4221/4634 (91.0876%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4262/4634 (91.9724%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8462, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4234/4716 (89.7795%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4239/4716 (89.8855%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0970, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4357/4767 (91.3992%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4406/4767 (92.4271%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8959, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3417/3804 (89.8265%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3525/3804 (92.6656%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0391, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3185/3472 (91.7339%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3189/3472 (91.8491%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8906, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5101/5392 (94.6031%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4994/5392 (92.6187%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0512, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5245/5740 (91.3763%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5251/5740 (91.4808%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1051, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4191/4596 (91.1880%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4296/4596 (93.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9748, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3244/3616 (89.7124%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3320/3616 (91.8142%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8980, Accuracy: 5700/10000 (57.0000%)
time spent on training: 256.9088318347931
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.5722, Accuracy: 6321/10000 (63.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 9.7527, Accuracy: 63/9900 (0.6364%)
Done in 281.3473927974701 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4484/4885 (91.7912%), train_poison_data_count: 385
Global model norm: 44.55264151777016.
Norm before scaling: 44.541557195307085. Distance: 2.062814052831432
Total norm for 4 adversaries is: 44.541557195307085. distance: 2.062814052831432
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1100, Accuracy: 9610/9900 (97.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 44.55264151777016.
Norm before scaling: 44.54714080506458. Distance: 2.231194105970901
Total norm for 4 adversaries is: 44.54714080506458. distance: 2.231194105970901
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1767, Accuracy: 9452/9900 (95.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4313/4717 (91.4352%), train_poison_data_count: 370
Global model norm: 44.55264151777016.
Norm before scaling: 44.54280003722543. Distance: 2.008542414290742
Total norm for 4 adversaries is: 44.54280003722543. distance: 2.008542414290742
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1751, Accuracy: 9455/9900 (95.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4605/5066 (90.9001%), train_poison_data_count: 400
Global model norm: 44.55264151777016.
Norm before scaling: 44.54589945441808. Distance: 2.151998004040271
Total norm for 4 adversaries is: 44.54589945441808. distance: 2.151998004040271
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.3215, Accuracy: 9131/9900 (92.2323%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4523/5063 (89.3344%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4521/5063 (89.2949%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1726, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4379/4804 (91.1532%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4449/4804 (92.6103%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1416, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4175/4558 (91.5972%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4190/4558 (91.9263%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1982, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3455/3756 (91.9862%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3502/3756 (93.2375%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8438, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5043/5424 (92.9757%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5076/5424 (93.5841%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3851, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4064/4511 (90.0909%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4135/4511 (91.6648%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8989, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4673/5167 (90.4393%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4692/5167 (90.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2266, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3990/4356 (91.5978%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4067/4356 (93.3655%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0234, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4615/5244 (88.0053%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4576/5244 (87.2616%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0537, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4378/4793 (91.3415%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4461/4793 (93.0732%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9564, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3450/3828 (90.1254%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3541/3828 (92.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9678, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3676/4046 (90.8552%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3687/4046 (91.1270%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9227, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3661/4013 (91.2285%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3746/4013 (93.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8692, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2927/3271 (89.4833%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0044, Accuracy: 2981/3271 (91.1342%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9659, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4133/4362 (94.7501%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4072/4362 (93.3517%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0069, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3993/4346 (91.8776%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4084/4346 (93.9715%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8615, Accuracy: 5827/10000 (58.2700%)
time spent on training: 258.14892768859863
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.6060, Accuracy: 6260/10000 (62.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 9.6095, Accuracy: 79/9900 (0.7980%)
Done in 282.470148563385 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4492/4885 (91.9550%), train_poison_data_count: 385
Global model norm: 44.57903001403449.
Norm before scaling: 44.568904036685154. Distance: 2.028531999703732
Total norm for 4 adversaries is: 44.568904036685154. distance: 2.028531999703732
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.4988, Accuracy: 8687/9900 (87.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4832/5305 (91.0839%), train_poison_data_count: 415
Global model norm: 44.57903001403449.
Norm before scaling: 44.57235356303768. Distance: 2.2016547958704704
Total norm for 4 adversaries is: 44.57235356303768. distance: 2.2016547958704704
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1620, Accuracy: 9530/9900 (96.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4315/4717 (91.4776%), train_poison_data_count: 370
Global model norm: 44.57903001403449.
Norm before scaling: 44.56800977289863. Distance: 1.9649375453274218
Total norm for 4 adversaries is: 44.56800977289863. distance: 1.9649375453274218
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1264, Accuracy: 9602/9900 (96.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4606/5066 (90.9199%), train_poison_data_count: 400
Global model norm: 44.57903001403449.
Norm before scaling: 44.57230837446188. Distance: 2.1420964662002997
Total norm for 4 adversaries is: 44.57230837446188. distance: 2.1420964662002997
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.2453, Accuracy: 9306/9900 (94.0000%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3778/4126 (91.5657%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3822/4126 (92.6321%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8847, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4963/5455 (90.9808%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4962/5455 (90.9624%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9988, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4232/4558 (92.8477%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4179/4558 (91.6849%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0429, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3995/4235 (94.3329%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3977/4235 (93.9079%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9238, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3447/3804 (90.6151%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3514/3804 (92.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9832, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5585/6391 (87.3885%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5595/6391 (87.5450%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2228, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3932/4336 (90.6827%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3968/4336 (91.5129%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0009, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4286/4663 (91.9151%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4332/4663 (92.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9115, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4064/4511 (90.0909%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4071/4511 (90.2461%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9706, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4147/4503 (92.0942%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4176/4503 (92.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0085, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4514/5063 (89.1566%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4490/5063 (88.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2658, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3973/4315 (92.0742%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3997/4315 (92.6304%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9484, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3279/3638 (90.1319%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3338/3638 (91.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9873, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4083/4441 (91.9388%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4148/4441 (93.4024%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9436, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4389/4679 (93.8021%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4431/4679 (94.6997%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8663, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4844/5265 (92.0038%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4771/5265 (90.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0661, Accuracy: 5447/10000 (54.4700%)
time spent on training: 262.8132426738739
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.6154, Accuracy: 6261/10000 (62.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 9.5864, Accuracy: 83/9900 (0.8384%)
Done in 287.05723571777344 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4486/4885 (91.8321%), train_poison_data_count: 385
Global model norm: 44.603383189979965.
Norm before scaling: 44.59209658812871. Distance: 2.0924323191572785
Total norm for 4 adversaries is: 44.59209658812871. distance: 2.0924323191572785
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1444, Accuracy: 9541/9900 (96.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4828/5305 (91.0085%), train_poison_data_count: 415
Global model norm: 44.603383189979965.
Norm before scaling: 44.59793800411349. Distance: 2.2375413560508424
Total norm for 4 adversaries is: 44.59793800411349. distance: 2.2375413560508424
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.2289, Accuracy: 9317/9900 (94.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4283/4717 (90.7992%), train_poison_data_count: 370
Global model norm: 44.603383189979965.
Norm before scaling: 44.593342127602135. Distance: 2.042224639111236
Total norm for 4 adversaries is: 44.593342127602135. distance: 2.042224639111236
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1994, Accuracy: 9404/9900 (94.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4625/5066 (91.2949%), train_poison_data_count: 400
Global model norm: 44.603383189979965.
Norm before scaling: 44.59628611612813. Distance: 2.1582717263206246
Total norm for 4 adversaries is: 44.59628611612813. distance: 2.1582717263206246
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1333, Accuracy: 9568/9900 (96.6465%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3914/4336 (90.2675%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4014/4336 (92.5738%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8984, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3505/3828 (91.5622%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3537/3828 (92.3981%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8196, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3322/3672 (90.4684%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3417/3672 (93.0556%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9116, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4216/4651 (90.6472%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4262/4651 (91.6362%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9494, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4034/4361 (92.5017%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3899/4361 (89.4061%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9652, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4578/5025 (91.1045%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4651/5025 (92.5572%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9521, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5390/6124 (88.0144%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5419/6124 (88.4879%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1597, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3349/3704 (90.4158%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3411/3704 (92.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9330, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4412/4934 (89.4203%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4176/4934 (84.6372%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2739, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4572/5017 (91.1302%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4666/5017 (93.0038%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8203, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5265/5582 (94.3210%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5218/5582 (93.4790%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9656, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4657/5167 (90.1297%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4678/5167 (90.5361%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1772, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3579/3861 (92.6962%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3613/3861 (93.5768%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7978, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3301/3646 (90.5376%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3353/3646 (91.9638%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7743, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4232/4558 (92.8477%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4153/4558 (91.1145%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0590, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4749/5116 (92.8264%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4712/5116 (92.1032%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9684, Accuracy: 5555/10000 (55.5500%)
time spent on training: 262.16252970695496
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.6841, Accuracy: 6156/10000 (61.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 9.3611, Accuracy: 95/9900 (0.9596%)
Done in 286.50399589538574 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4507/4885 (92.2620%), train_poison_data_count: 385
Global model norm: 44.63104360992399.
Norm before scaling: 44.6245459098045. Distance: 2.0772447370939284
Total norm for 4 adversaries is: 44.6245459098045. distance: 2.0772447370939284
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.2377, Accuracy: 9296/9900 (93.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4839/5305 (91.2158%), train_poison_data_count: 415
Global model norm: 44.63104360992399.
Norm before scaling: 44.621025186249085. Distance: 2.200111546722957
Total norm for 4 adversaries is: 44.621025186249085. distance: 2.200111546722957
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.2714, Accuracy: 9240/9900 (93.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4291/4717 (90.9688%), train_poison_data_count: 370
Global model norm: 44.63104360992399.
Norm before scaling: 44.62243405613089. Distance: 2.024468236732927
Total norm for 4 adversaries is: 44.62243405613089. distance: 2.024468236732927
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1384, Accuracy: 9547/9900 (96.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4621/5066 (91.2159%), train_poison_data_count: 400
Global model norm: 44.63104360992399.
Norm before scaling: 44.62135757412377. Distance: 2.141701977311302
Total norm for 4 adversaries is: 44.62135757412377. distance: 2.141701977311302
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1980, Accuracy: 9441/9900 (95.3636%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4156/4511 (92.1303%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4217/4511 (93.4826%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9248, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4008/4346 (92.2227%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4061/4346 (93.4422%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8718, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4370/4804 (90.9659%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4174/4804 (86.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1032, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4718/5232 (90.1758%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4684/5232 (89.5260%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1789, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4236/4618 (91.7280%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4182/4618 (90.5587%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0537, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3301/3590 (91.9499%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3331/3590 (92.7855%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9705, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5638/6391 (88.2178%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5699/6391 (89.1723%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1963, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3913/4354 (89.8714%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0102, Accuracy: 3577/4354 (82.1543%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.4923, Accuracy: 4647/10000 (46.4700%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4576/5055 (90.5242%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4658/5055 (92.1464%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0384, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3489/3837 (90.9304%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3535/3837 (92.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8180, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4165/4503 (92.4939%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4109/4503 (91.2503%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0338, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4183/4576 (91.4117%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4207/4576 (91.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9403, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4399/4793 (91.7797%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4461/4793 (93.0732%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8927, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4200/4634 (90.6344%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4278/4634 (92.3177%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7103, Accuracy: 5929/10000 (59.2900%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3717/4158 (89.3939%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3767/4158 (90.5964%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9350, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5257/5740 (91.5854%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5196/5740 (90.5226%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1850, Accuracy: 5355/10000 (53.5500%)
time spent on training: 262.81861424446106
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7285, Accuracy: 6116/10000 (61.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 9.5037, Accuracy: 103/9900 (1.0404%)
Done in 287.424320936203 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4492/4885 (91.9550%), train_poison_data_count: 385
Global model norm: 44.66457289917396.
Norm before scaling: 44.65432280218652. Distance: 2.0687783368984842
Total norm for 4 adversaries is: 44.65432280218652. distance: 2.0687783368984842
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1984, Accuracy: 9412/9900 (95.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 44.66457289917396.
Norm before scaling: 44.653450752013555. Distance: 2.201578774537578
Total norm for 4 adversaries is: 44.653450752013555. distance: 2.201578774537578
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1137, Accuracy: 9626/9900 (97.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4339/4717 (91.9864%), train_poison_data_count: 370
Global model norm: 44.66457289917396.
Norm before scaling: 44.65156444102771. Distance: 1.9510366643083528
Total norm for 4 adversaries is: 44.65156444102771. distance: 1.9510366643083528
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2545, Accuracy: 9270/9900 (93.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4615/5066 (91.0975%), train_poison_data_count: 400
Global model norm: 44.66457289917396.
Norm before scaling: 44.6577889649093. Distance: 2.15865181103771
Total norm for 4 adversaries is: 44.6577889649093. distance: 2.15865181103771
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1267, Accuracy: 9574/9900 (96.7071%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3811/4184 (91.0851%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3837/4184 (91.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9445, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5860/6263 (93.5654%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5751/6263 (91.8250%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0139, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4035/4456 (90.5521%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4126/4456 (92.5943%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9480, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4212/4538 (92.8162%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4202/4538 (92.5959%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8799, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3995/4235 (94.3329%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3979/4235 (93.9551%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9324, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3857/4223 (91.3332%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3948/4223 (93.4880%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9137, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4899/5455 (89.8075%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4872/5455 (89.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0293, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4539/5037 (90.1132%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4656/5037 (92.4360%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9198, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3427/3756 (91.2407%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3543/3756 (94.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9218, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4802/5265 (91.2061%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4780/5265 (90.7882%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8613, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4599/5055 (90.9792%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4630/5055 (91.5925%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0717, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4369/4804 (90.9450%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3998/4804 (83.2223%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.5115, Accuracy: 4846/10000 (48.4600%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4555/5063 (89.9664%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4350/5063 (85.9174%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1771, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3962/4295 (92.2468%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3822/4295 (88.9872%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1526, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2923/3271 (89.3611%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0044, Accuracy: 2986/3271 (91.2871%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8417, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3979/4356 (91.3453%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3837/4356 (88.0854%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1871, Accuracy: 5206/10000 (52.0600%)
time spent on training: 264.65400290489197
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.7979, Accuracy: 6010/10000 (60.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 9.4319, Accuracy: 110/9900 (1.1111%)
Done in 289.2691812515259 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4505/4885 (92.2211%), train_poison_data_count: 385
Global model norm: 44.693151412751426.
Norm before scaling: 44.681946223943456. Distance: 2.0428062943295293
Total norm for 4 adversaries is: 44.681946223943456. distance: 2.0428062943295293
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1526, Accuracy: 9529/9900 (96.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4839/5305 (91.2158%), train_poison_data_count: 415
Global model norm: 44.693151412751426.
Norm before scaling: 44.68603854690663. Distance: 2.207746919709507
Total norm for 4 adversaries is: 44.68603854690663. distance: 2.207746919709507
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1769, Accuracy: 9440/9900 (95.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4310/4717 (91.3716%), train_poison_data_count: 370
Global model norm: 44.693151412751426.
Norm before scaling: 44.68188475428619. Distance: 2.012089311858513
Total norm for 4 adversaries is: 44.68188475428619. distance: 2.012089311858513
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0821, Accuracy: 9705/9900 (98.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4616/5066 (91.1173%), train_poison_data_count: 400
Global model norm: 44.693151412751426.
Norm before scaling: 44.684661732418036. Distance: 2.1721468967972375
Total norm for 4 adversaries is: 44.684661732418036. distance: 2.1721468967972375
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1340, Accuracy: 9562/9900 (96.5859%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4148/4503 (92.1164%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4163/4503 (92.4495%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9331, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4124/4456 (92.5494%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4090/4456 (91.7864%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9408, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4791/5265 (90.9972%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4704/5265 (89.3447%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0086, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4359/4793 (90.9451%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4425/4793 (92.3221%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9611, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4573/4928 (92.7963%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4655/4928 (94.4602%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.7646, Accuracy: 5922/10000 (59.2200%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3264/3638 (89.7196%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3333/3638 (91.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8335, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4231/4663 (90.7356%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4321/4663 (92.6657%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0854, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4518/4928 (91.6802%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4556/4928 (92.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9556, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4096/4465 (91.7357%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4156/4465 (93.0795%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9608, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3707/3911 (94.7839%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3652/3911 (93.3777%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8537, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4118/4518 (91.1465%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4155/4518 (91.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0184, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3988/4235 (94.1677%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3956/4235 (93.4120%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0198, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4457/4934 (90.3324%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4301/4934 (87.1707%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2651, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4241/4647 (91.2632%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4220/4647 (90.8113%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9440, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4201/4651 (90.3247%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4224/4651 (90.8192%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0539, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4555/4989 (91.3009%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4529/4989 (90.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8868, Accuracy: 5775/10000 (57.7500%)
time spent on training: 263.13401532173157
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.7800, Accuracy: 6017/10000 (60.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 9.3360, Accuracy: 107/9900 (1.0808%)
Done in 287.5593445301056 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4500/4885 (92.1187%), train_poison_data_count: 385
Global model norm: 44.72079179475694.
Norm before scaling: 44.708979212968224. Distance: 2.0609721680473565
Total norm for 4 adversaries is: 44.708979212968224. distance: 2.0609721680473565
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.2128, Accuracy: 9348/9900 (94.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4830/5305 (91.0462%), train_poison_data_count: 415
Global model norm: 44.72079179475694.
Norm before scaling: 44.71107878821814. Distance: 2.1895141048599935
Total norm for 4 adversaries is: 44.71107878821814. distance: 2.1895141048599935
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1277, Accuracy: 9583/9900 (96.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4300/4717 (91.1596%), train_poison_data_count: 370
Global model norm: 44.72079179475694.
Norm before scaling: 44.71101599350964. Distance: 2.043695324274314
Total norm for 4 adversaries is: 44.71101599350964. distance: 2.043695324274314
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.2060, Accuracy: 9402/9900 (94.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4615/5066 (91.0975%), train_poison_data_count: 400
Global model norm: 44.72079179475694.
Norm before scaling: 44.709620836152254. Distance: 2.122649407402076
Total norm for 4 adversaries is: 44.709620836152254. distance: 2.122649407402076
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.2878, Accuracy: 9212/9900 (93.0505%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4211/4538 (92.7942%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4258/4538 (93.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8164, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4116/4362 (94.3604%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4059/4362 (93.0536%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9628, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4607/5244 (87.8528%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4636/5244 (88.4058%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1892, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3691/4046 (91.2259%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3687/4046 (91.1270%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9529, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3700/4013 (92.2003%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3761/4013 (93.7204%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7951, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4059/4465 (90.9071%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4178/4465 (93.5722%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8436, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4865/5232 (92.9855%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4875/5232 (93.1766%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9293, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4531/4928 (91.9440%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4591/4928 (93.1615%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9312, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4507/5063 (89.0184%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4199/5063 (82.9350%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.3622, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5248/5902 (88.9190%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5060/5902 (85.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2464, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4107/4456 (92.1679%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4113/4456 (92.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9165, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4230/4596 (92.0366%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4240/4596 (92.2541%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9762, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4094/4441 (92.1864%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4148/4441 (93.4024%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0491, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5253/5740 (91.5157%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5306/5740 (92.4390%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1845, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3180/3472 (91.5899%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3226/3472 (92.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9784, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3535/3861 (91.5566%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3604/3861 (93.3437%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8627, Accuracy: 5720/10000 (57.2000%)
time spent on training: 262.3182759284973
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9353, Accuracy: 5770/10000 (57.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 4.8996, Accuracy: 1627/9900 (16.4343%)
Done in 286.64041686058044 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4528/4885 (92.6919%), train_poison_data_count: 385
Global model norm: 44.727061269053046.
Norm before scaling: 44.71550013304601. Distance: 1.893480146966312
Total norm for 4 adversaries is: 44.71550013304601. distance: 1.893480146966312
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1390, Accuracy: 9548/9900 (96.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4904/5305 (92.4411%), train_poison_data_count: 415
Global model norm: 44.727061269053046.
Norm before scaling: 44.71574446136813. Distance: 1.9655380690717896
Total norm for 4 adversaries is: 44.71574446136813. distance: 1.9655380690717896
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1577, Accuracy: 9519/9900 (96.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4379/4717 (92.8344%), train_poison_data_count: 370
Global model norm: 44.727061269053046.
Norm before scaling: 44.71566938856208. Distance: 1.8249843387715619
Total norm for 4 adversaries is: 44.71566938856208. distance: 1.8249843387715619
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.2137, Accuracy: 9381/9900 (94.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4722/5066 (93.2096%), train_poison_data_count: 400
Global model norm: 44.727061269053046.
Norm before scaling: 44.711723111436335. Distance: 1.8297159819825288
Total norm for 4 adversaries is: 44.711723111436335. distance: 1.8297159819825288
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0766, Accuracy: 9712/9900 (98.1010%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3486/3797 (91.8093%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3469/3797 (91.3616%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0350, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3025/3297 (91.7501%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3093/3297 (93.8126%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.6888, Accuracy: 5983/10000 (59.8300%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3702/3911 (94.6561%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3552/3911 (90.8208%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0400, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2942/3271 (89.9419%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2916/3271 (89.1470%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0170, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3700/4046 (91.4483%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3741/4046 (92.4617%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9689, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5223/5740 (90.9930%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5308/5740 (92.4739%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0859, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3684/3969 (92.8193%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3628/3969 (91.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8654, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3381/3704 (91.2797%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3427/3704 (92.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8037, Accuracy: 5917/10000 (59.1700%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4388/4767 (92.0495%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4403/4767 (92.3642%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0620, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4559/4956 (91.9895%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4521/4956 (91.2228%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0305, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3286/3590 (91.5320%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3200/3590 (89.1365%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1029, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5266/5902 (89.2240%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5146/5902 (87.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0962, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4571/4928 (92.7557%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4595/4928 (93.2427%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9315, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3969/4235 (93.7190%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3996/4235 (94.3566%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9144, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4847/5265 (92.0608%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4813/5265 (91.4150%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9240, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3972/4356 (91.1846%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3910/4356 (89.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0990, Accuracy: 5362/10000 (53.6200%)
time spent on training: 257.8614864349365
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8887, Accuracy: 5792/10000 (57.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 5.0179, Accuracy: 1499/9900 (15.1414%)
Done in 282.358181476593 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4566/4885 (93.4698%), train_poison_data_count: 385
Global model norm: 44.75372196681313.
Norm before scaling: 44.740934508603246. Distance: 1.8274118059327855
Total norm for 4 adversaries is: 44.740934508603246. distance: 1.8274118059327855
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1275, Accuracy: 9576/9900 (96.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4892/5305 (92.2149%), train_poison_data_count: 415
Global model norm: 44.75372196681313.
Norm before scaling: 44.74568163957976. Distance: 2.040095860342049
Total norm for 4 adversaries is: 44.74568163957976. distance: 2.040095860342049
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1481, Accuracy: 9537/9900 (96.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4376/4717 (92.7708%), train_poison_data_count: 370
Global model norm: 44.75372196681313.
Norm before scaling: 44.739874520055515. Distance: 1.8175999810425327
Total norm for 4 adversaries is: 44.739874520055515. distance: 1.8175999810425327
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0806, Accuracy: 9696/9900 (97.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4706/5066 (92.8938%), train_poison_data_count: 400
Global model norm: 44.75372196681313.
Norm before scaling: 44.73894820319455. Distance: 1.8700853150841432
Total norm for 4 adversaries is: 44.73894820319455. distance: 1.8700853150841432
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0865, Accuracy: 9691/9900 (97.8889%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3692/4025 (91.7267%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3769/4025 (93.6398%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9106, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5244/5902 (88.8512%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5057/5902 (85.6828%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2342, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4360/4793 (90.9660%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4456/4793 (92.9689%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8890, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4778/5265 (90.7502%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4683/5265 (88.9459%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0635, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4033/4295 (93.8999%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4006/4295 (93.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7848, Accuracy: 6001/10000 (60.0100%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3362/3704 (90.7667%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3420/3704 (92.3326%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8166, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4729/5116 (92.4355%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4687/5116 (91.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9858, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5257/5740 (91.5854%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5365/5740 (93.4669%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1063, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3431/3797 (90.3608%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3447/3797 (90.7822%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9154, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4270/4716 (90.5428%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4285/4716 (90.8609%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8945, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4029/4433 (90.8865%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4050/4433 (91.3603%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9146, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3938/4416 (89.1757%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4047/4416 (91.6440%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9070, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3884/4223 (91.9725%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3940/4223 (93.2986%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7830, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4678/5083 (92.0323%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4606/5083 (90.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9489, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4130/4576 (90.2535%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4203/4576 (91.8488%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9381, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5062/5392 (93.8798%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4955/5392 (91.8954%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9263, Accuracy: 5653/10000 (56.5300%)
time spent on training: 264.4001247882843
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8229, Accuracy: 5896/10000 (58.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 5.3720, Accuracy: 1183/9900 (11.9495%)
Done in 288.8916869163513 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4552/4885 (93.1832%), train_poison_data_count: 385
Global model norm: 44.77949855917256.
Norm before scaling: 44.7673251749567. Distance: 1.8708161404958845
Total norm for 4 adversaries is: 44.7673251749567. distance: 1.8708161404958845
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2597, Accuracy: 9268/9900 (93.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4867/5305 (91.7436%), train_poison_data_count: 415
Global model norm: 44.77949855917256.
Norm before scaling: 44.76967559117513. Distance: 2.08358860995013
Total norm for 4 adversaries is: 44.76967559117513. distance: 2.08358860995013
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1047, Accuracy: 9647/9900 (97.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4360/4717 (92.4316%), train_poison_data_count: 370
Global model norm: 44.77949855917256.
Norm before scaling: 44.767293817061635. Distance: 1.8632768355023375
Total norm for 4 adversaries is: 44.767293817061635. distance: 1.8632768355023375
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2341, Accuracy: 9352/9900 (94.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4736/5066 (93.4860%), train_poison_data_count: 400
Global model norm: 44.77949855917256.
Norm before scaling: 44.762728963914554. Distance: 1.8283441526335682
Total norm for 4 adversaries is: 44.762728963914554. distance: 1.8283441526335682
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2041, Accuracy: 9356/9900 (94.5051%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4831/5265 (91.7569%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4785/5265 (90.8832%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1366, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3978/4356 (91.3223%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3949/4356 (90.6566%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1766, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3482/3756 (92.7050%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3540/3756 (94.2492%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.7982, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3507/3837 (91.3995%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3592/3837 (93.6148%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8025, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5285/5740 (92.0732%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5266/5740 (91.7422%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1198, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3848/4223 (91.1201%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3940/4223 (93.2986%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8653, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4109/4465 (92.0269%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4158/4465 (93.1243%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9142, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5071/5591 (90.6993%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5073/5591 (90.7351%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0675, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5250/5902 (88.9529%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5110/5902 (86.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1135, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4452/4918 (90.5246%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4488/4918 (91.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1238, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3539/3861 (91.6602%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3596/3861 (93.1365%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8540, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4019/4295 (93.5739%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3881/4295 (90.3609%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0470, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3732/4158 (89.7547%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3743/4158 (90.0192%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9020, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5772/6263 (92.1603%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5801/6263 (92.6233%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9598, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3897/4354 (89.5039%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3614/4354 (83.0041%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.4782, Accuracy: 4872/10000 (48.7200%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3484/3797 (91.7566%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3516/3797 (92.5994%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9545, Accuracy: 5595/10000 (55.9500%)
time spent on training: 263.54486656188965
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8467, Accuracy: 5879/10000 (58.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 5.5999, Accuracy: 1058/9900 (10.6869%)
Done in 287.9345717430115 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4541/4885 (92.9580%), train_poison_data_count: 385
Global model norm: 44.81104670978533.
Norm before scaling: 44.79817343121746. Distance: 1.8864483688936697
Total norm for 4 adversaries is: 44.79817343121746. distance: 1.8864483688936697
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1406, Accuracy: 9580/9900 (96.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4877/5305 (91.9321%), train_poison_data_count: 415
Global model norm: 44.81104670978533.
Norm before scaling: 44.800823313096046. Distance: 2.0424714221612645
Total norm for 4 adversaries is: 44.800823313096046. distance: 2.0424714221612645
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1026, Accuracy: 9625/9900 (97.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4362/4717 (92.4740%), train_poison_data_count: 370
Global model norm: 44.81104670978533.
Norm before scaling: 44.797650248349385. Distance: 1.8648954872526353
Total norm for 4 adversaries is: 44.797650248349385. distance: 1.8648954872526353
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0998, Accuracy: 9652/9900 (97.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4708/5066 (92.9333%), train_poison_data_count: 400
Global model norm: 44.81104670978533.
Norm before scaling: 44.798484068154444. Distance: 1.8890136914380555
Total norm for 4 adversaries is: 44.798484068154444. distance: 1.8890136914380555
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1733, Accuracy: 9480/9900 (95.7576%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3484/3797 (91.7566%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3464/3797 (91.2299%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9904, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4631/5037 (91.9396%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4674/5037 (92.7933%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9701, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4394/4934 (89.0555%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4314/4934 (87.4341%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1514, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4920/5455 (90.1925%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4913/5455 (90.0642%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0956, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5283/5902 (89.5120%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5180/5902 (87.7669%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0425, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5677/6391 (88.8280%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5579/6391 (87.2946%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1103, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3670/3911 (93.8379%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3541/3911 (90.5395%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0764, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4666/5195 (89.8171%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4694/5195 (90.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1629, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3981/4235 (94.0024%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3980/4235 (93.9787%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8626, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4734/5116 (92.5332%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4743/5116 (92.7091%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9630, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4167/4538 (91.8246%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4218/4538 (92.9484%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8190, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5219/5582 (93.4970%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5147/5582 (92.2071%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0461, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4364/4558 (95.7437%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4319/4558 (94.7565%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8824, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3733/4046 (92.2640%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3776/4046 (93.3267%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9416, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3510/3828 (91.6928%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3551/3828 (92.7638%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9361, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4564/5055 (90.2868%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4619/5055 (91.3749%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8957, Accuracy: 5657/10000 (56.5700%)
time spent on training: 266.3932411670685
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8534, Accuracy: 5834/10000 (58.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 5.4783, Accuracy: 1082/9900 (10.9293%)
Done in 290.895126581192 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4540/4885 (92.9376%), train_poison_data_count: 385
Global model norm: 44.83549847863995.
Norm before scaling: 44.822882775570115. Distance: 1.8732894724443419
Total norm for 4 adversaries is: 44.822882775570115. distance: 1.8732894724443419
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.3773, Accuracy: 9016/9900 (91.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4843/5305 (91.2912%), train_poison_data_count: 415
Global model norm: 44.83549847863995.
Norm before scaling: 44.82337434526. Distance: 2.0656764683392668
Total norm for 4 adversaries is: 44.82337434526. distance: 2.0656764683392668
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1216, Accuracy: 9608/9900 (97.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4340/4717 (92.0076%), train_poison_data_count: 370
Global model norm: 44.83549847863995.
Norm before scaling: 44.827192337369986. Distance: 1.9142036230261643
Total norm for 4 adversaries is: 44.827192337369986. distance: 1.9142036230261643
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.2175, Accuracy: 9387/9900 (94.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4709/5066 (92.9530%), train_poison_data_count: 400
Global model norm: 44.83549847863995.
Norm before scaling: 44.82415458192575. Distance: 1.899918720113018
Total norm for 4 adversaries is: 44.82415458192575. distance: 1.899918720113018
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0984, Accuracy: 9646/9900 (97.4343%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5220/5582 (93.5149%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5212/5582 (93.3716%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0568, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4015/4501 (89.2024%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4085/4501 (90.7576%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9260, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3744/3911 (95.7300%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3486/3911 (89.1332%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0269, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4291/4663 (92.0223%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4372/4663 (93.7594%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9178, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4936/5265 (93.7512%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4912/5265 (93.2953%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7814, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3951/4416 (89.4701%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3990/4416 (90.3533%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9637, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4144/4433 (93.4807%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4133/4433 (93.2326%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8853, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5810/6263 (92.7670%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5806/6263 (92.7032%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0071, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4864/5455 (89.1659%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4929/5455 (90.3575%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9504, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4169/4634 (89.9655%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4206/4634 (90.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8667, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4258/4707 (90.4610%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4344/4707 (92.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9171, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3763/4126 (91.2021%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3837/4126 (92.9956%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8530, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4740/5116 (92.6505%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4708/5116 (92.0250%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9528, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4575/5063 (90.3614%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4340/5063 (85.7199%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2701, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4003/4361 (91.7909%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3982/4361 (91.3093%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0722, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5500/6124 (89.8106%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5419/6124 (88.4879%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0619, Accuracy: 5375/10000 (53.7500%)
time spent on training: 268.0006260871887
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8316, Accuracy: 5881/10000 (58.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 5.3724, Accuracy: 1128/9900 (11.3939%)
Done in 292.2546935081482 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4517/4885 (92.4667%), train_poison_data_count: 385
Global model norm: 44.8619518808812.
Norm before scaling: 44.84964981877994. Distance: 1.9300834465764145
Total norm for 4 adversaries is: 44.84964981877994. distance: 1.9300834465764145
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.3361, Accuracy: 9126/9900 (92.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4875/5305 (91.8944%), train_poison_data_count: 415
Global model norm: 44.8619518808812.
Norm before scaling: 44.85211022897571. Distance: 2.051379074880165
Total norm for 4 adversaries is: 44.85211022897571. distance: 2.051379074880165
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.3194, Accuracy: 9136/9900 (92.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4342/4717 (92.0500%), train_poison_data_count: 370
Global model norm: 44.8619518808812.
Norm before scaling: 44.84978046342242. Distance: 1.854160980330188
Total norm for 4 adversaries is: 44.84978046342242. distance: 1.854160980330188
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0422, Accuracy: 9796/9900 (98.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4717/5066 (93.1109%), train_poison_data_count: 400
Global model norm: 44.8619518808812.
Norm before scaling: 44.84519406429258. Distance: 1.8903239617399894
Total norm for 4 adversaries is: 44.84519406429258. distance: 1.8903239617399894
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1332, Accuracy: 9547/9900 (96.4343%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3972/4356 (91.1846%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3896/4356 (89.4399%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3294, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4136/4362 (94.8189%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4183/4362 (95.8964%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8625, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4391/4679 (93.8448%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4346/4679 (92.8831%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0890, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3771/4158 (90.6926%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3763/4158 (90.5002%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9295, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4191/4651 (90.1097%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4222/4651 (90.7762%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8796, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3841/4175 (92.0000%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3829/4175 (91.7126%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8366, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4240/4618 (91.8146%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4173/4618 (90.3638%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0692, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4130/4625 (89.2973%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4032/4625 (87.1784%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2321, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5228/5582 (93.6582%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0030, Accuracy: 5259/5582 (94.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9613, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4443/4874 (91.1572%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4288/4874 (87.9770%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1479, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4448/4934 (90.1500%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4187/4934 (84.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2444, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5000/5424 (92.1829%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5087/5424 (93.7869%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0115, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4372/4804 (91.0075%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4322/4804 (89.9667%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1016, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4431/4918 (90.0976%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4492/4918 (91.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1244, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3497/3861 (90.5724%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3518/3861 (91.1163%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0453, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3850/4223 (91.1674%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3918/4223 (92.7776%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8821, Accuracy: 5701/10000 (57.0100%)
time spent on training: 262.3703052997589
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8795, Accuracy: 5819/10000 (58.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 6.0451, Accuracy: 720/9900 (7.2727%)
Done in 286.7191650867462 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4538/4885 (92.8966%), train_poison_data_count: 385
Global model norm: 44.89022798292937.
Norm before scaling: 44.87394725871711. Distance: 1.8758003434079726
Total norm for 4 adversaries is: 44.87394725871711. distance: 1.8758003434079726
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1468, Accuracy: 9523/9900 (96.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4845/5305 (91.3289%), train_poison_data_count: 415
Global model norm: 44.89022798292937.
Norm before scaling: 44.87795271231117. Distance: 2.1045390891670395
Total norm for 4 adversaries is: 44.87795271231117. distance: 2.1045390891670395
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.2130, Accuracy: 9387/9900 (94.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4362/4717 (92.4740%), train_poison_data_count: 370
Global model norm: 44.89022798292937.
Norm before scaling: 44.87939295611489. Distance: 1.8717555904353345
Total norm for 4 adversaries is: 44.87939295611489. distance: 1.8717555904353345
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1360, Accuracy: 9577/9900 (96.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4683/5066 (92.4398%), train_poison_data_count: 400
Global model norm: 44.89022798292937.
Norm before scaling: 44.87847767905082. Distance: 1.94299110488701
Total norm for 4 adversaries is: 44.87847767905082. distance: 1.94299110488701
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.2047, Accuracy: 9409/9900 (95.0404%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4218/4647 (90.7682%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4232/4647 (91.0695%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8977, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3442/3804 (90.4837%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3537/3804 (92.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7982, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5137/5591 (91.8798%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4967/5591 (88.8392%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2405, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4220/4634 (91.0660%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4220/4634 (91.0660%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0126, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4178/4433 (94.2477%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4181/4433 (94.3154%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8667, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3392/3704 (91.5767%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3450/3704 (93.1425%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8218, Accuracy: 5897/10000 (58.9700%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3482/3837 (90.7480%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3569/3837 (93.0154%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0461, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4920/5455 (90.1925%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4859/5455 (89.0742%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9406, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5272/5740 (91.8467%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5265/5740 (91.7247%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0093, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4559/4986 (91.4360%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4557/4986 (91.3959%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8510, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4066/4456 (91.2478%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4150/4456 (93.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8901, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3991/4356 (91.6208%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3796/4356 (87.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3366, Accuracy: 4928/10000 (49.2800%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3304/3590 (92.0334%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3316/3590 (92.3677%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8892, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4162/4503 (92.4273%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4158/4503 (92.3384%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8775, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4614/5037 (91.6021%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4638/5037 (92.0786%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9357, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4673/5167 (90.4393%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4710/5167 (91.1554%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1344, Accuracy: 5438/10000 (54.3800%)
time spent on training: 260.58898735046387
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8963, Accuracy: 5807/10000 (58.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 6.5199, Accuracy: 493/9900 (4.9798%)
Done in 285.07939529418945 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4530/4885 (92.7329%), train_poison_data_count: 385
Global model norm: 44.91867787535951.
Norm before scaling: 44.90329642992191. Distance: 1.871798261238087
Total norm for 4 adversaries is: 44.90329642992191. distance: 1.871798261238087
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1169, Accuracy: 9596/9900 (96.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4892/5305 (92.2149%), train_poison_data_count: 415
Global model norm: 44.91867787535951.
Norm before scaling: 44.90689695950111. Distance: 2.0201889531358375
Total norm for 4 adversaries is: 44.90689695950111. distance: 2.0201889531358375
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1570, Accuracy: 9500/9900 (95.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4336/4717 (91.9228%), train_poison_data_count: 370
Global model norm: 44.91867787535951.
Norm before scaling: 44.903984209105126. Distance: 1.885856668404054
Total norm for 4 adversaries is: 44.903984209105126. distance: 1.885856668404054
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0927, Accuracy: 9661/9900 (97.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4669/5066 (92.1634%), train_poison_data_count: 400
Global model norm: 44.91867787535951.
Norm before scaling: 44.90730606143406. Distance: 1.9475129945098673
Total norm for 4 adversaries is: 44.90730606143406. distance: 1.9475129945098673
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.2808, Accuracy: 9208/9900 (93.0101%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3252/3638 (89.3898%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3346/3638 (91.9736%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7785, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4248/4716 (90.0763%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4240/4716 (89.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1706, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4540/4956 (91.6061%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4471/4956 (90.2139%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0911, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5011/5392 (92.9340%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4952/5392 (91.8398%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0502, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3807/4184 (90.9895%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3859/4184 (92.2323%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8421, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3952/4481 (88.1946%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3903/4481 (87.1011%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.3345, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3292/3646 (90.2907%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3332/3646 (91.3878%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8663, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4558/5025 (90.7065%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4581/5025 (91.1642%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0861, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3280/3590 (91.3649%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0092, Accuracy: 2985/3590 (83.1476%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2843, Accuracy: 5007/10000 (50.0700%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4206/4596 (91.5144%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4255/4596 (92.5805%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0010, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3927/4336 (90.5673%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4025/4336 (92.8275%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1001, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4438/4874 (91.0546%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4369/4874 (89.6389%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1137, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4754/5167 (92.0070%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4798/5167 (92.8585%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1196, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4213/4618 (91.2300%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4197/4618 (90.8835%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9699, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4465/4928 (90.6047%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4535/4928 (92.0252%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0669, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4235/4647 (91.1341%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4280/4647 (92.1024%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9749, Accuracy: 5632/10000 (56.3200%)
time spent on training: 258.3004193305969
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9281, Accuracy: 5782/10000 (57.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 6.3407, Accuracy: 614/9900 (6.2020%)
Done in 282.62167835235596 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4522/4885 (92.5691%), train_poison_data_count: 385
Global model norm: 44.94833324087571.
Norm before scaling: 44.93634821194308. Distance: 1.9407852991214063
Total norm for 4 adversaries is: 44.93634821194308. distance: 1.9407852991214063
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1326, Accuracy: 9586/9900 (96.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4882/5305 (92.0264%), train_poison_data_count: 415
Global model norm: 44.94833324087571.
Norm before scaling: 44.93719983166439. Distance: 2.093749772256867
Total norm for 4 adversaries is: 44.93719983166439. distance: 2.093749772256867
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1645, Accuracy: 9474/9900 (95.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4360/4717 (92.4316%), train_poison_data_count: 370
Global model norm: 44.94833324087571.
Norm before scaling: 44.93560116381136. Distance: 1.8802063819544028
Total norm for 4 adversaries is: 44.93560116381136. distance: 1.8802063819544028
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1064, Accuracy: 9640/9900 (97.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4730/5066 (93.3675%), train_poison_data_count: 400
Global model norm: 44.94833324087571.
Norm before scaling: 44.93344416241509. Distance: 1.855667649701169
Total norm for 4 adversaries is: 44.93344416241509. distance: 1.855667649701169
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2485, Accuracy: 9333/9900 (94.2727%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3953/4368 (90.4991%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3868/4368 (88.5531%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0601, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4681/5195 (90.1059%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4613/5195 (88.7969%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0633, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3998/4315 (92.6535%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3984/4315 (92.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7964, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3324/3646 (91.1684%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3357/3646 (92.0735%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8318, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3325/3590 (92.6184%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3367/3590 (93.7883%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8542, Accuracy: 5916/10000 (59.1600%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3763/4126 (91.2021%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3801/4126 (92.1231%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9537, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4006/4361 (91.8597%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3982/4361 (91.3093%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9891, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3520/3837 (91.7383%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3569/3837 (93.0154%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9244, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3971/4235 (93.7662%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3971/4235 (93.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8278, Accuracy: 5901/10000 (59.0100%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5242/5902 (88.8174%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5064/5902 (85.8014%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1348, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4137/4433 (93.3228%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4118/4433 (92.8942%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9410, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3271/3638 (89.9120%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3348/3638 (92.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7702, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4859/5232 (92.8708%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4801/5232 (91.7622%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0611, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3942/4336 (90.9133%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3991/4336 (92.0434%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9900, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4655/4989 (93.3053%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4657/4989 (93.3454%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8765, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3974/4481 (88.6856%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3945/4481 (88.0384%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2346, Accuracy: 5249/10000 (52.4900%)
time spent on training: 258.53701424598694
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8957, Accuracy: 5852/10000 (58.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 6.2960, Accuracy: 698/9900 (7.0505%)
Done in 282.918639421463 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4582/4885 (93.7973%), train_poison_data_count: 385
Global model norm: 44.972653366031786.
Norm before scaling: 44.95882990824772. Distance: 1.8851170029489228
Total norm for 4 adversaries is: 44.95882990824772. distance: 1.8851170029489228
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1490, Accuracy: 9527/9900 (96.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4875/5305 (91.8944%), train_poison_data_count: 415
Global model norm: 44.972653366031786.
Norm before scaling: 44.95753204414139. Distance: 2.074688472112654
Total norm for 4 adversaries is: 44.95753204414139. distance: 2.074688472112654
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0989, Accuracy: 9646/9900 (97.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4358/4717 (92.3892%), train_poison_data_count: 370
Global model norm: 44.972653366031786.
Norm before scaling: 44.95944624481739. Distance: 1.8412725970609627
Total norm for 4 adversaries is: 44.95944624481739. distance: 1.8412725970609627
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.3167, Accuracy: 9173/9900 (92.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4699/5066 (92.7556%), train_poison_data_count: 400
Global model norm: 44.972653366031786.
Norm before scaling: 44.95933628230417. Distance: 1.9284686977030843
Total norm for 4 adversaries is: 44.95933628230417. distance: 1.9284686977030843
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.2019, Accuracy: 9393/9900 (94.8788%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4712/5116 (92.1032%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4651/5116 (90.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0297, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4111/4362 (94.2458%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4093/4362 (93.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8622, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4137/4441 (93.1547%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4127/4441 (92.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9453, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4276/4663 (91.7006%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4292/4663 (92.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9106, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4646/5083 (91.4027%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4669/5083 (91.8552%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0227, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4362/4767 (91.5041%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4398/4767 (92.2593%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0201, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3461/3797 (91.1509%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3526/3797 (92.8628%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9493, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4730/5195 (91.0491%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4622/5195 (88.9702%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0216, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4217/4618 (91.3166%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4166/4618 (90.2122%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0194, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4162/4433 (93.8868%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4113/4433 (92.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9924, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4620/5055 (91.3947%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4641/5055 (91.8101%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9113, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3713/4158 (89.2977%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3757/4158 (90.3559%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9248, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3494/3781 (92.4094%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3550/3781 (93.8905%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8223, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3841/4175 (92.0000%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3838/4175 (91.9281%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8960, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4882/5265 (92.7255%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4876/5265 (92.6116%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0745, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3536/3837 (92.1553%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3567/3837 (92.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9029, Accuracy: 5727/10000 (57.2700%)
time spent on training: 259.09250116348267
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9286, Accuracy: 5781/10000 (57.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 6.9455, Accuracy: 476/9900 (4.8081%)
Done in 283.21678352355957 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4514/4885 (92.4053%), train_poison_data_count: 385
Global model norm: 45.00154484110448.
Norm before scaling: 44.99209457470001. Distance: 1.968631740832961
Total norm for 4 adversaries is: 44.99209457470001. distance: 1.968631740832961
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.4908, Accuracy: 8753/9900 (88.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4890/5305 (92.1772%), train_poison_data_count: 415
Global model norm: 45.00154484110448.
Norm before scaling: 44.98678462632804. Distance: 1.9791715989971606
Total norm for 4 adversaries is: 44.98678462632804. distance: 1.9791715989971606
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1651, Accuracy: 9485/9900 (95.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4332/4717 (91.8380%), train_poison_data_count: 370
Global model norm: 45.00154484110448.
Norm before scaling: 44.98775468156932. Distance: 1.8870834092959794
Total norm for 4 adversaries is: 44.98775468156932. distance: 1.8870834092959794
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0971, Accuracy: 9660/9900 (97.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4711/5066 (92.9925%), train_poison_data_count: 400
Global model norm: 45.00154484110448.
Norm before scaling: 44.9867235732006. Distance: 1.8880321914506595
Total norm for 4 adversaries is: 44.9867235732006. distance: 1.8880321914506595
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.4518, Accuracy: 8844/9900 (89.3333%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3726/3911 (95.2698%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3480/3911 (88.9798%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2650, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4659/5195 (89.6824%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4637/5195 (89.2589%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0482, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3465/3775 (91.7881%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3568/3775 (94.5166%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9310, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4354/4679 (93.0541%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4364/4679 (93.2678%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9168, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4103/4361 (94.0839%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4036/4361 (92.5476%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8195, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3326/3672 (90.5773%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3325/3672 (90.5501%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9876, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4080/4481 (91.0511%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3913/4481 (87.3243%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2462, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3749/4126 (90.8628%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3806/4126 (92.2443%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8660, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3651/3969 (91.9879%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3654/3969 (92.0635%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8751, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4693/5116 (91.7318%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4678/5116 (91.4386%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9036, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4538/5063 (89.6307%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4501/5063 (88.8999%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9698, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3051/3297 (92.5387%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3075/3297 (93.2666%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.6374, Accuracy: 6139/10000 (61.3900%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4567/5037 (90.6690%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4619/5037 (91.7014%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0011, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4237/4596 (92.1889%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4305/4596 (93.6684%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0274, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4137/4501 (91.9129%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4125/4501 (91.6463%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9329, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4084/4465 (91.4670%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4169/4465 (93.3707%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9162, Accuracy: 5681/10000 (56.8100%)
time spent on training: 256.6487834453583
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9938, Accuracy: 5663/10000 (56.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 6.9198, Accuracy: 448/9900 (4.5253%)
Done in 281.0896828174591 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4536/4885 (92.8557%), train_poison_data_count: 385
Global model norm: 45.023186029794.
Norm before scaling: 45.009883897178625. Distance: 1.941353380799708
Total norm for 4 adversaries is: 45.009883897178625. distance: 1.941353380799708
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1096, Accuracy: 9637/9900 (97.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4841/5305 (91.2535%), train_poison_data_count: 415
Global model norm: 45.023186029794.
Norm before scaling: 45.01303657735237. Distance: 2.065958187223004
Total norm for 4 adversaries is: 45.01303657735237. distance: 2.065958187223004
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1448, Accuracy: 9543/9900 (96.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4354/4717 (92.3044%), train_poison_data_count: 370
Global model norm: 45.023186029794.
Norm before scaling: 45.012258258775326. Distance: 1.8731320931596582
Total norm for 4 adversaries is: 45.012258258775326. distance: 1.8731320931596582
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.4053, Accuracy: 8950/9900 (90.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4700/5066 (92.7754%), train_poison_data_count: 400
Global model norm: 45.023186029794.
Norm before scaling: 45.01209554238935. Distance: 1.9650809597974201
Total norm for 4 adversaries is: 45.01209554238935. distance: 1.9650809597974201
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1344, Accuracy: 9548/9900 (96.4444%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4087/4361 (93.7170%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4017/4361 (92.1119%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9905, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4027/4346 (92.6599%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4079/4346 (93.8564%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8926, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4931/5455 (90.3941%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4971/5455 (91.1274%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0471, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4099/4465 (91.8029%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4203/4465 (94.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8050, Accuracy: 5907/10000 (59.0700%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3928/4336 (90.5904%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3969/4336 (91.5360%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0964, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4104/4441 (92.4116%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4166/4441 (93.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9442, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4076/4362 (93.4434%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4138/4362 (94.8647%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8075, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3750/3969 (94.4822%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3714/3969 (93.5752%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8338, Accuracy: 5911/10000 (59.1100%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3985/4295 (92.7823%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3958/4295 (92.1537%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9591, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4627/5017 (92.2264%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4592/5017 (91.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8954, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4535/5063 (89.5714%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4405/5063 (87.0038%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1374, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2941/3271 (89.9113%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2932/3271 (89.6362%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9400, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5808/6263 (92.7351%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5802/6263 (92.6393%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0531, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4411/4874 (90.5006%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4518/4874 (92.6959%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9972, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3700/3911 (94.6050%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3654/3911 (93.4288%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9909, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4498/4804 (93.6303%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4453/4804 (92.6936%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1725, Accuracy: 5309/10000 (53.0900%)
time spent on training: 263.57823061943054
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1165, Accuracy: 5556/10000 (55.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 7.0285, Accuracy: 444/9900 (4.4848%)
Done in 288.0297555923462 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4548/4885 (93.1013%), train_poison_data_count: 385
Global model norm: 45.04305259320312.
Norm before scaling: 45.02482903345872. Distance: 1.8469310409899227
Total norm for 4 adversaries is: 45.02482903345872. distance: 1.8469310409899227
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.2261, Accuracy: 9363/9900 (94.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4883/5305 (92.0452%), train_poison_data_count: 415
Global model norm: 45.04305259320312.
Norm before scaling: 45.03167017066295. Distance: 2.0422308265625615
Total norm for 4 adversaries is: 45.03167017066295. distance: 2.0422308265625615
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1970, Accuracy: 9426/9900 (95.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4352/4717 (92.2620%), train_poison_data_count: 370
Global model norm: 45.04305259320312.
Norm before scaling: 45.02833716073621. Distance: 1.8693554793613718
Total norm for 4 adversaries is: 45.02833716073621. distance: 1.8693554793613718
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1274, Accuracy: 9575/9900 (96.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4693/5066 (92.6372%), train_poison_data_count: 400
Global model norm: 45.04305259320312.
Norm before scaling: 45.02862045584175. Distance: 1.939688461792678
Total norm for 4 adversaries is: 45.02862045584175. distance: 1.939688461792678
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0375, Accuracy: 9801/9900 (99.0000%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5222/5902 (88.4785%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5068/5902 (85.8692%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1361, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4463/4918 (90.7483%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4582/4918 (93.1680%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9259, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3721/4025 (92.4472%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3808/4025 (94.6087%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8036, Accuracy: 5943/10000 (59.4300%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3180/3472 (91.5899%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3241/3472 (93.3468%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8742, Accuracy: 5888/10000 (58.8800%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4362/4793 (91.0077%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4450/4793 (92.8437%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9987, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4397/4934 (89.1163%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0098, Accuracy: 4037/4934 (81.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.4672, Accuracy: 4828/10000 (48.2800%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3722/3911 (95.1675%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3698/3911 (94.5538%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8852, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4973/5392 (92.2292%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5049/5392 (93.6387%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8966, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3298/3638 (90.6542%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3352/3638 (92.1385%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8837, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5481/6124 (89.5003%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5441/6124 (88.8472%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0579, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3820/4175 (91.4970%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3849/4175 (92.1916%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8065, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4142/4625 (89.5568%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4166/4625 (90.0757%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0534, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3921/4354 (90.0551%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0110, Accuracy: 3468/4354 (79.6509%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.7258, Accuracy: 4571/10000 (45.7100%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4110/4511 (91.1106%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4181/4511 (92.6845%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9011, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3375/3704 (91.1177%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3430/3704 (92.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8775, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3549/3861 (91.9192%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3626/3861 (93.9135%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7936, Accuracy: 5817/10000 (58.1700%)
time spent on training: 260.21197152137756
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1454, Accuracy: 5528/10000 (55.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 6.9752, Accuracy: 491/9900 (4.9596%)
Done in 284.63317465782166 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4526/4885 (92.6510%), train_poison_data_count: 385
Global model norm: 45.07146831266289.
Norm before scaling: 45.059553962731506. Distance: 1.912826512707165
Total norm for 4 adversaries is: 45.059553962731506. distance: 1.912826512707165
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0834, Accuracy: 9694/9900 (97.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4862/5305 (91.6494%), train_poison_data_count: 415
Global model norm: 45.07146831266289.
Norm before scaling: 45.058563780061554. Distance: 2.0623647472076567
Total norm for 4 adversaries is: 45.058563780061554. distance: 2.0623647472076567
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1513, Accuracy: 9515/9900 (96.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4371/4717 (92.6648%), train_poison_data_count: 370
Global model norm: 45.07146831266289.
Norm before scaling: 45.05620134117916. Distance: 1.792247884942008
Total norm for 4 adversaries is: 45.05620134117916. distance: 1.792247884942008
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.3135, Accuracy: 9127/9900 (92.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4696/5066 (92.6964%), train_poison_data_count: 400
Global model norm: 45.07146831266289.
Norm before scaling: 45.055423768260134. Distance: 1.9167857202236815
Total norm for 4 adversaries is: 45.055423768260134. distance: 1.9167857202236815
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1579, Accuracy: 9518/9900 (96.1414%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4668/5083 (91.8355%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4656/5083 (91.5994%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9390, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3309/3646 (90.7570%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3361/3646 (92.1832%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8348, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4156/4503 (92.2940%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4081/4503 (90.6285%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1284, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4115/4501 (91.4241%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4110/4501 (91.3130%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0958, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3692/4013 (92.0010%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3766/4013 (93.8450%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8104, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4112/4362 (94.2687%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3979/4362 (91.2196%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9277, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4038/4315 (93.5805%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4039/4315 (93.6037%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8306, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4244/4651 (91.2492%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4271/4651 (91.8297%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0549, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3972/4416 (89.9457%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3966/4416 (89.8098%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0223, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3404/3704 (91.9006%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3452/3704 (93.1965%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7709, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4280/4707 (90.9284%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4271/4707 (90.7372%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9670, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4290/4662 (92.0206%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4361/4662 (93.5435%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9106, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5049/5424 (93.0863%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5040/5424 (92.9204%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2344, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3937/4336 (90.7980%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4003/4336 (92.3201%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9871, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4032/4481 (89.9799%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3934/4481 (87.7929%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1329, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3498/3828 (91.3793%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3561/3828 (93.0251%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8074, Accuracy: 5859/10000 (58.5900%)
time spent on training: 256.0923345088959
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0936, Accuracy: 5573/10000 (55.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 7.4416, Accuracy: 328/9900 (3.3131%)
Done in 280.32856822013855 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4530/4885 (92.7329%), train_poison_data_count: 385
Global model norm: 45.09401664205643.
Norm before scaling: 45.08126072282557. Distance: 1.925726032819571
Total norm for 4 adversaries is: 45.08126072282557. distance: 1.925726032819571
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1891, Accuracy: 9431/9900 (95.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4866/5305 (91.7248%), train_poison_data_count: 415
Global model norm: 45.09401664205643.
Norm before scaling: 45.08393187251903. Distance: 2.1113026041328755
Total norm for 4 adversaries is: 45.08393187251903. distance: 2.1113026041328755
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0764, Accuracy: 9706/9900 (98.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4347/4717 (92.1560%), train_poison_data_count: 370
Global model norm: 45.09401664205643.
Norm before scaling: 45.08097505071776. Distance: 1.9549428186078714
Total norm for 4 adversaries is: 45.08097505071776. distance: 1.9549428186078714
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0830, Accuracy: 9689/9900 (97.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4711/5066 (92.9925%), train_poison_data_count: 400
Global model norm: 45.09401664205643.
Norm before scaling: 45.079585927366416. Distance: 1.9257543844395713
Total norm for 4 adversaries is: 45.079585927366416. distance: 1.9257543844395713
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.2903, Accuracy: 9234/9900 (93.2727%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3822/4184 (91.3480%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3881/4184 (92.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7929, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4607/5037 (91.4632%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4605/5037 (91.4235%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0285, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3728/4158 (89.6585%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3797/4158 (91.3179%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8388, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3017/3271 (92.2348%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3005/3271 (91.8679%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8564, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4455/4918 (90.5856%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4523/4918 (91.9683%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0586, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5274/5902 (89.3595%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5109/5902 (86.5639%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0902, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3911/4354 (89.8254%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3742/4354 (85.9440%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.3179, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3741/3969 (94.2555%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3758/3969 (94.6838%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8475, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3990/4356 (91.5978%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3868/4356 (88.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2201, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4010/4295 (93.3644%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3954/4295 (92.0605%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0227, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3780/4126 (91.6142%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3831/4126 (92.8502%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7318, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4540/4928 (92.1266%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4604/4928 (93.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8457, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4105/4511 (90.9998%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4135/4511 (91.6648%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9215, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4239/4618 (91.7930%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4159/4618 (90.0606%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1608, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3387/3704 (91.4417%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3440/3704 (92.8726%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9207, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3237/3616 (89.5188%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3331/3616 (92.1184%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9119, Accuracy: 5759/10000 (57.5900%)
time spent on training: 257.48279213905334
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1219, Accuracy: 5563/10000 (55.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 7.6223, Accuracy: 284/9900 (2.8687%)
Done in 281.78947854042053 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4554/4885 (93.2242%), train_poison_data_count: 385
Global model norm: 45.120126392376854.
Norm before scaling: 45.10610862351407. Distance: 1.9116843260614853
Total norm for 4 adversaries is: 45.10610862351407. distance: 1.9116843260614853
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1396, Accuracy: 9558/9900 (96.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4865/5305 (91.7059%), train_poison_data_count: 415
Global model norm: 45.120126392376854.
Norm before scaling: 45.10659304722675. Distance: 2.08543269874998
Total norm for 4 adversaries is: 45.10659304722675. distance: 2.08543269874998
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1719, Accuracy: 9506/9900 (96.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4345/4717 (92.1136%), train_poison_data_count: 370
Global model norm: 45.120126392376854.
Norm before scaling: 45.10510051838303. Distance: 1.8860318214830651
Total norm for 4 adversaries is: 45.10510051838303. distance: 1.8860318214830651
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1057, Accuracy: 9641/9900 (97.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4682/5066 (92.4201%), train_poison_data_count: 400
Global model norm: 45.120126392376854.
Norm before scaling: 45.10443610389115. Distance: 1.9411697704196154
Total norm for 4 adversaries is: 45.10443610389115. distance: 1.9411697704196154
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1816, Accuracy: 9435/9900 (95.3030%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3009/3271 (91.9902%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0089, Accuracy: 2701/3271 (82.5741%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2898, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4096/4456 (91.9210%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4116/4456 (92.3698%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7712, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3714/4013 (92.5492%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3747/4013 (93.3715%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8297, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3497/3781 (92.4888%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3433/3781 (90.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0339, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3496/3775 (92.6093%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3532/3775 (93.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8560, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4858/5232 (92.8517%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4826/5232 (92.2401%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8775, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4656/4989 (93.3253%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4669/4989 (93.5859%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7651, Accuracy: 6053/10000 (60.5300%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3330/3646 (91.3330%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3368/3646 (92.3752%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8000, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3962/4315 (91.8192%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4045/4315 (93.7428%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8377, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4511/4918 (91.7243%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4548/4918 (92.4766%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0051, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3947/4416 (89.3795%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4067/4416 (92.0969%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8833, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5822/6263 (92.9586%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5818/6263 (92.8948%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9816, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5460/6124 (89.1574%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5439/6124 (88.8145%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0410, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4248/4651 (91.3352%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4237/4651 (91.0987%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0436, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4091/4356 (93.9164%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3943/4356 (90.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1657, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3970/4356 (91.1387%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3908/4356 (89.7153%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3321, Accuracy: 4924/10000 (49.2400%)
time spent on training: 256.25921845436096
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Misclassification from 70 to 92 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1512, Accuracy: 5524/10000 (55.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 8.0177, Accuracy: 216/9900 (2.1818%)
Done in 280.33033657073975 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 28, 21, 98, 56, 67, 90, 0, 37, 76, 54, 5, 19, 11, 25, 80, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4561/4885 (93.3675%), train_poison_data_count: 385
Global model norm: 45.15138787621525.
Norm before scaling: 45.13451709932281. Distance: 1.8674686491554853
Total norm for 4 adversaries is: 45.13451709932281. distance: 1.8674686491554853
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1716, Accuracy: 9488/9900 (95.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4852/5305 (91.4609%), train_poison_data_count: 415
Global model norm: 45.15138787621525.
Norm before scaling: 45.143000597320594. Distance: 2.1534754275551276
Total norm for 4 adversaries is: 45.143000597320594. distance: 2.1534754275551276
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1272, Accuracy: 9620/9900 (97.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4369/4717 (92.6224%), train_poison_data_count: 370
Global model norm: 45.15138787621525.
Norm before scaling: 45.136855155841054. Distance: 1.859322747530141
Total norm for 4 adversaries is: 45.136855155841054. distance: 1.859322747530141
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.2430, Accuracy: 9325/9900 (94.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4683/5066 (92.4398%), train_poison_data_count: 400
Global model norm: 45.15138787621525.
Norm before scaling: 45.13708097674862. Distance: 1.9866397579448796
Total norm for 4 adversaries is: 45.13708097674862. distance: 1.9866397579448796
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1652, Accuracy: 9466/9900 (95.6162%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4269/4716 (90.5216%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4301/4716 (91.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8676, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4155/4634 (89.6634%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4215/4634 (90.9581%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8619, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3472/3828 (90.7001%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3541/3828 (92.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8653, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4605/4989 (92.3031%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4651/4989 (93.2251%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8398, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4692/5116 (91.7123%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4696/5116 (91.7905%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9440, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4164/4362 (95.4608%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4170/4362 (95.5983%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8081, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4634/5017 (92.3660%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4660/5017 (92.8842%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9811, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3922/4354 (90.0781%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   2,  Average loss: 0.0113, Accuracy: 3464/4354 (79.5590%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.6739, Accuracy: 4620/10000 (46.2000%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3291/3638 (90.4618%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3358/3638 (92.3035%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8402, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4730/5195 (91.0491%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4670/5195 (89.8941%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1689, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4182/4596 (90.9922%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4252/4596 (92.5152%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0715, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4455/4928 (90.4018%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4540/4928 (92.1266%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8895, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4602/5244 (87.7574%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4580/5244 (87.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0523, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5256/5902 (89.0546%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5144/5902 (87.1569%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1695, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4589/5025 (91.3234%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4586/5025 (91.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9839, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5445/6124 (88.9125%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5425/6124 (88.5859%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0250, Accuracy: 5520/10000 (55.2000%)
time spent on training: 266.5252413749695
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1594, Accuracy: 5514/10000 (55.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 8.3047, Accuracy: 194/9900 (1.9596%)
Done in 290.9267635345459 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 67, 49, 55, 96, 77, 18, 20, 2, 21, 65, 90, 88, 72, 33, 19, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4539/4885 (92.9171%), train_poison_data_count: 385
Global model norm: 45.183064054397086.
Norm before scaling: 45.166642943278674. Distance: 1.9405863391016789
Total norm for 4 adversaries is: 45.166642943278674. distance: 1.9405863391016789
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0991, Accuracy: 9643/9900 (97.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4849/5305 (91.4043%), train_poison_data_count: 415
Global model norm: 45.183064054397086.
Norm before scaling: 45.17138046685368. Distance: 2.111347773599021
Total norm for 4 adversaries is: 45.17138046685368. distance: 2.111347773599021
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.2226, Accuracy: 9372/9900 (94.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4324/4717 (91.6684%), train_poison_data_count: 370
Global model norm: 45.183064054397086.
Norm before scaling: 45.17080755829754. Distance: 1.9429242897852201
Total norm for 4 adversaries is: 45.17080755829754. distance: 1.9429242897852201
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.1305, Accuracy: 9562/9900 (96.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4701/5066 (92.7951%), train_poison_data_count: 400
Global model norm: 45.183064054397086.
Norm before scaling: 45.16851450012982. Distance: 1.956272061744577
Total norm for 4 adversaries is: 45.16851450012982. distance: 1.956272061744577
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.1203, Accuracy: 9611/9900 (97.0808%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4723/5116 (92.3182%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4696/5116 (91.7905%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9854, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4806/5197 (92.4764%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4762/5197 (91.6298%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0705, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3974/4356 (91.2305%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4007/4356 (91.9881%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0995, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4346/4679 (92.8831%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4111/4679 (87.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.4407, Accuracy: 4928/10000 (49.2800%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4229/4647 (91.0049%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4240/4647 (91.2417%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8871, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3725/3911 (95.2442%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3738/3911 (95.5766%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7847, Accuracy: 5967/10000 (59.6700%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4007/4315 (92.8621%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4033/4315 (93.4647%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7965, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3301/3646 (90.5376%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3377/3646 (92.6221%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8950, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4227/4634 (91.2171%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4224/4634 (91.1524%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9657, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4576/5055 (90.5242%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4661/5055 (92.2057%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0426, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4132/4362 (94.7272%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4182/4362 (95.8735%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8789, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4433/4934 (89.8460%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4054/4934 (82.1646%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.4494, Accuracy: 4915/10000 (49.1500%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4361/4767 (91.4831%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4382/4767 (91.9236%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1003, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4127/4433 (93.0972%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4163/4433 (93.9093%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7907, Accuracy: 5929/10000 (59.2900%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4423/4928 (89.7524%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4526/4928 (91.8425%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9352, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3514/3837 (91.5820%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3586/3837 (93.4584%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8460, Accuracy: 5754/10000 (57.5400%)
time spent on training: 260.67002749443054
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1380, Accuracy: 5556/10000 (55.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 8.3826, Accuracy: 183/9900 (1.8485%)
Done in 285.55253744125366 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 1, 72, 20, 87, 57, 98, 96, 46, 55, 6, 69, 9, 10, 92, 62, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4554/4885 (93.2242%), train_poison_data_count: 385
Global model norm: 45.210404918454614.
Norm before scaling: 45.19749819153088. Distance: 1.9131622688678693
Total norm for 4 adversaries is: 45.19749819153088. distance: 1.9131622688678693
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1530, Accuracy: 9522/9900 (96.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4832/5305 (91.0839%), train_poison_data_count: 415
Global model norm: 45.210404918454614.
Norm before scaling: 45.202813093030365. Distance: 2.1950418434412606
Total norm for 4 adversaries is: 45.202813093030365. distance: 2.1950418434412606
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1948, Accuracy: 9422/9900 (95.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4352/4717 (92.2620%), train_poison_data_count: 370
Global model norm: 45.210404918454614.
Norm before scaling: 45.19499851338641. Distance: 1.9110444233161021
Total norm for 4 adversaries is: 45.19499851338641. distance: 1.9110444233161021
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.2423, Accuracy: 9314/9900 (94.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4659/5066 (91.9660%), train_poison_data_count: 400
Global model norm: 45.210404918454614.
Norm before scaling: 45.199238836580534. Distance: 2.0515080789755147
Total norm for 4 adversaries is: 45.199238836580534. distance: 2.0515080789755147
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0745, Accuracy: 9721/9900 (98.1919%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4566/4986 (91.5764%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4581/4986 (91.8773%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0335, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4362/4767 (91.5041%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4330/4767 (90.8328%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0912, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3910/4315 (90.6141%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4001/4315 (92.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8782, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3350/3672 (91.2309%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3372/3672 (91.8301%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0880, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4289/4558 (94.0983%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4309/4558 (94.5371%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9284, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3505/3828 (91.5622%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3577/3828 (93.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9416, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4398/4679 (93.9944%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4390/4679 (93.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0334, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4627/4956 (93.3616%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4605/4956 (92.9177%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0430, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4081/4356 (93.6869%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4003/4356 (91.8962%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9378, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4208/4538 (92.7281%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4251/4538 (93.6756%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7704, Accuracy: 5968/10000 (59.6800%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3667/4013 (91.3780%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3763/4013 (93.7702%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8037, Accuracy: 5913/10000 (59.1300%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5013/5265 (95.2137%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4939/5265 (93.8082%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8389, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4276/4663 (91.7006%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4333/4663 (92.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0658, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5918/6263 (94.4915%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5855/6263 (93.4856%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1688, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4528/5063 (89.4331%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4531/5063 (89.4924%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1353, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3995/4416 (90.4665%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4039/4416 (91.4629%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9149, Accuracy: 5710/10000 (57.1000%)
time spent on training: 263.7931172847748
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0502, Accuracy: 5668/10000 (56.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 8.5082, Accuracy: 169/9900 (1.7071%)
Done in 288.07227087020874 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 38, 93, 64, 72, 32, 99, 46, 4, 78, 12, 53, 75, 94, 84, 33, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4519/4885 (92.5077%), train_poison_data_count: 385
Global model norm: 45.23673218167469.
Norm before scaling: 45.223460470790215. Distance: 1.9399090833105093
Total norm for 4 adversaries is: 45.223460470790215. distance: 1.9399090833105093
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.2470, Accuracy: 9326/9900 (94.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4868/5305 (91.7625%), train_poison_data_count: 415
Global model norm: 45.23673218167469.
Norm before scaling: 45.2254929751324. Distance: 2.143325995061404
Total norm for 4 adversaries is: 45.2254929751324. distance: 2.143325995061404
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1507, Accuracy: 9525/9900 (96.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4370/4717 (92.6436%), train_poison_data_count: 370
Global model norm: 45.23673218167469.
Norm before scaling: 45.21994588518849. Distance: 1.9032368218404023
Total norm for 4 adversaries is: 45.21994588518849. distance: 1.9032368218404023
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0544, Accuracy: 9763/9900 (98.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4668/5066 (92.1437%), train_poison_data_count: 400
Global model norm: 45.23673218167469.
Norm before scaling: 45.22730541689873. Distance: 2.0284292736365623
Total norm for 4 adversaries is: 45.22730541689873. distance: 2.0284292736365623
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.2848, Accuracy: 9204/9900 (92.9697%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5277/5740 (91.9338%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5288/5740 (92.1254%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0872, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4248/4651 (91.3352%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4243/4651 (91.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9596, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4155/4503 (92.2718%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4172/4503 (92.6493%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0008, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4382/4767 (91.9236%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4350/4767 (91.2524%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1471, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5151/5591 (92.1302%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5141/5591 (91.9514%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0088, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4093/4465 (91.6685%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4192/4465 (93.8858%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7755, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4657/4956 (93.9669%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4570/4956 (92.2115%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0403, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3390/3704 (91.5227%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3439/3704 (92.8456%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7463, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3699/4025 (91.9006%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3782/4025 (93.9627%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8691, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4636/5083 (91.2060%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4624/5083 (90.9699%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1399, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5514/6124 (90.0392%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5435/6124 (88.7492%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0832, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4001/4295 (93.1548%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3956/4295 (92.1071%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9938, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4432/4804 (92.2565%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4319/4804 (89.9042%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1436, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4395/4793 (91.6962%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4429/4793 (92.4056%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1272, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4138/4433 (93.3454%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4090/4433 (92.2626%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8491, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4095/4361 (93.9005%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3968/4361 (90.9883%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9731, Accuracy: 5671/10000 (56.7100%)
time spent on training: 263.03167605400085
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0538, Accuracy: 5658/10000 (56.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 8.8624, Accuracy: 91/9900 (0.9192%)
Done in 287.1297652721405 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 57, 5, 82, 91, 40, 29, 96, 74, 98, 27, 9, 53, 97, 46, 38, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4542/4885 (92.9785%), train_poison_data_count: 385
Global model norm: 45.26318437068917.
Norm before scaling: 45.25054223173049. Distance: 1.9798379529281522
Total norm for 4 adversaries is: 45.25054223173049. distance: 1.9798379529281522
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.2687, Accuracy: 9294/9900 (93.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4828/5305 (91.0085%), train_poison_data_count: 415
Global model norm: 45.26318437068917.
Norm before scaling: 45.25038037219273. Distance: 2.1713373630233694
Total norm for 4 adversaries is: 45.25038037219273. distance: 2.1713373630233694
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.1550, Accuracy: 9506/9900 (96.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4356/4717 (92.3468%), train_poison_data_count: 370
Global model norm: 45.26318437068917.
Norm before scaling: 45.24607874282105. Distance: 1.8699817897297553
Total norm for 4 adversaries is: 45.24607874282105. distance: 1.8699817897297553
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.1544, Accuracy: 9527/9900 (96.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4674/5066 (92.2621%), train_poison_data_count: 400
Global model norm: 45.26318437068917.
Norm before scaling: 45.25203266109642. Distance: 2.029556389994433
Total norm for 4 adversaries is: 45.25203266109642. distance: 2.029556389994433
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.2614, Accuracy: 9293/9900 (93.8687%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4265/4558 (93.5717%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4214/4558 (92.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9882, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4202/4596 (91.4273%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4237/4596 (92.1889%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9602, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4514/4874 (92.6139%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4308/4874 (88.3874%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2625, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3758/4158 (90.3800%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3752/4158 (90.2357%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0432, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4945/5455 (90.6508%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5019/5455 (92.0073%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9573, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3982/4346 (91.6245%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4025/4346 (92.6139%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9438, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4356/4679 (93.0968%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4148/4679 (88.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0972, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3954/4416 (89.5380%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4021/4416 (91.0553%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9423, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3535/3828 (92.3459%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3588/3828 (93.7304%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8585, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3869/4223 (91.6173%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3928/4223 (93.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8576, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4951/5265 (94.0361%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4878/5265 (92.6496%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.7901, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5480/6124 (89.4840%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5463/6124 (89.2064%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9861, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4064/4361 (93.1896%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4062/4361 (93.1438%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9557, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4591/4956 (92.6352%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4666/4956 (94.1485%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0654, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5295/5740 (92.2474%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5319/5740 (92.6655%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0403, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3761/4013 (93.7204%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3803/4013 (94.7670%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.7418, Accuracy: 5998/10000 (59.9800%)
time spent on training: 259.6533246040344
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0159, Accuracy: 5697/10000 (56.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 8.6821, Accuracy: 127/9900 (1.2828%)
Done in 283.88063168525696 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 23, 63, 91, 78, 59, 80, 62, 89, 93, 55, 43, 66, 68, 94, 24, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4518/4885 (92.4872%), train_poison_data_count: 385
Global model norm: 45.29073022308897.
Norm before scaling: 45.27790705396507. Distance: 1.978993364744161
Total norm for 4 adversaries is: 45.27790705396507. distance: 1.978993364744161
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.2935, Accuracy: 9220/9900 (93.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4858/5305 (91.5740%), train_poison_data_count: 415
Global model norm: 45.29073022308897.
Norm before scaling: 45.28078361992397. Distance: 2.153386412144496
Total norm for 4 adversaries is: 45.28078361992397. distance: 2.153386412144496
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0993, Accuracy: 9647/9900 (97.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4344/4717 (92.0924%), train_poison_data_count: 370
Global model norm: 45.29073022308897.
Norm before scaling: 45.277591618088245. Distance: 1.9076635404102698
Total norm for 4 adversaries is: 45.277591618088245. distance: 1.9076635404102698
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1485, Accuracy: 9510/9900 (96.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4666/5066 (92.1042%), train_poison_data_count: 400
Global model norm: 45.29073022308897.
Norm before scaling: 45.277451423659826. Distance: 1.9936415807249883
Total norm for 4 adversaries is: 45.277451423659826. distance: 1.9936415807249883
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1395, Accuracy: 9552/9900 (96.4848%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3799/4184 (90.7983%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3847/4184 (91.9455%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9333, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3311/3590 (92.2284%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3156/3590 (87.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0284, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3778/4158 (90.8610%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3737/4158 (89.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0154, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3756/4025 (93.3168%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3793/4025 (94.2360%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8186, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3724/4046 (92.0415%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3767/4046 (93.1043%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8669, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4602/5025 (91.5821%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4579/5025 (91.1244%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0061, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4580/5063 (90.4602%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4505/5063 (88.9789%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0062, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3972/4356 (91.1846%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3868/4356 (88.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1313, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4274/4651 (91.8942%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4256/4651 (91.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9459, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4021/4356 (92.3095%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3721/4356 (85.4224%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3776, Accuracy: 5009/10000 (50.0900%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4219/4576 (92.1984%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4277/4576 (93.4659%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0117, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4115/4456 (92.3474%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4121/4456 (92.4820%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9255, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3042/3297 (92.2657%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3070/3297 (93.1150%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7679, Accuracy: 5948/10000 (59.4800%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4450/4804 (92.6311%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3955/4804 (82.3272%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2509, Accuracy: 5036/10000 (50.3600%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3714/3969 (93.5752%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3696/3969 (93.1217%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8289, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4839/5195 (93.1473%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4743/5195 (91.2993%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9185, Accuracy: 5724/10000 (57.2400%)
time spent on training: 257.47651624679565
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1015, Accuracy: 5597/10000 (55.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 8.6133, Accuracy: 156/9900 (1.5758%)
Done in 281.6719057559967 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 15, 40, 96, 34, 81, 28, 11, 82, 19, 61, 98, 30, 76, 63, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4526/4885 (92.6510%), train_poison_data_count: 385
Global model norm: 45.31399782007211.
Norm before scaling: 45.3001410947375. Distance: 1.9650079798839726
Total norm for 4 adversaries is: 45.3001410947375. distance: 1.9650079798839726
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0840, Accuracy: 9678/9900 (97.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4858/5305 (91.5740%), train_poison_data_count: 415
Global model norm: 45.31399782007211.
Norm before scaling: 45.30535504013295. Distance: 2.1568550698335867
Total norm for 4 adversaries is: 45.30535504013295. distance: 2.1568550698335867
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0611, Accuracy: 9756/9900 (98.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4344/4717 (92.0924%), train_poison_data_count: 370
Global model norm: 45.31399782007211.
Norm before scaling: 45.30045098423414. Distance: 1.9496058383574038
Total norm for 4 adversaries is: 45.30045098423414. distance: 1.9496058383574038
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1198, Accuracy: 9590/9900 (96.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4668/5066 (92.1437%), train_poison_data_count: 400
Global model norm: 45.31399782007211.
Norm before scaling: 45.301687826414096. Distance: 2.091731450672136
Total norm for 4 adversaries is: 45.301687826414096. distance: 2.091731450672136
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0291, Accuracy: 9820/9900 (99.1919%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3555/3837 (92.6505%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3587/3837 (93.4845%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8564, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5223/5582 (93.5686%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5116/5582 (91.6517%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1719, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5093/5455 (93.3639%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5022/5455 (92.0623%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9773, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4383/4679 (93.6739%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4419/4679 (94.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9651, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4151/4518 (91.8769%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4136/4518 (91.5449%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1474, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4328/4618 (93.7202%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4357/4618 (94.3482%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9282, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4263/4716 (90.3944%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4310/4716 (91.3910%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8807, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4681/5244 (89.2639%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4672/5244 (89.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0031, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4484/4874 (91.9984%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4459/4874 (91.4854%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0449, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4502/4928 (91.3555%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4523/4928 (91.7817%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9085, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3795/4126 (91.9777%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3819/4126 (92.5594%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8954, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3535/3828 (92.3459%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3561/3828 (93.0251%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9037, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3206/3472 (92.3387%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3177/3472 (91.5035%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9196, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3332/3638 (91.5888%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3372/3638 (92.6883%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8636, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3338/3590 (92.9805%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3331/3590 (92.7855%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8330, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3908/4223 (92.5408%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3957/4223 (93.7012%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7808, Accuracy: 5870/10000 (58.7000%)
time spent on training: 257.6519763469696
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0489, Accuracy: 5670/10000 (56.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 8.7966, Accuracy: 132/9900 (1.3333%)
Done in 281.9937860965729 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 48, 0, 3, 49, 55, 40, 68, 54, 98, 66, 97, 73, 80, 2, 91, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4511/4885 (92.3439%), train_poison_data_count: 385
Global model norm: 45.340061660812175.
Norm before scaling: 45.326686895490994. Distance: 1.98648889841837
Total norm for 4 adversaries is: 45.326686895490994. distance: 1.98648889841837
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1599, Accuracy: 9509/9900 (96.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4858/5305 (91.5740%), train_poison_data_count: 415
Global model norm: 45.340061660812175.
Norm before scaling: 45.327842230245196. Distance: 2.1665231094730135
Total norm for 4 adversaries is: 45.327842230245196. distance: 2.1665231094730135
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0985, Accuracy: 9671/9900 (97.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4350/4717 (92.2196%), train_poison_data_count: 370
Global model norm: 45.340061660812175.
Norm before scaling: 45.325905883287376. Distance: 1.934800574797426
Total norm for 4 adversaries is: 45.325905883287376. distance: 1.934800574797426
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0392, Accuracy: 9812/9900 (99.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4683/5066 (92.4398%), train_poison_data_count: 400
Global model norm: 45.340061660812175.
Norm before scaling: 45.32794187312198. Distance: 1.969914046799028
Total norm for 4 adversaries is: 45.32794187312198. distance: 1.969914046799028
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.2147, Accuracy: 9410/9900 (95.0505%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4128/4441 (92.9520%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4181/4441 (94.1455%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9497, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4626/5017 (92.2065%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4617/5017 (92.0271%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9174, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4509/4918 (91.6836%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4527/4918 (92.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0023, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4869/5197 (93.6887%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4767/5197 (91.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1421, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4082/4356 (93.7098%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3845/4356 (88.2691%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0626, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5057/5455 (92.7039%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4987/5455 (91.4207%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9825, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3048/3297 (92.4477%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3075/3297 (93.2666%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7166, Accuracy: 6002/10000 (60.0200%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4838/5195 (93.1280%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4774/5195 (91.8961%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1890, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3549/3828 (92.7116%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3543/3828 (92.5549%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7815, Accuracy: 5987/10000 (59.8700%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4105/4456 (92.1230%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4144/4456 (92.9982%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9497, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4080/4361 (93.5565%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4038/4361 (92.5934%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9493, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3952/4235 (93.3176%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3840/4235 (90.6730%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0312, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4607/5025 (91.6816%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4616/5025 (91.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0394, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3338/3646 (91.5524%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3400/3646 (93.2529%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8364, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3767/4158 (90.5964%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3762/4158 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8972, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4219/4538 (92.9705%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4252/4538 (93.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9088, Accuracy: 5710/10000 (57.1000%)
time spent on training: 260.9097557067871
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0510, Accuracy: 5637/10000 (56.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 9.0691, Accuracy: 88/9900 (0.8889%)
Done in 285.500874042511 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 15, 87, 34, 52, 90, 94, 67, 80, 68, 4, 42, 14, 82, 77, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4545/4885 (93.0399%), train_poison_data_count: 385
Global model norm: 45.36489158668711.
Norm before scaling: 45.34776106483924. Distance: 1.9223325851427508
Total norm for 4 adversaries is: 45.34776106483924. distance: 1.9223325851427508
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.2601, Accuracy: 9318/9900 (94.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4875/5305 (91.8944%), train_poison_data_count: 415
Global model norm: 45.36489158668711.
Norm before scaling: 45.351795999614225. Distance: 2.117138626266497
Total norm for 4 adversaries is: 45.351795999614225. distance: 2.117138626266497
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1564, Accuracy: 9534/9900 (96.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4356/4717 (92.3468%), train_poison_data_count: 370
Global model norm: 45.36489158668711.
Norm before scaling: 45.34856592705689. Distance: 1.9137718135654478
Total norm for 4 adversaries is: 45.34856592705689. distance: 1.9137718135654478
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1337, Accuracy: 9550/9900 (96.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4689/5066 (92.5582%), train_poison_data_count: 400
Global model norm: 45.36489158668711.
Norm before scaling: 45.34953766474637. Distance: 1.9995061741566897
Total norm for 4 adversaries is: 45.34953766474637. distance: 1.9995061741566897
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1179, Accuracy: 9593/9900 (96.8990%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4031/4295 (93.8533%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3966/4295 (92.3399%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9262, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5236/5582 (93.8015%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5252/5582 (94.0881%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9251, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3325/3672 (90.5501%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3355/3672 (91.3671%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8885, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4179/4518 (92.4967%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4203/4518 (93.0279%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9641, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3539/3797 (93.2052%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3505/3797 (92.3097%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9170, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4142/4362 (94.9564%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4158/4362 (95.3232%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8020, Accuracy: 5924/10000 (59.2400%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4425/4804 (92.1107%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4163/4804 (86.6570%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3177, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4722/5116 (92.2987%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4721/5116 (92.2791%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8697, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4620/5025 (91.9403%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4617/5025 (91.8806%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0388, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3013/3297 (91.3861%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3084/3297 (93.5396%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8001, Accuracy: 5949/10000 (59.4900%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3432/3704 (92.6566%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3448/3704 (93.0886%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8245, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5062/5424 (93.3260%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5076/5424 (93.5841%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0002, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3584/3861 (92.8257%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3597/3861 (93.1624%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9628, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4419/4874 (90.6648%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4336/4874 (88.9618%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2820, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4202/4647 (90.4239%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4277/4647 (92.0379%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9210, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4040/4356 (92.7456%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3741/4356 (85.8815%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3218, Accuracy: 5036/10000 (50.3600%)
time spent on training: 260.00098276138306
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9686, Accuracy: 5754/10000 (57.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 8.9536, Accuracy: 97/9900 (0.9798%)
Done in 284.5083067417145 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 64, 14, 23, 34, 12, 94, 89, 11, 96, 74, 3, 86, 43, 16, 69, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4519/4885 (92.5077%), train_poison_data_count: 385
Global model norm: 45.39258816752879.
Norm before scaling: 45.37615679482728. Distance: 1.9897910271000092
Total norm for 4 adversaries is: 45.37615679482728. distance: 1.9897910271000092
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1280, Accuracy: 9573/9900 (96.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4863/5305 (91.6682%), train_poison_data_count: 415
Global model norm: 45.39258816752879.
Norm before scaling: 45.376320895891006. Distance: 2.1167446672780814
Total norm for 4 adversaries is: 45.376320895891006. distance: 2.1167446672780814
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1884, Accuracy: 9456/9900 (95.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4361/4717 (92.4528%), train_poison_data_count: 370
Global model norm: 45.39258816752879.
Norm before scaling: 45.37614872426785. Distance: 1.88642599863461
Total norm for 4 adversaries is: 45.37614872426785. distance: 1.88642599863461
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1524, Accuracy: 9500/9900 (95.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4699/5066 (92.7556%), train_poison_data_count: 400
Global model norm: 45.39258816752879.
Norm before scaling: 45.37909169309832. Distance: 2.0227774349846683
Total norm for 4 adversaries is: 45.37909169309832. distance: 2.0227774349846683
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.2306, Accuracy: 9319/9900 (94.1313%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4126/4503 (91.6278%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4109/4503 (91.2503%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9198, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3569/3861 (92.4372%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3594/3861 (93.0847%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8341, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3867/4184 (92.4235%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3806/4184 (90.9656%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8763, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4142/4518 (91.6777%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4180/4518 (92.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8430, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4666/5083 (91.7962%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4582/5083 (90.1436%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9613, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4456/4804 (92.7560%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4474/4804 (93.1307%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9266, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4020/4356 (92.2865%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3932/4356 (90.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2209, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4670/5244 (89.0542%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4651/5244 (88.6918%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0512, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4424/4679 (94.5501%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4299/4679 (91.8786%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0028, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3969/4416 (89.8777%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4059/4416 (91.9158%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9308, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4526/4918 (92.0293%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4577/4918 (93.0663%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0712, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3295/3616 (91.1228%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3366/3616 (93.0863%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8162, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4208/4576 (91.9580%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4237/4576 (92.5918%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9672, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4571/4928 (92.7557%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4615/4928 (93.6485%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8405, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3746/4013 (93.3466%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3793/4013 (94.5178%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.6893, Accuracy: 6027/10000 (60.2700%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3929/4336 (90.6135%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3994/4336 (92.1125%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9797, Accuracy: 5596/10000 (55.9600%)
time spent on training: 252.746515750885
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0266, Accuracy: 5687/10000 (56.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 8.9975, Accuracy: 77/9900 (0.7778%)
Done in 277.56680154800415 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 92, 30, 91, 76, 82, 55, 6, 16, 81, 47, 96, 77, 43, 59, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
